const mySQLDate="",defaultLocationDisplayFormat="medium",sideNavOptions={edge:"left",closeOnClick:!1,breakpoint:1199,menuWidth:240,timeDurationOpen:500,timeDurationClose:500,timeDurationOverlayOpen:200,timeDurationOverlayClose:200,easingOpen:"easeInOutQuad",easingClose:"easeInOutQuad",showOverlay:!0,showCloseButton:!1,slim:!1,onOpen:null,onClose:null,mode:"over"},toastrOptions={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"md-toast-bottom-right",preventDuplicates:!0,onclick:null,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},dow_short=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],days=[{0:{name:"Sunday",short:"Sun"}},{1:{name:"Monday",short:"Mon"}},{1:{name:"Tuesday",short:"Tue"}},{1:{name:"Wednesday",short:"Wed"}},{1:{name:"Thursday",short:"Thu"}},{1:{name:"Friday",short:"Fri"}},{1:{name:"Saturday",short:"Sat"}}],dowStart=1,short_dexcription_max=250,colorScheme=new Map,toggleAJAXResponse=!1,debugMode=!0;colorScheme.set(1,{name:"Color - 1",backGround:"#bdbdbd",borderColor:"#686868",textColor:"#000"}),colorScheme.set(2,{name:"Color - 2",backGround:"#54cbe3",borderColor:"#357f8e",textColor:"#000"}),colorScheme.set(3,{name:"Color - 3",backGround:"#49de94",borderColor:"#2d895b",textColor:"#000"}),colorScheme.set(4,{name:"Color - 4",backGround:"#ab8c82",borderColor:"#564641",textColor:"#000"}),colorScheme.set(5,{name:"Color - 5",backGround:"#ffcd17",borderColor:"#aa890f",textColor:"#000"}),colorScheme.set(6,{name:"Color - 6",backGround:"#96a3fa",borderColor:"#636ca5",textColor:"#000"}),colorScheme.set(7,{name:"Color - 7",backGround:"#fa983c",borderColor:"#a56428",textColor:"#000"}),colorScheme.set(8,{name:"Color - 8",backGround:"#17b3a3",borderColor:"#0c5e56",textColor:"#000"}),colorScheme.set(9,{name:"Color - 9",backGround:"#76838f",borderColor:"#30353a",textColor:"#fff"}),colorScheme.set(10,{name:"Color - 10",backGround:"#910112",borderColor:"#3c0007",textColor:"#fff"}),colorScheme.set(11,{name:"Color - 11",backGround:"#ff666b",borderColor:"#aa4447",textColor:"#000"}),colorScheme.set(12,{name:"Color - 12",backGround:"#3e8ef7",borderColor:"#295da2",textColor:"#000"}),colorScheme.set(13,{name:"Color - 13",backGround:"#f74584",borderColor:"#a22d57",textColor:"#000"}),colorScheme.set(14,{name:"Color - 14",backGround:"#5a9101",borderColor:"#253c00",textColor:"#fff"}),colorScheme.set(15,{name:"Color - 15",backGround:"#9463f7",borderColor:"#6141a2",textColor:"#fff"});const tableCellMaxChars=10,defaultAddressView="medium",DEBUGMODE=!0,inactivityTimeout=36e5,initialCalenderViewCount=12;let mdbPreloader=document.getElementById("mdb-preloader");$.fn.BuildDropDown=function(e){if(!e||!e.text_field||!e.id_field)return;let t=document.getElementById($(this).attr("id")),n=e.data?e.data:[],a=(e.class_list&&e.class_list,e.id_field?e.id_field:""),i=e.text_field?e.text_field:"",o=e.title?e.title:"Select Option",d=!!e.first_selectable&&e.firstSelectable,l=!!e.select2&&e.select2,r=e.type?e.type:"";if($(t).empty(),"multiple"===r&&t.setAttribute("multiple","multiple"),!1===d){let e=$(document.createElement("option")).prop({value:"",text:"-- "+o.charAt(0).toUpperCase()+o.slice(1)+" --",disabled:!0}).attr("readonly","readonly");$(t).append(e)}$.each(n,function(e,n){let o=n[a],d=n[i];$(t).append($(document.createElement("option")).prop({value:o,text:d.charAt(0).toUpperCase()+d.slice(1)}))}),$(t).val(""),l&&$(t).select2()};const clearAllValidation=function(){$("div.error").html("&nbsp;").hide(),$(".is-invalid").removeClass("is-invalid")};$.fn.showError=function(e){let t=this.parents("div.form-element").find("div.error");return this.addClass("is-invalid"),t.html(e).show(),this},$.fn.hideError=function(){let e=this.parents("div.form-element").find("div.error");return this.removeClass("is-invalid"),e.html("&nbsp;").hide(),this};const hexToRgb=e=>e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,a)=>"#"+t+t+n+n+a+a).substring(1).match(/.{2}/g).map(e=>parseInt(e,16));jQuery.fn.dataTable.Api.register("page.jumpToData()",function(e,t){var n=this.column(t,{order:"current"}).data().indexOf(e);if(n>=0){var a=Math.floor(n/this.page.info().length);this.page(a).draw(!1)}return this});const isOdd=function(e){return e%2},clearValidation=function(e){$(".autocomplete-suggestions").hide();var t=$(e).validate();$("[name]",e).each(function(){t&&(t.successList&&t.successList.push(this),t.showErrors())}),$(".is-invalid").each(function(){t&&(t.successList&&t.successList.push(this),t.showErrors())}),t&&(t.resetForm(),t.reset())},get_errors=function(e){},validator_init=function(e){let t={},n={},a={};return e&&(e.rules&&(t=e.rules),e.messages&&(n=e.messages),e.groups&&(a=e.groups)),jQuery.validator.setDefaults({rules:t,messages:n,groups:a,ignore:"",success:"valid",invalidHandler:function(e,t){t.numberOfInvalids();let n=t.findLastActive()||t.errorList.length&&t.errorList[0].element;n&&$(n).closest(".accordion-body").collapse("show")},errorElement:"span",highlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");a.attr("data-ref")?$("#"+a.attr("data-ref")).addClass("is-invalid"):(n.parent().find("span.select2").addClass("is-invalid"),n.addClass("is-invalid")),a&&a.css({display:"block"})},unhighlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");n.parents("div.form-element").find("span.select2").removeClass("is-invalid"),n.removeClass("is-invalid"),a&&a.css({display:"none"})},errorPlacement:function(e,t){let n=t.attr("id");$("#"+n+"-error").html(e)},submitHandler:function(e){return!0}}),jQuery.validator.addMethod("postalCode",function(e){return/^((\d{5}-\d{4})|(\d{5})|([A-Z]\d[A-Z]\s\d[A-Z]\d))$/.test(e)},"Please enter a valid postal code."),jQuery.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("phoneIT",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator},jsonPrettify=e=>{if("object"==typeof e&&null!==e)return JSON.stringify(e,void 0,"\t");try{const t=JSON.parse(e);return jsonPrettify(t)}catch(t){return e}},setError=function(e,t){let n=$(e).attr("id"),a=$("#"+n),i=$("#"+n+"-error");i.attr("data-ref")?$("#"+i.attr("data-ref")).addClass("is-invalid"):(a.parent().find("span.select2").addClass("is-invalid"),a.addClass("is-invalid")),i&&i.css({display:"block"}),$(i).append(`<span id="#${n}-error" class="invalid">${t}</span>`)},clearError=function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");a.attr("data-ref")?$("#"+a.attr("data-ref")).removeClass("is-invalid"):(n.parent().find("span.select2").removeClass("is-invalid"),n.removeClass("is-invalid")),a&&($(a).empty(),a.css({display:"none"}))},toNumbers=e=>e.map(Number),remove_nulls=function(e){let t={};return $.each(e,function(e,n){null===n||(t[e]=n)}),t},removeNulls=function(e){let t={};return $.each(e,function(e,n){null===n||(t[e]=n)}),t},buildMap=function(e,t){let n=new Map;return $.each(e,function(e,a){n.set(a[t],a)}),n},getListOfIds=function(e){if(e){if("string"==typeof e){let t=e.replace(/\s/g,"");return Array.from(t.split(","),Number)}if("object"==typeof e)return e}return[]},formatListOfIds=function(e){let t="";return e&&"object"==typeof e&&(t=e.join(",")),t},sendGetRequest=function(e,t,n){let a=[];if(!e||!t){let n=[];return e||n.push("url"),t||n.push("data_to_send"),handleError("Missing Data: "+n.join(", "))}$.getJSONRequest(e,t,function(e,t,i){return"success"===t&&void 0!==e.result?(a=e.result,n(a)):"failed"===t&&void 0===e.error?handleError(e):"success"===t&&void 0!==e.error?handleError(e.error):void 0})},sendPostRequest=function(e,t,n){let a=[];if(!e||!t)return e||(void 0).push("url"),t||(void 0).push("data_to_send"),handleError("Missing Data: "+(void 0).join(", "));$.postJSON(e,t,function(e,t,i){return"success"===t&&void 0!==e.result?e.result?(a=e.result,n(a)):handleError("Error Posting Data 1"):"failed"===t&&void 0===e.result?e.error?handleError(e.error):handleError("Error Posting Data"):handleError("Error Posting Data 2")})},getAjaxError=function(e,t,n){let a="",i={message:"",status:"",uri:n};return 404===e.status&&(a="Requested page( "+n+" ) not found. [404]"),i.message=a,i.status=e.status,i.uri=n,i.jqXHR=e,i},_display_ajax_error=function(e,t,n){let a="",i={message:"",status:"",uri:n};return a=0===e.status?"Not connected, verify Network.":404===e.status?"Requested page( "+n+" ) not found. [404]":500===e.status?e.responseJSON?e.responseJSON:"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error."+e.responseText,i.message=a,i.status=e.status,i.uri=n,i.jqXHR=e,i},handleError=function(e){e||(e="3Error processing request"),toastr.error(" -- "+e)},validInt=function(e){return e&&!isNaN(parseInt(e))?parseInt(e):null},formatDateMySQL=function(e){if(!e){new Date}return moment(e).format("YYYY-MM-DD HH:mm:ss")},resize_elements=function(){const e=document.getElementById("page"),t=document.getElementById("main"),n=document.getElementsByClassName("double-nav"),a=document.getElementById("screen_width"),i=document.getElementById("screen_height"),o=document.getElementsByClassName("page-footer"),d=document.getElementById("slide-out"),l=document.getElementById("page_header");let r=0,s=0,c=0,u=0,_=0,m=0;r=window.innerHeight,s=window.innerWidth,$.each(n,function(e,t){let n=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());c+=n}),$.each(o,function(e,t){let n=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());m+=n});let p=r-m-c-1+"px";d&&(_=isNaN(parseInt($(d).outerHeight()))?0:parseInt($(d).outerHeight()),u=isNaN(parseInt($(d).width()))?0:parseInt($(d).width())),e&&i&&a&&(t&&$(t).css({"padding-left":u+"px","min-height":r-m-c+"px!important"}),e&&e.setAttribute("style","min-height:"+p+"!important"),l&&l.setAttribute("style","margin-top:"+c+"px;"),i.innerText=r+"",a.innerText=s+"")},debounce=function(e){var t;return function(n){t&&clearTimeout(t),t=setTimeout(e,100,n)}},populateMultiSelect=function(e,t){for(var n,a=0,i=t.options.length;a<i;a++)n=t.options[a],-1!==e.indexOf(n.value)&&(n.selected=!0)},findObjectByKey=function(e,t,n){let a=[];for(var i=0;i<e.length;i++)e[i][t]===n&&a.push(e[i]);return a},addTinyMCE=function(e){tinymce.init({selector:"#"+e,menubar:!1,height:"400",plugins:"print visualblocks visualchars charmap hr pagebreak advlist lists",content_css:["https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","/assets/css/bootstrap.min.css","/assets/css/style.css"],body_class:"p-2",font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Open Sans=Open Sans; Roboto=Roboto;Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",toolbar1:"undo redo | styleselect | fontselect fontsizeselect | removeformat | numlist bullist checklist | outdent indent ",toolbar2:"cut copy | bold italic underline strikethrough | forecolor | alignleft aligncenter alignright alignjustify | backcolor",content_style:'body { font-family:"Roboto",sans-serif", sans-serif; font-size:14px; font-weight: 400 }',style_formats:[{title:"Headers",items:[{title:"h1",block:"h1"},{title:"h2",block:"h2"},{title:"h3",block:"h3"},{title:"h4",block:"h4"},{title:"h5",block:"h5"},{title:"h6",block:"h6"}]},{title:"Blocks",items:[{title:"p",block:"p"},{title:"div",block:"div"},{title:"pre",block:"pre"}]},{title:"Containers",items:[{title:"section",block:"section",wrapper:!0,merge_siblings:!1},{title:"article",block:"article",wrapper:!0,merge_siblings:!1},{title:"blockquote",block:"blockquote",wrapper:!0},{title:"hgroup",block:"hgroup",wrapper:!0},{title:"aside",block:"aside",wrapper:!0},{title:"figure",block:"figure",wrapper:!0}]}],branding:!1,resize:!1,setup:function(e){e.on("change",function(){e.save()})}})},htmlDecode=function(e){return $("<textarea/>").html(e).text()},is_null=function(e){return null==e};function decodeHtml(e){e||(e="");var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g,function(e){return t[e]})}function escapeHtml(e){e||(e="");var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}const setInt=function(e){let t=null;return e&&(isNaN(parseInt(e))||(t=e)),t},inactivityTime=function(){let e;function t(){location.href="/logout"}function n(){clearTimeout(e),e=setTimeout(t,inactivityTimeout)}window.onload=n,document.onmousemove=n,document.onkeydown=n},htmlEncode=function(e){return $("<textarea/>").text(e).html()},paddy=function(e,t,n){var a=void 0!==n?n:"0",i=new Array(1+11).join(a);return(i+e).slice(-i.length)},generateCodeDirectId=function(e){return e?"D"+(t=14,a=void 0!==n?n:"0",((i=new Array(1+11).join(a))+t).slice(-i.length)):"";var t,n,a,i},getDate=function(e){if(e.pickadate("picker"))return e.pickadate("picker").get()};jQuery.extend({postJSON:function(e,t,n){let a=$.ajax({url:e,type:"POST",data:t,dataType:"json"});return a.done(function(e){if($.isFunction(n))return n(e,"success"),!0}),a.fail(function(t,a,i){return console.error("Request failed",_display_ajax_error(t,a,e)),$.isFunction(n)&&(t.responseJSON,n(t,"failed")),!1}),a},getJSONRequest:function(e,t,n){let a=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!0});a.done(function(e){$.isFunction(n)&&n(e,"success")}),a.fail(function(t,a,i){let o=getAjaxError(t,0,e);if(void 0!==a){_display_ajax_error(t,a,e);console.log("err",getAjaxError(t,0,e))}else{_display_ajax_error(t,a,e)}$.isFunction(n)&&(i=o.message,console.log("msg -- ",i),console.log("msg -- ",o.message),n(i,"failed"))})},getJSON:function(e,t,n){let a=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!1});a.done(function(e){$.isFunction(n)&&n(e,"success")}),a.fail(function(t,a,i){console.log("Request failed"),console.log(_display_ajax_error(t,a,e)),$.isFunction(n)&&n(i,"failed")})}});const infoDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-info" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">${e}</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-info fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-info btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-info waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body");const n=document.getElementById("modalConfirm");if(n){const e=$(n);e.modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){t(!0),e.modal("hide")}),$(".btn-no").click(function(){t(!1),e.modal("hide")}),e.on("hidden.bs.modal",function(){e.remove()})}},confirmDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n            <div class="modal-dialog modal-sm modal-notify modal-info" role="document">\n                \x3c!--Content--\x3e\n                <div class="modal-content text-center">\n                    \x3c!--Header--\x3e\n                    <div class="modal-header d-flex justify-content-center">\n                        <p class="heading">${e}</p>\n                    </div>\n                    \x3c!--/.Header--\x3e\n                    \n                    \x3c!--Body--\x3e\n                    <div class="modal-body">\n                        <i class="fas fa-check fa-4x mb-3 animated rotateIn"></i>\n                    </div>\n                    \x3c!--/.Body--\x3e\n                   \n        \n                    \x3c!--Footer--\x3e\n                    <div class="modal-footer flex-center">\n                        <a type="button" class="btn btn-outline-info btn-sm waves-effect btn-no">no</a>\n                        <a class="btn btn-info btn-sm btn-yes">yes</a>\n                    </div>\n                    \x3c!--/.Footer--\x3e\n                    \n                </div>\n                \n                \x3c!--/.Content--\x3e\n\t        </div>\n        </div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body");const n=document.getElementById("modalConfirm");if(n){const e=$(n);e.modal({backdrop:"static",keyboard:!1}),$(".btn-yes").on("click",function(){t(!0),e.modal("hide")}),$(".btn-no").click(function(){t(!1),$("#modalConfirm").modal("hide")}).on("click",function(){t(!1),e.modal("hide")}),e.on("hidden.bs.modal",function(){$("#modalConfirm").remove()})}},deleteDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-danger" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">${e}</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-times fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-danger btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-danger waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body"),$("#modalConfirm").modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){t(!0),$("#modalConfirm").modal("hide")}),$(".btn-no").click(function(){t(!1),$("#modalConfirm").modal("hide")}),$("#modalConfirm").on("hidden.bs.modal",function(){$("#modalConfirm").remove()})},formatURL=function(e){return console.log("formatURL()",e),encodeURIComponent(e.trim())},buildMapsURL=function(e){let t,n,a,i,o,d,l;t=e.name?e.name:null,n=null!==(n=e.street_1?e.street_1:null)?n:null,a=null!==(a=e.street_2?e.street_2:null)?a:null,i=null!==(i=e.zipcode?e.zipcode:null)?i:null,o=null!==(o=e.city.name?e.city.name:null)?o:null,d=null!==(d=e.province.iso2?e.province.iso2:e.province.iso3?e.province.iso3:e.province.name?e.province.name:null)?d:null,l=null!==(l=e.province.name?e.country.name:e.country.iso2?e.country.iso2:e.country.iso3?e.country.iso3:null)?l:null;let r=[];is_null(t=null!==t?t:null)||r.push(t),is_null(n)||r.push(n),is_null(a)||r.push(a),is_null(o);let s="";is_null(o)||is_null(d)||is_null(i)?!is_null(o)||is_null(d)||is_null(i)?is_null(o)&&is_null(d)&&!is_null(i)?s=i:is_null(o)||!is_null(d)||is_null(i)?is_null(o)||is_null(d)||!is_null(i)||(s=o+" "+d):s=i+" "+o:s=i+" "+d:s=i+" "+o+" "+d,""!==s&&r.push(s),is_null(l)||r.push(l);let c=r.join(", ");var u;return u=c,console.log("formatURL()",u),`https://maps.google.com/maps?q=${c=encodeURIComponent(u.trim())}&t=&z=7&ie=UTF8&iwloc=&output=embed`},weatherUpdate=function(e){const t=new XMLHttpRequest;let n=e;t.open("GET",`https://api.openweathermap.org/data/2.5/weather?q=${n}&appid=2ad550b2d7e352b38c3ca9da8396aade`),t.send(),t.onload=(()=>{if(404===t.status);else{let e=JSON.parse(t.response);e.name,Math.round(e.main.temp-273.15),e.weather[0].main,e.weather[0].description,e.weather[0].icon}})},ucwords=function(e){return(e=e.toLowerCase()).replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};String.prototype.ucwords=function(){return str=this.toLowerCase(),str.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},$(function(){$(".debug").on("click",function(){showElements=!0,$(this).attr("data-shown")||($(this).attr("data-shown","true"),showElements=!0),"false"===$(this).attr("data-shown")?($(this).attr("data-shown","true"),showElements=!0):(showElements=!1,$(this).attr("data-shown","false"));let e=document.getElementsByClassName("dev-element");for(let t=0;t<e.length;t++){let n=e[t],a=n.tagName;"input"===a.toLowerCase()?!1===showElements?(n.hidden=!1,n.type="text"):(n.hidden=!0,n.type="hidden"):"label"===a.toLowerCase()&&(!1===showElements?$(n).removeClass("d-none"):$(n).addClass("d-none"))}}),$(".debug_demo").on("click",function(){showElements=!0,$(this).attr("data-shown")||($(this).attr("data-shown","true"),showElements=!0),"false"===$(this).attr("data-shown")?($(this).attr("data-shown","true"),showElements=!0):(showElements=!1,$(this).attr("data-shown","false"));let e=document.getElementsByClassName("dev-element");for(let t=0;t<e.length;t++){let n=e[t],a=n.tagName;"input"===a.toLowerCase()?!1===showElements?(n.hidden=!1,n.type="text"):(n.hidden=!0,n.type="hidden"):"label"===a.toLowerCase()&&(!1===showElements?$(n).removeClass("d-none"):$(n).addClass("d-none"))}})});const Console={error:function(){},log:function(){let e,t,n;arguments.length>0&&(1===arguments.length&&(e="Log Object",n=arguments[0]),2===arguments.length&&("string"==typeof arguments[0]?e=arguments[0]:(e="Log Object",n=arguments[0]),"object"==typeof arguments[1]?(t=" [object] ",n=arguments[1]):"boolean"==typeof arguments[1]?(t=" [boolean] ",n=arguments[1]):"number"==typeof arguments[1]?(t=" [number] ",n=arguments[1]):"bigint"==typeof arguments[1]?(t=" [bigint] ",n=arguments[1]):"string"==typeof arguments[1]?(t=" [string] ",n=arguments[1]):"symbol"==typeof arguments[1]?(t=" [symbol] ",n=arguments[1]):"function"==typeof arguments[1]?(t=" [function] ",n=arguments[1]):(t=" [other] ",n=arguments[1]),console.log(e+t,n)))}};$.fn.formFields=function(e){"use strict";let t=$(this).attr("id"),n=document.getElementById(t),a=n.elements,i=document.createElement("pre"),o=document.createElement("code"),d="",l="";o.id="constantFields",o.classList=["language-javascript"],i.appendChild(o),n.appendChild(i);for(var r=0;r<a.length;r++){let e=a[r];if(e.id){let t=e.id;d+=`const _${t} = document.getElementById('${t}')\n`,l+=`_${t}.value = ""\n`}}$(o).attr("data-prismjs-copy","Copy the JavaScript snipp"),o.innerHTML=d+"\n"+l,Prism.highlightElement(o)},jQuery(e=>{e.fn.dateSelect=function(t){let n,a,i,o,d,l,r,s,c,u,_=e(this),m=_.attr("id");_.attr("id","date-selector-"+m);let p={monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],showMonthsShort:void 0,showWeekdaysFull:void 0,today:"Today",clear:"Clear",close:"Close",labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd",hiddenPrefix:void 0,hiddenSuffix:"_submit",hiddenName:void 0,editable:void 0,selectYears:void 0,selectMonths:void 0,firstDay:void 0,min:void 0,max:void 0,disable:void 0,container:void 0,containerHidden:void 0,closeOnSelect:!0,closeOnClear:!0,onStart:void 0,onRender:void 0,onOpen:void 0,onClose:void 0,onSet:void 0,onStop:void 0},f={label:"Date",placeholder:"Select Date"};const y=function(t){e(t).parents("div.form-element").find("div.error").html("").hide()},g=function(t,n){let a=t.value;16===n&&(isShift=!0),/(((19|20)\d\d)\-(0[1-9]|1[0-2])\-((0|1)[0-9]|2[0-9]|3[0-1]))$/.test(a)||0===a.length?(y(t),h.picker.set("select",a,{format:"yyyy-mm-dd"}),h.picker.render()):function(t){e(t).parents("div.form-element").find("div.error").html("Invalid Date. Only YYYY-MM-DD format allowed.").show()}(t)},v=function(t,u){n=t,a=e("<div>").addClass("form-element"),i=e("<div>").addClass("input-group"),o=e("<div>").addClass("input-group-append"),d=e("<button type='button'>").attr("id","button-"+m).attr("type","button").addClass("btn btn-md btn-secondary m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-calendar-alt"></i>').on("click",function(e){e.preventDefault()}),c=e("<button type='button'>").attr("id","button-clear-"+m).addClass("btn btn-md btn-outline-danger m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-ban"></i>').on("click",function(){h.clear(),l.val("").trigger("change"),y(l[0])}),l=e("<input>").addClass("form-control date-format").attr("id",m).attr("type","text").attr("placeholder",f.placeholder).attr("maxlength","10").on("keydown",function(e){return t=this,n=e.keyCode,isNaN(parseInt(n))||(n=parseInt(n)),16===n&&(isShift=!0),(n>=48&&n<=57||n>=96&&n<=105||8===n||46===n)&&16!==n&&(4!==t.value.length&&7!==t.value.length||8===n||(t.value+="-"),!0);var t,n}).on("keyup",function(e){g(this,e.keyCode),b()}).on("change",function(){b()}),r=e("<label>").attr("for",m).html(f.label),s=e("<div>").addClass("error w-100 text-center")},b=function(){if(""!==l.val()){c.show();let e=l.attr("id");clearError(document.getElementById(e))}else c.hide()},h={picker:null,val:null,fooListener:function(e){},registerNewListener:function(e){this.fooListener=e},set:function(){var e;e||(e={}),h.picker.set(e,{muted:!0})},value:function(e){return e||(e=null),(t=e)?(h.picker.set("select",t,{format:"yyyy-mm-dd"}),h.picker.render(),null):""===l.val()?null:l.val();var t},clear:function(){h.picker.clear()&&(h.picker.clear(),h.picker.set("select",moment().format("YYYY-MM-DD"),{format:"yyyy-mm-dd"}),h.picker.render(),y(l[0]))},init:function(e,t){I(e,t)}},I=function(t,_){var m;(m=_)&&e.each(m,function(e,t){p[e]=t}),f.label=e(t).attr("data-label")?e(t).attr("data-label"):"Date",f.placeholder=e(t).attr("data-placeholder")?e(t).attr("data-placeholder"):"Select Date",function(e,t){v(e),o.append(c,d),i.append(l,o),a.append(r,i,s),n.append(a),u=d.pickadate("picker")}(t),d.pickadate(p).on("change",function(){""===e(this).val()?l.val(""):l.val(e(this).val()),l.trigger("change")}),u=d.pickadate("picker"),b(),h.picker=d.pickadate("picker")};return I(_,t),h}});const tinyEditor=function(){"use strict";let e;const t=function(e){tinymce.init({selector:"#"+e,menubar:!1,height:"400",plugins:"print visualblocks visualchars charmap hr pagebreak advlist lists",content_css:["https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","/public/css/bootstrap.min.css","/public/css/style.css","/public/css/variant.min.css"],body_class:"p-2",font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Open Sans=Open Sans;Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",toolbar1:"undo redo | styleselect | fontselect fontsizeselect | removeformat | numlist bullist checklist | outdent indent ",toolbar2:"cut copy | bold italic underline strikethrough | forecolor | alignleft aligncenter alignright alignjustify | backcolor",content_style:'body { font-family:"Open Sans", sans-serif; font-size:14px; font-weight: 400 }',style_formats:[{title:"Headers",items:[{title:"h1",block:"h1"},{title:"h2",block:"h2"},{title:"h3",block:"h3"},{title:"h4",block:"h4"},{title:"h5",block:"h5"},{title:"h6",block:"h6"}]},{title:"Blocks",items:[{title:"p",block:"p"},{title:"div",block:"div"},{title:"pre",block:"pre"}]},{title:"Containers",items:[{title:"section",block:"section",wrapper:!0,merge_siblings:!1},{title:"article",block:"article",wrapper:!0,merge_siblings:!1},{title:"blockquote",block:"blockquote",wrapper:!0},{title:"hgroup",block:"hgroup",wrapper:!0},{title:"aside",block:"aside",wrapper:!0},{title:"figure",block:"figure",wrapper:!0}]}],branding:!1,resize:!1,setup:function(e){e.on("change",function(){e.save()})}})};return{addTinyMCE:function(e){t(e)},init:function(){(e=document.querySelectorAll(".but_toggle")).forEach(e=>e.addEventListener("click",n=>{if(e.dataset.texted){let n=e.dataset.texted,a=$("#"+n),i=a.parents("div.card");tinyMCE.get(n)?(a.val(htmlEncode(a.val())),tinymce.remove("#"+n),i.removeClass("is-fullscreen")):(a.val(decodeHtml(a.val())),i.addClass("is-fullscreen"),t(n))}}))}}}();$(document).ready(function(){$(function(){tinyEditor.init()})});const ContextMenu=function(){"use strict";let e;const t=function(t){e=$.contextMenu({selector:".selected-day",callback:function(e,t){switch(e.toLowerCase()){case"edit":console.log("ContextMenu:assignSeasonToDays()",ContextMenu)}},items:{edit:{name:"Assign Season To Days",icon:"edit"},cut:{name:"Cut",icon:"cut"},copy:{name:"Copy",icon:"copy"},paste:{name:"Paste",icon:"paste"},delete:{name:"Delete",icon:"delete"},sep1:"---------",quit:{name:"Quit",icon:function(){return"context-menu-icon context-menu-icon-quit"}}}}),$(".selected-day").on("click",function(e){})};return{init:function(e){t()}}}(),Season=function(){"use strict";const t=document.getElementById("edit_product_season"),n=document.getElementById("product_edit_season_form_edit_season_link"),a=(document.getElementById("product_season"),document.getElementById("product_edit_season_form_season_name_filter")),i=document.getElementById("category_id"),o=document.getElementById("product_edit_season_form_season_color_scheme_id"),d=document.getElementById("product_edit_season_form_season_id"),l=document.getElementById("product_edit_season_form_season_name"),r=document.getElementById("product_edit_season_id_name_display"),s=document.getElementById("product_edit_season_form_season_enabled"),c=document.getElementById("edit_season_button"),u=document.getElementById("table_season_product_edit"),_=document.getElementById("button_clear_form_edit_season"),m=document.getElementById("display_product_season_name"),p=document.getElementById("button_submit_form_edit_season"),f=document.getElementById("product_id"),y=document.getElementById("panel_tab_season"),g=document.getElementById("button_remove_season_from_product"),v=document.getElementById("calendar_loader"),b=document.getElementById("table_season_product_edit_add_new_button");document.getElementById("product_edit_season_section");let h,I,w=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,E=new Map,C=!1;$(b).on("click",function(){Y(),l.disabled=!1,l.readonly=!1,ColorScheme.enable()}),$(g).on("click",function(){let e={product_id:parseInt(f.value),season_id:parseInt(d.value)};confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&M(e)})}),$(n).on("click",function(){Q()}),$(c).on("click",function(){ColorScheme.enable()}),$(_).on("click",function(){a.value="",O(),A(),h.clearSelectedRows()}),$(p).on("click",function(){let e=N();confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&B(e)})}),$(y).on("hide.bs.tab",function(){a.value="",O(),A(),h&&h.clearSelectedRows()});const k=function(){0===Array.from(Season.all.values()).length?$(y).html('Season <span id="seasonNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>'):$(y).html("Season"),Product.updateProgress()},B=function(e){e&&$(v).fadeIn("fast",function(){x(e,function(e){if(e){let t=e[0]?e[0]:e;q(t)}else YearCalendar.endLoading()})})},x=function(e,t){if(e)try{sendPostRequest("/api/v1.0/seasons/update",e,function(e,n,a){if(e)return t(e);S("Oops: 1")})}catch(e){console.log("error",e)}},M=function(e){e&&$(v).fadeIn("fast",function(){!function(e,t){if(e)try{sendPostRequest("/api/v1.0/seasons/remove",e,function(e,n,a){if(e)return t(e);S("Oops: 1")})}catch(e){console.log("error",e)}}(e,function(t){t?R(e.season_id):YearCalendar.endLoading()})})},S=function(e){toastr.error(e)},N=function(){return remove_nulls({product_id:isNaN(parseInt(f.value))?null:parseInt(f.value),season_id:isNaN(parseInt(d.value))?null:parseInt(d.value),disabled_dow:formatListOfIds(I.disabled_dows)})},D=function(){return{id:null,color_scheme_id:null,name:null,view_product_index:1,view_product_index_filter:1,view_product_index_search:1,view_product_edit:1,view_product_package_edit:1,view_product_package_index:1,enabled:1,date_created:formatDateMySQL(),created_by:w,date_modified:formatDateMySQL(),modified_by:w,note:null,category_id:null,color_scheme:{id:null,name:null,background_color:null,border_color:null,text_color:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:w,date_modified:formatDateMySQL(),modified_by:w,note:null},product_season_detail:{created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),disabled_dow:null,enabled:1,id:null,modified_by:w,note:null,product_id:null,season_id:null,seasons_background:null,seasons_border:null,seasons_text:null}}},L=function(e){E=new Map,e&&$.each(e,function(e,t){Season.types.set(t.id,function(e){let t=D(),n=isNaN(parseInt(e.category_id))?null:parseInt(e.category_id);t.id=isNaN(parseInt(e.id))?null:parseInt(e.id),t.color_scheme_id=isNaN(parseInt(e.color_scheme_id))?null:parseInt(e.color_scheme_id),t.name=e.name?e.name:null,t.view_product_index=e.view_product_index?e.view_product_index:1,t.view_product_index_filter=e.view_product_index_filter?e.view_product_index_filter:1,t.view_product_index_search=e.view_product_index_search?e.view_product_index_search:1,t.view_product_edit=e.view_product_edit?e.view_product_edit:1,t.view_product_package_edit=e.view_product_package_edit?e.view_product_package_edit:1,t.view_product_package_index=e.view_product_package_index?e.view_product_package_index:1,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=isNaN(parseInt(e.created_by))?w:parseInt(e.created_by),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=isNaN(parseInt(e.modified_by))?w:parseInt(e.modified_by),t.note=e.note?e.note:null,t.category_id=isNaN(parseInt(e.category_id))?null:parseInt(e.category_id),t.color_scheme.id=isNaN(parseInt(e.color_scheme.id))?null:parseInt(e.color_scheme.id),t.color_scheme.name=e.color_scheme.name,t.color_scheme.background_color=e.color_scheme.background_color,t.color_scheme.border_color=e.color_scheme.border_color,t.color_scheme.text_color=e.color_scheme.text_color,t.color_scheme.sort_order=isNaN(parseInt(e.color_scheme.sort_order))?999:parseInt(e.color_scheme.sort_order),t.color_scheme.enabled=e.color_scheme.enabled,t.color_scheme.date_created=e.color_scheme.date_created?e.color_scheme.date_created:formatDateMySQL(),t.color_scheme.created_by=isNaN(parseInt(e.color_scheme.created_by))?w:parseInt(e.color_scheme.created_by),t.color_scheme.date_modified=e.color_scheme.date_modified?e.color_scheme.date_modified:formatDateMySQL(),t.color_scheme.modified_by=isNaN(parseInt(e.color_scheme.modified_by))?w:parseInt(e.color_scheme.modified_by),t.color_scheme.note=e.color_scheme.note,E.get(n)||E.set(n,{seasons:[]});let a=E.get(n);a.seasons&&a.seasons;return t}(t))})},P=function(e){let t=D();return e&&(t=e),t},T=function(){h=$(u).table({table_type:"display_list",data:Season.all,columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Color Scheme",targets:2,data:"color_scheme",render:function(e,t,n,a){return`\n                            <div style="font-size:14px; line-height:1.25;padding-left:.5rem;background:${e.background_color};color:${e.text_color}; border:solid 1px ${e.border_color}">${e.name}</div>\n                        `}},{title:"Disabled DOW",targets:3,data:"product_season_detail",render:function(e,t,n,a){let i=e.disabled_dow?getListOfIds(e.disabled_dow):[],o=[];for(let e=0;e<i.length;e++)o.push(dow_short[i[e]]);return`\n                            <span>${e=o.join(", ")}</span>\n                        `}}],rowClick:Season.edit})},R=function(e){if(e){let t=Season.all.get(e);t&&(Season.all.delete(e),h.deleteRow(t),h.clearSelectedRows(),a.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),k(),O(),A(),toastr.success(`Season: ${t.name} - has been deleted`),YearCalendar.endLoading())}},q=function(e){if(e){let t=P(e);Season.all.get(t.id)?h.updateRow(t):h.insertRow(t),Season.all.set(t.id,t),h.loadRow(t),h.jumpToRow(t),h.clearSelectedRows(),a.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),k(),O(),A(),toastr.success(`Season: ${t.name} - has been updated`),YearCalendar.endLoading()}},O=function(){d.value="",l.value="",r.value="",s.checked=!0,k(),ColorScheme.load()},Q=function(){},A=function(){I.init([]),F()},Y=function(e){let n=[],i="Details";if(e){let t=e.color_scheme?e.color_scheme:{};i=e.name?e.name:"Detail",e.product_season_detail&&e.product_season_detail.disabled_dow&&(n=getListOfIds(e.product_season_detail.disabled_dow)),ColorScheme.load(t),ColorScheme.disable(),d.value=e.id,l.value=e.name,o.value=e.color_scheme_id,s.checked=1===e.enabled,s.disabled=!0,a.disabled=!0}a.disabled=!0,m.innerText=i,I.init(n),$(t).show()},F=function(){console.log("unloadProductSeasonForm()"),a.disabled=!1,l.disabled=!0,$(t).hide()},U=function(e,t){if(e)try{sendPostRequest("/api/v1.0/seasons/add",e,function(e,n,a){if(e)return t(e);S("Oops: 1")})}catch(e){console.log("error",e),S("Error Validating Airport")}else S("Error Loading Airport - Missing Data")},W=function(e,t){if(e)try{sendGetRequest("/api/v1.0/seasons/validate",e,function(e,n,a){if(e)return t(e);S("Oops: 1")})}catch(e){console.log("error",e),S("Error Validating Airport")}else S("Error Loading Airport - Missing Data")},V=function(){let t=isNaN(parseInt(i.value))?null:parseInt(i.value);$(a).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){h.clearSelectedRows(),O()}).on("change",function(){setTimeout(function(){""===a.value?(h.clearSelectedRows(),O()):function(e){let t=isNaN(parseInt(i.value))?null:parseInt(i.value);if(e&&""!==e&&t){let n={name:e,category_id:t};W(n,function(t){let a=null;if(t&&(a=t,t[0]&&(a=t[0])),a&&a.id){C=!0;let e=a.color_scheme?a.color_scheme:{},t=Season.all.get(a.id);h.clearSelectedRows(),d.value=a.id,l.value=a.name,o.value=a.color_scheme_id,s.checked=1===a.enabled,s.disabled=!0,ColorScheme.load(e),ColorScheme.disable(),t?(Y(t),h.loadRow(t)):Y(a)}else confirmDialog(`The season: ${e} does not exist exists. Would you like to create it?`,e=>{e?U(n,function(e){let t=null;if(e&&(t=e,e[0]&&(t=e[0])),t&&t.id){let e=t.color_scheme?t.color_scheme:{},n=Season.all.get(t.id);h.clearSelectedRows(),d.value=t.id,l.value=t.name,o.value=t.color_scheme_id,s.checked=1===t.enabled,s.disabled=!0,ColorScheme.load(e),ColorScheme.disable(),n?(Y(n),h.loadRow(n)):Y(t)}}):(h.clearSelectedRows(),O())})})}}(a.value)},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/seasons",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:t},onSelect:function(e){if(!e.data)return;let t=e.data,n=t.color_scheme?t.color_scheme:{},a=Season.all.get(t.id);h.clearSelectedRows(),d.value=t.id,l.value=t.name,o.value=t.color_scheme_id,s.checked=1===t.enabled,s.disabled=!0,ColorScheme.load(n),ColorScheme.disable(),a?(Y(a),h.loadRow(a)):Y(t)}})};return{types:new Map,all:new Map,edit:function(e){!function(e){if(e&&e.id){let t=e.id;console.log("seasonId",t);let n=d?isNaN(parseInt(d.value))?null:parseInt(d.value):null;console.log("loadedSeasonId",n)}A(),Y(e)}(e)},loadTypes:function(e){L(e)},init:function(e){!function(e){let n=[];e&&(n=e,e.seasons&&(n=e.seasons)),L(n),a&&(V(),O()),document.getElementById("season_disabled_dow")&&(I=$("#season_disabled_dow").DisabledDOW({name:"season_disabled_dow",label:"Disabled DOW"})),t&&F()}(e)},loadAll:function(e){!function(e){Season.all=new Map,u&&T(),e||(e=[]),$.each(e,function(e,t){let n=P(t);isNaN(parseInt(n.id))||(h.insertRow(n),Season.all.set(parseInt(n.id),n))}),k()}(e)}}}();document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("div.panel").forEach(e=>{const t=$(e),n=t.find("div.panel-heading").find("div.panel-actions.panel-actions-keep").find("a.panel-action");$.each(n,function(e,n){let a=$(n).attr("data-toggle");if(a)switch(a){case"panel-refresh":break;case"panel-hide":n.addEventListener("click",function(){let e=$(n).attr("data-loadonhide");$(e).show(),$(n).parents("div.pre_display").find("div.pre_display_el").hide()});break;case"panel-collapse":break;case"panel-fullscreen":n.addEventListener("click",function(){$(n).hasClass("fa-expand")?($(n).removeClass("fa-expand"),$(n).addClass("fa-compress"),t.addClass("is-fullscreen")):$(n).hasClass("fa-compress")&&($(n).removeClass("fa-compress"),$(n).addClass("fa-expand"),t.removeClass("is-fullscreen"))})}})})}),$.fn.table=function(e){"use strict";let t,n,a=[],i="display_list",o=$(this).attr("id");const d=document.getElementById(o);if($.fn.DataTable.isDataTable("#"+o))return;e&&(e.columnDefs&&(t=e.columnDefs),e.table_type&&(i=e.table_type),e.data&&(a=e.data));const l=function(){let e=$("#"+o+"_wrapper .dataTables_filter"),t=$("#"+o+"_wrapper .dataTables_length"),n=$("#"+o+"_wrapper .dataTables_info"),a=$("#"+o+"_wrapper .dataTables_paginate"),d=$("#"+o+"_wrapper"),l=$("#"+o+"_wrapper select");$("#"+o).parent("div").removeClass("col-sm-12").addClass("p-0 m-0 w-100 h-100"),d.find("label").each(function(){$(this).parent().append($(this).children())}),d.find("div.row").removeClass("row").addClass("d-flex justify-content-between"),e.find("input").each(function(){const e=$(this);e.attr("placeholder","Search"),e.removeClass("form-control-sm")}),e.find("label").remove(),e.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),n.parent("div").removeClass("col-sm-12 col-md-5").addClass("w-50 d-flex align-content-center flex-wrap px-0"),n.addClass("py-0"),a.parent("div").removeClass("col-sm-12 col-md-7").addClass("w-50 px-0"),a.addClass("py-0"),a.find("ul.pagination").addClass("mb-0"),t.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),t.find("label").each(function(){$(this).addClass("mb-0 pb-0 mr-3 d-inline-block")}),l.removeClass("custom-select custom-select-sm form-control form-control-sm"),l.addClass("form-control d-inline-block"),"display_list"===i&&$("#"+o+">tbody>tr").css({cursor:"pointer"})},r=function(e){if(e)try{$("#"+o+"_tr_"+e.id).addClass("selected"),n.page.jumpToData(e.id,0)}catch(e){console.log("error",e)}},s=function(){try{let e=$("#"+o+"> tbody  > tr");$.each(e,function(e,t){$(t).removeClass("selected")})}catch(e){console.log("clear_selected_rows",e)}};if(d)try{n=$(this).DataTable({pageLength:5,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],data:a,columnDefs:t}),e.rowClick&&n.on("click","tr",function(){if($(this).find("td").hasClass("dataTables_empty"));else{s(),$(this).addClass("selected");let t=n.row(this).data();e.rowClick(t)}}),l()}catch(e){console.log("error",e)}return{insertRow:function(e){!function(e){if(e)try{n.row.add(e).node().id=o+"_tr_"+e.id,n.draw(!1),n.page.jumpToData(e.id,0),l()}catch(e){console.log("error",e)}}(e)},clearSelectedRows:function(){s()},deleteRow:function(e){!function(e){if(e)try{let t="#"+o+"_tr_"+e.id;n.row(t).remove().draw()}catch(e){console.log("error",e)}}(e)},loadRow:function(e){r(e)},updateRow(e){!function(e){if(e)try{let t="#"+o+"_tr_"+e.id;n.row(t).data(e).draw(),r(e.id)}catch(e){console.log("error",e)}l()}(e)},jumpToRow:function(e){!function(e){if(e)try{n.page.jumpToData(e.id,0)}catch(e){console.log("error",e)}}(e)}}},$.fn.BuildKeyword=function(e){let t,n,a,i,o,d,l,r,s=0,c=null,u=new Map;if(!$(this).hasClass("keyword")||!$(this).attr("id"))return;if(t=(a=$(this).attr("id"))+"_search",n=a+"_container",i=document.getElementById(a),o=document.getElementById(t),!(d=document.getElementById(n))||!o||!i)return;l=$(o),r=$(d),e||(e=[]),"string"==typeof e&&(e=e.split(",").map(function(e){return e.trim()})),jQuery.event.special.destroyed={remove:function(e){e.handler&&e.handler()}},l.on("keydown",function(e){9===e.keyCode&&e.preventDefault(),13!==e.which&&9!==e.keyCode||(y(),c=null)});const _=function(e){if(e){let t=e,n=t.text();u.get(n)&&(t.remove(),u.delete(n))}},m=function(e){},p=function(e){let t=u.get(e);if(t)toastr.error(`A tag for ${e} already exists`),u.set(e,t);else{let t=function(e){if(s+=1,e){let t=$("<div>"),n=$("<i>");return n.addClass("close fas fa-times").on("click",function(e){e.stopPropagation();let t=$(this).parents("div.chip");var n;n=(e=>{e&&($id=t.attr("id"),_(t))}),$('\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-danger" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">Would you like to delete?</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-times fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-danger btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-danger waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    ').appendTo("body"),$("#modalConfirm").modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){n(!0),$("#modalConfirm").modal("hide")}),$(".btn-no").click(function(){n(!1),$("#modalConfirm").modal("hide")}),$("#modalConfirm").on("hidden.bs.modal",function(){$("#modalConfirm").remove()})}),t.addClass("chip blue lighten-4 waves-effect").text(e).append(n).attr("id",a+"_"+s).on("click",function(e){let t=$(this);c=u.get(t.text());let n=t.attr("id");m(n)}),t}}(e);t&&(u.set(e,t),r&&r.append(t))}},f=function(e){$.each(e,function(e,t){t&&y(t)})},y=function(e){e||(e=l.val()),""!==e&&(p(e),l.val(""))};return f(e),{add:function(e){p(e)},delete:function(e){_(e)},build:function(){let e=[],t=Array.from(u.values());for(let n=0;n<t.length;n++){let a=t[n].text();e.push(a)}return e.join(",")},init:function(){f()}}};const InventoryProfile=function(){"use strict";const e=document.getElementById("panel_tab_inventory"),t=document.getElementById("table_profile_product_edit_add_new_button"),n=document.getElementById("product_edit_profile_form_profile_transfer_sales_types_id_block"),a=document.getElementById("product_edit_profile_form_profile_allot_by_id_block"),i=document.getElementById("product_edit_profile_form_profile_name_filter"),o=document.getElementById("table_profile_product_edit"),d=document.getElementById("product_edit_profile_form_profile_days_out_block"),l=document.getElementById("product_edit_profile_form_profile_expires_block"),r=document.getElementById("product_edit_profile_form_profile_quantity_block"),s=document.getElementById("product_edit_profile_form_profile_release_amt_block"),c=document.getElementById("product_edit_profile_form"),u=document.getElementById("product_edit_profile_form_profile_id"),_=document.getElementById("product_edit_profile_form_profile_name"),m=document.getElementById("product_edit_profile_form_profile_enabled"),p=document.getElementById("product_edit_profile_form_profile_sales_types_id"),f=document.getElementById("product_edit_profile_form_profile_allot_by_id"),y=document.getElementById("product_edit_profile_form_profile_transfer_sales_types_id"),g=document.getElementById("product_edit_profile_form_profile_days_out"),v=document.getElementById("product_edit_profile_form_profile_quantity"),b=document.getElementById("product_edit_profile_form_profile_release_amt"),h=document.getElementById("product_edit_profile_form_profile_min_length_days"),I=document.getElementById("product_edit_profile_form_profile_min_duration"),w=document.getElementById("product_edit_profile_form_profile_max_duration"),E=document.getElementById("product_edit_profile_form_profile_equal_duration"),C=document.getElementById("product_edit_profile_form_profile_advanced_booking_min"),k=document.getElementById("product_edit_profile_form_profile_advanced_booking_max"),B=document.getElementById("product_edit_profile_form_profile_checkin_dow"),x=document.getElementById("product_edit_profile_form_profile_checkout_dow"),M=document.getElementById("product_edit_profile_form_profile_departure_dow"),S=document.getElementById("product_edit_profile_form_profile_return_dow"),N=document.getElementById("product_edit_profile_form_profile_inc_days_dow"),D=document.getElementById("product_edit_profile_form_profile_weekday_dow"),L=document.getElementById("product_edit_profile_form_close_button"),P=document.getElementById("button_add_product_profile"),T=document.getElementById("product_edit_profile_form_clear_button"),R=document.getElementById("product_edit_profile_form_submit_button"),q=document.getElementById("product_id"),O=document.getElementById("button_remove_profile_from_product");let Q,A,Y,F,U,W,V=$(o),j=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,H={rules:{product_edit_profile_form_profile_sales_types_id:{required:!0},product_edit_profile_form_profile_allot_by_id:{required:function(e){return""!==$(p).val()&&1===$(p).val()||"1"===$(p).val()}},profile_expires:{required:function(e){return""!==$(f).val()&&1===$(f).val()||"1"===$(f).val()}},product_edit_profile_form_profile_days_out:{required:function(e){return""!==$(f).val()&&2===$(f).val()||"2"===$(f).val()},number:!0,min:1},product_edit_profile_form_profile_name:{required:!0}},messages:{product_edit_profile_form_profile_sales_types_id:{required:"Field Required"},product_edit_profile_form_profile_allot_by_id:{required:"Field Required"},profile_expires:{required:"Field Required"},product_edit_profile_form_profile_days_out:{required:"Field Required"},product_edit_profile_form_profile_name:{required:"Field Required"}}},G=!1;$(P).on("click",function(){se()}),$(t).on("click",function(){i.value="",V.clearSelectedRows(),se()}),$(T).on("click",function(){V.clearSelectedRows(),de(),i.value="",ae()}),$(R).on("click",function(){ue()}),$(L).on("click",function(){V.clearSelectedRows(),de(),ee(),ae(),i.value=""}),$(p).on("change",function(){ee(),InventoryProfile.expiration_date.value(""),g.value="",f.value=""}),$(f).on("change",function(){ee(),InventoryProfile.expiration_date.value(""),g.value=""}),$(y).on("change",function(){}),$(O).on("click",function(){J()}),$(e).on("hide.bs.tab",function(){V.clearSelectedRows(),de(),ee(),ae(),i.value=""});const z=function(){0===Array.from(InventoryProfile.all.values()).length?$(e).html('Inventory <span id="profileNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>'):$(e).html("Inventory"),Product.updateProgress()},J=function(){let e={product_id:parseInt(q.value),profile_id:parseInt(u.value)};e&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&function(e,t){if(e){let n="/api/v1.0/profiles/remove";try{sendPostRequest(n,e,function(e,n,a){return e?t(e):_e("Oops: 1")})}catch(e){console.log("error",e)}}}(e,function(t){if(t){let t=ce(InventoryProfile.all.get(e.profile_id));InventoryProfile.all.delete(t.id),V.deleteRow(t),V.clearSelectedRows(),i.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.resetForm(),PricingWorksheet.status(),z(),se(),ae(),toastr.success(`InventoryProfile: ${t.name} - has been removed`),YearCalendar.endLoading()}})})},K=function(){let e=isNaN(parseInt(q.value))?null:parseInt(q.value);$(i).on("click",function(){$(this).select()}).on("search",function(){V.clearSelectedRows(),oe()}).on("change",function(){setTimeout(function(){let e=i.value;!1===G&&(""===e?(G=!1,V.clearSelectedRows(),oe()):Z(e))},200),""===i.value&&(V.clearSelectedRows(),oe())}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/profiles",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,params:{product_id:e},paramName:"st",onSelect:function(e){if(!e.data)return;V.clearSelectedRows();let t=isNaN(parseInt(e.data.id))?null:parseInt(e.data.id),n=InventoryProfile.all.get(t);if(n)return V.loadRow(n),void se(n);se(),_.value=i.value}})},Z=function(e){if(e&&""!==e){let t={name:e,product_id:isNaN(parseInt(q.value))?null:parseInt(q.value)};X(t,function(t){let n=null;if(t&&t[0]&&(n=t,t[0]&&(n=t[0])),n){let t,a=InventoryProfile.all.get(parseInt(n.id));if(a)return t=ce(a),V.loadRow(t),void se(t);se(),_.value=e}})}},X=function(e,t){if(!e)return _e("Error Loading InventoryProfile - Missing Data");try{sendGetRequest("/api/v1.0/profiles/validate",e,function(e,n,a){return e?t(e):_e("Oops: 1")})}catch(e){return _e("Error Validating InventoryProfile")}},ee=function(){let e=isNaN(parseInt(p.value))?null:parseInt(p.value);if(ne(),e)switch(e){case 1:te()}},te=function(){let e=isNaN(parseInt(f.value))?null:parseInt(f.value);if(e)switch(e){case 1:$(d).hide(),$(l).show();break;case 2:$(d).show(),$(l).hide();break;case 3:default:$(d).hide(),$(l).hide()}$(n).show(),$(r).show(),$(s).show(),$(a).show()},ne=function(){$(d).hide(),$(l).hide(),$(a).hide(),$(n).hide(),$(r).hide(),$(s).hide(),$("#accordionEx").collapse("hide")},ae=function(){c&&(ne(),$(c).hide(),i.disabled=!1,$("#accordionEx").collapse("hide"),z())},ie=function(){c&&(i.disabled=!0,$(c).show())},oe=function(){de(),re()},de=function(){re(),u.value="",_.value="",m.checked=!0,p.value="",f.value="",y.value="",g.value="",v.value="",b.value="",h.value="",I.value="",w.value="",E.value="",C.value="",k.value="",InventoryProfile.checkin_dow.init([0,1,2,3,4,5,6]),InventoryProfile.checkout_dow.init([0,1,2,3,4,5,6]),InventoryProfile.departure_dow.init([0,1,2,3,4,5,6]),InventoryProfile.return_dow.init([0,1,2,3,4,5,6]),InventoryProfile.weekday_dow.init([0,1,2,3,4,5,6]),InventoryProfile.inc_days_dow.init([0,1,2,3,4,5,6]),InventoryProfile.expiration_date.value(""),InventoryProfile.advanced_booking_date.value(""),ee()},le=function(){let e=$(c).valid();if(e){if(1===(isNaN(parseInt(f.value))?3:parseInt(f.value))){let t=InventoryProfile.expiration_date.value();null===t||""===t?(setError(document.getElementById("profile_expires"),"Field Required"),e=!1):clearError(document.getElementById("profile_expires"))}}return e},re=function(){_.disabled=!1},se=function(e){de(),e&&(u.value=e.id?e.id:"",_.value=e.name?e.name:"",m.checked=0!==e.enabled,p.value=e.sales_types_id?e.sales_types_id:"",f.value=e.allot_by_id?e.allot_by_id:"",y.value=e.transfer_sales_types_id?e.transfer_sales_types_id:"",g.value=e.days_out?e.days_out:"",v.value=e.quantity?e.quantity:"",b.value=e.release_amt?e.release_amt:"",h.value=e.min_length_days?e.min_length_days:"",I.value=e.min_duration?e.min_duration:"",w.value=e.max_duration?e.max_duration:"",E.value=e.equal_duration?e.equal_duration:"",C.value=e.advanced_booking_min?e.advanced_booking_min:"",k.value=e.advanced_booking_max?e.advanced_booking_max:"",InventoryProfile.checkin_dow.init(e.checkin_dow?e.checkin_dow:[0,1,2,3,4,5,6]),InventoryProfile.checkout_dow.init(e.checkout_dow?e.checkout_dow:[0,1,2,3,4,5,6]),InventoryProfile.departure_dow.init(e.departure_dow?e.departure_dow:[0,1,2,3,4,5,6]),InventoryProfile.return_dow.init(e.return_dow?e.return_dow:[0,1,2,3,4,5,6]),InventoryProfile.weekday_dow.init(e.weekday_dow?e.weekday_dow:[0,1,2,3,4,5,6]),InventoryProfile.inc_days_dow.init(e.inc_days_dow?e.inc_days_dow:[0,1,2,3,4,5,6]),InventoryProfile.expiration_date.value(e.expires?e.expires:""),InventoryProfile.advanced_booking_date.value(e.advanced_booking_date?e.advanced_booking_date:"")),ee(),ie()},ce=function(e){let t,n,a,i={id:null,allot_by_id:null,sales_types_id:null,name:null,quantity:null,expires:null,transfer_sales_types_id:null,release_amt:null,min_length_days:null,checkin_dow:[0,1,2,3,4,5,6],checkout_dow:[0,1,2,3,4,5,6],departure_dow:[0,1,2,3,4,5,6],return_dow:[0,1,2,3,4,5,6],inc_days_dow:[0,1,2,3,4,5,6],weekday_dow:[0,1,2,3,4,5,6],min_duration:null,max_duration:null,equal_duration:null,advanced_booking_min:null,advanced_booking_max:null,advanced_booking_date:null,days_out:null,enabled:1,date_created:formatDateMySQL(),created_by:j,date_modified:formatDateMySQL(),modified_by:j,note:null,sales_types_details:{},allot_by_details:{},tranfer_sales_type_details:{}};if(e){let o=getListOfIds(e.checkin_dow),d=getListOfIds(e.checkout_dow),l=getListOfIds(e.departure_dow),r=getListOfIds(e.return_dow),s=getListOfIds(e.inc_days_dow),c=getListOfIds(e.weekday_dow);t=Types.sales_types.get(isNaN(parseInt(e.sales_types_id))?null:parseInt(e.sales_types_id)),n=Types.allot_by.get(isNaN(parseInt(e.allot_by_id))?null:parseInt(e.allot_by_id)),a=Types.sales_types.get(isNaN(parseInt(e.transfer_sales_types_id))?null:parseInt(e.transfer_sales_types_id)),i.id=isNaN(parseInt(e.id))?null:parseInt(e.id),i.allot_by_id=isNaN(parseInt(e.allot_by_id))?null:parseInt(e.allot_by_id),i.sales_types_id=isNaN(parseInt(e.sales_types_id))?null:parseInt(e.sales_types_id),i.name=e.name?e.name:null,i.quantity=isNaN(parseInt(e.quantity))?null:parseInt(e.quantity),i.expires=e.expires?e.expires:null,i.transfer_sales_types_id=isNaN(parseInt(e.transfer_sales_types_id))?null:parseInt(e.transfer_sales_types_id),i.release_amt=e.release_amt?e.release_amt:null,i.min_length_days=e.min_length_days?e.min_length_days:null,i.min_duration=e.min_duration?e.min_duration:null,i.max_duration=e.max_duration?e.max_duration:null,i.equal_duration=e.equal_duration?e.equal_duration:null,i.advanced_booking_min=e.advanced_booking_min?e.advanced_booking_min:null,i.advanced_booking_max=e.advanced_booking_max?e.advanced_booking_max:null,i.advanced_booking_date=e.advanced_booking_date?e.advanced_booking_date:null,i.checkin_dow=o,i.checkout_dow=d,i.departure_dow=l,i.return_dow=r,i.inc_days_dow=s,i.weekday_dow=c,i.days_out=e.days_out?e.days_out:null,i.enabled=e.enabled?e.enabled:1,i.date_created=e.date_created?e.date_created:formatDateMySQL(),i.created_by=isNaN(parseInt(e.created_by))?j:parseInt(e.created_by),i.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),i.modified_by=isNaN(parseInt(e.modified_by))?j:parseInt(e.modified_by),i.note=e.note?e.note:null,i.sales_types_details=t,i.allot_by_details=n,i.tranfer_sales_type_details=a}return InventoryProfile.detail=i,i},ue=function(){let e=!!le()&&remove_nulls({id:isNaN(parseInt(u.value))?null:parseInt(u.value),name:""!==_.value?_.value:null,product_id:isNaN(parseInt(q.value))?null:parseInt(q.value),sales_types_id:isNaN(parseInt(p.value))?null:parseInt(p.value),transfer_sales_types_id:isNaN(parseInt(y.value))?null:parseInt(y.value),allot_by_id:isNaN(parseInt(f.value))?3:parseInt(f.value),enabled:!0===m.checked?1:0,expires:InventoryProfile.expiration_date.value(),advanced_booking_date:InventoryProfile.advanced_booking_date.value(),checkin_dow:null===formatListOfIds(InventoryProfile.checkin_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.checkin_dow.disabled_dows),checkout_dow:""===formatListOfIds(InventoryProfile.checkout_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.checkout_dow.disabled_dows),departure_dow:""===formatListOfIds(InventoryProfile.departure_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.departure_dow.disabled_dows),return_dow:""===formatListOfIds(InventoryProfile.return_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.return_dow.disabled_dows),weekday_dow:""===formatListOfIds(InventoryProfile.weekday_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.weekday_dow.disabled_dows),inc_days_dow:""===formatListOfIds(InventoryProfile.inc_days_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.inc_days_dow.disabled_dows),days_out:isNaN(parseInt(g.value))?null:parseInt(g.value),release_amt:isNaN(parseInt(b.value))?null:parseInt(b.value),min_length_days:isNaN(parseInt(h.value))?"":parseInt(h.value),min_duration:isNaN(parseInt(I.value))?null:parseInt(I.value),max_duration:isNaN(parseInt(w.value))?null:parseInt(w.value),equal_duration:isNaN(parseInt(E.value))?null:parseInt(E.value),advanced_booking_min:isNaN(parseInt(C.value))?null:parseInt(C.value),advanced_booking_max:isNaN(parseInt(k.value))?null:parseInt(k.value)});e&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&me(e,function(e){if(e){let t=ce(e[0]?e[0]:e);InventoryProfile.all.get(t.id)?V.updateRow(t):V.insertRow(t),InventoryProfile.all.set(t.id,t),V.loadRow(t),V.jumpToRow(t),V.clearSelectedRows(),i.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),z(),se(),ae(),toastr.success(`InventoryProfile: ${t.name} - has been updated`),YearCalendar.endLoading()}})})},_e=function(e){toastr.error(e)},me=function(e,t){if(e){let n="/api/v1.0/profiles/update";try{sendPostRequest(n,e,function(e,n,a){return e?t(e):_e("Oops: 1")})}catch(e){console.log("error",e)}}},pe=function(e){let t=[];e&&e.profiles&&(t=e.profiles),Q=$(B).DisabledDOW({name:"checkin_dow",label:"Checkin DOW"}),A=$(x).DisabledDOW({name:"checkout_dow",label:"Checkout DOW"}),Y=$(M).DisabledDOW({name:"departure_dow",label:"Departure DOW"}),F=$(S).DisabledDOW({name:"return_dow",label:"Return DOW"}),W=$(N).DisabledDOW({name:"inc_days_dow",label:"Included Days"}),U=$(D).DisabledDOW({name:"weekday_dow",label:"Weekdays"}),InventoryProfile.checkin_dow=Q,InventoryProfile.checkout_dow=A,InventoryProfile.departure_dow=Y,InventoryProfile.return_dow=F,InventoryProfile.weekday_dow=U,InventoryProfile.inc_days_dow=W,InventoryProfile.advanced_booking_date=$("#profile_advanced_booking_date").dateSelect({onStart:function(){}}),InventoryProfile.expiration_date=$("#profile_expires").dateSelect({onStart:function(){}}),$(document).ready(function(){o&&(V=$(o).table({table_type:"display_list",data:[],columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Sales Types",targets:1,data:"sales_types_details",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+(e.name?e.name:"N/A")+"</span>"}},{title:"Allot By",targets:2,data:"allot_by_id",render:function(e,t,n,a){let i="N/A";return"<span style='white-space: nowrap;'>"+(i=null===e?"N/A":(i=Types.allot_by.get(e))?i.name:"N/A")+"</span>"}},{title:"Expires",targets:3,data:"expires",render:function(e,t,n,a){let i;if(null===e)i="N/A";else{let t=e.replace(/-|\s/g,"");i=moment(t).format("YYYY-MM-DD")}return"<span style='white-space: nowrap;'>"+i+"</span>"}},{title:"Release",targets:4,data:"release_amt",render:function(e,t,n,a){let i="N/A";return e&&(i=e),"<span style='white-space: nowrap;'>"+i+"</span>"}}],rowClick:InventoryProfile.edit})),i&&K(),c&&(validator_init(H),InventoryProfile.validator=$(c).validate(),oe(),ae()),function(e){InventoryProfile.all=new Map,e||(e=[]),$.each(e,function(e,t){let n=ce(t);isNaN(parseInt(n.id))||(o&&V.insertRow(n),InventoryProfile.all.set(parseInt(n.id),n))}),Pricing.loadProfileDropdown(),z()}(t)})};return{validator:null,all:new Map,detail:{},expiration_date:null,advanced_booking_date:null,checkin_dow:null,checkout_dow:null,departure_dow:null,return_dow:null,weekday_dow:null,inc_days_dow:null,init:function(e){pe(e)},initAutoComplete:function(){K()},edit:function(e){!function(e){if(e){V.clearSelectedRows();let t=ce(e);ie(),i.value=t.name,i.disabled=!0,V.loadRow(t),se(t)}}(e)}}}(),PricingWorksheet=function(){"use strict";const e=document.getElementById("product_edit_matrix_form"),t=["sun","mon","tue","wed","thu","fri","sat"],n=document.getElementById("product_edit_pricing_section_reset_filters"),a=document.getElementById("pricing_strategy_types_id"),i=document.getElementById("product_id"),o=document.getElementById("pricing_strategy_unit_id"),d=document.getElementById("pricing_strategy_season_id"),l=document.getElementById("button_collapse_seasons"),r=document.getElementById("button_collapse_units"),s=document.getElementById("button_toggle_completed_pricings"),c=document.getElementById("button_toggle_completed_matrices"),u=document.getElementById("product_edit_pricing_section_reload_worksheet");let _,m,p,f,y,g=!1,v='<span class="badge badge-pill badge-success">Completed</span>',b='<span class="badge badge-pill badge-danger">Incomplete</span>',h=[],I=[],w=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(u).on("click",function(){$(a).val(PricingWorksheet.pricingStrategyId).trigger("change")}),$(n).on("click",function(){S()}),$(a).on("change",function(){}),$(o).on("change",function(){N()}),$(d).on("change",function(){D()}),$(n).on("click",function(){S()}),$(s).on("click",function(){B()}),$(c).on("click",function(){k()}),$(l).on("click",function(){M()}),$(r).on("click",function(){x()});const E=function(){let e=!1,t="complete",n=Array.from(PricingWorksheet.incompletePricings.values()),a=Array.from(PricingWorksheet.incompleteMatrices.values());return(n.length>0||a.length>0)&&(e=!0),$("<span>",{class:"badge rounded-pill badge-notification bg-danger tab-badge",alt:"Notification",css:{color:"rgb(255, 255, 255) !important"},text:"!"}),!0===e?(t="incomplete",$("#panel_tab_pricing").html("Pricing<span class='badge rounded-pill badge-notification bg-danger tab-badge' style='color:#fff!important'>!</span>")):(t="complete",$("#panel_tab_pricing").html("Pricing")),t},C=function(e,n){let a,i,o=-1,d=[],l={};return n&&e&&(a=Season.all.get(n))&&(l=a.product_season_detail?a.product_season_detail:{},d=getListOfIds(l.disabled_dow.trim()),i=t.indexOf(e),o=d.indexOf(i)),o>=0},k=function(e){let t=!0;e&&(t=e),$(c).attr("data-shown")||$(c).attr("data-shown",!0===t?"true":"false"),"false"===$(c).attr("data-shown")?($(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices"),t=!0):($(c).attr("data-shown","false"),$(c).text("Show Completed Matrices"),t=!1),t?($("[data-matrixcomplete='true']").show(),m=!1):(m=!0,$("[data-matrixcomplete='true']").hide())},B=function(){let e=!0;$(s).attr("data-shown")||$(s).attr("data-shown",!0===e?"true":"false"),"false"===$(s).attr("data-shown")?($(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings"),e=!0):($(s).attr("data-shown","false"),$(s).text("Show Completed Pricings"),e=!1),e?($("[data-pricingcomplete='true']").show(),_=!1):($("[data-pricingcomplete='true']").hide(),_=!0)},x=function(){let e,t=document.querySelectorAll("[data-type='unit']");$(r).attr("data-shown")||($(r).attr("data-shown","true"),e=!0),"false"===$(r).attr("data-shown")?($(r).attr("data-shown","true"),$(r).text("Collapse Units"),e=!0):($(r).attr("data-shown","false"),$(r).text("Expand Units"),e=!1);for(let n=0;n<t.length;n++){let a=t[n],i=$(a).attr("id");$("#"+i).collapse(!0===e?"show":"hide"),p=!0===e}},M=function(){let e=document.querySelectorAll("[data-type='season']"),t=!0;$(l).attr("data-shown")||$(l).attr("data-shown","true"),"false"===$(l).attr("data-shown")?($(l).attr("data-shown","true"),$(l).text("Collapse Seasons"),t=!0):($(l).attr("data-shown","false"),$(l).text("Expand Seasons"),t=!1);for(let n=0;n<e.length;n++){let a=e[n],i=$(a).attr("id");$("#"+i).collapse(!0===t?"show":"hide"),g=!0===t}},S=function(){var e;$(n).html("<span class='spinner-border spinner-border-sm' role='status' aria-hidden='true'></span> Loading..."),e=function(e){e&&$(n).html("Reset Filters")},$("[data-matrixcomplete='true']").show(),$(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices"),$("[data-pricingcomplete='true']").show(),$(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings"),$(d).val([]).trigger("change"),$(o).val([]).trigger("change"),$(r).attr("data-shown","false"),$(r).text("Expand Units"),x(),$(l).attr("data-shown","false"),$(l).text("Expand Seasons"),M(),e(1)},N=function(){!function(){let e=Array.from(Unit.all.values());$.each(e,function(e,t){let n="unit-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).hide()})})}();let e=getListOfIds($(o).val());e.length?$.each(e,function(e,t){let n="unit-"+t,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})}):function(){let e=Array.from(Unit.all.values());$.each(e,function(e,t){let n="unit-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})})}()},D=function(){!function(){let e=Array.from(Season.all.values());$.each(e,function(e,t){let n="season-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).hide()})})}();let e=getListOfIds($(d).val());e.length?$.each(e,function(e,t){let n="season-"+t,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})}):function(){let e=Array.from(Season.all.values());$.each(e,function(e,t){let n="season-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})})}()},L=function(e){let t,n,a,i,o=null,d=[],l={monCost:null,tueCost:null,wedCost:null,thuCost:null,friCost:null,satCost:null,sunCost:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null};if("true"!==$(e).attr("data-dowrow"))return i=$(e).attr("data-matrixid")?isNaN(parseInt($(e).attr("data-matrixid")))?null:parseInt($(e).attr("data-matrixid")):null,t=$(e).attr("data-pricingid")?isNaN(parseInt($(e).attr("data-pricingid")))?null:parseInt($(e).attr("data-pricingid")):null,n=$(e).attr("data-variantid")?isNaN(parseInt($(e).attr("data-variantid")))?null:parseInt($(e).attr("data-variantid")):null,a=$(e).attr("data-pricingcode")?$(e).attr("data-pricingcode"):null,o=$(e).attr("data-pricingcount")?isNaN(parseInt($(e).attr("data-pricingcount")))?null:parseInt($(e).attr("data-pricingcount")):null,d=e.getElementsByTagName("input"),$.each(d,function(e,t){let n=t.name?t.name:null,a=!!t.disabled&&t.disabled,i=t.value?t.value:null;is_null(n)||is_null(a)||a||(l[n]=isNaN(parseInt(i))?null:parseInt(i))}),remove_nulls({id:t,matrix_id:i,variant_id:n,code:a,count:o,mon:l.monCost,tue:l.tueCost,wed:l.wedCost,thu:l.thuCost,fri:l.friCost,sat:l.satCost,sun:l.sunCost,monMargin:l.monMargin,tueMargin:l.tueMargin,wedMargin:l.wedMargin,thuMargin:l.thuMargin,friMargin:l.friMargin,satMargin:l.satMargin,sunMargin:l.sunMargin,enabled:1,note:null})},P=function(e){if(!e)return;let t=e.id,n=document.getElementById(t+"-table"),a=$(n).attr("data-productid"),i=$(n).attr("data-seasonid"),o=$(n).attr("data-unitid"),d=($(n).attr("data-matrixid"),{id:null,code:""!==e.elements.baseMatrixCode.value?e.elements.baseMatrixCode.value:"",product_id:isNaN(parseInt(a))?null:parseInt(a),season_id:isNaN(parseInt(i))?null:parseInt(i),unit_id:isNaN(parseInt(o))?null:parseInt(o),name:""!==e.elements.baseMatrixName.value?e.elements.baseMatrixName.value:"",cost:""!==e.elements.baseCost.value?parseInt(e.elements.baseCost.value):null,margin:""!==e.elements.baseMargin.value?parseInt(e.elements.baseMargin.value):null,has_pricing:1,been_saved:1,enabled:1,pricings:[],price:null});return d.id=$(n).attr("data-matrixid")?parseInt($(n).attr("data-matrixid")):null,d.pricings=function(e,t){let n=[];$(e).attr("data-productid"),$(e).attr("data-seasonid"),$(e).attr("data-unitid"),$(e).attr("data-matrixid");for(let a of e.rows){L(a);let e,i,o,d=null,l=[],r={monCost:null,tueCost:null,wedCost:null,thuCost:null,friCost:null,satCost:null,sunCost:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null};"true"!==$(a).attr("data-dowrow")&&(e=$(a).attr("data-pricingid")?isNaN(parseInt($(a).attr("data-pricingid")))?null:parseInt($(a).attr("data-pricingid")):null,i=$(a).attr("data-variantid")?isNaN(parseInt($(a).attr("data-variantid")))?null:parseInt($(a).attr("data-variantid")):null,o=$(a).attr("data-pricingcode")?$(a).attr("data-pricingcode"):null,d=$(a).attr("data-pricingcount")?isNaN(parseInt($(a).attr("data-pricingcount")))?null:parseInt($(a).attr("data-pricingcount")):null,l=a.getElementsByTagName("input"),$.each(l,function(e,t){let n=t.name?t.name:null,a=!!t.disabled&&t.disabled,i=t.value?t.value:null;is_null(n)||is_null(a)||a||(r[n]=isNaN(parseInt(i))?null:parseInt(i))}),n.push(remove_nulls({id:e,matrix_id:t.id,variant_id:i,code:o,count:d,mon:r.monCost,tue:r.tueCost,wed:r.wedCost,thu:r.thuCost,fri:r.friCost,sat:r.satCost,sun:r.sunCost,monMargin:r.monMargin,tueMargin:r.tueMargin,wedMargin:r.wedMargin,thuMargin:r.thuMargin,friMargin:r.friMargin,satMargin:r.satMargin,sunMargin:r.sunMargin,enabled:1,note:null})))}return n}(n,d),remove_nulls(d)},T=function(e){toastr.error(e)},R=function(e,t){if(e)try{sendPostRequest("/api/v1.0/matrices/update",e,function(e,n,a){return e?t(e):T("Oops: 1")})}catch(e){console.log("error",e)}},q=function(e,t){if(e)try{sendPostRequest("/api/v1.0/pricings/update",e,function(e,n,a){return e?t(e):T("Oops: 1")})}catch(e){console.log("error",e)}},O=function(e){let t=P(document.getElementById($(e).attr("data-targetform")));confirmDialog("Would you like to update?",e=>{e&&function(e){e&&R(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);let n=t.pricings?t.pricings:[];new Map,Matrix.all.set(t.code,t),$.each(n,function(e,t){Pricing.all.set(t.code,t)}),PricingWorksheet.pricingWorksheet(),toastr.success(`Matrix: ${t.name} - has been updated`)}})}(t)})},Q=function(e,t){let n=L(t);confirmDialog("Would you like to update?",e=>{e&&function(e){e&&q(e,function(e){let t;e&&(t=e,e[0]&&(t=e[0]),Pricing.all.set(t.code,t),PricingWorksheet.pricingWorksheet(),console.log("pricingsHidden",_),console.log("matricesHidden",m),console.log("unitsCollapsed",p),console.log("seasonsCollapsed",g),g&&($(l).attr("data-shown","false"),$(l).text("Expand Seasons"),M()),p&&($(r).attr("data-shown","false"),$(r).text("Expand Units"),x()),m&&($("[data-matrixcomplete='true']").show(),$(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices")),_&&($("[data-pricingcomplete='true']").show(),$(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings")),toastr.success(`Pricing: ${t.name} - has been updated`))})}(n)})},A=function(e){let n=isNaN(parseInt(i.value))?null:parseInt(i.value),o=e.matrix_code,d=$("<form/>",{id:"pricingMatrixForm-"+o,class:"card card-body border border-dark rounded-lg mb-2 mt-2 p-0 ",attr:{novalidate:"novalidate"}});e&&e.been_saved&&1===e.been_saved?(d.attr("data-matrixcomplete","true"),PricingWorksheet.incompleteMatrices.get(o)&&PricingWorksheet.incompleteMatrices.delete(o)):(PricingWorksheet.incompleteMatrices.set(o,e),d.attr("data-matrixcomplete","false"));let l=$("<div/>",{class:"pl-1 pr-1"}),r=$("<div/>",{class:"row"}),s=$("<div/>",{class:"col-12"}),c=function(e){let t=$("<div/>",{class:"p-2"}),n=$("<div/>",{class:"row"});if(e){let a,i=e.matrix_code,o=Matrix.all.get(i),d="",l=e.name?e.name:"",r=!1,s=null;o&&(d=o.id?o.id:null,s=o.margin?o.margin:null,a=o.cost?o.cost:null,r=1===e.been_saved);let c=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),u=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),_=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),m=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),p=$("<label/>",{class:"",for:"base_cost_"+i,text:"Cost"}),f=$("<label/>",{class:"",for:"base_margin_"+i,text:"Margin"}),y=$("<label/>",{class:"dev-element d-none",for:"base_matrix_id_"+i,text:"Matrix Id:"}),g=$("<div/>",{class:"form-element"}),v=$("<label/>",{class:"dev-element d-none",for:"base_matrix_name_"+i,text:"Matrix Name:"}),b=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixName",readonly:"readonly",disabled:"disabled",id:"base_matrix_name_"+i}).val(l),h=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixId",readonly:"readonly",disabled:"disabled",id:"base_matrix_id_"+i}).val(d),I=$("<input/>",{class:"form-control",id:"base_cost_"+i,name:"baseCost",attr:{"data-targetform":"pricingMatrixForm-"+i}}).on("keyup",function(){let e=document.getElementById($(this).attr("data-targetform"));this.value,e.querySelectorAll(".cost").forEach(e=>{e.disabled||($(e).val(this.value),""!==this.value?$(e).parent("div").find("label").addClass("active"):$(e).parent("div").find("label").removeClass("active"))})}).on("click",function(){$(this).select()}).val(a),w=$("<input/>",{class:"form-control",id:"base_margin_"+i,name:"baseMargin",attr:{"data-targetform":"pricingMatrixForm-"+i}}).on("keyup",function(){document.getElementById($(this).attr("data-targetform")).querySelectorAll(".margin").forEach(e=>{e.disabled||($(e).val(this.value),""!==this.value?$(e).parent("div").find("label").addClass("active"):$(e).parent("div").find("label").removeClass("active"))})}).on("click",function(){$(this).select()}).val(s),E=$("<div/>",{class:"form-element"}),C=$("<div/>",{class:"form-element"}),k=$("<div/>",{class:"form-element"}),B=$("<label/>",{class:"dev-element d-none",for:"base_matrix_code_"+i,text:"Matrix Code:"}),x=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixCode",readonly:"readonly",disabled:"disabled",id:"base_matrix_code_"+i}).val(i),M=$("<div/>",{class:"form-element"}),S=$("<div/>",{class:"error w-100 text-center"}),N=$("<div/>",{class:"error w-100 text-center"});C.append(y,h),E.append(p,I,S),M.append(f,w,N),k.append(B,x),g.append(v,b),c.append(E),u.append(M),_.append(C),m.append(k,g),n.append(c,u,_,m),t.append(n)}return t}(e),u=function(e){let t=e.matrix_code,n=$("<div/>",{class:"row"}),a=$("<div/>",{class:"col-12 col-md-6 mb-2 text-left"}),i=$("<div/>",{class:"col-12 col-md-6 mb-2 text-right"}),o=$("<button/>",{class:"btn btn-primary btn-sm submit-pricing-matrix-form waves-effect waves-light",text:"Update",type:"button",id:"submitPricingMatrixForm-"+t,attr:{"data-targetform":"pricingMatrixForm-"+t}}).on("click",function(){O(this)});return i.append(o),n.append(a,i)}(e),_=$("<table/>",{class:"table table-bordered table-sm",id:"pricingMatrixForm-"+o+"-table",attr:{"data-matrixcode":o,"data-productid":n,"data-unitid":e.unit_id,"data-seasonid":e.season_id,"data-name":e.name}});e.id&&_.attr("data-matrixid",e.id);let m=$("<tbody/>",{}),p=$("<thead/>",{}).append(function(e){let n=$("<tr/>"),a=$("<th/>",{html:"&nbsp;"}),i=$("<th/>",{css:{width:"120px"}});if(n.attr("data-dowrow","true"),n.append(i),e){let i=!1,o=Matrix.all.get(e.pricing_code);o&&(i=!(!o.been_saved||1!==o.been_saved));for(let a=0;a<t.length;a++){let i="",o=ucwords(t[a]);C(a,e.season_id)&&(i="disabled",o=ucwords(t[a])+" (disabled)");let d=$("<th/>",{class:""+i,text:o});n.append(d)}n.append(a)}return n}(e));for(let a=0;a<e.variants.length;a++){let i=e.variants[a],d=b;i.matrix_code=o;let l=$("<tr/>"),r=$("<i/>",{class:"far fa-edit"});l.attr({id:"tr-"+i.code,"data-variantid":i.variant_id?i.variant_id:null,"data-pricingid":i.id?i.id:null,"data-pricingcode":i.code?i.code:null,"data-matrixcode":i.matrix_code?i.matrix_code:null,"data-pricingcount":i.count?i.count:null,"data-productid":n,"data-targetform":"pricingMatrixForm-"+i.matrix_code,"data-seasonid":i.season_id?i.season_id:null,"data-name":i.name?i.name:null}),1===i.been_saved?(l.attr("data-pricingcomplete","true"),d=v):(l.attr("data-pricingcomplete","false"),PricingWorksheet.incompletePricings.set(i.pricing_code,i));let s=$(`\n                        <td style="padding:0;">\n                            <div class="d-flex flex-column">\n                                <div class="p-1">\n                                    ${d}\n                                </div>\n                                <div class="p-1">\n                                    <span class="table-variant-title">${e.name}</span>\n                                </div>\n                               \n                            </div>\n                        </td>\n                    `);l.append(s);let c=$("<button/>",{class:"btn btn-sm editRow btn-sm btn-teal waves-effect waves-light",type:"button",attr:{"data-variantid":i.variant_id?i.variant_id:null,"data-pricingid":i.id?i.id:null,"data-pricingcode":i.code?i.code:null,"data-matrixcode":i.matrix_code?i.matrix_code:null,"data-pricingcount":i.count?i.count:null,"data-productid":n,"data-targetform":"pricingMatrixForm-"+i.matrix_code,"data-seasonid":i.season_id?i.season_id:null,"data-name":i.name?i.name:null}}).append(r);i.matrix_id&&c.attr("data-matrixid",i.matrix_id),c.on("click",function(){let e=document.getElementById("tr-"+i.code);e&&Q(0,e)});for(let e=0;e<t.length;e++){let n=$("<td/>");n.append(F(i,t[e]),Y(i,t[e])),l.append(n)}let u=$("<td/>",{class:"text-center td-editor"}).append(c);l.append(u),m.append(l)}_.append(p,m),l.append(_),s.append(l),r.append(s);let f=function(e){let t,n=$("<h5/>",{class:"card-title d-flex justify-content-between m-2"});e&&((t=Matrix.all.get(e.pricing_code))||(t=Matrix.set()));let i=e.name?e.name:"Pricing";1===parseInt(a.value)?i="Unit Pricing":3===parseInt(a.value)&&(i="Daily Pricing");let o=$("<span/>",{class:"",text:i||"Pricing Variant"});return e&&e.been_saved&&1===e.been_saved?n.append(o,v):n.append(o,b),n}(e),y=$("<hr/>",{class:"ml-3 mr-3 mt-1 mb-3 color-dark"});return d.append(f,y,c,r,u)},Y=function(e,t){let n=e.matrix_code,a=n+"-"+e.variant_id+"-"+e.count,i=Pricing.all.get(a);if(i||((i=Pricing.set()).note="generated form"),i.product_id=e.product_id,i.season_id=e.product_id,i.unit_id=e.product_id,i.variant_id=e.variant_id,i.matrix_code=n,i.pricing_code=a,i.name=e.name,i.code=a,t){C(t,e.season_id);let n=t+"Margin",o=i[n]?i[n]:null,d=$("<input/>",{type:"text",id:"cm-"+a+"-"+t,name:n,class:"form-control margin m-0"}).attr("data-element","margin"),l=$("<div/>",{class:"md-form md-outline form-sm input-with-post-icon mb-2 mt-3"}),r=$("<label/>",{text:"Margin",for:"cm-"+a+"-"+t}),s=$("<i/>",{class:"fas fa-percentage input-prefix"});return C(t,e.season_id)?(d.attr("disabled","disabled"),d.val(""),r.removeClass("active"),l.addClass("disabled")):(l.removeClass("disabled"),o>0&&(d.val(o),r.addClass("active"))),l.append(s,d,r),l}},F=function(e,t){let n=e.matrix_code,a=n+"-"+e.variant_id+"-"+e.count,i=Pricing.all.get(a);if(i||((i=Pricing.set()).note="generated form"),i.product_id=e.product_id,i.season_id=e.product_id,i.unit_id=e.product_id,i.variant_id=e.variant_id,i.matrix_code=n,i.pricing_code=a,i.name=e.name,i.code=a,t){let n=t+"Cost",o=i[t]?i[t]:0,d=$("<input/>",{type:"text",name:n,id:"ce-"+a+"-"+t,class:"form-control cost m-0"}).attr("data-element","cost"),l=$("<div/>",{class:"md-form md-outline form-sm input-with-pre-icon mt-2 mb-3"}),r=$("<label/>",{text:"Cost",for:"ce-"+a+"-"+t}),s=$("<i/>",{class:"fas fa-dollar-sign input-prefix"});return C(t,e.season_id)?(d.attr("disabled","disabled"),d.val(""),r.removeClass("active"),l.addClass("disabled")):(l.removeClass("disabled"),o>0&&(d.val(o),r.addClass("active"))),l.append(s,d,r),l}},U=function(e){let t=$("<div/>",{});if(e&&e.units){let n=0;$.each(e.units,function(e,a){let o=a.seasons,d=function(e,t){let n=e.id+"-"+t;return $("<div/>",{class:"accordion md-accordion card card-body p-1 mb-2",id:"accordionUnit-"+n,role:"tablist","aria-multiselectable":"true"}).attr("data-sectiontype","unit-"+e.id)}(a,n),l=function(e,t){let n=e.id+"-"+t,a=e.name?e.name:null,i=isNaN(parseInt(e.id))?null:parseInt(e.id);if(Unit.all.get(i)){let e=$("<div/>",{class:"card-header p-0",role:"tab",id:"unitHeading-"+n}),t=$("<i/>",{class:"fas fa-angle-down rotate-icon"}),i=$("<a/>",{href:"#unitCollapse-"+n,"aria-controls":"unitCollapse-"+n,"data-toggle":"collapse","aria-expanded":"true"}),o=$("<span/>",{text:a}),d=$("<h5/>",{class:"mb-0 w-100 d-flex align-items-center justify-content-between p-1"});return e.append(i.append(d.append(o,t))),e}}(a,n),r=$("<div/>",{class:"card border border-0"}),s=$("<div/>",{class:"collapse show",role:"tabpanel","data-parent":"#accordionUnit-"+a.id+"-"+n,id:"unitCollapse-"+a.id+"-"+n,"aria-labelledby":"unitHeading-"+a.id+"-"+n}).attr("data-type","unit"),c=$("<div/>",{class:"card-body px-1"}),u=0;$.each(o,function(e,t){let n,o,d,l=i.value+"-"+a.id+"-"+t.season_id,r=t.pricings,_=t.season_id?t.season_id:null,m=Season.all.get(_),p=function(e,t,n){return $("<div/>",{class:"accordion md-accordion",id:"accordionEx"+t+"-"+n,role:"tablist","aria-multiselectable":"true"}).attr("data-sectiontype","season-"+e.season_id)}(t,l,u),f=function(e,t,n){let a,i,o;if(e){let d=e.season_name?e.season_name:null,l=e.season_id?e.season_id:null,r=Season.all.get(l);r&&(a=r.color_scheme.background_color?r.color_scheme.background_color:null,i=r.color_scheme.text_color?r.color_scheme.text_color:null,o=r.color_scheme.border_color?r.color_scheme.border_color:null);let s=$("<div/>",{class:"card-header p-0",role:"tab",id:"seasonHeading"+t+"-"+n}),c=$("<i/>",{class:"fas fa-angle-down rotate-icon"}),u=$("<a/>",{href:"#collapse"+t+"-"+n,"aria-controls":"collapse"+t+"-"+n,"data-toggle":"collapse","aria-expanded":"true"}),_=$("<span/>",{text:d}),m=$("<h5/>",{class:"mb-0 w-100 d-flex align-items-center justify-content-between p-1",css:{"background-color":`${a}`,border:`solid 1px ${o}`,color:`${i}`}});return s.append(u.append(m.append(_,c))),s}}(t,l,u),y=$("<div/>",{class:"card"}),g=$("<div/>",{class:"collapse show",role:"tabpanel","data-parent":"#accordionEx"+l+"-"+u,id:"collapse"+l+"-"+u,"aria-labelledby":"seasonHeading"+l+"-"+u}).attr("data-type","season");m&&(n=hexToRgb(m.color_scheme.background_color),o=m.color_scheme.text_color,d=m.color_scheme.border_color);let v=$("<div/>",{class:"card-body p-1",css:{background:`rgba(${n.join(",")}, .15)`,color:o}});$.each(r,function(e,t){v.append(A(t)),g.append(v)}),y.append(f,g),p.append(y),c.append(p),s.append(c),u+=1}),r.append(l,s),d.append(r),t.append(d),n+=1})}return t},W=function(){let e=[];switch(isNaN(parseInt(a.value))?null:parseInt(a.value)){case 1:e=[36];break;case 2:let t=Array.from(Variant.all.values());for(let n=0;n<t.length;n++)t[n].used_in_pricing&&e.push(t[n].id);break;default:e=[36]}return e},V=function(e){let t="";1===parseInt(a.value)?t="Unit Pricing":3===parseInt(a.value)&&(t="Daily Pricing");let n={category_id:1,code:"VA-00000000036-OTHR",created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:36,max_age:null,min_age:null,modified_by:w,name:t,note:null,used_in_pricing:1},i=Variant.all.get(e);return i&&(n=Variant.set(i)),n},j=function(e,t,n,a){let o=a.trim().split("-").map(Number),d=parseInt(t.id),l=parseInt(e.id),r=isNaN(parseInt(i.value))?null:parseInt(i.value),s=new Map;$.each(o,function(o,c){let u=V(c);if(u){let o=s.get(c);if(o){let a=o.count;a+=1,o.count=a,o.name=a+" "+pluralize(u.name);let s=n.toString()+"-"+c+"-"+a,_=Pricing.all.get(s);_?(_.aaa=1,_.has_pricing=1,_.been_saved=1):_={aaa:"ok here 2",been_saved:0,has_pricing:0,code:n.toString()+"-"+c.toString()+"-"+a.toString(),count:a,created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,fri:null,friMargin:null,id:null,matrix_code:n.toString(),matrix_id:null,modified_by:w,mon:null,monMargin:null,name:u.name+" "+a,note:"generated form",pricing_code:s,product_id:r,sat:null,satMargin:null,season_id:d,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:l,variant_id:c,wed:null,wedMargin:null},o.variants.push({aaa:"ok here",matrix_code:n.toString(),been_saved:5,has_pricing:_.has_pricing?_.has_pricing:0,code:n.toString()+"-"+c.toString()+"-"+a.toString(),count:a,created_by:_.created_by?_.created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:_.enabled?_.enabled:1,fri:_.fri?_.fri:null,friMargin:_.friMargin?_.friMargin:null,id:_.id?_.id:null,matrix_id:_.matrix_id?_.matrix_id:null,modified_by:_.modified_by?_.matrix_id:w,mon:_.mon?_.mon:null,monMargin:_.monMargin?_.monMargin:null,name:u.name+" "+a,note:"generated form",pricing_code:n.toString()+"-"+c.toString()+"-"+a.toString(),product_id:isNaN(parseInt(i.value))?null:parseInt(i.value),sat:_.sat?_.sat:null,satMargin:_.satMargin?_.satMargin:null,season_id:parseInt(t.id),sun:_.sun?_.sun:null,sunMargin:_.sunMargin?_.sunMargin:null,thu:_.thu?_.thu:null,thuMargin:_.thuMargin?_.thuMargin:null,tue:_.tue?_.tue:null,tueMargin:_.tueMargin?_.tueMargin:null,unit_id:e.id,variant_id:c,wed:_.wed?_.wed:null,wedMargin:_.wedMargin?_.wedMargin:null})}else{let t=1,i=n.toString()+"-"+c+"-"+t,s=Pricing.all.get(i);s?(s.aaa="hasPricing",s.been_saved=1,s.has_pricing=1):s={aaa:"ok here 1",has_pricing:0,been_saved:0,code:i,count:t,created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,fri:null,friMargin:null,id:null,matrix_code:n,pricing_code:i,matrix_id:null,modified_by:w,mon:null,monMargin:null,name:u.name+" "+t,note:"generated form",product_id:r,sat:null,satMargin:null,season_id:d,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:l,variant_id:u.id,wed:null,wedMargin:null},o={name:t+" "+u.name,variant_combo_id:a.trim(),count:t,variants:[{aaa:s.aaa?s.aaa:"ghg",code:i,has_pricing:s.has_pricing?s.has_pricing:0,variant_id:c,name:u.name+" "+t,count:t,created_by:s.created_by,date_created:s.date_created?s.date_created:formatDateMySQL(),date_modified:s.date_modified?s.date_modified:formatDateMySQL(),enabled:s.enabled?s.enabled:1,fri:null,friMargin:null,id:s.id?s.id:null,matrix_code:n,matrix_id:s.matrix_id?parseInt(s.matrix_id):null,modified_by:s.modified_by?parseInt(s.modified_by):w,mon:s.mon?parseInt(s.mon):null,monMargin:null,note:"fff",pricing_code:n+"-"+c+"-"+t,product_id:null,sat:null,satMargin:null,season_id:null,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:e.id,wed:null,wedMargin:null}]}}s.set(c,o)}else 36===parseInt(c)&&(u={category_id:1,code:"VA-00000000036-OTHR",created_by:4,date_created:"2022-01-18 08:08:22",date_modified:"2022-01-18 12:02:26",enabled:1,id:36,max_age:null,min_age:null,modified_by:4,name:"Other",note:null,used_in_pricing:1})});let c,u,_,m,p=0,f=[],y=[],g=null;$.each(Array.from(s.values()),function(e,t){y.push(t.name),t.variants&&$.each(t.variants,function(e,t){u=n+"-"+t.variant_id+"-"+t.count,_=n;let a=V(t.variant_id),i=Matrix.all.get(_),o=Pricing.all.get(u),s=(Season.all.get(d),null),y=null,v=null,b=null,h=null,I=null,$=null,E=null,C=null,k=null,B=null,x=null,M=null,S=null,N=1,D=null,L=formatDateMySQL(),P=formatDateMySQL(),T=w,R=w;i&&(m=i.id,c=1),o&&(g=o.id,p=1,s=o.sun,y=o.mon,v=o.tue,b=o.wed,h=o.thu,I=o.fri,$=o.sat,E=o.sunMargin,C=o.monMargin,k=o.tueMargin,B=o.wedMargin,x=o.thuMargin,M=o.friMargin,S=o.satMargin,N=o.enabled,D=o.note,L=o.date_created,P=o.date_modified,T=o.created_by,R=o.modified_by);let q={count:t.count,been_saved:p,code:u,pricing_code:u,product_id:r,unit_id:l,season_id:d,variant_id:t.variant_id,matrix_id:m,name:a.name+" "+t.count,id:g,sun:s,mon:y,tue:v,wed:b,thu:h,fri:I,sat:$,sunMargin:E,monMargin:C,tueMargin:k,wedMargin:B,thuMargin:x,friMargin:M,satMargin:S,enable:N,note:D,date_created:L,date_modified:P,created_by:T,modified_by:R,matrix_code:"H"};f.push(q)})}),y=y.join(" - ");let v=0,b=null,h=null,I=Matrix.all.get(n);return I&&(v=1,b=I.cost,h=I.margin),{name:y,cost:b,margin:h,season_id:d,unit_id:l,product_id:r,been_saved:v,matrix_code:n,id:m||null,variants:f}},H=function(e,t,n){for(let a=0;a<n.length;a++)if(1===e){let e=t+n[a],i=e.split("-").map(function(e){return parseInt(e,10)});i=i.sort().join("-"),I.indexOf(e)<0&&I.push(i)}else{n[a];H(e-1,t+n[a]+"-",n)}},G=function(){let e=isNaN(parseInt(i.value))?null:parseInt(i.value),t={id:null,units:[]};h=W(),f=function(){var e=[],t=Array.from(Season.all.values());for(let n=0;n<t.length;n++)e.push(t[n]);return e}(),y=function(){var e=[],t=Array.from(Unit.all.values());for(let n=0;n<t.length;n++)e.push(t[n]);return e}();for(let n=0;n<y.length;n++){I=[];let i=y[n],o=parseInt(i.id),d=i.max_pax?parseInt(i.max_pax):5,l=i.min_pax?parseInt(i.min_pax):1;switch(isNaN(parseInt(a.value))?null:parseInt(a.value)){case 1:l=1,d=1;break;case 2:if(l>d){let e=d;d=l,l=e}break;default:l=1,d=1}for(let e=l;e<=d;e++)H(e,"",W());let r=I,s={id:i.id,name:i.name,seasons:[]};for(let t=0;t<f.length;t++){let n=f[t],a=e+"-"+o+"-"+(isNaN(parseInt(n.id))?null:parseInt(n.id)),d=Matrix.all.get(a);d?d.pricings=[]:d={been_saved:0,code:a,cost:0,created_by:4,date_created:"2022-01-14 09:00:39",date_modified:"2022-01-14 09:00:39",enabled:1,has_pricing:1,id:null,margin:0,modified_by:4,note:null,price:201,pricings:[]};let l={been_saved:d.been_saved,code:d.code,cost:d.cost,created_by:d.created_by,date_created:d.date_created,date_modified:d.date_modified,enabled:d.enabled,has_pricing:d.has_pricing,id:d.id,margin:d.margin,modified_by:d.modified_by,note:d.note,price:d.price,season_id:n.id,season_name:n.name,matrix_code:a,pricings:[]};$.each(r,function(e,t){l.matrix_code=a+"-"+t,l.pricings.push(j(i,n,a+"-"+t,t))}),s.seasons.push(l)}t.units.push(s)}return t},z=function(){S(),PricingWorksheet.incompletePricings=new Map,PricingWorksheet.incompleteMatrices=new Map,$(e).empty(),$(e).html('\n                <div style="top:0;left:0;width:100%;height:500px;background:rgba(0,0,0,.25);" class="flex-center">\n                    <div class="preloader-wrapper active">\n                        <div class="spinner-layer spinner-blue-only">\n                            <div class="circle-clipper left">\n                                <div class="circle"></div>\n                            </div>\n                            <div class="gap-patch">\n                                <div class="circle"></div>\n                            </div>\n                            <div class="circle-clipper right">\n                                <div class="circle"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            '),I=[],$(e).empty().append(U(PricingWorksheet.buildPricingWorksheet())),E()};return{pricingStrategyId:null,incompleteMatrices:new Map,incompletePricings:new Map,init:function(e){!function(e){let t=null;e&&e.pricing_strategy&&e.pricing_strategy.pricing_strategy_types_id&&(t=isNaN(parseInt(e.pricing_strategy.pricing_strategy_types_id))?null:parseInt(e.pricing_strategy.pricing_strategy_types_id)),$(document).ready(function(){PricingWorksheet.pricingStrategyId=t,a&&$(a).val(PricingWorksheet.pricingStrategyId).trigger("change")})}(e)},pricingWorksheet:function(){z()},buildPricingWorksheet:function(){return G()},status:function(){return E()}}}(),Upload=function(e){this.file=e},_image_manager_is_cover_image=document.getElementById("image_manager_is_cover_image"),_image_manager_title=document.getElementById("image_manager_title"),_image_manager_caption=document.getElementById("image_manager_caption"),_image_manager_upload=document.getElementById("image_manager_upload"),_image_manager_alt_text=document.getElementById("image_manager_alt_text"),_image_manager_form_data=document.getElementById("image_manager_form_data"),_image_manager_image_id=document.getElementById("image_manager_id"),_provider_edit=document.getElementById("provider_edit"),_vendor_edit=document.getElementById("vendor_edit"),_provider_company_id=document.getElementById("provider_company_id"),_vendor_company_id=document.getElementById("vendor_company_id");Upload.prototype.getType=function(){return this.file.type},Upload.prototype.getSize=function(){return this.file.size},Upload.prototype.getName=function(){return this.file.name},Upload.prototype.doUpload=function(){let e=this,t=new FormData;t.append("file",this.file,this.getName()),t.append("upload_file",!0),t.append("title",""!==_image_manager_title.value?_image_manager_title.value:null),t.append("caption",""!==_image_manager_caption.value?_image_manager_caption.value:null),t.append("is_cover_image",!0!==_image_manager_is_cover_image.checked?parseInt(0):parseInt(1)),t.append("alt",""!==_image_manager_alt_text.value?_image_manager_alt_text.value:null),_provider_edit&&(t.append("directory_id",parseInt(_provider_company_id.value)),t.append("directory","company")),_vendor_edit&&(t.append("directory_id",parseInt(_vendor_company_id.value)),t.append("directory","company")),$.ajax({type:"POST",url:"/api/v1.0/images/update",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",e.progressHandling,!1),t},success:function(e){Console.log("data",e);let t,n=null;if(e&&e.result&&(n=e.result)[0]&&(t=n[0]),t){let e;_provider_edit&&(e=$("#companyImages").imageManager()),_vendor_edit&&(e=$("#companyImages").imageManager()),e.addImage(t),toastr.success("Image Uploaded"),Upload.prototype.resetForm(),$("button.dropify-clear").click()}},error:function(e){toastr.error("Error"),Console.log("error",e)},async:!0,data:t,cache:!1,contentType:!1,processData:!1,timeout:6e4})},Upload.prototype.progressHandling=function(e){var t=0,n=e.loaded||e.position,a=e.total;e.lengthComputable&&(t=Math.ceil(n/a*100)),$("#progress-wrp .progress-bar").css("width",+t+"%"),$("#progress-wrp .status").text(t+"%")},Upload.prototype.progressReset=function(){$("#progress-wrp .progress-bar").css("width","0%"),$("#progress-wrp .status").text("0%")},Upload.prototype.resetForm=function(){Upload.prototype.progressReset(),_image_manager_is_cover_image.checked=!1,_image_manager_image_id.value="",_image_manager_title.value="",_image_manager_upload.value="",_image_manager_caption.value="",_image_manager_alt_text.value="",_image_manager_upload.disabled=!1,$(_image_manager_form_data).hide()},Upload.prototype.populateForm=function(e){Upload.prototype.progressReset();e.path,e.name,e.extension;_image_manager_is_cover_image.checked=1===e.is_cover_image,_image_manager_image_id.value=e.id,_image_manager_title.value=e.title,_image_manager_caption.value=e.caption,_image_manager_alt_text.value=e.alt,$("button.dropify-clear").click(),_image_manager_upload.disabled=!0,$(_image_manager_form_data).show()},$("#image_manager_upload").on("change",function(){_image_manager_is_cover_image.checked=!1,_image_manager_image_id.value="",_image_manager_title.value="",_image_manager_caption.value="",_image_manager_alt_text.value="",$(_image_manager_form_data).show()}),$("#image_manager_clear_button").on("click",function(){Upload.prototype.resetForm()}),$.fn.YearCalendar=function(e){"use strict";document.getElementById("calendar_filter_ranges");const t=document.getElementById("product_id"),n=document.getElementById("calendar_display_select_all_days"),a=document.getElementById("calendar_display_clear_selected_days");let i,o="season",d=null,l=$(this).attr("id"),r=document.getElementById(l),s=[],c=new Map,u=parseInt(t.value);$(n).on("click",function(){_()}),$(a).on("click",function(){y()});const _=function(){y();const e=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),11,31);let n=moment(e).format("YYYY-MM-DD"),a=moment(t).format("YYYY-MM-DD");v(this,n,a)},m=function(e){return e<10?"0"+e.toString():e.toString()},p=function(e){let t=document.createElement("div");return t.classList="row gx-1",t},f=function(e){let t=function(e){let t=document.createElement("div");return t.classList=["card card-block p-1 z-depth-0"],t}(),n=function(e){let t=document.createElement("div");return t.classList="flex-fill col-6 p-1",t}(),a=document.createElement("div"),i="calendar_block_"+e;return a.classList="my_calendar",a.id=i,n.appendChild(t),t.appendChild(a),s.push(a),n},y=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("selected-day"),$(this).attr("data-selected","false")}),YearCalendar.selectedDates=new Map},g=function(e,t){$(e).hasClass("selected-day")?($(e).removeClass("selected-day"),$("td.fc-day-top[data-date='"+moment(t).format("YYYY-MM-DD")+"']").removeClass("selected-day"),YearCalendar.selectedDates.delete(t)):($(e).addClass("selected-day"),$("td.fc-day-top[data-date='"+moment(t).format("YYYY-MM-DD")+"']").addClass("selected-day"),YearCalendar.selectedDates.set(t,t),i=t,d=null)},v=function(e,t,n){let a=new Date(moment(t).format("MM/DD/YYYY")),i=new Date(moment(n).format("MM/DD/YYYY")),o=new Date(a);for($("td.fc-day[data-date='"+moment(n).format("YYYY-MM-DD")+"']").removeClass("selected-day"),$("td.fc-day[data-date='"+moment(t).format("YYYY-MM-DD")+"']").removeClass("selected-day"),$("td.fc-day-top[data-date='"+moment(n).format("YYYY-MM-DD")+"']").removeClass("selected-day");o<=i;){g($("td.fc-day[data-date='"+moment(o).format("YYYY-MM-DD")+"']"),moment(o).format("YYYY-MM-DD"));let e=o.setDate(o.getDate()+1);o=new Date(e)}},b=function(e){YearCalendar.season_events=new Map;let t=new Date;r.appendChild(function(){let e=document.createElement("div"),t=p();e.classList=["calendarContainer container-fluid"],e.id="calendar_block_container";for(let n=0;n<12;n++){let a=n+1;n%2==0&&n>0&&(e.appendChild(t),t=p()),t.appendChild(f(a))}return e.appendChild(t),e}()),YearCalendar.start=e&&e.start?e.start:t.getFullYear(),YearCalendar.events=e&&e.events?e.events:[],YearCalendar.getTitle(),$.each(s,function(e,t){let n=(a=YearCalendar.start,moment(a+"-"+m(0+e+1)+"-"+m(1)).format("YYYY-MM-DD"));var a;let o=$(t).fullCalendar({selectable:!1,showNonCurrentDates:!1,defaultDate:n,initialView:"dayGridMonth",displayEventTime:!1,eventLimit:3,header:{left:"",center:"title",right:""},views:{month:{titleFormat:"MMMM"}},dayRender:function(e,t){let n=moment(e).format("YYYYMMDD"),a=moment(e).format("YYYY-MM-DD"),i="s"+n,o=moment(e).month(),d=moment(e).year(),l=moment(e).day(),r=$(`td.fc-day-top[data-date='${a}']`);$(`td.fc-day-top[data-date='${a}'] > span.fc-day-number`);$(t).hasClass("fc-disabled-day")||($(r).attr("season","true"),$(r).attr("data-date",a),$(r).attr("id",i),$(r).attr("day",n),$(r).attr("month",o),$(r).attr("year",d),$(r).attr("dow",l),$(t).attr("season","true"),$(t).attr("data-date",a),$(t).attr("id",i),$(t).attr("day",n),$(t).attr("month",o),$(t).attr("year",d),$(t).attr("dow",l),$(t).attr("data-selected","false"))},dayClick:function(e,t,n){let a=moment(e).format("YYYY-MM-DD");if(t.originalEvent.shiftKey){if(null!==i){if(d=a,moment(d)<moment(i)){let e=moment(i).format("YYYY-MM-DD"),t=moment(d).format("YYYY-MM-DD"),n=$("td.fc-day[data-date='"+t+"'][season='true']"),a=$("td.fc-day[data-date='"+e+"'][season='true']");$(n).removeClass("is-selected"),a.removeClass("is-selected"),v(this,t,e),i=e,d=t}else v(this,i,d);i=null,d=null}}else if(t.originalEvent.ctrlKey)this.hasClass("selected-day")?(this.removeClass("selected-day"),YearCalendar.selectedDates.delete(a),i=null,d=null):(YearCalendar.selectedDates.set(a,a),i=a,d=null,this.addClass("selected-day"));else{Array.from(YearCalendar.selectedDates.values());y(),g(this,a),i=a,d=a,this.addClass("selected-day")}},eventRender:function(e,t,n){$(t).attr("season","true");let a=moment(e.start).format("YYYY-MM-DD"),i=$("td.fc-day-top[data-date='"+a+"']"),o=$("td.fc-day[data-date='"+a+"'][season='true']"),d=c.get(a),l=e.textColor,r=(e.backgroundColor,e.borderColor,hexToRgb(e.backgroundColor));r.push(.6);let s="rgba("+r.join(", ")+")";if("background"===e.rendering){if($(t).hasClass("fc-disabled-day"))return;YearCalendar.season_events.set(a,"true"),i.addClass("background_event").attr("data",e);let n=document.querySelectorAll(`td.fc-day[season='true'][data-date='${a}']`);d&&($(o).addClass("has-event"),$(o).attr("seasons_types_id",e.id),$(o).data("season","true"),$(o).attr("data-seasonid",e.id)),$(n).addClass("background_event").attr("data",e).css({background:s,color:l}),$(t).attr("data-sid",e.id),$(t).attr("data-date",a),$(t).attr("season","true"),$(t).attr("seasonid",e.id),$(t).addClass("background_event"),$(t).attr("data",e),$(t).css({background:s,color:l})}},eventClick:function(e,t,n){console.log("Event: ",e)},events:YearCalendar.events});YearCalendar.activeCalendars.push(o);let l=isNaN(parseInt($(document.getElementById("calendar_block_1")).actual("width")))?600:parseInt($(document.getElementById("calendar_block_1")).actual("width"));$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("option","contentHeight",l)})})};return function(e){s=[],e&&e.calendarType&&(o=e.calendarType),function(e,t){if(!e)return t([]);try{sendGetRequest("/api/v1.0/calendars",e,function(e,n,a){return t(e||[])})}catch(e){return console.log("error",e),t([])}}({product_id:u},function(e){e||(e=[]),YearCalendar.start=(new Date).getFullYear(),YearCalendar.loadSeasonDropdown(),YearCalendar.loadProfileDropdown(),YearCalendar.loadUnitDropdown(),b({events:e,start:YearCalendar.start}),YearCalendar.endLoading()}),$(function(){YearCalendar.init(e)})}(e),{calendars:[]}};const YearCalendar=function(){"use strict";const e=document.getElementById("calendar_display_remove"),t=document.getElementById("calendar_loader"),n=document.getElementById("seasonCalendarModal"),a=document.getElementById("calendar_display_year"),i=document.getElementById("calendar_display_next_year"),o=document.getElementById("calendar_display_prev_year"),d=document.getElementById("calendar_filter_season_id"),l=document.getElementById("product_id"),r=document.getElementById("calendar_filter_profile_id"),s=document.getElementById("calendar_filter_unit_id"),c=(document.getElementById("calendar_filter_profile_id_assign"),document.getElementById("calendar_filter_profile_id_clear")),u=document.getElementById("calendar_filter_unit_id_assign"),_=document.getElementById("calendar_filter_unit_id_clear"),m=document.getElementById("calendar_filter_season_id_assign"),p=document.getElementById("calendar_filter_season_id_clear"),f=document.getElementById("calendar_display_refresh");$(e).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.remove(),b()})}),$(f).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.refresh(),b()})}),$(i).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.start=(parseInt(YearCalendar.start)+1).toString(),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("nextYear")}),N(),YearCalendar.endLoading()})}),$(o).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.start=(parseInt(YearCalendar.start)-1).toString(),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("prevYear")}),YearCalendar.getTitle(),YearCalendar.endLoading()})}),$(d).on("change",function(){let e,t,n,a=isNaN(parseInt(d.value))?null:parseInt(d.value);is_null(a),is_null(a)?(m.disabled=!0,r.disabled=!1,u.disabled=!0):((t=Season.all.get(a))&&t.product_season_detail&&(e=t.product_season_detail),e.disabled_dow&&(n=getListOfIds(e.disabled_dow)),r.value="",r.disabled=!0,u.disabled=!0,m.disabled=!1,r.value="",$(s).val([])),B(n)}),$(s).on("change",function(){let e=$(s).val();u.disabled=e.length<=0}).on("click",function(){let e=$(s).val();u.disabled=e.length<=0}),$(r).on("change",function(){null!==(isNaN(parseInt(r.value))?null:parseInt(r.value))?(s.disabled=!1,d.disabled=!0):($(s).val([]),s.disabled=!0,d.disabled=!1)}),$(m).on("click",function(){h()}),$(u).on("click",function(){w()}),$(p).on("click",function(){$(d).val("").trigger("change"),b()}),$(_).on("click",function(){$(s).val([]).trigger("change"),b()}),$(c).on("click",function(){$(r).val("").trigger("change"),b()}),$(n).on("shown.bs.modal",function(){b(),$("html").css({overflow:"hidden"})}).on("hidden.bs.modal",function(){k(),$("html").css({overflow:"auto"})}).on("click",function(){YearCalendar.checkProgress()});const y=function(){let e=Season&&Season.all?Array.from(Season.all.values()):[],t="<option value='' disabled readonly selected>-- Seasons --</option>",n="";$.each(e,function(e,a){let i=a.name,o=a.id;t+=`<option value="${o}">${i}</option>`,n+=`<option value="${o}">${i}</option>`}),$(d).empty(),$(d).html(t),$(d).val("").trigger("change")},g=function(){let e=InventoryProfile&&InventoryProfile.all?Array.from(InventoryProfile.all.values()):[],t="<option value='' disabled readonly selected>-- Profiles --</option>";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(r).empty(),$(r).html(t),$(r).val("").trigger("change")},v=function(){let e=Unit&&Unit.all?Array.from(Unit.all.values()):[],t="";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(s).empty(),$(s).html(t),$(s).val([]).trigger("change")},b=function(){x()},h=function(){let e=parseInt(l.value),n=parseInt(d.value),a=Season.all.get(n),i=[],o={season_id:n,product_id:e,days:[]},r=Array.from(YearCalendar.selectedDates.values());a&&a.product_season_detail&&(i=getListOfIds(a.product_season_detail.disabled_dow)),$.each(r,function(e,t){const n=moment(t).day();i.indexOf(n)<0&&o.days.push(t)}),confirmDialog("Would you like to assign? This change may affect your Pricing Worksheets.",e=>{e&&$(t).fadeIn("slow",function(){C(o,function(e){e&&(M(),x(),P(),toastr.success("Dates Assigned.")),S()})})})},I=function(e){toastr.error(e)},w=function(){let e=function(){let e,t=r&&!is_null(parseInt(r.value))?parseInt(r.value):null,n=l&&!isNaN(parseInt(l.value))?parseInt(l.value):null,a=s?$(s).val().map(Number):[],i=[],o=Array.from(YearCalendar.selectedDates.values());if(n&&t&&(e=InventoryProfile.all.get(t))&&$.each(a,function(e,a){let d={product_id:n,profile_id:t,unit_id:a,quantity_released:0,quantity_used:0,days:[]};$.each(o,function(e,t){YearCalendar.season_events.get(t)&&d.days.push(t)}),d.days.length>0&&i.push(d)}),i.length>0)return i}();e?confirmDialog("Would you like to assign? This change may affect your Pricing Worksheets.",n=>{n&&$(t).fadeIn("slow",function(){E(e,function(e){e&&(M(),x(),P(),toastr.success("Dates Assigned.","Inventory Profile")),S()})})}):(toastr.warning("No Profiles to update.","Inventory Profile"),S())},E=function(e,t){if(e)try{sendPostRequest("/api/v1.0/products/assign_profiles",{params:e},function(e,n,a){if(e)return t(e);I("Oops: 1"),S()})}catch(e){console.log("error",e),I("Oops: 2"),S()}},C=function(e,t){if(e)try{sendPostRequest("/api/v1.0/products/assign_seasons",e,function(e,n,a){return e?t(e):I("Oops: 1")})}catch(e){return console.log("error",e),I("Oops: 1")}},k=function(){M(),x(),y(),v(),g()},B=function(e){e||(e=[]),x(),$.each(e,function(e,t){let n=t.toString();$(`td[season='true'][dow='${n}']`).each(function(e,t){let n=$(t).attr("data-date");$("td[data-date='"+n+"']").addClass("disabled-dow"),$(t).addClass("disabled-dow")})})},x=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("disabled-dow")})},M=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("selected-day"),$(this).attr("selected","false")}),YearCalendar.selectedDates=new Map},S=function(){b(),$(t).hide()},N=function(){a.innerText=YearCalendar.start},D=function(){YearCalendar.events=[],document.querySelectorAll("td[season='true']").forEach(e=>{$(e).css({background:"initial","background-color":"initial",color:"initial","border-color":"#ddd"})}),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("removeEvents")}),YearCalendar.endLoading()},L=function(){$(t).fadeIn("slow",function(){let e=isNaN(parseInt(l.value))?null:parseInt(l.value);M(),x(),D(),function(e,t){if(e)try{sendGetRequest("/api/v1.0/calendars",e,function(e,n,a){return t(e||[])})}catch(e){console.log("error",e)}}({product_id:e},function(e){YearCalendar.events=e,$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("removeEvents"),$(t).fullCalendar("addEventSource",YearCalendar.events),$(t).fullCalendar("rerenderEvents")}),YearCalendar.endLoading()})})},P=function(){k(),L()};return{calendarContextMenu:null,calendars:new Map,events:[],start:(new Date).getFullYear(),selectedDates:new Map,activeCalendars:[],season_events:[],refresh:function(){P()},remove:function(){M(),x(),D()},checkProgress:function(){},endLoading:function(){S()},loadSeasonDropdown:function(){y()},loadProfileDropdown:function(){g()},loadUnitDropdown:function(){v()},getTitle:function(){N()},clearSelected:function(){M()},init:function(e){s.disabled=!0,m.disabled=!0,u.disabled=!0,v(),g(),y()},resetForm:function(){k()}}}();$.fn.imageManager=function(e){const t=$(this).find("div.carousel"),n=$(this).find("ol.carousel-indicators"),a=$(this).find("div.carousel-inner"),i=document.getElementById("companyImageManager"),o=document.getElementById("image_manager_is_cover_image"),d=document.getElementById("image_manager_title"),l=document.getElementById("image_manager_caption"),r=document.getElementById("image_manager_upload"),s=document.getElementById("image_manager_alt_text"),c=(document.getElementById("image_manager_form_data"),document.getElementById("image_manager_id")),u=($("#image_manager_form_data"),document.getElementById("vendor_edit")),_=document.getElementById("image_manager_cancel_upload");let m,p,f=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,y=0,g="";const v={rules:{image_manager_title:{required:!0},image_manager_alt_text:{required:!0},image_manager_caption:{required:!0}},messages:{image_manager_title:{required:"Field Required"},image_manager_alt_text:{required:"Field Required"},image_manager_caption:{required:"Field Required"}}};$("#image_manager_upload_button").on("click",function(){i&&h()&&confirmDialog("Would you like to update?",e=>{e&&w()})}),$("button.dropify-clear").on("click",function(){$("input.dropify").trigger("change")}),$(_).on("click",function(){Upload.prototype.resetForm(),$("button.dropify-clear").trigger("click")});const b=function(e,t){if(e){Console.log("data",e);try{sendPostRequest("/api/v1.0/images/update",e,function(e,n,a){return e?t(e):(i="Oops: 1",void toastr.error(i));var i})}catch(e){Console.log("error",e)}}},h=function(){return $(i).valid()},I=function(e){m=$("#image_manager_upload").dropify({}),e&&(e.images&&x(e.images),e.id&&(g="carousel-"+e.id)),i&&(validator_init(v),p=$(i).validate()),t.carousel()},w=function(){let e=null;if(c)if(isNaN(parseInt(c.value))){let t=$(r);if(t&&t[0]&&t[0].files&&t[0].files[0]){e=t[0].files[0],new Upload(e).doUpload()}}else{let e=this.all.get(parseInt(c.value));e.alt=""!==s.value?s.value:null,e.caption=""!==l.value?l.value:null,e.is_cover_image=!0===o.checked?1:0,e.title=""!==d.value?d.value:null,_provider_edit&&(e.directory_id=parseInt(_provider_company_id.value),e.directory="company"),u&&(e.directory_id=parseInt(_provider_company_id.value),e.directory="company"),b(e,function(e){let t;Console.log("data",e),e&&e[0]&&(t=e[0],M(t))})}},E=function(e){let t={id:null,path:null,type:null,caption:null,alt:null,is_cover_image:0,enabled:1,date_created:formatDateMySQL(),created_by:f,date_modified:formatDateMySQL(),modified_by:f,note:null};return t.alt=e.alt?e.alt:"",t._caption=e.caption?e.caption:"This is a Test Caption 3",t.id=e.id?e.id:3,t.is_cover_image=e.is_cover_image?e.is_cover_image:0,t.path=e.path?e.path:"/company/1/image_3",t.title=e.title?e.title:"Image 3",t.type=e.type?e.type:"jpg",t},C=function(e,t){E(e);let n=e.alt?e.alt:"",a=e.name?e.name:"",i=e.caption?e.caption:"",o=e.id?e.id:3,d=e.is_cover_image?e.is_cover_image:0,l=e.path?e.path:"",r=e.title?e.title:"",s=e.extension?e.extension:"jpg",c=0===t?"active ":"",u=$("<H3>"),_=$("<img>"),m=$("<div>"),p=$("<div>"),f=$("<div>"),y=$("<div>"),g=$("<p>"),v=1===e.is_cover_image?" is_cover ":"";return m.addClass("carousel-item "+c+v),f.addClass("view").appendTo(m),_.addClass("d-block w-100 imageManager_edit").attr("src",`${l}/${a}.${s}`).data("imgid",o).data("is_cover",d).attr("alt",n).appendTo(f),y.addClass("mask rgba-blue-light").data("key",e).css({cursor:"pointer"}).on("click",function(){k($(this).data("key"))}).appendTo(f),u.addClass("").text(r).appendTo(p).css({cursor:"pointer"}).data("key",e).on("click",function(){k($(this).data("key"))}),g.addClass("").text(i).appendTo(p).data("key",e).css({cursor:"pointer"}).on("click",function(){k($(this).data("key"))}),p.addClass("carousel-caption").appendTo(m),m},k=function(e){Upload.prototype.populateForm(e)},B=function(e,t){let n=0===t?"active":"",a=1===e.is_cover_image?" is_cover ":"",i=$("<li>");return i.addClass(n+" "+a).attr("data-slide-to",t).attr("data-target","#carousel-companyImageManager"),i},x=function(e){y=0,n.empty(),a.empty(),this.all=new Map;for(let t=0;t<e.length;t++){let i=e[t];this.all.set(i.id,i),n.append(B(i,y)),a.append(C(i,y)),y+=1}},M=function(e){e&&(this.all.set(e.id,e),x(Array.from(this.all.values())))};return I(e),{addImage:function(e){!function(e){e&&(this.all.set(e.id,e),x(Array.from(this.all.values())))}(e)},reset:function(){},all:new Map,init:function(e){I(e)},loadAll:function(e){x(e)}}};const LocationTypes=function(){"use strict";document.getElementById("input_location_types_id"),document.getElementById("input_location_types_name"),document.getElementById("input_location_types_icon"),document.getElementById("input_location_types_sort_order"),document.getElementById("input_location_types_enabled"),document.getElementById("input_location_types_date_created"),document.getElementById("input_location_types_created_by"),document.getElementById("input_location_types_date_modified"),document.getElementById("input_location_types_modified_by"),document.getElementById("input_location_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,icon:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.icon=t.icon?t.icon:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),LocationTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,LocationTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);LocationTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),AddressTypes=function(){"use strict";document.getElementById("input_address_types_id"),document.getElementById("input_address_types_name"),document.getElementById("input_address_types_sort_order"),document.getElementById("input_address_types_enabled"),document.getElementById("input_address_types_date_created"),document.getElementById("input_address_types_created_by"),document.getElementById("input_address_types_date_modified"),document.getElementById("input_address_types_modified_by"),document.getElementById("input_address_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),AddressTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,AddressTypes.all=new Map,n&&($.each(n,function(e,n){let a=t(n);AddressTypes.all.set("id",a)}),console.log(" AddressTypes.all",AddressTypes.all))},save:function(e){},init:function(){}}}(),City=function(){"use strict";const e=document.getElementById("modal_product_city_id"),t=document.getElementById("modal_product_provider_name"),n=document.getElementById("modal_product_vendor_name"),a=document.getElementById("modal_product_arrive_to_airport_city"),i=document.getElementById("modal_product_arrive_to_airport_country_id"),o=document.getElementById("modal_product_arrive_to_airport_province_id"),d=document.getElementById("modal_product_arrive_to_airport_city_id"),l=document.getElementById("modal_product_depart_from_airport_city"),r=document.getElementById("modal_product_depart_from_airport_country_id"),s=document.getElementById("modal_product_depart_from_airport_province_id"),c=document.getElementById("modal_product_depart_from_airport_city_id"),u=(document.getElementById("modal_product_arrive_to_station_city"),document.getElementById("modal_product_arrive_to_station_country_id")),_=document.getElementById("modal_product_arrive_to_station_province_id"),m=document.getElementById("modal_product_arrive_to_station_city_id"),p=(document.getElementById("modal_product_depart_from_station_city"),document.getElementById("modal_product_depart_from_station_country_id")),f=document.getElementById("modal_product_depart_from_station_province_id"),y=document.getElementById("modal_product_depart_from_station_city_id");let g=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$("#form_product_search_hotel_product_location").on("change",function(){setTimeout(function(){},200)}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){console.log("city",e),e.data&&console.log("city",e)}}),$(e).on("change",function(){""===e.value?(t.disabled=!0,n.disabled=!0):(t.disabled=!1,n.disabled=!1)}),$("#modal_product_depart_from_airport_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(l).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(t){if(!t.data)return;let n=t.data;e.value=n.id,$(e).val(n.id?n.id:"").trigger("change"),r.value=isNaN(parseInt(n.country.id))?null:parseInt(n.country.id),s.value=isNaN(parseInt(n.province.id))?null:parseInt(n.province.id),c.value=isNaN(parseInt(n.id))?null:parseInt(n.id)}}),$("#modal_product_arrive_to_airport_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(a).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;i.value=t.country.id?t.country.id:null,o.value=t.province.id?t.province.id:null,d.value=t.id?t.id:null}}),$("#modal_product_depart_from_station_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(e).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(t){if(!t.data)return;let n=t.data;e.value=n.id,$(e).val(n.id?n.id:"").trigger("change"),p.value=isNaN(parseInt(n.country.id))?null:parseInt(n.country.id),f.value=isNaN(parseInt(n.province.id))?null:parseInt(n.province.id),y.value=isNaN(parseInt(n.id))?null:parseInt(n.id)}}),$("#modal_product_arrive_to_station_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(e).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;u.value=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),_.value=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),m.value=isNaN(parseInt(t.id))?null:parseInt(t.id)}}),$("#modal_product_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(e).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(t){if(console.log("city",t),!t.data)return;let n=t.data;e.value=n.id,$(e).val(n.id?n.id:"").trigger("change")}}),$("#modal_product_city_cars").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(e).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(t){if(!t.data)return;let n=t.data;e.value=n.id,$(e).val(n.id?n.id:"").trigger("change")}}),$("#modal_product_city_transports").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(e).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(t){if(!t.data)return;let n=t.data;e.value=n.id,$(e).val(n.id?n.id:"").trigger("change")}});const v=function(e){toastr.error(e),console.log("msg",e)},b=e=>{$(e.target).parents("div.form-new-city")[0]||e.target.className.includes("select-add-option")||City.close()},h=function(e){let t={id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:1,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),note:null},n=null;return e&&(n=validInt(e.id),t={id:validInt(e.id),province_id:validInt(e.province_id),created_by:e.created_by?e.created_by:g,modified_by:e.created_by?e.created_by:g,sort_order:e.sort_order?e.sort_order:null,name:e.name?e.name:null,enabled:e.enabled?e.enabled:1,date_created:e.date_created?e.date_created:formatDateMySQL(),date_modified:e.date_modified?e.date_modified:formatDateMySQL(),note:e.note?e.note:null}),City.detail=t,t},I=function(e,t,n){City.all=new Map;let a=null;if(null!==City.id&&(a=City.id),n)return e&&t&&n?void function(e,t){if(!e)return v("Error Loading Province- Missing Data");try{sendGetRequest("/api/v1.0/cities",e,function(e,n,a){return e?t(e):v("Oops: 1")})}catch(e){return console.log("error",e),v("Error Validating City")}}({country_id:parseInt(e),province_id:parseInt(t)},function(e){e&&(C(e),$(n).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),""!==a&&null!==a&&$(n).val(a).trigger("change"))}):($(n).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),void $(n).val("").trigger("change"))},w=function(e,t,n){e&&function(e,t,n){let a=$(e).attr("id"),i=$(e).parents("div.row"),o="";if(t&&(o=t),!a||!i[0])return;if(document.getElementById("form_new_city"))return;let d=document.createElement("div"),l=document.createElement("h5"),r=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),_=document.createElement("div"),m=document.createElement("div"),p=document.createElement("div"),f=document.createElement("div"),y=document.createElement("div"),g=document.createElement("div"),v=document.createElement("div"),h=document.createElement("div"),I=document.createElement("input"),w=document.createElement("label"),E=document.createElement("button"),C=document.createElement("button");l.classList="card-title",l.innerText="City Details",d.id="form_new_city",d.classList=["card card-body m-3 form-new-city"],I.id="city_name",I.name="city_name",I.type="text",I.classList=["form-control "],w.htmlFor="city_name",w.innerHTML="Name:",h.id="city_name-error",E.classList=["btn btn-primary btn-sm waves-effect waves-light"],E.innerText="save",E.type="button",E.addEventListener("click",t=>{City.save(e,n)}),C.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],C.innerText="cancel",C.type="button",C.addEventListener("click",e=>{City.close()}),r.classList=["row"],s.classList=["row"],c.classList=["col-lg-3 mb-1"],u.classList=["col-lg-3 mb-1"],_.classList=["col-lg-3 mb-1"],m.classList=["col-lg-3 mb-1"],p.classList=["col-12 mb-1 text-right"],f.classList=["form-element"],y.classList=["form-element"],g.classList=["form-element"],v.classList=["form-element"],h.classList=["error w-100 text-center"],f.appendChild(w),f.appendChild(I),f.appendChild(h),c.appendChild(f),r.appendChild(c),r.appendChild(u),r.appendChild(_),r.appendChild(m),p.append(C),p.appendChild(E),s.appendChild(p),d.appendChild(l),d.appendChild(r),d.appendChild(s),i[0].appendChild(d),I.value=o,I.focus({preventScroll:!1}),window.addEventListener("click",b)}(e,t,n)},E=function(e,t){let n={},a=document.getElementById("city_name"),i=document.getElementById(t.replace(/city_id/g,"")+"province_id"),o=document.getElementById(t.replace(/city_id/g,"")+"country_id");if(!isNaN(parseInt(o.value))&&!isNaN(parseInt(i.value))&&o){n.name=a.value,n.country_id=parseInt(o.value),n.province_id=parseInt(i.value),!0===confirm("Are you sure you want to edit this record?")&&function(e,t){if(t)try{sendPostRequest("/api/v1.0/cities/update",t,function(t,n,a){if(!t||!t[0])return v("Error: 1");{let n=t[0];City.all.set(n.id,n);let a=$("select[data-type='city']");City.id=n.id,a.each(function(e,t){var a=new Option(n.name,n.id,!1,!1);$(t).append(a).trigger("change")}),$(e).val(n.id).trigger("change"),City.close(),toastr.success("City: "+n.id+" updated")}})}catch(e){console.log("error",e),v("Error: Validating City")}else console.log("Error: Missing Data"),v("Error: Missing Data")}(e,remove_nulls(n))}},C=function(e){City.all=new Map,e&&$.each(e,function(e,t){let n=h(t);City.all.set(n.id,n)})},k=function(e){!function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=document.getElementById(t);n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_city_add_icon")){let a=document.createElement("i");a.classList="select-add-option fas fa-plus filter_city_add",a.id="filter_city_add_icon",a.addEventListener("click",a=>{let i=e.value;$(n).select2("close"),City.add(this,i,t)}),e.after(a)}$(".filter_city_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_city_add").show():$(".filter_city_add").hide()})}}).on("change",function(){$(this).attr("id").replace("city","city")})})}(e)};return{id:null,detail:{id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:null,date_created:null,date_modified:null,note:null},all:[],close:function(){!function(){let e=document.getElementById("form_new_city");e&&(e.parentNode.removeChild(e),window.removeEventListener("click",b))}()},save:function(e,t){E(e,t)},get:function(e,t,n){I(e,t,n)},add:function(e,t,n){w(e,t,n)},set_detail:function(e){h(e)},init:function(e){k(e)}}}(),Province=function(){"use strict";const e="form-new-province",t="form_new_province";let n=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const a=function(e){toastr.error(e),Console.log(e)},i=t=>{$(t.target).parents("div."+e)[0]||t.target.className.includes("select-add-option")||Province.close()},o=function(e){let t=d(),a=null;return e&&(a=validInt(e.id),t={id:validInt(e.id),name:e.name?e.name:null,sort_order:e.sort_order?e.sort_order:9999999,country_id:validInt(e.country_id),iso2:e.iso2?e.iso2:null,iso3:e.iso3?e.iso3:null,enabled:e.enabled?e.enabled:1,date_created:e.date_created?e.date_created:formatDateMySQL(),created_by:e.created_by?e.created_by:n,date_modified:e.date_modified?e.date_modified:formatDateMySQL(),modified_by:e.modified_by?e.modified_by:n,note:e.note?e.note:null}),Province.id=a,Province.detail=t,t},d=function(){return{id:null,name:null,sort_order:9999999,iso2:null,iso3:null,enabled:1,note:null,created_by:n,modified_by:n,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},l=function(){let e=document.getElementById(t);e&&(e.parentNode.removeChild(e),window.removeEventListener("click",i))},r=function(e,t){if(Province.all=new Map,!t)return;let n="";if(null!==Province.id&&(n=Province.id),!e)return $(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),void $(t).val("").trigger("change");!function(e,t){if(!e)return a("Error Loading Province- Missing Data");try{sendGetRequest("/api/v1.0/provinces",e,function(e,n,i){return e?t(e):a("Oops: 1")})}catch(e){return Console.log("error",e),a("Error Validating Province")}}({country_id:e},function(e){e&&(s(e),$(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(t).val(n).trigger("change"))})},s=function(e){Province.all=new Map,e&&$.each(e,function(e,t){let n=o(t);Province.all.set(n.id,n)})},c=function(n,a,o){n&&function(n,a,o){let d=$(n).attr("id"),r=$(n).parents("div.row"),s="";if(a&&(s=a),!d||!r[0])return;if(document.getElementById(t))return;let c=document.createElement("div"),u=document.createElement("h5"),_=document.createElement("div"),m=document.createElement("div"),p=document.createElement("div"),f=document.createElement("div"),y=document.createElement("div"),g=document.createElement("div"),v=document.createElement("div"),b=document.createElement("div"),h=document.createElement("div"),I=document.createElement("div"),w=document.createElement("div"),E=document.createElement("div"),C=document.createElement("div"),k=document.createElement("div"),B=document.createElement("input"),x=document.createElement("label"),M=document.createElement("input"),S=document.createElement("label"),N=document.createElement("input"),D=document.createElement("label"),L=document.createElement("button"),P=document.createElement("button");c.id=t,c.classList=["card card-body m-3 "+e],u.classList="card-title",u.innerText="Province Details",B.id="province_name",B.name="province_name",B.type="text",B.classList=["form-control "+e],x.htmlFor="province_name",x.innerHTML="Name:",E.id="province_name-error",M.id="province_iso2",M.name="province_iso2",M.type="text",M.maxLength=2,M.classList=["form-control "+e],S.htmlFor="province_iso2",S.innerHTML="ISO2:",C.id="province_iso2-error",N.id="province_iso3",N.name="province_iso3",N.type="text",N.maxLength=3,N.classList=["form-control "+e],D.htmlFor="province_iso3",D.innerHTML="ISO3:",k.id="province_iso3-error",L.classList=["btn btn-primary btn-sm waves-effect waves-light"],L.innerText="save",L.type="button",L.addEventListener("click",e=>{Province.save(n,o)}),P.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],P.innerText="cancel",P.type="button",P.addEventListener("click",e=>{l()}),_.classList=["row"],m.classList=["row"],p.classList=["col-lg-3 mb-1"],f.classList=["col-lg-3 mb-1"],y.classList=["col-lg-3 mb-1"],g.classList=["col-lg-3 mb-1"],v.classList=["col-12 mb-1 text-right"],b.classList=["form-element"],h.classList=["form-element"],I.classList=["form-element"],w.classList=["form-element"],E.classList=["error w-100 text-center"],C.classList=["error w-100 text-center"],k.classList=["error w-100 text-center"],b.appendChild(x),b.appendChild(B),b.appendChild(E),p.appendChild(b),h.appendChild(S),h.appendChild(M),h.appendChild(C),f.appendChild(h),I.appendChild(D),I.appendChild(N),I.appendChild(k),y.appendChild(I),_.appendChild(p),_.appendChild(f),_.appendChild(y),_.appendChild(g),v.append(P),v.appendChild(L),m.appendChild(v),c.appendChild(u),c.appendChild(_),c.appendChild(m),r[0].appendChild(c),B.value=s,B.focus({preventScroll:!1}),window.addEventListener("click",i)}(n,a,o)},u=function(e,t){let n={},a=document.getElementById("province_name"),i=document.getElementById("province_iso2"),o=document.getElementById("province_iso3"),d=document.getElementById(t.replace(/province_id/g,"")+"country_id");isNaN(parseInt(d.value))||d&&function(){let e=document.getElementById("province_name"),t=document.getElementById("province_iso2"),n=document.getElementById("province_iso3"),a=!0;return e&&t&&n?(""===e.value?($(e).addClass("is-invalid"),$("#province_name-error").text("Required: Field is required").show(),a=!1):($(e).removeClass("is-invalid"),$("#province_name-error").text("").hide()),""===t.value?($(t).addClass("is-invalid"),$("#province_iso2-error").text("Required: Field is required").show(),a=!1):($(t).removeClass("is-invalid"),$("#province_iso2-error").text("").hide()),""===n.value?($(n).addClass("is-invalid"),$("#province_iso3-error").text("Required: Field is required").show(),a=!1):($(n).removeClass("is-invalid"),$("#province_iso3-error").text("").hide()),a):(handle_country_error("Error Processing Data"),!1)}()&&(n.name=a.value,n.iso2=i.value,n.iso3=o.value,n.country_id=parseInt(d.value),confirmDialog("Would you like to update?",t=>{t&&_(e,remove_nulls(n))}))},_=function(e,t){if(t)try{sendPostRequest("/api/v1.0/provinces/update",t,function(t,n,i){if(!t||!t[0])return a("Error: 1");{let n=t[0];Console.log("new_province",n),Province.all.set(n.id,n);let a=$("select[data-type='province']");Province.id=n.id,City.id=null,a.each(function(e,t){var a=new Option(n.name,n.id,!1,!1);$(t).append(a).trigger("change")}),$(e).val(n.id).trigger("change"),Province.close(),toastr.success("Province: "+n.id+" updated")}})}catch(e){Console.log("error",e),a("Error: Validating Province")}else Console.log("Error: Missing Data"),a("Error: Missing Data")},m=function(e){!function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=Country.id,a=(Province.id,document.getElementById(t));a&&$(a).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let n=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(n[0]){let e=n[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_province_add_icon")){let n=document.createElement("i");n.classList="select-add-option fas fa-plus filter_province_add",n.id="filter_province_add_icon",n.addEventListener("click",n=>{let i=e.value;$(a).select2("close"),Province.add(this,i,t)}),e.after(n)}$(".filter_province_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_province_add").show():$(".filter_province_add").hide()})}}).on("change",function(){let e=$(this).attr("id").replace("province","city"),t=$(this).attr("id").replace("province","country"),a=document.getElementById(e),i=document.getElementById(t);a&&i&&(n=parseInt(i.value),isNaN(parseInt(i.value))?(City.id=null,City.get(null,null,a)):isNaN(parseInt($(this).val()))?(City.id=null,City.get(n,null,a),City.id):City.get(n,parseInt($(this).val()),a)),City.id=null,Province.id=null})})}(e)};return{detail:{},all:new Map,id:null,set_detail:function(e){o(e)},update_select:function(e,t){},close:function(){l()},save:function(e,t){u(e,t)},get:function(e,t){r(e,t)},add:function(e,t,n){c(e,t,n)},init:function(e){m(e)}}}(),Country=function(){"use strict";const e="form_new_country";let t=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const n=function(e){toastr.error(e),console.log(e)},a=e=>{$(e.target).parents("div.form-new-country")[0]||e.target.className.includes("select-add-option")||Country.close()},i=function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=document.getElementById(t);n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_country_add_icon")){let t=document.createElement("i");t.classList="select-add-option fas fa-plus filter_country_add",t.id="filter_country_add_icon",t.addEventListener("click",t=>{let a=e.value;$(n).select2("close"),Country.add(this,a)}),e.after(t)}$(".filter_country_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_country_add").show():$(".filter_country_add").hide()})}}).on("change",function(){isNaN(parseInt($(this).val()))||parseInt($(this).val());let e=$(this).attr("id").replace("country","province"),t=document.getElementById(e),n=$(this).attr("id").replace("country","city");document.getElementById(n);isNaN(parseInt($(this).val()))?Province.get(null,t):t&&Province.get(parseInt($(this).val()),t)})})},o=function(e){let n=d(),a=null;return e&&(a=validInt(e.id),n={id:validInt(e.id),name:e.name?e.name:null,sort_order:e.sort_order?e.sort_order:null,iso2:e.iso2?e.iso2:null,iso3:e.iso3?e.iso3:null,currency_id:validInt(e.currency_id),enabled:e.enabled?e.enabled:1,date_created:e.date_created?e.date_created:formatDateMySQL(),created_by:e.created_by?e.created_by:t,date_modified:e.date_modified?e.date_modified:formatDateMySQL(),modified_by:e.modified_by?e.modified_by:t,note:e.note?e.note:null}),Country.id=a,Country.detail=n,n},d=function(){return{id:null,name:null,sort_order:null,iso2:null,iso3:null,currency_id:null,enabled:1,note:null,created_by:t,modified_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},l=function(e){!function(e,t){if(!e)return n("Error Loading Country- Missing Data");try{$.ajax({type:"GET",url:"/api/v1.0/countries",data:e,async:!1}).done(function(e){return e?t(e):n("Oops: 1")})}catch(e){return console.log("error",e),n("Error Validating Country")}}({},function(t){t&&(Country.all=t,i(e))})},r=function(t,n){t&&function(t,n){let i=$(t).attr("id"),o=$(t).parents("div.row"),d="";if(n&&(d=n),!i||!o[0])return;if(document.getElementById(e))return;let l=document.createElement("div"),r=document.createElement("h5"),s=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),_=document.createElement("div"),m=document.createElement("div"),p=document.createElement("div"),f=document.createElement("div"),y=document.createElement("div"),g=document.createElement("div"),v=document.createElement("div"),b=document.createElement("div"),h=document.createElement("div"),I=document.createElement("div"),w=document.createElement("div"),E=document.createElement("input"),C=document.createElement("label"),k=document.createElement("input"),B=document.createElement("label"),x=document.createElement("input"),M=document.createElement("label"),S=document.createElement("button"),N=document.createElement("button");r.classList="card-title",r.innerText="Country Details",l.id=e,l.classList=["card card-body m-3 form-new-country"],E.id="country_name",E.name="country_name",E.type="text",E.classList=["form-control "],C.htmlFor="country_name",C.innerHTML="Name:",h.id="country_name-error",k.id="country_iso2",k.name="country_iso2",k.type="text",k.maxLength=2,k.classList=["form-control "],B.htmlFor="country_iso2",B.innerHTML="ISO2:",I.id="country_iso2-error",x.id="country_iso3",x.name="country_iso3",x.type="text",x.maxLength=3,x.classList=["form-control "],M.htmlFor="country_iso3",M.innerHTML="ISO3:",w.id="country_iso3-error",S.classList=["btn btn-primary btn-sm waves-effect waves-light"],S.innerText="save",S.type="button",S.addEventListener("click",e=>{Country.save(t)}),N.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],N.innerText="cancel",N.type="button",N.addEventListener("click",e=>{Country.close()}),s.classList=["row"],c.classList=["row"],u.classList=["col-lg-3 mb-1"],_.classList=["col-lg-3 mb-1"],m.classList=["col-lg-3 mb-1"],p.classList=["col-lg-3 mb-1"],f.classList=["col-12 mb-1 text-right"],y.classList=["form-element"],g.classList=["form-element"],v.classList=["form-element"],b.classList=["form-element"],h.classList=["error w-100 text-center"],I.classList=["error w-100 text-center"],w.classList=["error w-100 text-center"],y.appendChild(C),y.appendChild(E),y.appendChild(h),u.appendChild(y),g.appendChild(B),g.appendChild(k),g.appendChild(I),_.appendChild(g),v.appendChild(M),v.appendChild(x),v.appendChild(w),m.appendChild(v),s.appendChild(u),s.appendChild(_),s.appendChild(m),s.appendChild(p),f.append(N),f.appendChild(S),c.appendChild(f),l.appendChild(r),l.appendChild(s),l.appendChild(c),o[0].appendChild(l),E.value=d,E.focus({preventScroll:!1}),window.addEventListener("click",a)}(t,n)},s=function(e){let t=document.getElementById("country_name"),a=document.getElementById("country_iso2"),i=document.getElementById("country_iso3");if(t&&a&&i){if(function(){let e=document.getElementById("country_name"),t=document.getElementById("country_iso2"),a=document.getElementById("country_iso3"),i=!0;return e&&t&&a?(""===e.value?($(e).addClass("is-invalid"),$("#country_name-error").text("Required: Field is required").show(),i=!1):($(e).removeClass("is-invalid"),$("#country_name-error").text("").hide()),""===t.value?($(t).addClass("is-invalid"),$("#country_iso2-error").text("Required: Field is required").show(),i=!1):($(t).removeClass("is-invalid"),$("#country_iso2-error").text("").hide()),""===a.value?($(a).addClass("is-invalid"),$("#country_iso3-error").text("Required: Field is required").show(),i=!1):($(a).removeClass("is-invalid"),$("#country_iso3-error").text("").hide()),i):(n("Error Processing Data"),!1)}()){let o={};o.name=""!==t.value?t.value:null,o.iso2=""!==a.value?a.value:null,o.iso3=""!==i.value?i.value:null,confirmDialog("Would you like to update?",t=>{t&&function(e,t){if(t)try{sendPostRequest("/api/v1.0/countries/update",t,function(t,a,i){if(!t||!t[0])return n("Error: 1");{let n=t[0];Country.all.set(n.id,n),$("select[data-type='country']").each(function(e,t){var a=new Option(n.name,n.id,!1,!1);$(t).append(a).trigger("change")}),$(e).val(n.id).trigger("change"),Country.close(),toastr.success("Country: "+n.id+" updated")}})}catch(e){console.log("error",e),n("Error: Validating Country")}else console.log("Error: Missing Data"),n("Error: Missing Data")}(e,remove_nulls(o))})}}else toastr.error("Error: 2")};return{detail:{},all:new Map,close:function(){!function(){let t=document.getElementById(e);t&&(t.parentNode.removeChild(t),window.removeEventListener("click",a))}()},add:function(e,t){r(e,t)},save:function(e){s(e)},set:function(e){set(e)},set_detail:function(e){o(e)},load_all:function(e){!function(e){Country.all=new Map,e&&$.each(e,function(e,t){let n=o(t);Country.all.set(n.id,n)})}(e)},get:function(e){l(e)},init:function(e){!function(e){i(e)}(e)}}}(),Location=function(){"use strict";const e=document.getElementById("form_edit_location"),t=document.getElementById("form_location_details"),n=document.getElementById("location_types_id"),a=document.getElementById("location_name_filter"),i=document.getElementById("location_city_id"),o=document.getElementById("location_country_id"),d=document.getElementById("location_province_id"),l=document.getElementById("location_id"),r=document.getElementById("location_street_1"),s=document.getElementById("location_street_2"),c=document.getElementById("location_zipcode"),u=document.getElementById("location_name"),_=document.getElementById("location_enabled"),m=document.getElementById("button_clear_form_edit_location"),p=document.getElementById("button_submit_form_edit_location"),f=document.getElementById("button_edit_location"),y=document.getElementById("button_close_edit_location_form"),g=document.getElementById("form_edit_location_filter"),v=document.getElementById("location_name_filter_id"),b={groups:{locationGroup:"location_name_filter location_name_filter_id"},rules:{location_name_filter:{required:!0},location_name_filter_id:{required:!0,digits:!0}},messages:{location_name_filter:{required:"Field Required"},location_name_filter_id:{required:"Field Required",digits:"invalid"}}},h={rules:{location_types_id:{required:!0},location_city_id:{required:!0,digits:!0},location_country_id:{required:!0,digits:!0},location_province_id:{required:!0,digits:!0},location_name:{required:!0}},messages:{location_types_id:{required:"Field Required"},location_city_id:{required:"Field Required",digits:"invalid"},location_country_id:{required:"Field Required",digits:"invalid"},location_province_id:{required:"Field Required",digits:"invalid"},location_id:{required:"Field Required",digits:"invalid"},location_name:{required:"Field Required"}}},I=document.getElementById("form_product_edit_location"),w=document.getElementById("button_edit_product_location"),E=document.getElementById("button_clear_form_edit_product_location"),C=document.getElementById("button_submit_form_edit_product_location"),k=document.getElementById("button_close_edit_product_location_form"),B=document.getElementById("product_location_search"),x=document.getElementById("card_product_edit_location");let M,S,N={},D=!1,L=!1,P="medium",T=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$('a[data-toggle="tab"]').on("hide.bs.tab",function(e){H()});const R=function(){l.value="",n.value="",u.value="",r.value="",s.value="",c.value="",$(o).val("").trigger("change")},q=function(e){R();let t={},a={},i={},d={};if(e){B.value=e.display_medium?e.display_medium:"",u.value=e.name,$(l).val(e.id).trigger("change"),r.value=e.street_1,s.value=e.street_2,c.value=e.zipcode;let _="";e.type&&(_=(d=e.type).id),$(n).val(_),e.country&&(t=e.country,Country.id=t.id?t.id.toString():null),e.province&&(a=e.province,Province.id=a.id?a.id.toString():null),e.city&&(i=e.city,City.id=i.id?i.id:null),$(o).val(t.id?t.id:"").trigger("change")}},O=function(e){R(),$(x).hide()},Q=function(e){R(),q(e),$(x).show()};$(C).on("click",function(){Q()}),$(w).on("click",function(){Location.detail&&Q(Location.detail)}),$(C).on("click",function(){}),$(E).on("click",function(){O()}),$(k).on("click",function(){O()}),$(B).on("click",function(){$(this).select()}).on("change",function(){L=!1,setTimeout(function(){B.value},200)}).on("search",function(){L=!1}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/locations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{default_display:P},onSelect:function(e){e&&e.data&&(L=!0)},onSearchComplete:function(e,t){}}),$(y).on("click",function(){G(),z(N),a.value=N.display_medium,$(l).val(N.id).trigger("change"),H()}),$(m).on("click",function(){G(),z()}),$(p).on("click",function(){Z()}),$(f).on("click",function(){l.value,j()}),$("input[name='location_display']").on("change",function(){let e=$("input[name='location_display']:checked").val();P=e,A(),null!==Location.detail["display_"+e]&&(a.value=Location.detail["display_"+e])}),$(u).on("change",function(){setTimeout(function(){let e=u.value;F(e)},200)}),$(l).on("change",function(){$(v).val($(l).val())});const A=function(){$(a).on("click",function(){$(this).select()}).on("change",function(){setTimeout(function(){let e=a.value;!1===L&&(""===a.value?(a.value="",$(l).val("").trigger("change"),G()):U(e))},200)}).on("search",function(){L=!1,$(l).val("").trigger("change"),a.value="",D=!0,J(),G(),z()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/locations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{default_display:P},onSelect:function(t){if(t&&t.data&&t.data.country&&t.data.province&&t.data.city){L=!0,G();let e=t.data;Location.detail=e,N=e,z(e)}e&&clearValidation(e)},onSearchComplete:function(e,t){}})},Y=function(e){toastr.error(e)},F=function(e){if(e&&""!==e){V({name:e,default_display:P},function(t){if(t&&t[0])if(confirm(`Location: ${e} all ready exists. Would you like to use it?`)){let e=t[0];G(),z(e)}else G(),z()})}},U=function(e){if(e&&""!==e){V({name:e,default_display:P},function(t){if(t&&t[0]){let e=t[0];L=!0,G(),z(e)}else L=!1,confirmDialog(`Location: ${e} does not exist. Would you like to create it?`,t=>{t?W(e):(G(),z(N),H())})})}},W=function(e){!1===L&&e&&(G(),z(),j(),u.value=e,u.disabled=!0)},V=function(e,t){if(!e)return Y("Error Loading Location- Missing Data");try{sendGetRequest("/api/v1.0/locations/validate",e,function(e,n,a){return e?t(e):Y("Oops: 1")})}catch(e){return Y("Error Validating Location")}},j=function(){!function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!0}),a.disabled=!0,f.disabled=!0}(),$(t).show()},H=function(){if(!t)return;let e=J(N);z(e),function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!1}),a.disabled=!1,f.disabled=!1}(),$(t).hide()},G=function(){u.disabled=!1,u.value="",a.value="",$(l).val("").trigger("change"),n.value="",r.value="",s.value="",c.value="",$(o).val("").trigger("change"),document.getElementById("location_display_medium").checked=!0},z=function(e){let t={},i={},d={},m={};if(e){a.value=e.display_medium?e.display_medium:"",_.checked=1===e.enabled,u.value=e.name,$(l).val(e.id).trigger("change"),r.value=e.street_1,s.value=e.street_2,c.value=e.zipcode;let p="";e.type&&(p=(m=e.type).id),$(n).val(p),e.country&&(t=e.country,Country.id=t.id?t.id.toString():null),e.province&&(i=e.province,Province.id=i.id?i.id.toString():null),e.city&&(d=e.city,City.id=d.id?d.id.toString():null),$(o).val(t.id?t.id:"").trigger("change")}},J=function(e){let t={id:null,display_long:null,display_medium:null,display_short:null,location_types_id:null,name:null,street_1:null,street_2:null,zipcode:null,enabled:1,date_created:formatDateMySQL(),created_by:T,date_modified:formatDateMySQL(),modified_by:T,note:null,city:{id:null,name:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:T,date_modified:formatDateMySQL(),modified_by:T,note:null},province:{created_by:T,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,iso2:null,iso3:null,modified_by:T,name:null,name_long:null,note:null,sort_order:999},country:{created_by:T,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),currency_id:null,enabled:1,id:null,iso2:null,iso3:null,modified_by:T,name:null,name_long:null,note:null,sort_order:999},type:{created_by:T,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,icon:null,id:null,modified_by:T,name:null,note:null,sort_order:999}};N=t;let n={},a={},i={},o={};return e?(e.country&&(n=e.country),e.province&&(a=e.province),e.city&&(i=e.city),e.type&&(o=e.type)):e={},t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.zipcode=e.zipcode?e.zipcode:null,t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:T,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:T,t.note=e.note?e.note:null,t.country={created_by:n.created_by?n.created_by:T,date_created:n.date_created?n.date_created:formatDateMySQL(),date_modified:n.date_modified?n.date_modified:formatDateMySQL(),currency_id:n.currency_id?n.currency_id:null,enabled:n.enabled?n.enabled:1,id:n.id?n.id:null,iso2:n.iso2?n.iso2:null,iso3:n.iso3?n.iso3:null,modified_by:n.modified_by?n.modified_by:T,name:n.name?n.name:null,name_long:n.name_long?n.name_long:null,note:n.note?n.note:null,sort_order:n.sort_order?n.sort_order:999},t.province={created_by:a.created_by?a.created_by:T,date_created:a.date_created?a.date_created:formatDateMySQL(),date_modified:a.date_modified?a.date_modified:formatDateMySQL(),enabled:a.enabled?a.enabled:1,id:a.id?a.id:null,iso2:a.iso2?a.iso2:null,iso3:a.iso3?a.iso3:null,modified_by:a.modified_by?a.modified_by:T,name:a.name?a.name:null,name_long:a.name_long?a.name_long:null,note:a.note?a.note:null,sort_order:a.sort_order?a.sort_order:999},t.city={created_by:i.created_by?i.created_by:T,date_created:i.date_created?i.date_created:formatDateMySQL(),date_modified:i.date_modified?i.date_modified:formatDateMySQL(),enabled:i.enabled?i.enabled:1,id:i.id?i.id:null,modified_by:i.modified_by?i.modified_by:T,name:i.name?i.name:null,note:i.note?i.note:null,sort_order:i.sort_order?i.sort_order:999},t.type={created_by:o.created_by?o.created_by:T,date_created:o.date_created?o.date_created:formatDateMySQL(),date_modified:o.date_modified?o.date_modified:formatDateMySQL(),enabled:o.enabled?o.enabled:1,icon:o.icon?o.icon:null,id:o.id?o.id:null,modified_by:o.modified_by?o.modified_by:T,name:o.name?o.name:null,note:o.note?o.note:null,sort_order:o.sort_order?o.sort_order:999},Province.set_detail(t.province),Country.set_detail(t.country),City.set_detail(t.city),Location.detail=t,t},K=function(t){let n={};t&&(n=function(e){return J(e)}(t),N=n),e&&(validator_init(h),M=$(e).validate(),validator_init(b),S=$(g).validate(),$(o).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(d).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(i).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),G(),z(n),H()),I&&($(o).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(d).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(i).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),Location.detail=n,q(n)),a&&A()},Z=function(){$(e).valid()&&confirmDialog("Would you like to update?",e=>{e&&function(e,t){e&&sendPostRequest("/api/v1.0/locations/update",e,function(e,n,a){return e?t(e):Y("Oops: 1")})}(X(),function(e){let t;if(e&&e[0]){let n="medium";t=e[0],N=t;let i=document.getElementsByName("location_display");for(let e=0;e<i.length;e++)i[e].checked&&(n=i[e].value);l.value=t.id,a.value=t["display_"+n],H()}})})},X=function(){return remove_nulls({id:isNaN(parseInt(l.value))?null:parseInt(l.value),city_id:isNaN(parseInt(i.value))?null:parseInt(i.value),province_id:isNaN(parseInt(d.value))?null:parseInt(d.value),country_id:isNaN(parseInt(d.value))?null:parseInt(o.value),location_types_id:isNaN(parseInt(n.value))?null:parseInt(n.value),name:u&&""!==u.value?u.value:null,street_1:r&&""!==r.value?r.value:null,street_2:s&&""!==s.value?s.value:null,zipcode:c&&""!==c.value?c.value:null,enabled:1,note:null})};return{validator:null,detail:{},all:new Map,types:new Map,get:function(e){},load_all:function(e){load_all(e)},save:function(e){Z(e)},init:function(e){K(e)},populate_form:function(e){z(e)},set_detail:function(e){J(e)},build:function(){if($(g).valid())return X()}}}(),Variant=function(){"use strict";const e=document.getElementById("button_remove_variant_from_product"),t=document.getElementById("product_edit_variant_section"),n=document.getElementById("panel_tab_variant"),a=document.getElementById("category_id"),i=document.getElementById("product_id"),o=document.getElementById("product_edit_variant_form_variant_name_filter"),d=document.getElementById("table_variant_product_edit"),l=document.getElementById("product_edit_variant_form"),r=document.getElementById("display_product_variant_name"),s=document.getElementById("product_edit_variant_form_variant_id"),c=document.getElementById("product_edit_variant_form_variant_name"),u=document.getElementById("product_edit_variant_form_variant_enabled"),_=document.getElementById("product_edit_variant_form_variant_code"),m=document.getElementById("product_edit_variant_form_variant_min_age"),p=document.getElementById("product_edit_variant_form_variant_max_age"),f=document.getElementById("product_edit_variant_form_submit_button"),y=document.getElementById("product_edit_variant_form_clear_button"),g=document.getElementById("product_edit_variant_form_close_button"),v=document.getElementById("product_edit_variant_form_variant_used_in_pricing"),b=document.getElementById("table_variant_product_edit_add_new_button");let h=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,I=$(d),w=!1,E={rules:{product_edit_variant_form_variant_name:{required:!0},product_edit_variant_form_variant_min_age:{number:!0,min:0},product_edit_variant_form_variant_max_age:{number:!0,min:1}},messages:{product_edit_variant_form_variant_name:{required:"Field Required"},product_edit_variant_form_variant_min_age:{number:"Field Invalid",min:"Field Invalid"},product_edit_variant_form_variant_max_age:{number:"Field Invalid",min:"Field Invalid"}}};$(e).on("click",function(){C()}),$(t).on("change",function(){B()}),$(b).on("click",function(){I.clearSelectedRows(),D()}),$(y).on("click",function(){S(),I.clearSelectedRows()}),$(g).on("click",function(){S(),I.clearSelectedRows()}),$(f).on("click",function(){q()}),$(n).on("hide.bs.tab",function(){S(),I.clearSelectedRows(),o.value="",o.disabled=!1});const C=function(){confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e={variant_id:parseInt(s.value),product_id:parseInt(i.value)};k(e,function(t){if(t){let t=Q(Variant.all.get(e.variant_id));Variant.all.delete(e.variant_id),I.deleteRow(t),I.clearSelectedRows(),o.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),B(),S(),toastr.success(`Variant: ${t.name} - has been updated`),YearCalendar.endLoading()}})}else S(),I.clearSelectedRows(),o.value="",o.disabled=!1})},k=function(e,t){if(e){let n="/api/v1.0/variants/remove";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e);x("Oops: 1")})}catch(e){console.log("error",e)}}},B=function(){if(0===Array.from(Variant.all.values()).length){$("<span/>",{class:"badge badge-danger  ml-2",text:"!",id:"variantNeedsAttention"});$(n).html('Variant<span id="variantNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>')}else $(n).html("Variant");Product.updateProgress()},x=function(e){toastr.error(e)},M=function(e){if(e&&""!==e){let t=remove_nulls({name:e,category_id:isNaN(parseInt(a.value))?null:parseInt(a.value)});!function(e,t){if(e)try{sendGetRequest("/api/v1.0/variants/validate",e,function(e,n,a){if(e)return t(e);x("Oops: 1")})}catch(e){console.log("error",e),x("Error Validating Variant")}else x("Error Loading Variant - Missing Data")}(t,function(n){let a=null;if(n&&n[0]&&(a=n,n[0]&&(a=n[0])),a){let e,t=Variant.all.get(parseInt(a.id));t?(e=Q(t),I.loadRow(e)):e=Q(a),D(e)}else confirmDialog(`The variant: ${e} does not exist exists. Would you like to create it?`,n=>{if(n){let n="/api/v1.0/variants/new";try{sendPostRequest(n,t,function(t,n,a){if(!t)return x("Oops: 1");{let n=t;t[0]&&(n=t[0]),console.log("variant",n);let a=Q(n);console.log("detail",a),I.clearSelectedRows(),w=!1,N(),c.value=e,r.innerText=e,D(a),T()}})}catch(e){console.log("error",e)}}})})}},S=function(){N(),R(),L()},N=function(){clearValidation(l),r.innerText="&nbsp;",s.value="",c.value="",u.checked=!0,_.value="",m.value=0,p.value="",v.checked=!0},D=function(e){N(),e&&(v.checked=1===e.used_in_pricing,r.innerText=e.name?e.name:"&nbsp;",s.value=isNaN(parseInt(e.id))?"":parseInt(e.id),c.value=e.name?e.name:"&nbsp;",u.checked=!(e.enabled&&0===e.enabled),_.value=e.name?e.name:"&nbsp;",m.value=isNaN(parseInt(e.min_age))?1:parseInt(e.min_age),p.value=isNaN(parseInt(e.max_age))?"":parseInt(e.max_age)),T(),P()},L=function(){B(),o.disabled=!1,o.value="",$(l).hide()},P=function(){o.disabled=!0,$(l).show()},T=function(){v.disabled=!1,s.disabled=!0,c.disabled=!0,u.disabled=!0,_.disabled=!0,m.disabled=!1,p.disabled=!1,f.disabled=!1},R=function(){v.disabled=!0,s.disabled=!0,c.disabled=!0,u.disabled=!0,_.disabled=!0,m.disabled=!0,p.disabled=!0,f.disabled=!0},q=function(){(function(){let e=$(l).valid(),t=isNaN(parseInt(m.value))?null:parseInt(m.value),n=isNaN(parseInt(p.value))?null:parseInt(p.value);return null!==t&&null!==n&&parseInt(n)<parseInt(t)&&(setError(p,"Age is greater than minimum"),e=!1),e})()&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){!function(e,t){if(e){let n="/api/v1.0/variants/update";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e);x("Oops: 1")})}catch(e){console.log("error",e)}}}(function(){let e={id:isNaN(parseInt(s.value))?null:parseInt(s.value),category_id:isNaN(parseInt(a.value))?null:parseInt(a.value),product_id:isNaN(parseInt(i.value))?null:parseInt(i.value),name:c&&""!==c.value?c.value:null,code:_&&""!==_.value?_.value:null,min_age:isNaN(parseInt(m.value))?null:parseInt(m.value),max_age:isNaN(parseInt(p.value))?null:parseInt(p.value),used_in_pricing:!0===v.checked?1:0};return remove_nulls(e)}(),function(e){if(e){let t=Q(e[0]?e[0]:e);Variant.all.get(t.id)?I.updateRow(t):I.insertRow(t),Variant.all.set(t.id,t),I.loadRow(t),I.jumpToRow(t),I.clearSelectedRows(),o.disabled=!1,o.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),B(),S(),toastr.success(`Variant: ${t.name} - has been updated`),YearCalendar.endLoading()}})}else S(),I.clearSelectedRows(),o.value="",o.disabled=!1})},O=function(e){let t=[];e&&e&&(t=e),d&&(I=$(d).table({table_type:"display_list",data:Variant.all,columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Code",targets:1,data:"code",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Min Age",targets:2,data:"min_age",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Max Age",targets:3,data:"max_age",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Variant.edit})),function(e){Variant.all=new Map,e&&$.each(e,function(e,t){let n=Q(t);Variant.all.set(n.id,n),I.insertRow(n)})}(t),o&&function(){let e=isNaN(parseInt(a.value))?null:parseInt(a.value);$(o).on("click",function(){$(this).select()}).on("search",function(){w=!1,S(),I.clearSelectedRows()}).on("change",function(){setTimeout(function(){let e=o.value;I.clearSelectedRows(),!1===w&&(""===e?(o.value="",w=!1,S()):M(e))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/variants",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:e},onSelect:function(e){if(I.clearSelectedRows(),!e||!e.data)return;let t,n=e.data,a=Variant.all.get(parseInt(n.id));a?(t=Q(a),I.loadRow(t)):(t=Q(n)).used_in_pricing=1,D(t)}})}(),l&&(validator_init(E),Variant.validator=$(l).validate(),S(),B())},Q=function(e){let t={id:null,category_id:null,name:null,min_age:null,max_age:null,enabled:1,date_created:formatDateMySQL(),created_by:h,date_modified:formatDateMySQL(),modified_by:h,used_in_pricing:1,note:null};return e&&(t.id=e.id?e.id:null,t.category_id=e.category_id?e.category_id:null,t.name=e.name?e.name:null,t.code=e.code?e.code:null,t.min_age=e.min_age?e.min_age.toString():null,t.max_age=e.max_age?e.max_age:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:h,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:h,t.used_in_pricing=1===e.used_in_pricing?1:0,t.note=e.note?e.note:null),Product.detail=t,t};return{validator:null,all:new Map,set:function(e){return Q(e)},edit:function(e){!function(e){if(e){let t=Q(e);D(t)}}(e)},init:function(e){O(e)}}}(),Unit=function(){"use strict";const e=document.getElementById("panel_tab_unit"),t=document.getElementById("button_remove_unit_from_product"),n=document.getElementById("category_id"),a=document.getElementById("product_id"),i=document.getElementById("product_edit_unit_form"),o=document.getElementById("product_edit_unit_form_submit_button"),d=document.getElementById("edit_product_unit"),l=document.getElementById("product_edit_unit_form_unit_name_filter"),r=document.getElementById("table_unit_product_edit"),s=document.getElementById("product_edit_unit_form_unit_id"),c=document.getElementById("product_edit_unit_form_unit_name"),u=document.getElementById("product_edit_unit_form_unit_room_code"),_=document.getElementById("product_edit_unit_form_unit_min_nights"),m=document.getElementById("product_edit_unit_form_unit_max_nights"),p=document.getElementById("product_edit_unit_form_unit_min_pax"),f=document.getElementById("product_edit_unit_form_unit_max_pax"),y=document.getElementById("product_edit_unit_form_unit_description_short"),g=document.getElementById("product_edit_unit_form_unit_description_long"),v=document.getElementById("product_edit_unit_form_unit_enabled"),b=(document.getElementById("calendar_loader"),document.getElementById("display_product_unit_name")),h=document.getElementById("product_edit_unit_form_clear_button"),I=document.getElementById("product_edit_unit_form_close_button"),w=document.getElementById("table_unit_product_edit_add_new_button");let E,C=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,k=$(r),B=!1,x={rules:{product_edit_unit_form_unit_min_nights:{required:!0,number:!0,min:1},product_edit_unit_form_unit_min_pax:{required:!0,number:!0,min:1},product_edit_unit_form_unit_max_pax:{required:!0,number:!0,min:1}},messages:{product_edit_unit_form_unit_min_nights:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"},product_edit_unit_form_unit_min_pax:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"},product_edit_unit_form_unit_max_pax:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"}}};$(t).on("click",function(){M()}),$(o).on("click",function(){T()}),$(h).on("click",function(){W(),k.clearSelectedRows(),l.value="",l.disabled=!1,c.disabled=!0}),$(I).on("click",function(){W(),k.clearSelectedRows(),l.value="",l.disabled=!1,c.disabled=!0}),$(w).on("click",function(){W(),k.clearSelectedRows(),Y(),l.value="",c.value="",l.disabled=!0,c.disabled=!1,F(),A()}),$(e).on("hide.bs.tab",function(){W(),k.clearSelectedRows(),l.value="",l.disabled=!1,c.disabled=!0});const M=function(){confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e={unit_id:parseInt(s.value),product_id:parseInt(a.value)};!function(e,t){if(e){let n="/api/v1.0/units/remove";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e);D("Oops: 1")})}catch(e){console.log("error",e)}}}(e,function(t){let n=e.unit_id;if(t){let e=Unit.all.get(n);e&&k.deleteRow(e),Unit.all.delete(n),k.clearSelectedRows(),l.value="",l.disabled=!1,PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),S(),Q(),U(),toastr.success(`Unit: ${e.name} - has been removed`),YearCalendar.endLoading()}})}})},S=function(){0===Array.from(Unit.all.values()).length?$(e).html('Unit <span id="unitNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>'):$(e).html("Unit"),Product.updateProgress()},N=function(e){if(e&&""!==e){L({name:e},function(t){let a=null;if(t&&t[0]&&(a=t,t[0]&&(a=t[0])),a){let e,t=Unit.all.get(parseInt(a.id));t?(e=P(t),k.loadRow(e)):e=P(a),V(e)}else confirmDialog(`The unit: ${e} does not exist exists. Would you like to create it?`,t=>{if(t){let t=isNaN(parseInt(n.value))?null:parseInt(n.value),a=removeNulls({category_id:t,name:e||null});try{sendPostRequest("/api/v1.0/units/new",a,function(e,t,n){if(e){let t=e;e[0]&&(t=e[0]);let n=P(t);console.log("detail",n),k.clearSelectedRows(),B=!1,Q(),V(n),F()}})}catch(e){console.log("error",e)}}else W(),k.clearSelectedRows(),l.value="",l.disabled=!1,c.disabled=!0})})}},D=function(e){toastr.error(e)},L=function(e,t){if(e)try{sendGetRequest("/api/v1.0/units/validate",e,function(e,n,a){if(e)return t(e);D("Oops: 1")})}catch(e){console.log("error",e),D("Error Validating Unit")}else D("Error Loading Unit - Missing Data")},P=function(e){let t={api_id:null,blurb:null,category_id:1,cover_image:"/public/img/unit_cover_placeholder.jpg",created_by:C,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),description_long:null,description_short:null,enabled:1,end_time:null,id:null,max_nights:null,max_pax:null,meeting_point:null,min_nights:1,min_pax:1,modified_by:C,name:null,note:null,room_code:null,start_time:null,time_notes:null};return e&&(t.api_id=e.api_id?e.api_id:null,t.blurb=e.blurb?e.blurb:null,t.category_id=e.category_id?e.category_id:null,t.cover_image=e.cover_image?e.cover_image:"/public/img/unit_cover_placeholder.jpg",t.created_by=e.created_by?e.created_by:C,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.description_long=e.description_long?e.description_long:null,t.description_short=e.description_short?e.description_short:null,t.enabled=e.enabled?e.enabled:1,t.end_time=e.end_time?e.end_time:null,t.id=e.id?e.id:null,t.max_nights=e.max_nights?e.max_nights:null,t.max_pax=e.max_pax?e.max_pax:null,t.meeting_point=e.meeting_point?e.meeting_point:null,t.min_nights=e.min_nights?e.min_nights:1,t.min_pax=e.min_pax?e.min_pax:1,t.modified_by=e.modified_by?e.modified_by:C,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.room_code=e.room_code?e.room_code:null,t.start_time=e.start_time?e.start_time:null,t.time_notes=e.time_notes?e.time_notes:null),t},T=function(){R()&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e=q();O(e,function(e){if(e){let t=P(e[0]?e[0]:e);Unit.all.get(t.id)?k.updateRow(t):k.insertRow(t),Unit.all.set(t.id,t),k.loadRow(t),k.jumpToRow(t),k.clearSelectedRows(),l.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),S(),Q(),U(),toastr.success(`Unit: ${t.name} - has been updated`),YearCalendar.endLoading()}})}})},R=function(){let e=$(i).valid(),t=isNaN(parseInt(p.value))?null:parseInt(p.value),n=isNaN(parseInt(f.value))?null:parseInt(f.value),a=isNaN(parseInt(_.value))?null:parseInt(_.value),o=isNaN(parseInt(m.value))?null:parseInt(m.value);return null!==t&&null!==n&&(parseInt(n)<parseInt(t)?(setError(f,"Pax is greater than minimum"),e=!1):clearError(f)),null!==a&&null!==o&&(parseInt(o)<parseInt(a)?(setError(m,"Pax is greater than minimum"),e=!1):clearError(m)),e},q=function(){let e={id:isNaN(parseInt(s.value))?null:parseInt(s.value),product_id:isNaN(parseInt(a.value))?null:parseInt(a.value),category_id:isNaN(parseInt(n.value))?null:parseInt(n.value),min_pax:parseInt(p.value)?parseInt(p.value):null,max_pax:parseInt(f.value)?parseInt(f.value):null,min_nights:parseInt(_.value)?parseInt(_.value):null,max_nights:parseInt(m.value)?parseInt(m.value):null,api_id:null,name:c.value?c.value:null,room_code:u.value?u.value:null,blurb:null,cover_image:"",meeting_point:null,time_notes:null,start_time:null,end_time:null,description_short:y.value?y.value:null,description_long:g.value?g.value:null,enabled:!0===v.checked?1:0};return remove_nulls(e)},O=function(e,t){if(e){let n="/api/v1.0/units/update";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){console.log("error",e)}}},Q=function(){s.value="",c.value="",u.value="",_.value=1,m.value="",p.value=1,f.value="",y.value="",g.value="",v.checked=!0},A=function(){d&&($(d).show(),l.disabled=!0)},Y=function(){s.disabled=!0,u.disabled=!0,_.disabled=!0,p.disabled=!0,c.disabled=!1,m.disabled=!1,f.disabled=!1,y.disabled=!1,g.disabled=!1,v.disabled=!1},F=function(){Y(),s.disabled=!0,c.disabled=!0,u.disabled=!0,v.disabled=!0,y.disabled=!1,g.disabled=!1},U=function(){d&&($(d).hide(),l.disabled=!1,S())},W=function(){let e,t,a,i,o,d,l,r,s,c,y,g,v,b,h=isNaN(parseInt(n.value))?null:parseInt(n.value);switch(Q(),U(),h){case 1:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Nights:",i="Maximum Nights:",v="Room Code:",o=!1,d=!1,l=!1,r=!1,b=!1,s=1,c="",y=1,g="";break;case 2:case 4:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Days:",i="Maximum Days:",v="Seat Code:",s=1,c=1,y=1,g=1;break;default:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Nights:",i="Maximum Nights:",o=!1,d=!1,l=!1,r=!1,s=1,c="",y=1,g=""}let I=document.getElementsByTagName("LABEL");for(let e=0;e<I.length;e++)if(""!==I[e].htmlFor){let t=document.getElementById(I[e].htmlFor);t&&(t.label=I[e])}_.value=y,m.value=g,p.value=s,f.value=c,_.label.innerHTML=a,m.label.innerHTML=i,p.label.innerHTML=e,f.label.innerHTML=t,u.label.innerHTML=v,_.disabled=l,m.disabled=r,p.disabled=o,f.disabled=d},V=function(e){if(W(),e){let t=isNaN(parseInt(n.value))?null:parseInt(n.value);2===t||4===t?(_.value=e.min_nights?e.min_nights:1,m.value=e.max_nights?e.max_nights:1,p.value=e.min_pax?e.min_pax:1,f.value=e.max_pax?e.max_pax:1,_.disabled=!0,m.disabled=!0,p.disabled=!0,f.disabled=!0,u.disabled=!0):(_.value=e.min_nights?e.min_nights:1,m.value=e.max_nights?e.max_nights:null,p.value=e.min_pax?e.min_pax:1,f.value=e.max_pax?e.max_pax:null,_.disabled=!1,m.disabled=!1,p.disabled=!1,f.disabled=!1,u.disabled=!1),l.value=e.name?e.name:"",s.value=e.id?e.id:"",c.value=e.name?e.name:"",u.value=e.room_code?e.room_code:"",y.value=e.description_short?e.description_short:"",g.value=e.description_long?e.description_long:"",v.checked=!0,b.innerText=e.name?e.name:""}A()},j=function(e){let t=[];e&&(t=e,e.units&&(t=e.units)),i&&(E=isNaN(parseInt(n.value))?null:parseInt(n.value),$(l).on("click",function(){$(this).select()}).on("search",function(){B=!1,Q(),U()}).on("change",function(){setTimeout(function(){let e=l.value;!1===B&&(""===e?(B=!1,Q(),U()):N(e))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/units",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:E},onSelect:function(e){if(k.clearSelectedRows(),!e||!e.data)return;let t,n=e.data,a=Unit.all.get(parseInt(n.id));a?(t=P(a),k.loadRow(t)):t=P(n),V(t)}}),validator_init(x),Unit.validator=$(i).validate()),l&&(1===(E=isNaN(parseInt(n.value))?null:parseInt(n.value))?(Unit.byValue="Night",Unit.paxValue="Pax"):(Unit.byValue="Day",Unit.paxValue="Pax"),k=$(r).table({table_type:"display_list",data:[],columnDefs:[{title:"Room Code",targets:0,data:"room_code",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Min "+Unit.byValue+"(s)",targets:2,data:"min_nights",render:function(e,t,n,a){let i=1;return"<span style='white-space: nowrap;'>"+(i=null===e?"null":e)+"</span>"}},{title:"Max "+Unit.byValue+"(s)",targets:3,data:"max_nights",render:function(e,t,n,a){let i=1;return"<span style='white-space: nowrap;'>"+(i=null===e?"&infin;":e)+"</span>"}},{title:"Min "+Unit.paxValue,targets:4,data:"min_pax",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Max "+Unit.paxValue,targets:5,data:"max_pax",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Unit.edit}),function(e){Unit.all=new Map,e||(e=[]),$.each(e,function(e,t){let n=P(t);Unit.all.set(n.id,n),k.insertRow(n)}),S()}(t)),d&&(W(),S())};return{all:new Map,byValue:"Night",paxValue:"Pax",validator:null,edit:function(e){!function(e){V(e),F()}(e)},init:function(e){j(e)}}}(),Address=function(){"use strict";const e=document.getElementById("button_add_address_table"),t=document.getElementById("button_close_edit_address_form"),n=document.getElementById("button_clear_form_edit_address"),a=document.getElementById("button_submit_form_edit_address"),i=document.getElementById("form_edit_address"),o=document.getElementById("card_edit_address_form"),d=document.getElementById("table_address"),l=document.getElementById("address_id"),r=document.getElementById("company_id"),s=document.getElementById("address_enabled"),c=document.getElementById("address_street_1"),u=document.getElementById("address_street_2"),_=document.getElementById("address_street_3"),m=document.getElementById("address_country_id"),p=document.getElementById("address_types_id"),f=document.getElementById("address_province_id"),y=document.getElementById("address_city_id"),g=document.getElementById("address_postal_code"),v=document.getElementById("address_company_id"),b=document.getElementById("clear_address_table");let h,I=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,w=$(d),E={},C={groups:{cityGroup:"address_country_id address_province_id address_city_id"},rules:{address_types_id:{required:!0},address_company_id:{required:!0},address_country_id:{required:!0},address_province_id:{required:!0},address_city_id:{required:!0}},messages:{address_company_id:{required:"Field Required"},address_types_id:{required:"Field Required"},address_country_id:{required:"Field Required"},address_province_id:{required:"Field Required"},address_city_id:{required:"Field Required"}}};$(e).on("click",function(){w.clearSelectedRows(),N(),L()}),$(n).on("click",function(){w.clearSelectedRows(),N()}),$(a).on("click",function(){let e=B();e&&confirmDialog("Would you like to update?",t=>{t&&k(e)})}),$(t).on("click",function(){w.clearSelectedRows(),N(),D()}),$(b).on("click",function(){Address.clearTable()});const k=function(e){e&&x(e,function(e){if(e&&e[0]){let t=e[0],n=R(t);Address.all.get(n.id)?w.updateRow(n):w.insertRow(n),Address.all.set(n.id,n),w.clearSelectedRows(),N(),D(),toastr.success("Address Updated")}})},B=function(){if(M()){let e={company_id:isNaN(parseInt(v.value))?null:parseInt(v.value),street_1:""!==c.value?c.value:null,street_2:""!==u.value?u.value:null,street_3:""!==_.value?_.value:null,postal_code:""!==g.value?g.value:null,country_id:isNaN(m.value)?null:parseInt(m.value),province_id:isNaN(f.value)?null:parseInt(f.value),city_id:isNaN(y.value)?null:parseInt(y.value),address_types_id:toNumbers(getListOfIds($(p).val())),enabled:!0===s.checked?1:0,id:isNaN(parseInt(l.value))?null:parseInt(l.value)};return remove_nulls(e)}},x=function(e,t){e&&sendPostRequest("/api/v1.0/addresses/update",e,function(e,n,a){return e?t(e):S("Oops: 1")})},M=function(){return $(i).valid()},S=function(e){toastr.error(e)},N=function(){l.value="",s.checked=!0,c.value="",u.value="",_.value="",g.value="",$(p).val([]),$(m).val("").trigger("change")},D=function(){o&&$(o).hide()},L=function(e){o&&(l.value="",v.value=r.value,$(p).val([]),s.checked=!0,c.value="",u.value="",_.value="",m.value="",f.value="",y.value="",g.value="",function(e){e&&(l.value=e.id?e.id:null,v.value=e.company_id?e.company_id:null,$(p).val(e.address_types_id?e.address_types_id:[]),s.checked=1===e.enabled,c.value=e.street_1?e.street_1:null,u.value=e.street_2?e.street_2:null,_.value=e.street_3?e.street_3:null,g.value=e.postal_code?e.postal_code:null,Province.id=e.province.id,Country.id=e.country.id,City.id=e.city.id,$(m).val(e.country.id?e.country.id:"").trigger("change"))}(e),$(o).show())},P=function(e){if(Address.all=new Map,!e)return;let t,n=0;$.each(e,function(e,a){let i=R(a);0===n&&(t=i),Address.all.set(i.id,i),w.insertRow(i),n++}),d&&(t&&w.loadRow(t),w.clearSelectedRows()),o&&(N(),D())},T=function(e){d&&($.fn.DataTable.isDataTable(d)||(w=$(d).table({table_type:"display_list",data:Array.from(Address.all.values()),columnDefs:[{title:"ID",targets:0,data:"id",render:function(e,t,n,a){return e}},{title:"Address",targets:1,data:"medium_address_formatted",render:function(e,t,n,a){return e}},{title:"Types",targets:2,data:"formatted_types",render:function(e,t,n,a){return e}}],rowClick:Address.navigate}))),e&&P(e),i&&(validator_init(C),h=$(i).validate(),$(m).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(f).BuildDropDown({data:[],title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(y).BuildDropDown({data:[],title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["address_country_id"]}),Province.init({dropdowns:["address_province_id"]}),City.init({dropdowns:["address_city_id"]}))},R=function(e){let t={id:null,company_id:null,street_1:null,street_2:null,street_3:null,postal_code:null,enabled:1,address_types_id:[],date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null,short_address_formatted:null,medium_address_formatted:null,long_address_formatted:null,country:{id:null,name:null,iso2:null,iso3:null,currency_id:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},province:{id:null,country_id:null,name:null,iso2:null,iso3:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},city:{id:null,province_id:null,name:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},formatted_types:""};return e&&(t.country={id:parseInt(e.country.id?e.country.id:null),name:e.country.name?e.country.name:null,name_long:e.country.name_long?e.country.name_long:null,currency_id:parseInt(e.country.currency_id?e.country.currency_id:null),iso2:e.country.iso2?e.country.iso2:null,iso3:e.country.iso3?e.country.iso3:null,sort_order:parseInt(e.country.sort_order?e.country.sort_order:999),enabled:parseInt(e.country.enabled?e.country.enabled:1),date_created:e.country.date_created?e.country.date_created:formatDateMySQL(),created_by:parseInt(e.country.created_by?e.country.created_by:I),date_modified:e.country.date_modified?e.country.date_modified:formatDateMySQL(),modified_by:parseInt(e.country.modified_by?e.country.modified_by:I),note:e.country.note?e.country.note:null},t.province={id:parseInt(e.province.id?e.province.id:null),country_id:parseInt(e.country.id?e.country.id:null),name:e.province.name?e.province.name:null,iso2:e.province.iso2?e.province.iso2:null,iso3:e.province.iso3?e.province.iso3:null,sort_order:parseInt(e.province.sort_order?e.province.sort_order:999),enabled:parseInt(e.province.enabled?e.province.enabled:1),date_created:e.province.date_created?e.province.date_created:formatDateMySQL(),created_by:parseInt(e.province.created_by?e.province.created_by:I),date_modified:e.province.date_modified?e.province.date_modified:formatDateMySQL(),modified_by:parseInt(e.province.modified_by?e.province.modified_by:I),note:e.province.note?e.province.note:null},t.city={id:parseInt(e.city.id?e.city.id:null),province_id:parseInt(e.province.id?e.province.id:null),name:e.city.name?e.city.name:null,sort_order:parseInt(e.city.sort_order?e.city.sort_order:999),enabled:parseInt(e.city.enabled?e.city.enabled:1),date_created:e.city.date_created?e.city.date_created:formatDateMySQL(),created_by:parseInt(e.city.created_by?e.city.created_by:I),date_modified:e.city.date_modified?e.city.date_modified:formatDateMySQL(),modified_by:parseInt(e.city.modified_by?e.city.modified_by:I),note:e.city.note?e.city.note:null},t.id=parseInt(e.id?e.id:null),t.company_id=parseInt(e.company_id?e.company_id:null),t.address_types_id=getListOfIds(e.address_types_id),t.short_address_formatted=e.short_address_formatted?e.short_address_formatted:null,t.medium_address_formatted=e.medium_address_formatted?e.medium_address_formatted:null,t.long_address_formatted=e.long_address_formatted?e.long_address_formatted:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.street_3=e.street_3?e.street_3:null,t.postal_code=e.postal_code?e.postal_code:null,t.enabled=parseInt(e.enabled?e.enabled:1),t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=parseInt(e.created_by?e.created_by:I),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=parseInt(e.modified_by?e.modified_by:I),t.note=e.note?e.note:null,t.formatted_types=e.formatted_types?e.formatted_types:""),E=t,Address.detail=t,t},q=function(){let e=Array.from(Address.all.values());$.each(e,function(e,t){w.deleteRow(t)}),Address.all=new Map},O=function(e){e&&function(e,t){if(!e)return S("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/addresses",e,function(e,n,a){return e?t(e):S("Oops: 1")})}catch(e){return console.log("error",e),S("Error Validating Company")}}({company_id:e},function(e){if(e){let t=e;q(),function(e){if(d){let t;Address.all=new Map;let n=0;$.each(e,function(e,a){0===n&&(t=a),a.address_types_id=getListOfIds(a.address_types_id),Address.all.set(a.id,a),w.insertRow(a),n++}),d&&(t&&w.loadRow(t),w.clearSelectedRows())}}(t)}})};return{validator:null,detail:{},all:new Map,get_by_company_id:function(e){O(e)},get:function(e){},navigate:function(e){!function(e){e&&L(e)}(e)},load_all:function(e){P(e)},save:function(e){k(e)},clearTable:function(){q()},init:function(e){T(e)}}}(),Register=function(){"use strict";return{init:function(e){}}}();$.fn.DisabledDOW=function(e){"use strict";let t=this.attr("id"),n="Disabled DOW",a=t+"_";e&&(e.name&&""!==e.name&&(a=e.name),e&&e.label&&""!==e.label&&(n=e.label));const i=document.getElementById(t),o=$(i);o.on("change",function(){});const d=function(){let e=Array.from(s.days_of_week.values()),t=document.createElement("div");return t.classList.add("col-12"),t.classList.add("col-md-10"),t.classList.add("px-1"),$.each(e,function(e,n){let a=function(){let e=document.createElement("div");return e.classList.add("custom-control"),e.classList.add("custom-checkbox"),e.classList.add("custom-control-inline"),e}(),i=function(e){let t=document.createElement("label");return t.classList.add("custom-control-label"),t.htmlFor=e.for,t.innerText=e.label,t}(n),o=function(e){let t=document.createElement("input");return t.type="checkbox",t.classList=e.class,t.id=e.for,t.name=e.for,t.value=e.value,t.addEventListener("click",e=>{let n=t.id?t.id:"";r(t,n)}),t}(n);a.appendChild(o),a.appendChild(i),t.appendChild(a)}),t},l=function(){$.each(Array.from(s.days_of_week.values()),function(e,t){document.getElementById(t.for).checked=!1}),$.each(s.disabled_dows,function(e,t){let n="number"==typeof t?t.toString():t,a=s.days_of_week.get(n);a&&a.for&&(document.getElementById(a.for).checked=!0)}),7===s.disabled_dows.length&&(document.getElementById(a+"dow_select_all").checked=!0)},r=function(e,t){let n,i;switch(t){case a+"dow_select_all":!0===e.checked?s.disabled_dows=[0,1,2,3,4,5,6]:s.disabled_dows=[],s.disabled_dows.sort();break;case a+"dow_select_sun":n=0,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_mon":n=1,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_tue":n=2,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_wed":n=3,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_thu":n=4,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_fri":n=5,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_sat":n=6,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort()}l()},s={days_of_week:[],disabled_dows:[],el:null,value:function(e){},els:[],init:function(e){!function(e){let t=[];if(e){if(e===[]||null===e||""===e)return s.disabled_dows=[],[];t="string"==typeof e?getListOfIds(e.replace(/\s/g,"")):e}s.disabled_dows=t,l()}(e)}};return function(){o.empty(),s.days_of_week=new Map,s.days_of_week.set("*",{label:"All",for:a+"dow_select_all",value:"*",class:"custom-control-input dow_select"}),s.days_of_week.set("0",{label:"Sun",for:a+"dow_select_sun",value:0,class:"custom-control-input dow_select"}),s.days_of_week.set("1",{label:"Mon",for:a+"dow_select_mon",value:1,class:"custom-control-input dow_select"}),s.days_of_week.set("2",{label:"Tue",for:a+"dow_select_tue",value:2,class:"custom-control-input dow_select"}),s.days_of_week.set("3",{label:"Wed",for:a+"dow_select_wed",value:3,class:"custom-control-input dow_select"}),s.days_of_week.set("4",{label:"Thu",for:a+"dow_select_thu",value:4,class:"custom-control-input dow_select"}),s.days_of_week.set("5",{label:"Fri",for:a+"dow_select_fri",value:5,class:"custom-control-input dow_select"}),s.days_of_week.set("6",{label:"Sat",for:a+"dow_select_sat",value:6,class:"custom-control-input dow_select"});let e=function(){let e=document.createElement("div");return e.classList="row",e}(),t=function(){let e=document.createElement("div"),t=document.createElement("label");return t.innerText=n+":",e.classList.add("col-12"),e.classList.add("col-md-2"),e.classList.add("px-1"),e.appendChild(t),e}(),l=d();e.appendChild(t),e.appendChild(l),i.appendChild(e)}(),s};const ColorScheme=function(){"use strict";document.getElementById("product_edit_season_id");const e=document.getElementById("season_id"),t=document.getElementById("edit_scheme"),n=(document.getElementById("form_edit_scheme"),document.getElementById("product_edit_season_id_name_display")),a=document.getElementById("button_close_edit_scheme");let i;$(a).on("click",function(){$(t).hide()}),$(e).on("click",function(){$(t).show()});const o=function(e){var t;e&&e.swatches&&(t=e.swatches,ColorScheme.all=new Map,t&&$.each(t,function(e,t){ColorScheme.all.set(parseInt(t.id),t)})),(i=document.querySelectorAll(".season_toggle_item")).forEach(e=>e.addEventListener("click",t=>{let n=parseInt(e.dataset.colorschemeid),a=ColorScheme.all.get(n);a&&d(a)}))},d=function(e){if(e){let t=e.background_color?e.background_color:null,a=e.border_color?e.border_color:null,i=parseInt(e.id),o=e.text_color?e.text_color:null,d=e.name?e.name:null,l=document.querySelector("#product_edit_season_id");$(n).text(`\n                    ${d}\n                `),$("a.dropdown-item.season_toggle_item").removeClass("active"),$(`a#${i}`).addClass("active"),l.style.setProperty("color",o,"important"),l.style.setProperty("background-color",t,"important"),l.style.setProperty("border-color",a,"important")}},l=function(){let e=document.querySelector("#product_edit_season_id");$(e).addClass("disabled")};return{all:new Map,disable:function(){l()},enable:function(){!function(){let e=document.querySelector("#product_edit_season_id");$(e).removeClass("disabled")}()},load:function(e){d(e)},edit:function(e){!function(e){$(".color_scheme_block").removeClass("active"),$(e).addClass("active")}(e)},change:function(e){!function(e){console.log("ColorScheme:change(el)",e)}(e)},init:function(e){o(e),l()}}}();$.fn.ColorScheme=function(e){console.log("Test",Types.color_scheme)};const AirportTypes=function(){"use strict";document.getElementById("input_airport_types_id"),document.getElementById("input_airport_types_name"),document.getElementById("input_airport_types_sort_order"),document.getElementById("input_airport_types_enabled"),document.getElementById("input_airport_types_date_created"),document.getElementById("input_airport_types_created_by"),document.getElementById("input_airport_types_date_modified"),document.getElementById("input_airport_types_modified_by"),document.getElementById("input_airport_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),AirportTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,AirportTypes.all=new Map,n&&($.each(n,function(e,n){let a=t(n);AirportTypes.all.set("id",a)}),console.log(" AirportTypes.all",AirportTypes.all))},save:function(e){},init:function(){console.log(" -- AirportTypes -- ",{})}}}(),Category=function(){"use strict";const e=document.getElementById("modal_product_category_id"),t=(document.getElementById("modal_new_product"),document.getElementById("modal_product_provider_company_id")),n=document.getElementById("modal_product_provider_location_id"),a=document.getElementById("modal_product_location_id"),i=document.getElementById("modal_product_vendor_company_id"),o=document.getElementById("modal_product_city");let d=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(e).on("change",function(){let e=$(this).val();y(e)});const l=document.getElementById("modal_product_name"),r=document.getElementById("modal_product_sku"),s=(document.getElementById("modal_product_provider_name"),document.getElementById("modal_product_vendor_name")),c=document.getElementById("modal_product_provider_id"),u=document.getElementById("modal_product_vendor_id"),_=document.getElementById("modal_product_rating_types_id"),m=document.getElementById("modal_product_currency_id"),p=document.getElementById("modal_product_pricing_strategies_types_id"),f=document.getElementById("modal_product_city_id"),y=function(e){if($("div[data-categoryid]").hide(),!e)return;e=parseInt(e),Product.resetNewProductDetails(),Product.initAutoComplete(e);let d=Types.category.get(e);if(d&&(Product.attr1=d.attribute_id,Product.attr2=null,Product.attr3=null,Product.updateProductSKU(),e&&!isNaN(parseInt(e))))switch(parseInt(e)){case 1:p.value="",s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!1,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='1']").show();break;case 2:p.value="2",s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!0,l.disabled=!1,m.disabled=!1,p.disabled=!0,r.disabled=!0,$("div[data-categoryid='2']").show();break;case 3:p.value="3",s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!0,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='3']").show();break;case 4:p.value="2",s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!0,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='4']").show();break;case 5:p.value="",s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!1,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='5']").show();break;case 6:s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!0,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='6']").show();break;case 7:s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!1,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='7']").show();break;case 8:s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!1,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='8']").show();break;case 9:s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",m.value="",o.disabled=!1,_.disabled=!1,l.disabled=!1,m.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='9']").show();break;default:s.value="",s.value="",f.value="",c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",_.value="",r.value="",o.disabled=!0,_.disabled=!0,l.disabled=!0,m.disabled=!0,p.disabled=!0,r.disabled=!0,r.disabled=!0,o.disabled=!0,_.disabled=!0,p.disabled=!0}},g=function(e){let t={category_id:1,name:null,last_update:null,id:null,pricing_strategy_types_id:null,color_scheme_id:null,icon:null,view_product_index:1,view_product_index_filter:1,view_product_index_search:1,view_product_edit:1,view_product_package_edit:1,view_product_package_index:1,all_day:1,overlap:1,editable:1,duration_editable:1,start_editable:1,display:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:d,date_modified:formatDateMySQL(),modified_by:d,note:null};return e&&(t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.last_update=e.last_update?e.last_update:null,t.id=e.id?e.id:null,t.pricing_strategy_types_id=e.pricing_strategy_types_id?e.pricing_strategy_types_id:null,t.color_scheme_id=e.color_scheme_id?e.color_scheme_id:null,t.name=e.name?e.name:null,t.icon=e.icon?e.icon:null,t.view_product_index=e.view_product_index?e.view_product_index:1,t.view_product_index_filter=e.view_product_index_filter?e.view_product_index_filter:1,t.view_product_index_search=e.view_product_index_search?e.view_product_index_search:1,t.view_product_edit=e.view_product_edit?e.view_product_edit:1,t.view_product_package_edit=e.view_product_package_edit?e.view_product_package_edit:1,t.view_product_package_index=e.view_product_package_index?e.view_product_package_index:1,t.all_day=e.all_day?e.all_day:1,t.overlap=e.overlap?e.overlap:1,t.editable=e.editable?e.editable:1,t.duration_editable=e.duration_editable?e.duration_editable:1,t.start_editable=e.start_editable?e.start_editable:1,t.display=e.display?e.display:null,t.sort_order=e.sort_order?e.sort_order:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:created_by,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:modified_by,t.note=e.note?e.note:null,t.seasons=e.seasons?e.seasons:[]),Category.detail=t,t},v=function(e){Category.all=new Map,e&&$.each(e,function(e,t){let n=g(t);Category.all.set(n.id,n)})};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){v(e)},save:function(e){},init:function(e){!function(e){let t=[];e&&e.categories&&(t=e.categories),v(t)}(e)}}}(),ContactTypes=function(){"use strict";document.getElementById("input_contact_types_id"),document.getElementById("input_contact_types_name"),document.getElementById("input_contact_types_sort_order"),document.getElementById("input_contact_types_enabled"),document.getElementById("input_contact_types_date_created"),document.getElementById("input_contact_types_created_by"),document.getElementById("input_contact_types_date_modified"),document.getElementById("input_contact_types_modified_by"),document.getElementById("input_contact_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),ContactTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,ContactTypes.all=new Map,n&&($.each(n,function(e,n){let a=t(n);ContactTypes.all.set("id",a)}),console.log(" ContactTypes.all",ContactTypes.all))},save:function(e){},init:function(){console.log(" -- ContactTypes -- ",{})}}}(),Company=function(){"use strict";const e=document.getElementById("button_save_provider"),t=document.getElementById("form_edit_company"),n=(document.getElementById("company_enabled"),document.getElementById("company_name")),a=document.getElementById("company_phone_1"),i=document.getElementById("company_phone_2"),o=document.getElementById("company_fax"),d=document.getElementById("company_email"),l=document.getElementById("company_website"),r=document.getElementById("button_submit_form_edit_company"),s=document.getElementById("company_cover_image"),c=document.getElementById("address_company_id"),u=document.getElementById("company_id"),_=document.getElementById("contact_company_id"),m=document.getElementById("form_edit_company_block"),p=document.getElementById("button_edit_company_name"),f=document.getElementById("button_cancel_edit_company_name"),y=document.getElementById("button_close_edit_company_form"),g=document.getElementById("form_edit_vendor"),v=document.getElementById("form_edit_provider"),b=document.getElementById("vendor_name"),h=document.getElementsByClassName("vendor_company_id"),I=document.getElementById("provider_name"),w=document.getElementById("provider_company_id"),E=document.getElementById("company_keywords"),C=(document.getElementById("company_logo"),document.getElementById("company_description_long")),k=document.getElementById("company_description_short"),B=document.getElementById("button_clear_form_edit_company"),x=(document.getElementById("company_edit_table_filters"),{rules:{company_name:{required:!0},company_phone_1:{},company_phone_2:{},company_fax:{},company_email:{email:!0},company_website:{url:!0}},messages:{company_name:{required:"Field Required1"},company_email:{email:"Field Invalid"},company_website:{url:"Field Invalid"}}});let M,S,N={},D=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,L=!1,P={};$('a[data-toggle="tab"]').on("hide.bs.tab",function(e){V()}),$(f).on("click",function(){let e=U(P);R(e),V()}),$(p).on("click",function(){P=O(),W()}),$(B).on("click",function(){F()}),$(y).on("click",function(){V()}),$(r).on("click",function(){let e=Company.build();e&&confirmDialog("Would you like to update?",t=>{t&&Y(e,function(e){if(e&&e[0]){let t=e[0],n=U(t);N=n,R(n),T(),V()}})})}),$(u).on("change",function(){c.value=u.value}),$(t).on("change",function(){j()});const T=function(){$(n).on("change",function(){setTimeout(function(){let e=n.value;!1===L&&(""===e?(n.value="",u.value="",L=!1):Q(e))},200)}).on("search",function(){Company.reset_form(!0),v&&Provider.reset_form(),g&&Vendor.reset_form()}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/companies",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;L=!0,R(t),I?$(I).val(t.name).trigger("change"):$(b).val(t.name),w&&$(w).val(t.id),Address.get_by_company_id(t.id),Contact.getByCompanyId(t.id)}})},R=function(e){$("#company_logo").dropify();let t=e.keywords?e.keywords:"";$(u).val(e.id?e.id:"").trigger("change"),n.value=e.name?e.name:"",a.value=e.phone_1?e.phone_1:"",i.value=e.phone_2?e.phone_2:"",o.value=e.fax?e.fax:"",d.value=e.email?e.email:"",l.value=e.website?e.website:"",C.value=e.description_long?e.description_long:"",k.value=e.description_short?e.description_short:"",M=$(E).BuildKeyword(t),I&&$(I).val(e.name?e.name:"").trigger("change"),b&&(b.value=e.name?e.name:null),w&&(w.value=e.id?e.id:null),h&&(h.value=e.id?e.id:null),_&&(_.value=e.id?e.id:null),c&&(c.value=e.id?e.id:null)},q=function(e){toastr.error(e)},O=function(){return remove_nulls({email:$(d).val(),enabled:1,fax:$(o).val(),id:isNaN(u.value)?null:parseInt(u.value),modified_by:D,cover_image:"/public/img/placeholder.jpg",description_short:k.value,description_long:C.value,keywords:M.build(),name:$(n).val(),note:null,phone_1:$(a).val(),phone_2:$(i).val(),status_id:10,website:$(l).val()})},Q=function(e){if(e&&""!==e){A({name:e},function(t){let a=null;t&&t[0]&&t[0]&&(a=t[0]),a?(F(!0),R(a),Address.get_by_company_id(a.id),Contact.getByCompanyId(a.id)):confirmDialog(`The company: ${e} does not exist exists. Would you like to create it?`,e=>{e&&Y({name:n.value,status_id:10,enabled:1},function(e){e&&e[0]&&(a=e[0],P=a,F(!0),R(a),W())})})})}},A=function(e,t){if(e)try{sendGetRequest("/api/v1.0/companies/validate",e,function(e,n,a){if(e)return t(e);q("Oops: 1")})}catch(e){console.log("error",e),q("Error Validating Company")}else q("Error Loading Company- Missing Data")},Y=function(e,t){console.log("add_to_company_list()");e&&sendPostRequest("/api/v1.0/companies/update",e,function(e,n,a){if(e)return t(e);q("Oops: 1")})},F=function(e){a.value="",i.value="",o.value="",d.value="",l.value="",e&&!0===e&&(I&&$(I).val("").trigger("change"),b&&$(b).val("").trigger("change"),$(u).val("").trigger("change"),n.value="",Address.clearTable(),Contact.clearTable())},U=function(e){let t={created_by:D,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),email:null,cover_image:"/public/img/placeholder.jpg",enabled:1,fax:null,id:null,modified_by:D,name:null,note:null,phone_1:null,phone_2:null,status_id:10,website:null,description_short:null,description_long:null,keywords:null,logo:null};return e&&(t.created_by=e.created_by?e.created_by:D,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.email=e.email?e.email:null,t.cover_image=e.cover_image?e.cover_image:null,t.enabled=e.enabled?e.enabled:1,t.fax=e.fax?e.fax:null,t.id=e.id?e.id:null,t.modified_by=e.modified_by?e.modified_by:D,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.phone_1=e.phone_1?e.phone_1:null,t.phone_2=e.phone_2?e.phone_2:null,t.status_id=e.status_id?e.status_id:10,t.website=e.website?e.website:null,t.logo=e.logo?e.logo:"",t.keywords=e.keywords?e.keywords:"",t.description_long=e.description_long?e.description_long:"",t.description_short=e.description_short?e.description_short:""),Company.detail=t,t},W=function(){N=Company.build(),m&&($(m).show(),$(f).show(),$(p).hide(),$(n).attr("readonly",!0)),e&&($(e).attr("readonly",!0),e.disabled=!0)},V=function(){if(m){U(N);$(n).attr("readonly",!1),$(m).hide(),$(f).hide(),$(p).show(),T()}e&&($(e).attr("readonly",!1),e.disabled=!1)},j=function(){isNaN(parseInt(u.value))?(p.disabled=!0,$(s).attr("readonly",!0),$(a).attr("readonly",!0),$(i).attr("readonly",!0),$(o).attr("readonly",!0),$(d).attr("readonly",!0)):($(a).attr("readonly",!1),$(i).attr("readonly",!1),$(o).attr("readonly",!1),$(d).attr("readonly",!1),$(s).attr("readonly",!1),p.disabled=!1)};return{all:new Map,build:function(){if($(t).valid())return O()},validator:null,detail:{created_by:D,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),email:null,enabled:1,fax:null,id:null,modified_by:D,name:null,note:null,phone_1:null,phone_2:null,status_id:10,website:null},add_to_company_list:function(e,t){return Y(e,t)},company_exists:function(e){Q(e)},populate_form:function(e){R(e)},reset_form:function(e){F(e)},init:function(e){!function(e){let n=[];if(e){let t=U(e);n=e.images?e.images:[],R(t)}t&&(validator_init(x),S=$(t).validate(),T(),m&&V()),$("#companyImages").imageManager({id:"company_image_manager",images:n})}(e)}}}(),Contact=function(){"use strict";const e=document.getElementById("clear_contact_table"),t=document.getElementById("button_add_contact_table"),n=document.getElementById("button_clear_form_edit_contact"),a=document.getElementById("button_close_edit_contact_form"),i=document.getElementById("button_submit_form_edit_contact"),o=document.getElementById("company_id"),d=document.getElementById("contact_company_id"),l=document.getElementById("contact_id"),r=document.getElementById("contact_name_first"),s=document.getElementById("contact_name_last"),c=document.getElementById("contact_phone"),u=document.getElementById("contact_email"),_=document.getElementById("contact_enabled"),m=document.getElementById("contact_types_id"),p=document.getElementById("card_edit_contact_form"),f=document.getElementById("form_edit_contact"),y=document.getElementById("table_contact");document.getElementById("contact_date_created"),document.getElementById("contact_created_by"),document.getElementById("contact_date_modified"),document.getElementById("contact_modified_by"),document.getElementById("contact_note");let g,v=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,b=$(y),h={rules:{contact_name_first:{required:!0},contact_name_last:{required:!0},contact_phone:{required:!0},contact_email:{required:!0},contact_types_id:{required:!0}},messages:{contact_name_first:{required:"Field Required"},contact_name_last:{required:"Field Required"},contact_phone:{required:"Field Required"},contact_email:{required:"Field Required"},contact_types_id:{required:"Field Required"}}};$(i).on("click",function(){I()&&confirmDialog("Would you like to update?",e=>{e&&w()})}),$(t).on("click",function(){b.clearSelectedRows(),k(),B()}),$(n).on("click",function(){b.clearSelectedRows(),k()}),$(a).on("click",function(){b.clearSelectedRows(),k(),x()}),$(e).on("click",function(){Contact.clearTable()});const I=function(){return $(f).valid()},w=function(){let e=function(){let e={name_first:r.value,name_last:s.value,email:u.value,phone:c.value,contact_types_id:toNumbers(getListOfIds($(m).val())),enabled:!0===_.checked?1:0,company_id:isNaN(d.value)?null:parseInt(d.value),id:isNaN(l.value)?null:parseInt(l.value)};return remove_nulls(e)}();e&&E(e,function(e){if(console.log(e),e&&e[0]){let t=e[0],n=M(t);Contact.all.get(n.id)?b.updateRow(n):b.insertRow(n),Contact.all.set(n.id,n),toastr.success("Contact Updated")}})},E=function(e,t){e&&sendPostRequest("/api/v1.0/contacts/update",e,function(e,n,a){return e?t(e):C("Oops: 1")})},C=function(e){toastr.error(e)},k=function(){p&&(l.value="",r.value="",s.value="",c.value="",u.value="",_.checked=!0,$(m).val([]))},B=function(){p&&$(p).show()},x=function(){p&&$(p).hide()},M=function(e){let t={id:null,company_id:null,name_first:null,name_last:null,formatted_types:"",formatted_names:"",phone:null,email:null,enabled:1,date_created:formatDateMySQL(),created_by:v,date_modified:formatDateMySQL(),modified_by:v,note:null};return e&&(t.id=e.id?e.id:null,t.company_id=e.company_id?e.company_id:null,t.name_first=e.name_first?e.name_first:null,t.name_last=e.name_last?e.name_last:null,t.formatted_types=e.formatted_types?e.formatted_types:"",t.formatted_names=e.formatted_names?e.formatted_names:"",t.contact_types_id=getListOfIds(e.contact_types_id),t.phone=e.phone?e.phone:null,t.email=e.email?e.email:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:created_by,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:modified_by,t.note=e.note?e.note:null),Contact.detail=t,t},S=function(e){Contact.all=new Map,e&&($.each(e,function(e,t){let n=M(t);Contact.all.set(n.id,n),b.insertRow(n)}),e[0]&&b.loadRow(e[0]))},N=function(e){e&&function(e){k(),d.value=o.value,e&&(console.log("contact",e),l.value=validInt(e.id),r.value=e.name_first?e.name_first:null,s.value=e.name_last?e.name_last:null,c.value=e.phone?e.phone:null,u.value=e.email?e.email:null,_.checked=!e.enabled||1===e.enabled,$(m).val(e.contact_types_id?e.contact_types_id:[])),B()}(e)},D=function(e){y&&y&&($.fn.DataTable.isDataTable(y)||(b=$(y).table({table_type:"display_list",data:Contact.all,columnDefs:[{title:"ID",targets:0,data:"id",render:function(e,t,n,a){return e}},{title:"Name",targets:1,data:"formatted_names",render:function(e,t,n,a){return e}},{title:"Types",targets:2,data:"formatted_types",render:function(e,t,n,a){return e}}],rowClick:Contact.navigate}))),e&&S(e),f&&(validator_init(h),g=$(f).validate()),x()},L=function(){let e=Array.from(Contact.all.values());$.each(e,function(e,t){b.deleteRow(t)}),Contact.all=new Map},P=function(e){e&&function(e,t){if(!e)return C("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/contacts",e,function(e,n,a){return e?t(e):C("Oops: 1")})}catch(e){return console.log("error",e),C("Error Validating Company")}}({company_id:e},function(e){if(e){let t=e;L(),function(e){if(y){let t;Contact.all=new Map;let n=0;$.each(e,function(e,a){0===n&&(t=a),a.contact_types_id=getListOfIds(a.contact_types_id),Contact.all.set(a.id,a),b.insertRow(a),n++}),y&&(t&&b.loadRow(t),b.clearSelectedRows())}}(t)}})};return{validator:null,detail:{},all:new Map,getByCompanyId:function(e){P(e)},clearTable:function(){L()},navigate:function(e){N(e)},load_all:function(e){S(e)},save:function(e){w(e)},init:function(e){D(e)}}}(),Currency=function(){"use strict";document.getElementById("input_currency_id"),document.getElementById("input_currency_sort_order"),document.getElementById("input_currency_name"),document.getElementById("input_currency_iso"),document.getElementById("input_currency_minor_unit"),document.getElementById("input_currency_symbol"),document.getElementById("input_currency_enabled"),document.getElementById("input_currency_date_created"),document.getElementById("input_currency_created_by"),document.getElementById("input_currency_date_modified"),document.getElementById("input_currency_modified_by"),document.getElementById("input_currency_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,sort_order:null,name:null,iso:null,minor_unit:null,symbol:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.sort_order=t.sort_order?t.sort_order:null,n.name=t.name?t.name:null,n.iso=t.iso?t.iso:null,n.minor_unit=t.minor_unit?t.minor_unit:null,n.symbol=t.symbol?t.symbol:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),Currency.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,Currency.all=new Map,n&&$.each(n,function(e,n){let a=t(n);Currency.all.set("id",a)})},save:function(e){},init:function(){}}}();Currency.init();const Vendor=function(){"use strict";const e=document.getElementById("panel_tab_contact"),t=document.getElementById("button_add_vendor_page_heading"),n=document.getElementById("vendor_index_table_add_button"),a=document.getElementById("vendor_company_id"),i=document.getElementById("form_edit_vendor"),o=document.getElementById("vendor_name"),d=document.getElementById("vendor_id"),l=document.getElementById("vendor_show_online"),r=document.getElementById("vendor_show_sales"),s=document.getElementById("vendor_show_ops"),c=document.getElementById("vendor_is_provider"),u=document.getElementById("vendor_sku"),_=document.getElementById("vendor_enabled"),m=document.getElementById("provider_edit"),p=(document.getElementById("provider_name"),document.getElementById("provider_company_id"),document.getElementById("company_id")),f=document.getElementById("button_submit_form_edit_vendor"),y=document.getElementById("table_vendor_index"),g=document.getElementById("form_vendor_add"),v=document.getElementById("modal_button_submit_add_vendor"),b=document.getElementById("modal_button_cancel_add_vendor"),h=document.getElementById("modal_new_vendor"),I=document.getElementById("vendor_modal_vendor_name"),w=document.getElementById("button_save_vendor"),E=document.getElementById("company_name"),C=document.getElementById("form_product_add"),k=document.getElementById("modal_product_vendor_id"),B=document.getElementById("modal_product_vendor_name"),x=document.getElementById("modal_product_provider_vendor_match"),M=document.getElementById("modal_product_provider_company_id"),S=document.getElementById("modal_product_vendor_company_id");let N,D,L=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,P=!1,T={rules:{vendor_name:{required:!0}},messages:{vendor_name:{required:"Field Required"}}},R={rules:{vendor_modal_vendor_name:{required:!0}},messages:{vendor_modal_vendor_name:{required:"Field Required"}}},q=$(y);$(w).on("click",function(){let e=Company.build();Console.log("_button_save_vendor",e),J()}),$(t).on("click",function(){A()}),$(n).on("click",function(){A()}),$(b).on("click",function(){Q()}),$(v).on("click",function(){if(Y()){let e={name:I.value};confirmDialog(`Vendor: ${name} will be added`,t=>{t&&F(e)})}}),$(I).on("change",function(){setTimeout(function(){let e=I.value;!1===P&&(""===e?(I.value="",P=!1):O(e))},200)}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;confirmDialog(`Vendor ${t.name} ALREADY exists. Would you like to load this record to edit?`,e=>{e?window.location.replace("/vendors/"+t.id):W()})}}),$(B).on("change",function(){setTimeout(function(){let e=B.value;P=!1,""===e?(k.value="",B.value="",S.value="",Product.attr3=null,Product.updateProductSKU(),P=!1):O(e)},200)}).on("search",function(){k.value="",B.value="",S.value="",x.checked=!1,Product.attr3=null,Product.updateProductSKU(),P=!1}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;Console.log("suggestion.data",e.data);e.data;if(C){let t=isNaN(parseInt(M.value))?null:parseInt(M.value);k.value=e.data.id,B.value=e.data.name,S.value=e.data.company_id,Product.attr3=e.data.sku,Product.updateProductSKU(),x.checked=parseInt(e.data.company_id)===t}P=!0}}),$(p).on("change",function(){$(a).val(p.value)}),$(f).on("click",function(){J()});const O=function(e){if(Console.log("vendor_exists()",e),e&&""!==e){let t={name:e};Console.log("dataToSend",t),j(t,function(e){let t;if(Console.log("fetch_vendor_by_name()",e),e&&e.length>0)t=e,e.length>0&&e[0]&&(t=e[0]);else{Console.log("Vendor Does Not Exist"),k.value="",S.value="",Product.attr3=null,Product.updateProductSKU();let e=B.value;""!==e&&confirmDialog(`Vendor ${e} does not exists. Would you like to create this`,e=>{if(e){let e={name:B.value};F(e)}else B.value=""})}t&&(Console.log("Vendor Exists",t),I&&confirmDialog(`Vendor ${t.name} ALREADY exists. Would you like to load this record to edit?`,e=>{e&&window.location.replace("/vendors/"+t.id)}),C&&(k.value=t.id?t.id:"",S.value=t.company_id?t.company_id:"",Product.attr3=t.sku?t.sku:null,Product.updateProductSKU()))})}},Q=function(){$(h).modal("hide")},A=function(){$(I).val(""),$(h).modal("show")},Y=function(){return!!g&&$(g).valid()},F=function(e){e&&U(e,function(t){if(t)if(Console.log("data 1",t),t[0]){Console.log("data[0] 1",t[0]);let e=t[0];e.id?(C&&(Console.log("_form_product_add: details",e),S.value=e.company_id?e.company_id:"",k.value=e.id?e.id:"",x.checked=S.value===M.value,Product.attr3=e.sku?e.sku:null,Product.updateProductSKU()),g&&window.location.replace("/vendors/"+e.id)):Console.log("details 1",e)}else Console.log("details 2",t);else Console.log("details 3",e)})},U=function(e,t){if(e)try{sendPostRequest("/api/v1.0/vendors/add",e,function(e,n,a){return e?t(e):V("Oops: 1")})}catch(e){Console.log("error",e)}},W=function(){I.value=""},V=function(e){toastr.error(e)},j=function(e,t){if(!e)return V("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/vendors/validate",e,function(e,n,a){return e?t(e):V("Oops: 1")})}catch(e){return Console.log("error",e),V("Error Validating Company")}},H=function(){return{id:null,name:null,company_id:null,status_id:1,show_online:1,show_sales:1,show_ops:1,is_provider:1,sku:null,enabled:1,date_created:formatDateMySQL(),created_by:L,date_modified:formatDateMySQL(),modified_by:L,note:null,company:{},addresses:[],contacts:[]}},G=function(e){let t=H();return t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.status_id=e.status_id?e.status_id:null,t.show_online=e.show_online,t.show_sales=e.show_sales,t.show_ops=e.show_ops,t.is_provider=e.is_provider,t.sku=e.sku?e.sku:null,t.enabled=e.enabled,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:created_by,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:modified_by,t.note=e.note?e.note:null,t.addresses=e.company.addresses?e.company.addresses:[],t.contacts=e.company.contacts?e.company.contacts:[],t.company=e.company?e.company:{},Vendor.detail=t,t},z=function(e,t){Console.log("updateVendor()",e);if(e)try{sendPostRequest("/api/v1.0/vendors/update",e,function(e,n,a){return Console.log("data",e),e?t(e):V("Oops: 1")})}catch(e){Console.log("error",e)}},J=function(){let e=Vendor.build();e.company_detail=Company.build(),e&&confirmDialog("Would you like to update?",t=>{t&&(Console.log("vendor_detail",e),z(e,function(e){if(Console.log("data",e),e)if(Console.log("data 1",e),e[0]){Console.log("data[0] 1",e[0]);let t=e[0];if(t.id)if(""===d.value||isNaN(parseInt(d.value)))window.location.replace("/vendors/"+t.id);else{let e=E.value;toastr.success(`Vendor ${e} has been updated.`)}else Console.log("details 1",t)}else Console.log("details 2",e);else Console.log("details 3",provider)}))})},K=function(e){e&&z(e,function(e){if(e)if(Console.log("data",e),Console.log(e.length),e[0]){Console.log("data[0]",e[0]);let t=e[0];if(t.id)if(Console.log("details.id",t.id),Console.log("_vendor_id.value",d.value),""===d.value||isNaN(parseInt(d.value)))window.location.replace("/vendors/"+t.id);else{let e=E.value;toastr.success(`Vendor ${e} has been updated.`)}else Console.log("details 1",t)}else Console.log("details 2",e);else Console.log("details 3",provider)})},Z=function(e){Vendor.all=new Map,e&&$.each(e,function(e,t){let n=G(t);q.insertRow(n),Vendor.all.set(n.id,n)}),Console.log(" Vendor.all",Vendor.all)},X=function(e){let t={};e&&e.company&&(t=e.company),i&&(o&&(o.value=e.name?e.name:"",o&&$(o).on("change",function(){setTimeout(function(){let e=o.value;P=!1,""===e?(o.value="",a.value=""):O(e)},200)}).on("click",function(){$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){e.data}})),d&&(d.value=e.id?e.id:""),a&&(a.value=t.id?t.id:""),u&&(u.value=e.sku?e.sku:""),_&&(_.checked=!e.enabled||1===e.enabled),c&&(c.checked=1===e.is_provider),l&&(l.checked=1===e.show_online),s&&(s.checked=1===e.show_ops),r&&(r.checked=1===e.show_sales),validator_init(T),D=$(i).validate())},ee=function(e){g&&(validator_init(R),N=$(g).validate()),q=$(y).table({table_type:"display_list",data:Vendor.all,columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:2,data:"sku",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Vendor.navigate}),e&&e.vendors&&Z(e.vendors)},te=function(){o&&($(c).attr("readonly",!0),c.disabled=!0,$(o).attr("readonly",!0),$(d).attr("readonly",!0),$(u).attr("readonly",!0),$(c).attr("readonly",!0))};return{validator:null,detail:{},all:new Map,newVendor:function(e,t){return U(e,t)},index:function(e){ee(e)},setProvider:function(){Console.log("Set Provider"),m&&(c.checked=!0,$(c).attr("readonly","true"),c.disabled=!0,$(o).attr("readonly","true"),$(d).attr("readonly","true"),$(u).attr("readonly","true"),$(c).attr("readonly","true"))},get:function(e){},load_all:function(e){Z(e)},reset_form:function(){o.value="",d.value="",a.value="",l.checked=!0,r.checked=!0,s.checked=!0,c.checked=!0,u.value="",_.checked=!0},save:function(e){K(e)},init:function(e){X(e)},build:function(){if($(i).valid())return remove_nulls({id:isNaN(parseInt(d.value))?null:parseInt(d.value),company_id:isNaN(parseInt(a.value))?null:parseInt(a.value),name:""!==o.value?o.value:null,status_id:10,enabled:_.checked?1:0,show_online:!0===l.checked?1:0,show_sales:!0===r.checked?1:0,show_ops:!0===s.checked?1:0,is_provider:!0===c.checked?1:0,sku:u.value})},navigate:function(e){!function(e){e&&e.id&&window.location.replace("/vendors/"+e.id)}(e)},edit:function(t){!function(t){let n=[],a=[],i={},o={};t&&t.vendor_detail&&(o=G(t.vendor_detail),n=t.address_detail?t.address_detail:[],a=t.contact_detail?t.contact_detail:[],i=t.company_detail?t.company_detail:{}),$(e).removeClass("disabled"),Vendor.init(o),Address.init(n),Contact.init(a),Company.init(i),te()}(t)},setVendor:function(){te()}}}(),MessageTypes=function(){"use strict";document.getElementById("input_message_types_id"),document.getElementById("input_message_types_name"),document.getElementById("input_message_types_icon"),document.getElementById("input_message_types_sort_order"),document.getElementById("input_message_types_enabled"),document.getElementById("input_message_types_date_created"),document.getElementById("input_message_types_created_by"),document.getElementById("input_message_types_date_modified"),document.getElementById("input_message_types_modified_by"),document.getElementById("input_message_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,icon:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.icon=t.icon?t.icon:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),MessageTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,MessageTypes.all=new Map,n&&($.each(n,function(e,n){let a=t(n);MessageTypes.all.set("id",a)}),Console.log(" MessageTypes.all",MessageTypes.all))},save:function(e){},init:function(){Console.log(" -- MessageTypes -- ",{})}}}(),Pricing=function(){"use strict";let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=document.getElementById("pricing_strategy_unit_id"),n=document.getElementById("pricing_strategy_season_id"),a=(document.getElementById("pricing_strategy_profile_id"),document.getElementById("pricing_strategy_types_id")),i=document.getElementById("calendar_filter_profile_id");$(a).on("change",function(){PricingWorksheet.pricingWorksheet()});const o=function(e){Pricing.all=new Map,e||(e=[]),$.each(e,function(e,t){t.pricings;let n=t.pricing_code,a=t.matrix_code,i=(Matrix.all.get(a),r(t));Pricing.all.set(n,i)})},d=function(){let e=InventoryProfile&&InventoryProfile.all?Array.from(InventoryProfile.all.values()):[],t="<option value='' disabled readonly selected>-- Profiles --</option>";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(i).empty(),$(i).html(t)},l=function(){!function(){let e=Season&&Season.all?Array.from(Season.all.values()):[],t="";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(n).empty(),$(n).html(t)}(),function(){let e=Unit&&Unit.all?Array.from(Unit.all.values()):[],n="";$.each(e,function(e,t){let a=t.name,i=t.id;n+=`<option value="${i}">${a}</option>`}),$(t).empty(),$(t).html(n)}(),d()},r=function(t){let n={pricing_code:null,matrix_code:null,code:null,id:null,product_id:null,season_id:null,unit_id:null,matrix_id:null,variant_id:0,name:null,mon:null,tue:null,wed:null,thu:null,fri:null,sat:null,sun:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null,count:1,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.pricing_code=t.pricing_code?t.pricing_code:null,n.matrix_code=t.matrix_code?t.matrix_code:null,n.code=t.code?t.code:null,n.id=t.id?t.id:null,n.product_id=t.product_id?t.id:null,n.season_id=t.season_id?t.id:null,n.unit_id=t.unit_id?t.id:null,n.matrix_id=t.matrix_id?t.matrix_id:null,n.variant_id=t.variant_id?t.variant_id:null,n.name=t.name?t.name:null,n.mon=t.mon?t.mon:null,n.tue=t.tue?t.tue:null,n.wed=t.wed?t.wed:null,n.thu=t.thu?t.thu:null,n.fri=t.fri?t.fri:null,n.sat=t.sat?t.sat:null,n.sun=t.sun?t.sun:null,n.monMargin=t.monMargin?t.monMargin:null,n.tueMargin=t.tueMargin?t.tueMargin:null,n.wedMargin=t.wedMargin?t.wedMargin:null,n.thuMargin=t.thuMargin?t.thuMargin:null,n.friMargin=t.friMargin?t.friMargin:null,n.satMargin=t.satMargin?t.satMargin:null,n.sunMargin=t.sunMargin?t.sunMargin:null,n.count=t.count?t.count:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:e,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:e,n.note=t.note?t.note:null),Pricing.detail=n,n};return{all:new Map,init:function(e){!function(e){l();let t,n=[];e&&(t=e,e.pricings&&(n=e.pricings)),t.pricing_strategy_types_id&&(a.value=t.pricing_strategy_types_id,PricingWorksheet.pricingStrategyId=parseInt(t.pricing_strategy_types_id)),o(n)}(e)},set:function(e){return r(e)},resetForm:function(){l()},loadProfileDropdown:function(){d()}}}(),Matrix=function(){"use strict";let e,t,n,a=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const i=function(e){let t={been_saved:0,cost:0,created_by:a,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,has_pricing:0,id:null,margin:0,code:null,modified_by:a,note:null,price:0,pricings:new Map,product_id:null,season_id:null,unit_id:null};return e&&(t.been_saved=e.been_saved?e.been_saved:0,t.cost=e.cost?e.cost:null,t.created_by=e.created_by?e.created_by:a,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.enabled=e.enabled?e.enabled:1,t.has_pricing=e.has_pricing?e.has_pricing:null,t.id=e.id?e.id:null,t.margin=e.margin?e.margin:null,t.code=e.code?e.code:null,t.modified_by=e.modified_by?e.modified_by:a,t.note=e.note?e.note:null,t.price=e.price?e.price:null,t.product_id=e.product_id?e.product_id:null,t.season_id=e.season_id?e.season_id:null,t.unit_id=e.unit_id?e.unit_id:null),Matrix.detail=t,t},o=function(e){let t=[];e&&e.matrices&&(t=e.matrices),function(e){Matrix.all=new Map,e||(e=[]),$.each(e,function(e,t){let n=i(t),a=t.code;Matrix.all.set(a,n)})}(t),d()},d=function(){e=document.getElementsByName("matrix_cost"),n=document.getElementsByName("matrix_price"),t=document.getElementsByName("matrix_margin"),e.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid})),n.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid})),t.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid}))};return{detail:{},all:new Map,set:function(e){return i(e)},init:function(e){o(e)},buildMatrixForm:function(){d()},loadPerUnitForm:function(){},loadPerPersonForm:function(){},loadPerDayForm:function(){}}}(),PricingStrategyTypes=function(){"use strict";document.getElementById("input_pricing_strategy_types_id"),document.getElementById("input_pricing_strategy_types_name"),document.getElementById("input_pricing_strategy_types_enabled"),document.getElementById("input_pricing_strategy_types_date_created"),document.getElementById("input_pricing_strategy_types_created_by"),document.getElementById("input_pricing_strategy_types_date_modified"),document.getElementById("input_pricing_strategy_types_modified_by"),document.getElementById("input_pricing_strategy_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),PricingStrategyTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,PricingStrategyTypes.all=new Map,n&&($.each(n,function(e,n){let a=t(n);PricingStrategyTypes.all.set("id",a)}),Console.log(" PricingStrategyTypes.all",PricingStrategyTypes.all))},save:function(e){},init:function(){}}}();PricingStrategyTypes.init();const RatingTypes=function(){"use strict";document.getElementById("input_rating_types_id"),document.getElementById("input_rating_types_name"),document.getElementById("input_rating_types_enabled"),document.getElementById("input_rating_types_date_created"),document.getElementById("input_rating_types_created_by"),document.getElementById("input_rating_types_date_modified"),document.getElementById("input_rating_types_modified_by"),document.getElementById("input_rating_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),RatingTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,RatingTypes.all=new Map,n&&($.each(n,function(e,n){let a=t(n);RatingTypes.all.set("id",a)}),Console.log(" RatingTypes.all",RatingTypes.all))},save:function(e){},init:function(){Console.log(" -- RatingTypes -- ",{})}}}(),SalesTypes=function(){"use strict";document.getElementById("input_sales_types_id"),document.getElementById("input_sales_types_name"),document.getElementById("input_sales_types_class"),document.getElementById("input_sales_types_sort_order"),document.getElementById("input_sales_types_enabled"),document.getElementById("input_sales_types_date_created"),document.getElementById("input_sales_types_created_by"),document.getElementById("input_sales_types_date_modified"),document.getElementById("input_sales_types_modified_by"),document.getElementById("input_sales_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,class:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.class=t.class?t.class:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),SalesTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,SalesTypes.all=new Map,n&&($.each(n,function(e,n){let a=t(n);SalesTypes.all.set("id",a)}),Console.log(" SalesTypes.all",SalesTypes.all))},save:function(e){},init:function(){Console.log(" -- SalesTypes -- ",{})}}}(),StatusTypes=function(){"use strict";document.getElementById("input_status_types_id"),document.getElementById("input_status_types_name"),document.getElementById("input_status_types_enabled"),document.getElementById("input_status_types_date_created"),document.getElementById("input_status_types_created_by"),document.getElementById("input_status_types_date_modified"),document.getElementById("input_status_types_modified_by"),document.getElementById("input_status_types_note"),document.getElementById("input_status_types_sort_order");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null,sort_order:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null,n.sort_order=t.sort_order?t.sort_order:null),StatusTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,StatusTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);StatusTypes.all.set("id",a)})},save:function(e){},init:function(){Console.log(" -- StatusTypes -- ",{})}}}(),Types=function(){"use strict";const e=function(e,t){$.each(e,function(e,n){Types[t].set(n.id,n)})};return{allot_by:new Map,address_types:new Map,season_types:new Map,airport_types:new Map,categories_ratings_types:new Map,category:new Map,color_scheme:new Map,contact_types:new Map,currency:new Map,location_types:new Map,message_types:new Map,pricing_strategy_types:new Map,rating_types:new Map,sales_types:new Map,status_types:new Map,init:function(t){t&&function(t){Types.address_types=new Map,Types.allot_by=new Map,Types.airport_types=new Map,Types.categories_ratings_types=new Map,Types.category=new Map,Types.color_scheme=new Map,Types.contact_types=new Map,Types.currency=new Map,Types.location_types=new Map,Types.message_types=new Map,Types.pricing_strategy_types=new Map,Types.rating_types=new Map,Types.sales_types=new Map,Types.status_types=new Map,Country.all=new Map,t.address_types&&e(t.address_types,"address_types"),t.season_types&&(e(t.season_types,"season_types"),Season.init({seasons:t.season_types})),t.airport_types&&e(t.airport_types,"airport_types"),t.category&&(e(t.category,"category"),Category.init({categories:t.category})),t.color_scheme&&e(t.color_scheme,"color_scheme"),t.contact_types&&e(t.contact_types,"contact_types"),t.currency&&e(t.currency,"currency"),t.location_types&&e(t.location_types,"location_types"),t.message_types&&e(t.message_types,"message_types"),t.pricing_strategy_types&&e(t.pricing_strategy_types,"pricing_strategy_types"),t.rating_types&&e(t.rating_types,"rating_types"),t.sales_types&&e(t.sales_types,"sales_types"),t.status_types&&e(t.status_types,"status_types"),t.allot_by&&e(t.allot_by,"allot_by"),t.countries&&Country.load_all(t.countries),t.countries&&Country.load_all(t.countries)}(t)}}}(),Login=function(){"use strict";document.getElementById("dataToSend");const e=document.getElementById("email"),t=document.getElementById("password"),n=document.getElementById("button_login_submit"),a=document.getElementById("button_login_register"),i=document.getElementById("form_login"),o=document.getElementById("register_form_submit_button"),d=document.getElementById("register_page_form"),l=document.getElementById("register_page"),r=function(e,t){return Login.validator=validator_init(t),$(e).valid()},s=function(o){let d={rules:{email:{required:!0,email:!0},password:{required:!0}},messages:{email:{required:"Field Required",email:"Field invalid"},password:{required:"Field Required"}}};Login.validator=validator_init(d),$(a).on("click",function(){}),$(n).on("click",function(){s()});const l=function(e){toastr.error(e)},s=function(){if(r(i,d)){let n={email:e.value,password:t.value};!function(e){if(!e)return l("Error: 3");try{sendPostRequest("/api/v1.0/users/login",e,function(e,t,n){if(Console.log("data",e.id),!e||!e.id)return l("Error Logging In: 1");e.id&&window.location.replace("/")})}catch(e){return Console.error("Error",e),l("Error: 2")}}(remove_nulls(n))}}};return{detail:{},all:new Map,validator:null,init:function(e){!function(e){i&&Login.login(e),l&&Login.register(e)}(e)},login:function(e){s()},register:function(e){!function(e){let t={rules:{user_name_first:{required:!0},user_name_last:{required:!0},user_email:{required:!0,email:!0},user_password:{required:!0,minlength:5},user_password_confirm:{required:!0,minlength:5,equalTo:"#user_password"}},messages:{user_name_first:{required:"Field Required"},user_name_last:{required:"Field Required"},user_email:{required:"Field Required",email:"Field invalid"},user_password:{required:"Field Required"}}};const n=document.getElementById("user_name_first"),a=document.getElementById("user_name_last"),i=document.getElementById("user_email"),l=document.getElementById("user_password");Login.validator=validator_init(t),$(o).on("click",function(){s()});const s=function(){if(r(d,t)){let e={name_first:n.value,name_last:a.value,email:i.value,password:l.value};c(remove_nulls(e))}},c=function(e){if(Console.log("Login.register->send_register",e),!e)return handle_login_error("Error: 3");try{sendPostRequest("/api/v1.0/users/register",e,function(e,t,n){if(Console.log("data",e.id),!e||!e.id)return handle_login_error("Error Logging In: 1");e.id&&window.location.replace("/")})}catch(e){return Console.error("Error",e),handle_login_error("Error: 2")}}}()}}}();Login.init();const Provider=function(){"use strict";const t=document.getElementById("button_add_provider_page_heading"),n=document.getElementById("button_edit_provider_name"),a=document.getElementById("button_save_provider"),i=document.getElementById("panel_tab_contact"),o=document.getElementById("panel_tab_vendor"),d=document.getElementById("panel_tab_address"),l=document.getElementById("panel_tab_provider"),r=document.getElementById("table_provider_index"),s=document.getElementById("location_id"),c=document.getElementById("company_name"),u=document.getElementById("provider_id"),_=document.getElementById("provider_name"),m=document.getElementById("provider_company_id"),p=document.getElementById("provider_enabled"),f=document.getElementById("provider_code_direct_id"),y=document.getElementById("vendor_name"),g=document.getElementById("vendor_company_id"),v=document.getElementById("company_id"),b=document.getElementById("location_name_filter_id"),h=document.getElementById("form_edit_provider"),I=document.getElementById("form_product_add"),w=document.getElementById("modal_product_provider_name"),E=document.getElementById("modal_product_provider_id"),C=document.getElementById("modal_product_vendor_id"),k=document.getElementById("modal_product_vendor_name"),B=document.getElementById("modal_product_vendor_company_id"),x=document.getElementById("modal_product_provider_company_id"),M=document.getElementById("modal_product_provider_vendor_match"),S=document.getElementById("modal_product_provider_location_id"),N=document.getElementById("modal_product_location_id");let D,L=!1,P=!1,T=$(r),R=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,q={rules:{provider_name:{required:!0},provider_company_id:{required:!0}},messages:{provider_company_id:{required:"Field Required"},provider_name:{required:"Field Required"}}};$(a).on("click",function(){let e=$("#provider_edit_tabs > li.nav-item > a.nav-link"),t=$("div.tab-pane"),n=Company.build(),a=Provider.build(),i=Location.build(),o=Vendor.build(),d=Array.from(Address.all.values()),l=Array.from(Contact.all.values());n&&a&&i&&o&&d&&l?(a.location_id=i.id?i.id:null,o.is_provider=h?1:0,confirmDialog("Would you like to update?",e=>{e&&U({company_detail:n,provider_detail:a,location_detail:i,vendor_detail:o,addresses:d,contacts:l})})):$.each(t,function(n,a){if($(this).find(".is-invalid").length>0){let n=$("body").find("[aria-controls='"+$(this).attr("id")+"']");return e.removeClass("active"),t.removeClass("active"),$(this).addClass("active"),n.addClass("active"),!1}})}),$("#provider_edit").on("change",function(){H()}),$(m).on("change",function(){$(g).val($(this).val())}),$(t).on("click",function(){}),$(n).on("click",function(){j()}),$(v).on("change",function(){$(m).val(v.value)});const O=function(){_&&$(_).on("change",function(){}).on("search",function(){Provider.reset_form(),Vendor.reset_form()}).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data,n=t.company?t.company:{},a=(t.addresses&&t.addresses,t.contacts&&t.contacts,t.location?t.location:{}),i=(t.vendor&&t.vendor,t.id),o=t.company.name,d=t.company.id;h&&($(m).val(d),$(u).val(i),confirmDialog("This provider exists. Would you like to edit it?",e=>{e?(window.location.replace("/providers/"+i),z(t),Company.populate_form(n),Location.populate_form(a),$(g).val(d),$(y).val(o).trigger("change")):(Provider.reset_form(),Vendor.reset_form())}))}})};$("#modal_product_provider_name").on("change",function(){setTimeout(function(){let e=w.value;!1===L&&(""===e?(C.value="",E.value="",k.value="",w.value="",B.value="",x.value="",S.value="",k.disabled=!0,Product.attr2=null,Product.attr3=null,Product.updateProductSKU(),L=!1):Q(e))},200)}).on("search",function(){C.value="",E.value="",k.value="",w.value="",B.value="",x.value="",S.value="",Product.attr2=null,Product.attr3=null,Product.updateProductSKU(),k.disabled=!0}).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;let t=V(e.data),n=t.vendor,a=t.code_direct_id?t.code_direct_id:null,i=n.sku?n.sku:null;C.value=parseInt(e.data.vendor.id),E.value=e.data.id,k.value=e.data.name,B.value=isNaN(parseInt(e.data.company_id))?null:parseInt(e.data.company_id),x.value=isNaN(parseInt(e.data.company_id))?null:parseInt(e.data.company_id),M.checked=!0,k.disabled=!1,S.value=isNaN(parseInt(t.location.id))?null:parseInt(t.location.id),Product.attr2=a,Product.attr3=i,Product.updateProductSKU()}});const Q=function(e){if(e&&""!==e){J({name:e},function(e){let t;if(I)if(e&&0!==e.length){e&&(t=e,e.length>0&&(t=e[0]));let n=t.vendor,a=t.code_direct_id?t.code_direct_id:null,i=n.sku?n.sku:null;C.value=parseInt(n.id),E.value=t.id,k.value=t.name,B.value=isNaN(parseInt(t.company_id))?null:parseInt(t.company_id),x.value=isNaN(parseInt(t.company_id))?null:parseInt(t.company_id),M.checked=!0,k.disabled=!1,S.value=isNaN(parseInt(t.location.id))?null:parseInt(t.location.id),N.value=isNaN(parseInt(t.location.id))?null:parseInt(t.location.id),Product.attr2=a,Product.attr3=i,Product.updateProductSKU()}else confirmDialog("This provider does not exist. Would you like to create it?",e=>{e?Company.add_to_company_list({name:w.value,status_id:10,enabled:1},function(e){if(e&&e[0]){let t=e[0];x.value=t.id,B.value=t.id,w.value=t.name,k.value=t.name,M.checked=!0,function(e){if(console.log("Provider.add(provider)",e),e){let t={name:w.value,status_id:1,show_online:1,show_sales:1,show_ops:1,is_provider:1,enabled:1};Vendor.newVendor(t,function(t){let n,a={};t&&(n=t,t[0]&&(n=t[0]),console.log("Provider Upodating Vendor: vendor_detail",n),e.location_id=e.location_id?e.location_id:1,e.vendor_id=n.id,a={provider_detail:e},console.log("Provider : provider_detail",a),W(a,function(e){if(e&&(console.log("data",e),e[0])){let t=e[0],n=t.vendor,a=t.company;V(t),w.value=t.name,E.value=t.id,x.value=a.id,k.value=t.name,C.value=n.id,B.value=a.id,O(),Product.attr2=t.code_direct_id?t.code_direct_id:null,Product.attr3=n.sku?n.sku:null,Product.updateProductSKU()}}))})}}(remove_nulls({location_id:null,company_id:t.id,code_direct_id:null,id:null,provider_vendor:1,enabled:1}))}}):(C.value="",E.value="",k.value="",w.value="",L=!1)});h&&(e&&e.length>0&&(t=e[0],confirmDialog("This provider exists. Would you like to edit it?",e=>{e?window.location.href="/providers/"+t.id:(Company.reset_form(),Provider.reset_form(),Vendor.reset_form())})),console.log("provider",t),$(y).val($(_).val()).trigger("change"))})}},A=function(){T=$(r).table({table_type:"display_list",data:Provider.all,columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Code Direct ID",targets:1,data:"code_direct_id",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:2,data:"vendor",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e.sku+"</span>"}},{title:"Location",targets:3,data:"location",render:function(e,t,n,a){let i="";return"<span style='white-space: nowrap;'>"+(i=e.display_medium)+"</span>"}}],rowClick:Provider.navigate})},Y=function(e){toastr.error(e)},F=function(e){Provider.all=new Map,e&&$.each(e,function(e,t){let n=V(t);T.insertRow(n),Provider.all.set(n.id,n)})},U=function(e){e&&W(e,function(t){if(t)if(console.log("data 1",t),t[0]){console.log("data[0] 1",t[0]);let e=t[0];if(e.id)if(""===u.value||isNaN(parseInt(u.value)))window.location.replace("/providers/"+e.id);else{let e=c.value;toastr.success(`Provider ${e} has been updated.`)}else console.log("details 1",e)}else console.log("details 2",t);else console.log("details 3",e)})},W=function(e,t){if(e)try{sendPostRequest("/api/v1.0/providers/update",e,function(e,n,a){if(e)return t(e);Y("Oops: 1")})}catch(e){console.log("error",e)}},V=function(e){let t={addresses:[],contacts:[],location:{},company:{},vendor:{},id:null,description_long:null,description_short:null,keywords:null,company_id:null,name:null,code_direct_id:null,provider_vendor:1,enabled:1,date_created:formatDateMySQL(),created_by:R,date_modified:formatDateMySQL(),modified_by:R,note:null};return e&&(t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.location_id=e.location_id?e.location_id:null,t.code_direct_id=e.code_direct_id?e.code_direct_id:null,t.description_long=e.description_long?e.description_long:null,t.description_short=e.description_short?e.description_short:null,t.keywords=e.keywords?e.keywords:null,t.provider_vendor=e.provider_vendor?e.provider_vendor:1,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.company_id=e.company_id?e.company_id:null,t.created_by=e.created_by?e.created_by:R,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:R,t.note=e.note?e.note:null,t.vendor=e.vendor?e.vendor:{},t.addresses=e.addresses?e.addresses:[],t.contacts=e.contacts?e.contacts:[],t.location=e.location?e.location:{},t.company=e.company?e.company:{}),Provider.detail=t,t},j=function(){""!==u.value&&m.value},H=function(){console.log("set_progress()");isNaN(u.value)||u.value;let e=isNaN(m.value)?null:m.value;null===e||""===e?($(i).addClass("disabled"),$(d).addClass("disabled"),$(l).addClass("disabled"),$(o).addClass("disabled")):($(i).removeClass("disabled"),$(d).removeClass("disabled"),$(l).removeClass("disabled"),$(o).removeClass("disabled")),a.disabled=!(""!==v.value&&""!==b.value)},G=function(){$(_).attr("readonly",!0),h&&(P||$(c).attr("readonly",!0))},z=function(e){e&&(u.value=e.id?e.id:null,$(_).val(e.name?e.name:null),$(c).val($(_).val()),m.value=e.company_id?e.company_id:null,f.value=e.code_direct_id?e.code_direct_id:null,p.checked=!e.enabled||1===e.enabled)},J=function(e,t){if(e)try{sendGetRequest("/api/v1.0/providers/validate",e,function(e,n,a){if(e)return t(e);Y("Oops: 1")})}catch(e){console.log("error",e),Y("Error Validating Company")}else Y("Error Loading Company- Missing Data")};return{validator:null,detail:{},all:new Map,navigate:function(e){!function(e){e&&e.id&&window.location.replace("/providers/"+e.id)}(e)},get:function(e){get(e)},build:function(){if($(h).valid())return remove_nulls({location_id:isNaN(parseInt(s.value))?null:parseInt(s.value),company_id:isNaN(parseInt(m.value))?null:parseInt(m.value),code_direct_id:""===f.value?null:f.value,id:isNaN(parseInt(u.value))?null:parseInt(u.value),provider_vendor:h?1:0,enabled:1})},load_all:function(e){F(e)},save:function(e){U(e)},init:function(){O()},reset_form:function(){u.value="",$(_).val("").trigger("change"),m.value="",f.value="",p.checked=!0},provider_exists:function(e){Q(e)},enable_form_fields:function(){j()},disable_form_fields:function(){G()},index:function(e){var t;t=e,A(),t&&t.providers&&F(t.providers)},edit:function(e){!function(e){let t={},n=[],i=[],r={},s={},c={};h&&(O(),validator_init(q),D=$(h).validate()),e&&(e.is_new&&(P=e.is_new,a.disabled=!0,$(l).addClass("disabled"),$(o).addClass("disabled"),$(d).addClass("disabled")),e.provider_detail&&(n=(t=V(e.provider_detail)).addresses?t.addresses:[],i=t.contacts?t.contacts:[],r=t.location?t.location:{},s=t.company?t.company:{},c=t.vendor?t.vendor:{})),z(t),Vendor.init(c),Location.init(r),Address.init(n),Contact.init(i),Company.init(s),Vendor.setProvider(),G(),H()}(e)}}}(),Profile=function(){"use strict";const e=document.getElementById("table_profile_product_edit");document.getElementById("product_edit_profile_form_profile_name_filter"),document.getElementById("product_edit_profile_form");let t=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(e);const n=function(e){let n={advanced_booking_date:null,advanced_booking_max:null,advanced_booking_min:null,allot_by_details:{created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},allot_by_id:null,checkin_dow:"",checkout_dow:"",created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),days_out:null,departure_dow:"",enabled:1,equal_duration:null,expires:null,id:null,inc_days_dow:"",max_duration:null,min_duration:1,min_length_days:1,modified_by:t,name:null,note:null,product_profile_details:{created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,modified_by:t,note:null,product_id:null,profile_id:null},quantity:null,release_amt:null,return_dow:"",sales_types_details:{class:null,created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},sales_types_id:null,transfer_sales_types_details:{class:null,created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},transfer_sales_types_id:null,weekday_dow:""};return Console.log("Profile.set(profile)",e),e&&(n.advanced_booking_date=e.advanced_booking_date?e.advanced_booking_date:null,n.advanced_booking_max=e.advanced_booking_max?e.advanced_booking_max:null,n.advanced_booking_min=e.advanced_booking_min?e.advanced_booking_min:null,n.allot_by_details.created_by=e.created_by?e.created_by:null,n.allot_by_details.date_created=e.date_created?e.date_created:formatDateMySQL(),n.allot_by_details.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),n.allot_by_details.enabled=e.enabled?e.enabled:1,n.allot_by_details.id=e.id?e.id:null,n.allot_by_details.modified_by=e.modified_by?e.modified_by:t,n.allot_by_details.name=e.name?e.name:null,n.allot_by_details.note=e.note?e.note:null,n.allot_by_details.sort_order=e.sort_order?e.sort_order:999),n},a=function(e){let t=[];e&&e.profiles&&(t=e.profiles),function(e){Profile.all=new Map,e||(e=[]),$.each(e,function(e,t){let a=n(t);Console.log("detail",a)}),Console.log("Profile.all",Profile.all)}(t)};return{all:new Map,init:function(e){a(e)},edit:function(e){!function(e){Console.log("Profile.edit(profile)",e)}(e)}}}();$(function(){const e=document.getElementById("profile_card"),t=document.getElementById("profile_card_cover_image"),n=document.getElementById("profile_edit_name");$(n).on("click",function(){Console.log("_profile_edit_name:click")});const a=function(){parseInt($(e).outerHeight());let n,a=parseInt($(e).outerWidth()),i=0;n=a/2+"px",i=a+"px",$(t).css({width:"100%",height:"100%","max-height":n+"px"})};window.addEventListener("resize",debounce(function(t){e&&a()})),a()}),$(document).ready(function(){window.addEventListener("load",function(){const e=document.getElementsByTagName("input");mdbPreloader&&$(mdbPreloader).delay(1e3).fadeOut(300);for(let t=0;t<e.length;t++)"text"===e[t].type&&(e[t].classList.contains("date-format"),e[t].classList.contains("time-format"))},!1),window.addEventListener("resize",debounce(function(e){resize_elements()})),(new WOW).init(),$(this).scrollTop(0),$("body").scrollTop(),$.fn.dataTableExt.afnFiltering.push(function(e,t,n){if("dates_table"===e.nTable.id){var a=document.getElementById("min").value,i=document.getElementById("max").value;a=a.substring(6,10)+a.substring(3,5)+a.substring(0,2),i=i.substring(6,10)+i.substring(3,5)+i.substring(0,2);var o=t[1].substring(6,10)+t[1].substring(3,5)+t[1].substring(0,2),d=t[1].substring(6,10)+t[1].substring(3,5)+t[1].substring(0,2);return""===a&&""===i||(a<=o&&""===i||(i>=d&&""===a||a<=o&&i>=d))}return!0}),"scrollRestoration"in history&&(history.scrollRestoration="manual"),$(".button-collapse").sideNav(sideNavOptions),window.scrollTo(0,0),resize_elements(),$(function(){$('[data-toggle="tooltip"]').tooltip()}),document.querySelectorAll(".panel-code").forEach(e=>{let t=$(e).html(),n="",a="";$(e).empty(),"json"===e.dataset.datatype?(n=jsonPrettify(t),a="json"):"jsonp"===e.dataset.datatype?(n=jsonPrettify(t),a="jsonp"):"json5"===e.dataset.datatype&&(n=jsonPrettify(t),a="json5");let i=document.createElement("pre"),o=document.createElement("code");o.classList=[`language-${a}`],o.innerHTML=n,i.appendChild(o),e.appendChild(i),Prism.highlightElement(o)}),$("button.pre_display_button").show(),$("div.pre_display_el").hide(),$(function(){$("textarea.short-description").maxlength({alwaysShow:!0,threshold:10,warningClass:"badge badge-warning",limitReachedClass:"badge badge-danger"})}),$(function(){toastr.options={closeButton:!0,debug:!0,newestOnTop:!0,progressBar:!1,positionClass:"md-toast-bottom-right",preventDuplicates:!0,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}})});