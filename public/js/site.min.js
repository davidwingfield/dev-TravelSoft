const mySQLDate="",defaultLocationDisplayFormat="medium",populateDefaultValues=!1,defaultDateFormat="YYYY-MM-DD",sideNavOptions={edge:"left",closeOnClick:!1,breakpoint:1199,menuWidth:240,timeDurationOpen:500,timeDurationClose:500,timeDurationOverlayOpen:200,timeDurationOverlayClose:200,easingOpen:"easeInOutQuad",easingClose:"easeInOutQuad",showOverlay:!0,showCloseButton:!1,slim:!1,onOpen:null,onClose:null,mode:"over"},toastrOptions={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"md-toast-bottom-right",preventDuplicates:!0,onclick:null,showDuration:3e8,hideDuration:1e9,timeOut:5e6,extendedTimeOut:1e6,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},dow_short=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],days=[{name:"Sunday",short:"Sun"},{name:"Monday",short:"Mon"},{name:"Tuesday",short:"Tue"},{name:"Wednesday",short:"Wed"},{name:"Thursday",short:"Thu"},{name:"Friday",short:"Fri"},{name:"Saturday",short:"Sat"}],dowStart=1,short_dexcription_max=250,colorScheme=new Map,toggleAJAXResponse=!1,debugMode=!0;colorScheme.set(1,{name:"Color - 1",backGround:"#bdbdbd",borderColor:"#686868",textColor:"#000"}),colorScheme.set(2,{name:"Color - 2",backGround:"#54cbe3",borderColor:"#357f8e",textColor:"#000"}),colorScheme.set(3,{name:"Color - 3",backGround:"#49de94",borderColor:"#2d895b",textColor:"#000"}),colorScheme.set(4,{name:"Color - 4",backGround:"#ab8c82",borderColor:"#564641",textColor:"#000"}),colorScheme.set(5,{name:"Color - 5",backGround:"#ffcd17",borderColor:"#aa890f",textColor:"#000"}),colorScheme.set(6,{name:"Color - 6",backGround:"#96a3fa",borderColor:"#636ca5",textColor:"#000"}),colorScheme.set(7,{name:"Color - 7",backGround:"#fa983c",borderColor:"#a56428",textColor:"#000"}),colorScheme.set(8,{name:"Color - 8",backGround:"#17b3a3",borderColor:"#0c5e56",textColor:"#000"}),colorScheme.set(9,{name:"Color - 9",backGround:"#76838f",borderColor:"#30353a",textColor:"#fff"}),colorScheme.set(10,{name:"Color - 10",backGround:"#910112",borderColor:"#3c0007",textColor:"#fff"}),colorScheme.set(11,{name:"Color - 11",backGround:"#ff666b",borderColor:"#aa4447",textColor:"#000"}),colorScheme.set(12,{name:"Color - 12",backGround:"#3e8ef7",borderColor:"#295da2",textColor:"#000"}),colorScheme.set(13,{name:"Color - 13",backGround:"#f74584",borderColor:"#a22d57",textColor:"#000"}),colorScheme.set(14,{name:"Color - 14",backGround:"#5a9101",borderColor:"#253c00",textColor:"#fff"}),colorScheme.set(15,{name:"Color - 15",backGround:"#9463f7",borderColor:"#6141a2",textColor:"#fff"});const tableCellMaxChars=10,defaultAddressView="medium",DEBUGMODE=!0,inactivityTimeout=36e5,initialCalenderViewCount=12,FILE_TYPES={aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",mid:"audio/midi audio/x-midi",midi:"audio/midi audio/x-midi",mjs:"text/javascript",mp3:"audio/mpeg",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"text/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","7z":"application/x-7z-compressed"},STANDARD_ASPECT_RATIOS=[[1,"1:1"],[4/3,"4:3"],[5/4,"5:4"],[1.5,"3:2"],[1.6,"16:10"],[16/9,"16:9"],[21/9,"21:9"],[32/9,"32:9"]];let ERROR_ALLOWED=.05,RATIOS=STANDARD_ASPECT_RATIOS.map(function(e){return e[0]}).sort(),LOOKUP=Object();for(let e=0;e<STANDARD_ASPECT_RATIOS.length;e++)LOOKUP[STANDARD_ASPECT_RATIOS[e][0]]=STANDARD_ASPECT_RATIOS[e][1];const separatorDate="-",pickadateSettings={format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd",editable:!1,selectYears:!0,selectMonths:!0},regex=/(((19|20)\d\d)\-(0[1-9]|1[0-2])\-((0|1)[0-9]|2[0-9]|3[0-1]))$/,categoryColors={hotels:{color:"#065565",border:"#0bb2d4",background:"#c2f5ff"},flights:{color:"#5a4907",border:"#997b71",background:"#f5e2da"},cars:{color:"#574400",border:"#ffcd17",background:"#fff6b5"},rails:{color:"#eb6709",border:"#ffa853",background:"#ffe1c4"},transports:{color:"#7f0638",border:"#ab7474",background:"#eed3d3"},tours:{color:"#06562f",border:"#11c26d",background:"#c2fadc"},cruises:{color:"#490ac7",border:"#9463f7",background:"#eae1fc"},packages:{color:"#063f89",border:"#3e8ef7",background:"#d9e9ff"},other:{color:"#304809",border:"#6da611",background:"#DCF7B0"}};let mdbPreloader=document.getElementById("mdb-preloader"),isShift=!1;$.fn.BuildDropDown=function(e){if(!e||!e.text_field||!e.id_field)return;let t=document.getElementById($(this).attr("id")),a=e.data?e.data:[],n=e.id_field?e.id_field:"",o=e.text_field?e.text_field:"",i=e.title?e.title:"Select Option",l=!!e.first_selectable&&e.firstSelectable,r=!!e.select2&&e.select2,d=e.type?e.type:"";if($(t).empty(),"multiple"===d&&t.setAttribute("multiple","multiple"),!1===l){let e=$(document.createElement("option")).prop({value:"",text:"-- "+i.charAt(0).toUpperCase()+i.slice(1)+" --",disabled:!0}).attr("readonly","readonly");$(t).append(e)}$.each(a,function(e,a){let i=a[n],l=a[o];$(t).append($(document.createElement("option")).prop({value:i,text:l.charAt(0).toUpperCase()+l.slice(1)}))}),$(t).val(""),r&&$(t).select2()};const formatCountryName=function(e){let t,a,n="",o=null;if(e)switch(t=e.name?e.name:null,n=e.iso3?e.iso3:null,a=e.iso2?e.iso2:null,"medium".toLowerCase()){case"short":o=n||(a||(t||null));break;case"medium":o=t||(n||(a||null));break;case"long":o=t&&n?`${n}-${t}`:t&&a?`${a}-${t}`:t||(n||(a||null));break;default:o=null}return o},formatProvinceName=function(e){let t,a,n="",o=null;if(e)switch(t=e.name?e.name:null,a=e.iso3?e.iso3:null,n=e.iso2?e.iso2:null,"medium".toLowerCase()){case"short":o=a||(n||(t||null));break;case"medium":o=t||(a||(n||null));break;case"long":o=t&&a?`${a}-${t}`:t&&n?`${n}-${t}`:t||(a||(n||null));break;default:o=null}return o},formatLocationDisplay=function(e,t,a){let n,o,i=null,l="";return e&&(n=formatCountryName(e)),t&&(o=formatProvinceName(t)),a&&(i=a.name?a.name:null),l=null!==n&&null!==o&&null!==i?`${i} (${o}, ${n})`:n&&o&&null!==n&&null!==o&&null===i?`(${o}, ${n})`:!n||o&&null!==o||i&&null!==i?i&&null!==n&&null!==o&&null!==i?`${i}`:o&&i&&null!==n&&null!==o&&null!==i?`${i} (${o})`:null:`${n}`},formatDateRange=function(e,t){console.groupCollapsed("formatDateRange"),console.groupEnd()},fetchFormErrors=(e,t)=>{console.log("fetchFormErrors()");let a=document.getElementById("modal_product_category_id"),n=[];if(!e||!t||!a)return n.push({form:e||null,rules:t||null,message:"Missing Data"}),{valid:!1,errors:n};let o=jQuery(e).validate(t);return console.log("|__ validator",o),{valid:!0,errors:n}},calculateWidth=(e,t,a)=>{let n=e.value/t.value;return parseFloat((a*n).toFixed(2))},calculateHeight=(e,t,a)=>{return parseFloat((a/(e/t)).toFixed(2))},gcd=function(e,t){return 0===t?e:gcd(t,e%t)},shadeColor=function(e,t){let a=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16);return a=parseInt(a*(100+t)/100),n=(n=parseInt(n*(100+t)/100))<255?n:255,o=(o=parseInt(o*(100+t)/100))<255?o:255,"#"+(1===(a=a<255?a:255).toString(16).length?"0"+a.toString(16):a.toString(16))+(1===n.toString(16).length?"0"+n.toString(16):n.toString(16))+(1===o.toString(16).length?"0"+o.toString(16):o.toString(16))},clearAllValidation=function(){$("div.error").html("&nbsp;").hide(),$(".is-invalid").removeClass("is-invalid")};$.fn.showError=function(e){let t=this.parents("div.form-element").find("div.error");return this.addClass("is-invalid"),t.html(e).show(),this},$.fn.hideError=function(){let e=this.parents("div.form-element").find("div.error");return this.removeClass("is-invalid"),e.html("&nbsp;").hide(),this};const hexToRgb=e=>e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,a,n)=>"#"+t+t+a+a+n+n).substring(1).match(/.{2}/g).map(e=>parseInt(e,16));jQuery.fn.dataTable.Api.register("page.jumpToData()",function(e,t){let a=this.column(t,{order:"current"}).data().indexOf(e);if(a>=0){let e=Math.floor(a/this.page.info().length);this.page(e).draw(!1)}return this});const isOdd=function(e){return e%2},clearValidation=function(e){$(".autocomplete-suggestions").hide();let t=$(e).validate();t&&(t.resetForm(),t.reset())},get_errors=function(e){},validator_init=function(e){let t={},a={},n={};return e&&(e.rules&&(t=e.rules),e.messages&&(a=e.messages),e.groups&&(n=e.groups)),jQuery.validator.setDefaults({rules:t,messages:a,groups:n,ignore:"",success:"valid",invalidHandler:function(e,t){t.numberOfInvalids();let a=t.findLastActive()||t.errorList.length&&t.errorList[0].element;a&&$(a).closest(".accordion-body").collapse("show")},errorElement:"span",highlight:function(e){let t=$(e).attr("id"),a=$("#"+t),n=$("#"+t+"-error");n.attr("data-ref")?$("#"+n.attr("data-ref")).addClass("is-invalid"):(a.parent().find("span.select2").addClass("is-invalid"),a.addClass("is-invalid")),n&&n.css({display:"block"})},unhighlight:function(e){let t=$(e).attr("id"),a=$("#"+t),n=$("#"+t+"-error");a.parents("div.form-element").find("span.select2").removeClass("is-invalid"),a.removeClass("is-invalid"),n&&n.css({display:"none"})},errorPlacement:function(e,t){let a=t.attr("id");$("#"+a+"-error").html(e)},submitHandler:function(e){return!0}}),jQuery.validator.addMethod("postalCode",function(e){return/^((\d{5}-\d{4})|(\d{5})|([A-Z]\d[A-Z]\s\d[A-Z]\d))$/.test(e)},"Please enter a valid postal code."),jQuery.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("phoneIT",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator},initializeValidator=function(e){console.groupCollapsed("Functions.initializeValidator");let t={},a={},n={};return e&&(e.rules&&(t=e.rules),e.messages&&(a=e.messages),e.groups&&(n=e.groups)),jQuery.validator.setDefaults({rules:t,messages:a,groups:n,ignore:"",success:"valid",invalidHandler:function(e,t){t.numberOfInvalids();let a=t.findLastActive()||t.errorList.length&&t.errorList[0].element;a&&$(a).closest(".accordion-body").collapse("show")},errorElement:"span",highlight:function(e){let t=$(e).attr("id"),a=$("#"+t),n=$("#"+t+"-error");n.attr("data-ref")?$("#"+n.attr("data-ref")).addClass("is-invalid"):(a.parent().find("span.select2").addClass("is-invalid"),a.addClass("is-invalid")),n&&n.css({display:"block"})},unhighlight:function(e){let t=$(e).attr("id"),a=$("#"+t),n=$("#"+t+"-error");a.parents("div.form-element").find("span.select2").removeClass("is-invalid"),a.removeClass("is-invalid"),n&&n.css({display:"none"})},errorPlacement:function(e,t){let a=t.attr("id");$("#"+a+"-error").html(e)},submitHandler:function(e){return!0}}),jQuery.validator.addMethod("postalCode",function(e){return/^((\d{5}-\d{4})|(\d{5})|([A-Z]\d[A-Z]\s\d[A-Z]\d))$/.test(e)},"Please enter a valid postal code."),jQuery.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("phoneIT",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),console.groupEnd(),jQuery.validator},jsonPrettify=e=>{if("object"==typeof e&&null!==e)return JSON.stringify(e,void 0,"\t");try{const t=JSON.parse(e);return jsonPrettify(t)}catch(t){return e}},setError=function(e,t){let a=$(e).attr("id"),n=$("#"+a),o=$("#"+a+"-error");o.attr("data-ref")?$("#"+o.attr("data-ref")).addClass("is-invalid"):(n.parent().find("span.select2").addClass("is-invalid"),n.addClass("is-invalid")),o&&o.css({display:"block"}),$(o).append(`<span id="#${a}-error" class="invalid">${t}</span>`)},clearError=function(e){let t=$(e).attr("id"),a=$("#"+t),n=$("#"+t+"-error");n.attr("data-ref")?$("#"+n.attr("data-ref")).removeClass("is-invalid"):(a.parent().find("span.select2").removeClass("is-invalid"),a.removeClass("is-invalid")),n&&($(n).empty(),n.css({display:"none"}))},toNumbers=e=>e.map(Number),remove_nulls=function(e){let t={};return $.each(e,function(e,a){null===a||(t[e]=a)}),t},removeNulls=function(e){let t={};return $.each(e,function(e,a){null===a||(t[e]=a)}),t},buildMap=function(e,t){let a=new Map;return $.each(e,function(e,n){a.set(n[t],n)}),a},getListOfIds=function(e){if(e){if("string"==typeof e){let t=e.replace(/\s/g,"");return Array.from(t.split(","),Number)}if("object"==typeof e)return e}return[]},formatListOfIds=function(e){let t="";return e&&"object"==typeof e&&(t=e.join(",")),t},sendGetRequest=function(e,t,a){let n=[];if(!e||!t){let a=[];return e||a.push("url"),t||a.push("data_to_send"),handleError("Missing Data: "+a.join(", "))}$.getJSONRequest(e,t,function(t,o,i){return console.log("url",e),console.log("data",t),console.log("status",o),console.log("xhr",i),console.log("typeof data.result",typeof t.result),"success"===o&&void 0!==t.result?(n=t.result,a(n)):"failed"===o&&void 0===t.error?handleError(t):"success"===o&&void 0!==t.error?handleError(t.error):void console.log("getError:4")})},sendPostRequest=function(e,t,a){let n=[];if(!e||!t)return e||(void 0).push("url"),t||(void 0).push("data_to_send"),handleError("Missing Data: "+(void 0).join(", "));$.postJSON(e,t,function(e,t,o){return"success"===t&&void 0!==e.result?e.result?(n=e.result,a(n)):handleError("Error Posting Data 1"):"failed"===t&&void 0===e.result?e.error?handleError(e.error):handleError("Error Posting Data"):handleError("Error Posting Data 2")})},getAjaxError=function(e,t,a){let n="",o={message:"",status:"",uri:a};return 404===e.status&&(n="Requested page( "+a+" ) not found. [404]"),o.message=n,o.status=e.status,o.uri=a,o.jqXHR=e,o},_display_ajax_error=function(e,t,a){let n="",o={message:"",status:"",uri:a};return n=0===e.status?"Not connected, verify Network.":404===e.status?"Requested page( "+a+" ) not found. [404]":500===e.status?e.responseJSON?e.responseJSON:"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error."+e.responseText,o.message=n,o.status=e.status,o.uri=a,o.jqXHR=e,o},handleError=function(e,t,a){console.groupCollapsed("Functions.handleError"),t||(t="Request"),a||(a="error"),e||(e="Error processing request"),toastr[a](`${e}`,t),console.groupEnd()},validInt=function(e){return e&&!isNaN(parseInt(e))?(console.groupEnd(),parseInt(e)):null},formatDateMySQL=function(e){if(!e){new Date}return moment(e).format("YYYY-MM-DD HH:mm:ss")},resize_elements=function(){const e=document.getElementById("page"),t=document.getElementById("main"),a=document.getElementsByClassName("double-nav"),n=document.getElementById("screen_width"),o=document.getElementById("screen_height"),i=document.getElementsByClassName("page-footer"),l=document.getElementById("slide-out"),r=document.getElementById("page_header"),d=document.getElementById("product_location_map_container"),s=document.getElementById("product_location_map_container_frame");let c=0,u=0,p=0,_=0,m=0,g=0;c=window.innerHeight,u=window.innerWidth,$.each(a,function(e,t){let a=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());p+=a}),$.each(i,function(e,t){let a=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());g+=a});let h=c-g-p-1+"px";if(d&&s){let e=parseInt($(d).outerWidth()),t=e/2;console.log("mapWidth",e),console.log("mapHeight",t),$(s).css({height:t+"px","min-height":t+"px","max-height":t+"px"}),$(d).css({height:t+"px","min-height":t+"px","max-height":t+"px"})}l&&(m=isNaN(parseInt($(l).outerHeight()))?0:parseInt($(l).outerHeight()),_=isNaN(parseInt($(l).width()))?0:parseInt($(l).width())),e&&o&&n&&(t&&$(t).css({"padding-left":_+"px","min-height":c-g-p+"px!important"}),e&&e.setAttribute("style","min-height:"+h+"!important"),r&&r.setAttribute("style","margin-top:"+p+"px;"),o.innerText=c+"",n.innerText=u+"")},debounce=function(e){let t;return function(a){t&&clearTimeout(t),t=setTimeout(e,100,a)}},populateMultiSelect=function(e,t){for(let a,n=0,o=t.options.length;n<o;n++)a=t.options[n],-1!==e.indexOf(a.value)&&(a.selected=!0)},findObjectByKey=function(e,t,a){let n=[];for(let o=0;o<e.length;o++)e[o][t]===a&&n.push(e[o]);return n},addTinyMCE=function(e){tinymce.init({selector:"#"+e,menubar:!1,height:"400",plugins:"print visualblocks visualchars charmap hr pagebreak advlist lists",content_css:["https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","/assets/css/bootstrap.min.css","/assets/css/style.css"],body_class:"p-2",font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Open Sans=Open Sans; Roboto=Roboto;Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",toolbar1:"undo redo | styleselect | fontselect fontsizeselect | removeformat | numlist bullist checklist | outdent indent ",toolbar2:"cut copy | bold italic underline strikethrough | forecolor | alignleft aligncenter alignright alignjustify | backcolor",content_style:'body { font-family:"Roboto",sans-serif", sans-serif; font-size:14px; font-weight: 400 }',style_formats:[{title:"Headers",items:[{title:"h1",block:"h1"},{title:"h2",block:"h2"},{title:"h3",block:"h3"},{title:"h4",block:"h4"},{title:"h5",block:"h5"},{title:"h6",block:"h6"}]},{title:"Blocks",items:[{title:"p",block:"p"},{title:"div",block:"div"},{title:"pre",block:"pre"}]},{title:"Containers",items:[{title:"section",block:"section",wrapper:!0,merge_siblings:!1},{title:"article",block:"article",wrapper:!0,merge_siblings:!1},{title:"blockquote",block:"blockquote",wrapper:!0},{title:"hgroup",block:"hgroup",wrapper:!0},{title:"aside",block:"aside",wrapper:!0},{title:"figure",block:"figure",wrapper:!0}]}],branding:!1,resize:!1,setup:function(e){e.on("change",function(){e.save()})}})},htmlDecode=function(e){return $("<textarea/>").html(e).text()},is_null=function(e){return null==e};function decodeHtml(e){e||(e="");let t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g,function(e){return t[e]})}function escapeHtml(e){e||(e="");let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}const setInt=function(e){let t=null;return e&&(isNaN(parseInt(e))||(t=e)),t},inactivityTime=function(){let e;function t(){location.href="/logout"}function a(){clearTimeout(e),e=setTimeout(t,inactivityTimeout)}window.onload=a,document.onmousemove=a,document.onkeydown=a},htmlEncode=function(e){return $("<textarea/>").text(e).html()},paddy=function(e,t,a){let n=void 0!==a?a:"0",o=new Array(1+t).join(n);return(o+e).slice(-o.length)},generateCodeDirectId=function(e){return e?"D"+paddy(14,11):""},getDate=function(e){if(e.pickadate("picker"))return e.pickadate("picker").get()};jQuery.extend({postJSON:function(e,t,a){let n=$.ajax({url:e,type:"POST",data:t,dataType:"json"});return n.done(function(e){if($.isFunction(a))return a(e,"success"),!0}),n.fail(function(e,t,n){return $.isFunction(a)&&(e.responseJSON,a(e,"failed")),!1}),n},getJSONRequest:function(e,t,a){let n=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!0});n.done(function(e){$.isFunction(a)&&a(e,"success")}),n.fail(function(t,n,o){let i=getAjaxError(t,0,e);if(void 0!==n){_display_ajax_error(t,n,e)}else{_display_ajax_error(t,n,e)}$.isFunction(a)&&(o=i.message,a(o,"failed"))})},getJSON:function(e,t,a){let n=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!1});n.done(function(e){$.isFunction(a)&&a(e,"success")}),n.fail(function(e,t,n){$.isFunction(a)&&a(n,"failed")})}});const infoDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-info" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">${e}</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-info fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-info btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-info waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body");const a=document.getElementById("modalConfirm");if(a){const e=$(a);e.modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){t(!0),e.modal("hide")}),$(".btn-no").click(function(){t(!1),e.modal("hide")}),e.on("hidden.bs.modal",function(){e.remove()})}},confirmDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n            <div class="modal-dialog modal-sm modal-notify modal-info" role="document">\n                \x3c!--Content--\x3e\n                <div class="modal-content text-center">\n                    \x3c!--Header--\x3e\n                    <div class="modal-header d-flex justify-content-center">\n                        <p class="heading">${e}</p>\n                    </div>\n                    \x3c!--/.Header--\x3e\n                    \n                    \x3c!--Body--\x3e\n                    <div class="modal-body">\n                        <i class="fas fa-check fa-4x mb-3 animated rotateIn"></i>\n                    </div>\n                    \x3c!--/.Body--\x3e\n                   \n        \n                    \x3c!--Footer--\x3e\n                    <div class="modal-footer flex-center">\n                        <a type="button" class="btn btn-outline-info btn-sm waves-effect btn-no">no</a>\n                        <a class="btn btn-info btn-sm btn-yes">yes</a>\n                    </div>\n                    \x3c!--/.Footer--\x3e\n                    \n                </div>\n                \n                \x3c!--/.Content--\x3e\n\t        </div>\n        </div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body");const a=document.getElementById("modalConfirm");if(a){const e=$(a);e.modal({backdrop:"static",keyboard:!1}),$(".btn-yes").on("click",function(){t(!0),e.modal("hide")}),$(".btn-no").click(function(){t(!1),$("#modalConfirm").modal("hide")}).on("click",function(){t(!1),e.modal("hide")}),e.on("hidden.bs.modal",function(){$("#modalConfirm").remove()})}},deleteDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-danger" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">${e}</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-times fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-danger btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-danger waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body"),$("#modalConfirm").modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){t(!0),$("#modalConfirm").modal("hide")}),$(".btn-no").click(function(){t(!1),$("#modalConfirm").modal("hide")}),$("#modalConfirm").on("hidden.bs.modal",function(){$("#modalConfirm").remove()})},formatURL=function(e){return encodeURIComponent(e.trim())},buildMapsURL=function(e){let t,a,n,o,i,l,r,d;a=e.building_number?e.building_number:null,t=e.name?e.name:null,a=null!==a?a:null,n=null!==(n=e.street_1?e.street_1:null)?n:null,o=null!==(o=e.street_2?e.street_2:null)?o:null,i=null!==(i=e.zipcode?e.zipcode:null)?i:null,l=null!==(l=e.city.name?e.city.name:null)?l:null,r=null!==(r=e.province.iso2?e.province.iso2:e.province.iso3?e.province.iso3:e.province.name?e.province.name:null)?r:null,d=null!==(d=e.province.name?e.country.name:e.country.iso2?e.country.iso2:e.country.iso3?e.country.iso3:null)?d:null;let s=[];is_null(t=null!==t?t:null)||s.push(t),is_null(a)||s.push(a),is_null(n)||s.push(n),is_null(o)||s.push(o),is_null(l);let c="";is_null(l)||is_null(r)||is_null(i)?!is_null(l)||is_null(r)||is_null(i)?is_null(l)&&is_null(r)&&!is_null(i)?c=i:is_null(l)||!is_null(r)||is_null(i)?is_null(l)||is_null(r)||!is_null(i)||(c=l+" "+r):c=i+" "+l:c=i+" "+r:c=i+" "+l+" "+r,""!==c&&s.push(c),is_null(d)||s.push(d);let u=s.join(", ");return`https://maps.google.com/maps?q=${u=encodeURIComponent(u.trim())}&t=&z=7&ie=UTF8&iwloc=&output=embed`},weatherUpdate=function(e){const t=new XMLHttpRequest;let a=e;t.open("GET",`https://api.openweathermap.org/data/2.5/weather?q=${a}&appid=2ad550b2d7e352b38c3ca9da8396aade`),t.send(),t.onload=(()=>{if(404===t.status);else{let e=JSON.parse(t.response);e.name,Math.round(e.main.temp-273.15),e.weather[0].main,e.weather[0].description,e.weather[0].icon}})},ucwords=function(e){return(e=e.toLowerCase()).replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},trimTrailingChars=function(e,t){return e.replace(new RegExp(t+"+$"),"")},formatSize=function(e,t=2){const a=t<0?0:t;let n,o;var i;if(o=e.toUpperCase(),i="S",(o=(o=(o=(o=o.replace(new RegExp(i+"+$"),"")).replace(/BYTE/g,"BYTES")).replace(/MEGABYTE/g,"MB")).replace(/KILOBYTE/g,"KB")).includes("BYTES")){let e="BYTES";return isNaN(parseInt(o.replace(`/${e}/g`,"")))?null:parseInt(o.replace(`/${e}/g`,""))}if(o.includes("KB")){let e="KB";if(null!==(n=isNaN(parseInt(1024*parseFloat(o.replace(`/${e}/g`,"")).toFixed(a)))?null:parseInt(1024*parseFloat(o.replace(`/${e}/g`,"")).toFixed(a))))return n}else if(o.includes("MB")){let e="MB";if(null!==(n=isNaN(parseInt(2097152*parseFloat(o.replace(`/${e}/g`,"")).toFixed(a)))?null:parseInt(2097152*parseFloat(o.replace(`/${e}/g`,"")).toFixed(a))))return n}};$(function(){$(".debug").on("click",function(){showElements=!0,$(this).attr("data-shown")||($(this).attr("data-shown","true"),showElements=!0),"false"===$(this).attr("data-shown")?($(this).attr("data-shown","true"),showElements=!0):(showElements=!1,$(this).attr("data-shown","false"));let e=document.getElementsByClassName("dev-element");for(let t=0;t<e.length;t++){let a=e[t],n=a.tagName;"input"===n.toLowerCase()?!1===showElements?(a.hidden=!1,a.type="text"):(a.hidden=!0,a.type="hidden"):"label"===n.toLowerCase()&&(!1===showElements?$(a).removeClass("d-none"):$(a).addClass("d-none"))}}),$(".debug_demo").on("click",function(){showElements=!0,$(this).attr("data-shown")||($(this).attr("data-shown","true"),showElements=!0),"false"===$(this).attr("data-shown")?($(this).attr("data-shown","true"),showElements=!0):(showElements=!1,$(this).attr("data-shown","false"));let e=document.getElementsByClassName("dev-element");for(let t=0;t<e.length;t++){let a=e[t],n=a.tagName;"input"===n.toLowerCase()?!1===showElements?(a.hidden=!1,a.type="text"):(a.hidden=!0,a.type="hidden"):"label"===n.toLowerCase()&&(!1===showElements?$(a).removeClass("d-none"):$(a).addClass("d-none"))}})});const lowercaseFirstLetter=function(e){return e.charAt(0).toLowerCase()+e.slice(1)};String.prototype.ucwords=function(){return str=this.toLowerCase(),str.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},String.prototype.toUCWords=function(){return this.toLowerCase().replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})},String.prototype.toSnakeCase=function(){return this.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(e=>e.toLowerCase()).join("_")},String.prototype.toCamelCase=function(){const e=/[^A-Za-z0-9]/g;let t="";this.replace(/^\s+|\s+$/gm,"");let a=this.split(" ");for(let n=0;n<a.length;n++){let o=a[n].replace(e,"");t+=o=0===n?o.toLowerCase():o.toUCWords()}return t};const buildRow=function(e){console.log("buildRow(attr)",e);let t=document.createElement("div"),a=e&&e.classes?e.classes:["row"],n=e&&e.data?e.data:[],o=e&&e.id?e.id:null;null!==o&&t.setAttribute("id",o),Array.isArray(a)||(a=a.split(" ")),Array.isArray(n)||(n=n.split(" "));for(let e=0;e<a.length;e++)t.classList.add(a[e]);return t},buildColumn=function(e){console.log("buildColumn(attr)",e);let t=document.createElement("div"),a=e&&e.classes?e.classes:["col"],n=(e&&e.data&&e.data,e&&e.id?e.id:null);null!==n&&t.setAttribute("id",n);for(let e=0;e<a.length;e++)t.classList.add(a[e]);return t},isNumeric=function(e,t){return isNaN(parseInt(t))||(t=parseInt(t)),16===t&&(isShift=!0),(t>=48&&t<=57||t>=96&&t<=105||8===t||46===t)&&16!==t&&(4!==e.value.length&&7!==e.value.length||8===t||(e.value+="-"),!0)},Console={error:function(){},log:function(){let e,t,a;arguments.length>0&&(1===arguments.length&&(e="Log Object",a=arguments[0]),2===arguments.length&&("string"==typeof arguments[0]?e=arguments[0]:(e="Log Object",a=arguments[0]),"object"==typeof arguments[1]?(t=" [object] ",a=arguments[1]):"boolean"==typeof arguments[1]?(t=" [boolean] ",a=arguments[1]):"number"==typeof arguments[1]?(t=" [number] ",a=arguments[1]):"bigint"==typeof arguments[1]?(t=" [bigint] ",a=arguments[1]):"string"==typeof arguments[1]?(t=" [string] ",a=arguments[1]):"symbol"==typeof arguments[1]?(t=" [symbol] ",a=arguments[1]):"function"==typeof arguments[1]?(t=" [function] ",a=arguments[1]):(t=" [other] ",a=arguments[1])))}},Icon=function(){const e=function(e){e&&e.icons&&(e.icons,Icon.all=new Map)};return{all:new Map,init:function(t){return e(t)}}}(),ProductLocation=function(){"use strict";document.getElementById("product_location_transport_city_search");const e=document.getElementById("product_edit_location_id"),t=document.getElementById("product_location_search"),a=document.getElementById("product_edit_location_city_id"),n=document.getElementById("product_edit_location_city"),o=document.getElementById("product_edit_location_street_1"),i=document.getElementById("product_edit_location_street_2"),l=document.getElementById("product_edit_location_zipcode"),r=document.getElementById("product_edit_location_location_types_id"),d=document.getElementById("product_edit_location_name"),s=document.getElementById("button_submit_form_product_edit_location"),c=document.getElementById("button_clear_form_product_edit_location"),u=(document.getElementById("product_edit_location_city_edit"),document.getElementById("location_country_id")),p=document.getElementById("location_province_id"),_=document.getElementById("location_city_id"),m=document.getElementById("product_edit_location_form"),g=(document.getElementById("product_location"),document.getElementById("product_location_country_id"),document.getElementById("product_location_province_id"),document.getElementById("product_location_city_id")),h=document.getElementById("product_id"),f=document.getElementById("category_id");let v={group:{product_edit_location_city:"edit_location_country_id location_province_id location_city_id"},rules:{product_edit_location_city:{required:!0},product_edit_location_name:{required:!0},product_edit_location_location_types_id:{required:!0}},messages:{product_edit_location_city:{required:"Field Required"},product_edit_location_name:{required:"Field Required"},product_edit_location_location_types_id:{required:"Field Required"}}},y=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(s).on("click",function(){B()}),$(c).on("click",function(){E()}),$(l).on("change",function(){ProductLocation.detail.zipcode=""!==l.value?l.value:null,w()}),$(d).on("click",function(){ProductLocation.detail.name=""!==d.value?d.value:null,w()}),$(u).on("change",function(){let e=isNaN(parseInt(u.value))?null:parseInt(u.value);if(null!==e){let t=Country.all.get(e);ProductLocation.detail.country_id=e,ProductLocation.detail.country=t}}),$(p).on("change",function(){let e=isNaN(parseInt(p.value))?null:parseInt(p.value);if(null!==e){let t=Province.all.get(e);ProductLocation.detail.province_id=e,ProductLocation.detail.province=t}}),$(_).on("change",function(){let e=isNaN(parseInt(_.value))?null:parseInt(_.value);if(null!==e){let t=City.all.get(e);ProductLocation.detail.city_id=e,ProductLocation.detail.city=t,w()}}),$(d).on("change",function(){ProductLocation.detail.name=""!==d.value?d.value:null,w()}),$(o).on("change",function(){ProductLocation.detail.street_1=""!==o.value?o.value:null,w()}),$(i).on("change",function(){ProductLocation.detail.street_2=""!==i.value?i.value:null,w()}),$(_).on("change",function(){let e="",t=isNaN(parseInt(u.value))?null:parseInt(u.value),o=isNaN(parseInt(p.value))?null:parseInt(p.value),i=isNaN(parseInt(_.value))?null:parseInt(_.value),l=Country.all.get(t),r=Province.all.get(o),d=City.all.get(i);if(ProductLocation.detail.country=l,ProductLocation.detail.country_id=t,ProductLocation.detail.province=r,ProductLocation.detail.province_id=o,ProductLocation.detail.city=d,ProductLocation.detail.city_id=i,l&&r&&d){let t=d.name,n=r.name,o=l.name;a&&(a.value=d.id),g&&(g.value=d.id),e=`${t} (${n}, ${o})`}else e="",g&&(g.value=""),a&&(a.value="");n&&(n.value=e)});const b=function(){$(n).on("change",function(){setTimeout(function(){""===n.value&&I()},200)}).on("search",function(){I()}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let a,n,r,s,c=null,p=e.data;C(p);p.country&&(a=p.country,Country.set_detail(a),Country.id=a.id?a.id.toString():null),p.province&&(n=p.province,Province.set_detail(n),c=n.name,Province.id=n.id?n.id.toString():null),p.city&&(s=(r=p.city).name,City.set_detail(r),City.id=r.id?r.id.toString():null),$(u).val(p.city.country_id?p.city.country_id:"").trigger("change"),t.value=`City Center (${s}, ${c})`;let _=d&&""!==d.value?d.value:null,m=l&&""!==l.value?l.value:null,g=o&&""!==o.value?o.value:null,h=i&&""!==i.value?i.value:null;p.name=_,p.street_1=g,p.street_2=h,p.zipcode=m}})},I=function(){l.value="",a.value="",$(u).val("").trigger("change")},E=function(){o.value="",i.value="",l.value="",n.value="",d.value="",r.value="",I()},w=function(){let e,t=buildMapsURL(ProductLocation.detail),a=null,n=document.getElementById("locationMap");n&&($(n).empty().append($("<iframe/>",{id:"locationMapContainer",allowfullscreen:"allowfullscreen",frameborder:"0",src:t})),(e=isNaN(parseInt($(n).actual("width")))?null:parseInt($(n).actual("width")))&&(a=e/2,$("#locationMapContainer").css({height:a+"px",width:e+"px"})))},C=function(e){},k=function(t){if(m&&(E(),t)){let a,s,c={};ProductLocation.detail=t,ProductLocation.display_long=t.display_long,ProductLocation.display_medium=t.display_medium,ProductLocation.display_short=t.display_short;let p="",_=t.name?t.name:null,m=isNaN(parseInt(t.id))?null:parseInt(t.id),g=t.postal_code?t.postal_code:"",h=t.street_1?t.street_1:"",f=t.street_2?t.street_2:"";e.value=m,o.value=h,i.value=f,l.value=g,n.value="",d.value=_,$(r).val(t.type.id.toString()),t.country&&(a=t.country,Country.set_detail(a),Country.id=a.id?a.id.toString():null),t.province&&(s=t.province,Province.set_detail(s),Province.id=s.id?s.id.toString():null),t.city&&(c=t.city,City.set_detail(c),City.id=c.id?c.id.toString():null),ProductLocation.detail.name=t.name?t.name:null,p=c.name+" ("+s.name+", "+a.name+")",n.value=p,$(u).val(a.id?a.id:"").trigger("change"),w()}},S=function(){if($(m).valid()){let t,a,n,s,c,u,p;s=""!==d.value?d.value:null,c=""!==o.value?o.value:null,u=""!==i.value?i.value:null,a=isNaN(parseInt(_.value))?null:parseInt(_.value),p=""!==l.value?l.value:null,t=isNaN(parseInt(e.value))?null:parseInt(e.value),n=isNaN(parseInt(r.value))?null:parseInt(r.value);let m={product_id:isNaN(parseInt(h.value))?null:parseInt(h.value),category_id:isNaN(parseInt(f.value))?null:parseInt(f.value),id:t,city_id:a,location_types_id:n,name:s,street_1:c,street_2:u,zipcode:p,enabled:1,note:null};return removeNulls(m)}},N=function(e){},B=function(){let e=S();e&&confirmDialog("Would you like to update?",t=>{t&&function(e,t){try{sendPostRequest("/api/v1.0/locations/update",e,function(e,a,n){if(e)return t(e)})}catch(e){N("Error Updating Location")}}(e,function(e){let t;e&&(t=e,e[0]&&(t=e[0])),t&&(Product.detail.location=t,Product.updateDisplay(),toastr.success(`Location ${t.id} has been updated`,"Location Updated"))})})};return{validator:null,detail:{id:null,city_id:null,location_types_id:null,name:null,street_1:null,street_2:null,zipcode:null,enabled:1,date_created:formatDateMySQL(),created_by:y,date_modified:formatDateMySQL(),modified_by:y,note:null,display_long:null,display_medium:null,display_short:null,country:[],province:[],city:[],type:[]},display_long:null,display_medium:null,display_short:null,init:function(e){$(document).ready(function(){!function(e){$(document).ready(function(){let t,n=f&&!isNaN(parseInt(f.value))?parseInt(f.value):null;if(e){if(a.value=e.product.city_id?e.product.city_id:null,1===n&&m&&(a.value=e.product.city_id?e.product.city_id:null,(t=e.product_location?e.product_location:null)&&(validator_init(v),ProductLocation.validator=$(m).validate(),$(u).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(p).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(_).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),b(),k(t))),2===n){let t=e.product.city_id?e.product.city_id:null;a.value=t,e.arriving_location&&e.departing_location&&Airport.init(e)}3===n&&(e.product.city_id&&e.product.city_id,a.value=e.product.city_id?e.product.city_id:null,Car.init(e)),6===n&&m&&(a.value=e.product.city_id?e.product.city_id:null,(t=e.product_location?e.product_location:null)&&(validator_init(v),ProductLocation.validator=$(m).validate(),$(u).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(p).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(_).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),b(),k(t)))}})}(e)})}}}();function ProductSearch(e,t){if(console.groupCollapsed("ProductSearch"),!t||!e)return void console.error("ProductSearch - Missing options.");let a=t&&t.categories?t.categories:new Map,n=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,o=e.id?e.id:"product_search";this.categories=a,this.userId=n,this.element=e,this.baseId=o,this.isInit=!1,this.errorsEvent=$.Event("productsearch.errors"),this.errorsEvent.errors=[],this.isDisabled=!1,this.tabs=[],this.tab_content=[],this.search_results=[],this.global_location_select=!1,this.location_search=null,this.location_button=null,this.location_button_content=null,this.popup_location_title=null,this.popup_location_content=null,this.popup_location_input=null,this.popup_location_close_button=null,this.popup_location_update_button=null,this.location_popup=null,this.popup_location_heading_text=null,this.from_date_button=null,this.from_date_button_content=null,this.from_date_search=null,this.popup_from_date_close_button=null,this.popup_from_date_update_button=null,this.popup_from_date_wrapper=null,this.popup_from_date_button_label=null,this.popup_from_date_button=null,this.popup_from_date_input_label=null,this.popup_from_date_input=null,this.popup_from_date_error=null,this.popup_from_date_title=null,this.from_date_button_label=null,this.popup_from_date_content=null,this.popup_from_date_heading_text=null,this.from_popup=null,this.from_picker=null,this.popup_from_date_button=null,this.to_date_button=null,this.to_date_button_content=null,this.to_date_search=null,this.popup_to_date_close_button=null,this.popup_to_date_update_button=null,this.popup_to_date_wrapper=null,this.popup_to_date_button_label=null,this.popup_to_date_button=null,this.popup_to_date_input_label=null,this.popup_to_date_input=null,this.popup_to_date_error=null,this.popup_to_date_title=null,this.to_date_button_label=null,this.popup_to_date_content=null,this.popup_to_date_heading_text=null,this.to_popup=null,this.to_picker=null,this.popup_to_date_button=null,this.global_name_select=!1,this.name_search=null,this.name_button=null,this.name_button_content=null,this.popup_name_title=null,this.popup_name_content=null,this.popup_name_form=null,this.popup_name_input=null,this.popup_name_close_button=null,this.popup_name_update_button=null,this.name_popup=null,this.popup_name_heading_text=null,this.global_travelers_select=!1,this.travelers_search=null,this.travelers_button=null,this.travelers_button_content=null,this.popup_travelers_title=null,this.popup_travelers_content=null,this.popup_travelers_room_inc=document.createElement("div"),this.popup_travelers_room_dec=document.createElement("div"),this.popup_travelers_room_input=document.createElement("input"),this.popup_travelers_adult_inc=document.createElement("div"),this.popup_travelers_adult_dec=document.createElement("div"),this.popup_travelers_adult_input=document.createElement("input"),this.popup_travelers_child_inc=document.createElement("div"),this.popup_travelers_child_dec=document.createElement("div"),this.popup_travelers_child_input=document.createElement("input"),this.popup_travelers_input=null,this.popup_travelers_close_button=null,this.popup_travelers_update_button=null,this.travelers_popup=null,this.base_tab_row=null,this.name_button_error=buildRow({classes:["text-danger","text-center","w-100"]}),this.location_button_error=buildRow({classes:["text-danger","text-center","w-100"]}),this.travelers_button_error=buildRow({classes:["text-danger","text-center","w-100"]}),this.from_date_button_error=buildRow({classes:["text-danger","text-center","w-100"]}),this.to_date_button_error=buildRow({classes:["text-danger","text-center","w-100"]});let i=buildRow({classes:["card","card-body","transparent","z-depth-0","p-1","m-0","mt-2"]});this.hidden_fields_container=$(i),this.base_search_container=buildRow({classes:["card","card-body","transparent","z-depth-0","p-0","mb-2"]}),this.container=$(e),this.product_search_button_content=null,this.product_search=null,this.product_search_button=null,this.product_search_reset_button_content=null,this.product_search_reset=null,this.product_search_reset_button=null,this.product_search_results_element=document.createElement("ul"),this.product_search_results_filter_element=document.createElement("div"),this.product_name=null,this.product_id=null,this.country_id=null,this.province_id=null,this.city_id=null,this.from_date=null,this.to_date=null,this.category_id=null,this.adult_count=null,this.child_count=null,this.room_count=null,this.settings=$.extend(!0,{regex:/(((19|20)\d\d)\-(0[1-9]|1[0-2])\-((0|1)[0-9]|2[0-9]|3[0-1]))$/,separator_date:"-",pickadate_settings:{format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd",editable:!1,selectYears:!0,selectMonths:!0,container:"#main"},list_settings:{},hidden_elements:{product_name:{id:"product_name",label:"Product Name:"},product_id:{id:"product_id",label:"Product Id:"},category_id:{id:"category_id",label:"Category Id:"},country_id:{id:"country_id",label:"Country Id:"},province_id:{id:"province_id",label:"Province Id:"},city_id:{id:"city_id",label:"City Id:"},from_date:{id:"from_date",label:"From Date:"},to_date:{id:"to_date",label:"To Date:"},adult_count:{id:"adult_count",label:"Adult Count:"},child_count:{id:"child_count",label:"Child Count:"},room_count:{id:"room_count",label:"Room Count:"}},urls:{},messages:{},error:{},tpl:{toggle:"<a><i class='fas fa-sliders-h'></i></a>",heading:"<div class='d-flex justify-content-between'><h5 class=''><span class=''>Tour Route</span></h5></div>",container:"<ul class='list-group route-manager-wrapper'></ul>"}},t),this.init(t),this.setDateTitle(),this.init=this.init.bind(this),this.sort_by_name=null,this.sort_by_price=null,this.sort_by_rating=null,this.filter_by_name=null,this.listCallback=this.listCallback.bind(this),this.closeLocationSearch=this.closeLocationSearch.bind(this),this.closeFromDateSearch=this.closeFromDateSearch.bind(this),this.closeToDateSearch=this.closeToDateSearch.bind(this),this.closeNameSearch=this.closeNameSearch.bind(this),this.closeTravelersSearch=this.closeTravelersSearch.bind(this),this.updateTravelersSearch=this.updateTravelersSearch.bind(this),this.updateLocationSearch=this.updateLocationSearch.bind(this),this.clickOutsideLocationSearch=this.clickOutsideLocationSearch.bind(this),this.clickOutsideFromDateSearch=this.clickOutsideFromDateSearch.bind(this),this.clickOutsideToDateSearch=this.clickOutsideToDateSearch.bind(this),this.clickOutsideNameSearch=this.clickOutsideNameSearch.bind(this),this.clickOutsideTravelersSearch=this.clickOutsideTravelersSearch.bind(this),this.handleDateBlur=this.handleDateBlur.bind(this),this.handleDateKeyDown=this.handleDateKeyDown.bind(this),this.handleDateSelect=this.handleDateSelect.bind(this),this.handleDateKeyUp=this.handleDateKeyUp.bind(this),this.handleDateClear=this.handleDateClear.bind(this),this.executeSearch=this.executeSearch.bind(this),this.updateNameSearch=this.updateNameSearch.bind(this),this.handleError=this.handleError.bind(this),this.resetSearch=this.resetSearch.bind(this),this.generateTravelersSearchContent=this.generateTravelersSearchContent.bind(this),this.popup_travelers_update_button.on("click",this.generateTravelersSearchContent),this.popup_name_update_button.on("click",this.updateNameSearch),this.popup_name_close_button.on("click",this.closeNameSearch),this.popup_location_close_button.on("click",this.closeLocationSearch),this.popup_from_date_close_button.on("click",this.closeFromDateSearch),this.popup_to_date_close_button.on("click",this.closeToDateSearch),this.popup_location_update_button.on("click",this.updateLocationSearch),this.popup_to_date_input.on("keydown",this.handleDateKeyDown),this.popup_to_date_input.on("keyup",this.handleDateKeyUp),this.popup_to_date_input.on("click",this.handleDateSelect),this.popup_to_date_input.on("search",this.handleDateClear),this.popup_to_date_input.on("blur",this.handleDateBlur),this.popup_from_date_input.on("keydown",this.handleDateKeyDown),this.popup_from_date_input.on("keyup",this.handleDateKeyUp),this.popup_from_date_input.on("click",this.handleDateSelect),this.popup_from_date_input.on("search",this.handleDateClear),this.popup_travelers_close_button.on("click",this.updateTravelersSearch),this.popup_travelers_update_button.on("click",this.updateTravelersSearch),this.product_search.on("click",this.executeSearch),this.product_search_reset.on("click",this.resetSearch),this.resetSearch(),console.groupEnd()}ProductSearch.prototype.listCallback=function(){console.groupCollapsed("listCallback"),console.groupEnd()},ProductSearch.prototype.init=function(e){console.groupCollapsed("init");let t=this.categories?Array.from(this.categories.values()):[],a=this;this.isInit=!0,$.each(t,function(e,t){let n=t.name?t.name:null,o=n.toSnakeCase();n.toCamelCase(),n.toUCWords();a.tabs[o]=null,a.tab_content[o]=null}),this.createElements(e),console.groupEnd()},ProductSearch.prototype.assignEvents=function(){console.groupCollapsed("assignEvents");let e=this,t=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null;this.popup_travelers_adult_input.addEventListener("change",function(t){e.handleNumberChange(this)}),this.popup_travelers_adult_input.addEventListener("click",function(t){e.popup_travelers_adult_input.select()}),this.popup_travelers_child_input.addEventListener("change",function(t){e.handleNumberChange(this)}),this.popup_travelers_child_input.addEventListener("click",function(e){this.select()}),this.popup_travelers_room_input.addEventListener("change",function(t){e.handleNumberChange(this)}),this.popup_travelers_room_input.addEventListener("click",function(e){this.select()}),this.popup_travelers_adult_inc.addEventListener("click",function(t){e.numberIncrease(this)}),this.popup_travelers_adult_dec.addEventListener("click",function(t){e.numberDecrease(this)}),this.popup_travelers_child_inc.addEventListener("click",function(t){e.numberIncrease(this)}),this.popup_travelers_child_dec.addEventListener("click",function(t){e.numberDecrease(this)}),this.popup_travelers_room_inc.addEventListener("click",function(t){e.numberIncrease(this)}),this.popup_travelers_room_dec.addEventListener("click",function(t){e.numberDecrease(this)}),this.popup_name_input.on("search",function(){console.groupCollapsed("this.popup_name_input: search"),e.resetNameSearch(),e.global_name_select=!1,console.groupEnd()}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keyup",function(){console.groupCollapsed("this.popup_name_input: keyup"),e.global_name_select=!1,e.product_name.value=e.popup_name_input.val(),console.log("this.global_name_select",e.global_name_select),console.log("this.product_name.value",e.product_name.value),console.groupEnd()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/products",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,params:{category_id:t},paramName:"st",onSelect:function(t){t.data&&e.handleProductNameSelect(t.data[0]?t.data[0]:t.data)}}),this.name_button.popover({html:!0,placement:function(e,t){return $(e).addClass("popover-name"),"auto"},title:e.popup_name_title,content:e.popup_name_content,container:"body"}),this.name_button.on("show.bs.popover",function(){window.addEventListener("click",e.clickOutsideNameSearch)}),this.name_button.on("shown.bs.popover",function(){e.popup_name_input.focus()}),this.name_button.on("hide.bs.popover",function(){""===e.to_date.value&&(e.resetToDateSearch(),e.unSetDateError(e.popup_to_date_input)),window.removeEventListener("click",e.clickOutsideNameSearch)}),this.location_button.popover({container:"body",html:!0,placement:function(e,t){return $(e).addClass("popover-location"),"auto"},title:()=>this.popup_location_title,content:()=>this.popup_location_content}),this.location_button.on("show.bs.popover",function(){window.addEventListener("click",e.clickOutsideLocationSearch)}),this.location_button.on("shown.bs.popover",function(){e.popup_location_input.focus()}),this.location_button.on("hide.bs.popover",function(){window.removeEventListener("click",e.clickOutsideLocationSearch)}),this.travelers_button.popover({container:"body",html:!0,placement:function(e,t){return $(e).addClass("popover-travelers"),"auto"},title:()=>this.popup_travelers_title,content:()=>this.popup_travelers_content}),this.travelers_button.on("show.bs.popover",function(){window.addEventListener("click",e.clickOutsideTravelersSearch)}),this.travelers_button.on("hide.bs.popover",function(){window.removeEventListener("click",e.clickOutsideTravelersSearch)}),this.from_date_button.popover({container:"body",html:!0,placement:function(e,t){return $(e).addClass("popover-from-date"),"auto"},content:()=>this.popup_from_date_content,title:()=>this.popup_from_date_title}),this.from_date_button.on("show.bs.popover",function(){window.addEventListener("click",e.clickOutsideFromDateSearch)}),this.from_date_button.on("shown.bs.popover",function(){e.popup_from_date_input.focus()}),this.from_date_button.on("hide.bs.popover",function(){""===e.from_date.value&&(e.resetFromDateSearch(),e.unSetDateError(e.popup_from_date_input)),window.removeEventListener("click",e.clickOutsideFromDateSearch)}),this.to_date_button.popover({container:"body",html:!0,placement:function(e,t){return $(e).addClass("popover-to-date"),"auto"},title:()=>this.popup_to_date_title,content:()=>this.popup_to_date_content}),this.to_date_button.on("show.bs.popover",function(){window.addEventListener("click",e.clickOutsideToDateSearch)}),this.to_date_button.on("shown.bs.popover",function(){e.popup_to_date_input.focus()}),this.to_date_button.on("hide.bs.popover",function(){""===e.to_date.value&&(e.resetToDateSearch(),e.unSetDateError(e.popup_to_date_input)),window.removeEventListener("click",e.clickOutsideToDateSearch)}),this.popup_location_input.on("search",function(){e.resetLocationSearch()}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keypress",function(){e.resetLocationSearch()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/location_search",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(t){if(!t.data)return;let a,n,o,i,l,r,d,s,c="",u="",p="",_=t.data[0]?t.data[0]:t.data,m=_&&_.country?_.country:null,g=_&&_.province?_.province:null,h=_&&_.city?_.city:null,f=m&&m.id&&!isNaN(parseInt(m.id))?parseInt(m.id):null,v=g&&g.id&&!isNaN(parseInt(g.id))?parseInt(g.id):null,y=h&&h.id&&!isNaN(parseInt(h.id))?parseInt(h.id):null,b=m&&m.name?m.name:null,I=g&&g.name?g.name:null,E=h&&h.name?h.name:null,$=m&&m.iso2?m.iso2:null,w=g&&g.iso2?g.iso2:null,C=m&&m.iso3?m.iso3:null,k=g&&g.iso3?g.iso3:null,S=null;i=w||(k||(I||null)),a=null!==C?C:null!==b?b:null!==$?$:null,c=null!==(d=E||null)&&null!==i&&null!==a?`${d} (${i} - ${a})`:null===d&&null!==i&&null!==a?`${i} - ${a}`:`${a}`,u=`${s=E||null} (${l=I||(w||(k||null))} - ${n=b||null})`,p=`${S=E||null} (${r=I||(k||(w||null))} - ${o=null!==b?b:null!==C?C:null!==$?$:null})`,e.global_location_select=!0,e.country_id.value=null!==f?f:"",e.province_id.value=null!==v?v:"",e.city_id.value=null!==y?y:"",e.location_button_content.html(c),e.location_button.addClass("active")}}),this.popup_from_date_button=$(".input_from").pickadate(this.settings.pickadate_settings),this.popup_to_date_button=$(".input_to").pickadate(this.settings.pickadate_settings),this.from_picker=this.popup_from_date_button.pickadate("picker"),this.to_picker=this.popup_to_date_button.pickadate("picker"),this.to_picker.on({open:function(e){},close:function(e){$(document.activeElement).blur()},set:function(t){let a,n,o,i,l=e.from_picker.get("select"),r=e.to_picker.get("select");if(t.update){let t=e.popup_to_date_input.val();""===t?e.to_picker.clear():(e.to_picker.clear(),e.to_picker.set("select",t))}else if(t.select){if(r){let t=new Date(r.year,r.month,r.date);n=r.year,o=r.month,i=r.date,o&&!isNaN(parseInt(o))&&(o+=1,parseInt(o)<10&&(o="0"+o)),i&&!isNaN(parseInt(i))&&parseInt(i)<10&&(i="0"+i),a=moment(t,"YYYY-MM-DD").format("YYYY-MM-DD"),l?(e.from_picker.set("min",e.from_picker.get("select")),e.from_picker.set("max",e.to_picker.get("select")),e.to_picker.set("min",e.from_picker.get("select")),e.to_picker.set("max",e.to_picker.get("select"))):(e.from_picker.set("min",!1),e.from_picker.set("max",e.to_picker.get("select")),e.to_picker.set("min",e.to_picker.get("select")),e.to_picker.set("max",e.to_picker.get("select"))),e.updateToDateSearch(a)}}else"clear"in t&&e.updateToDateSearch()}}),this.from_picker.on({open:function(t){e.popup_from_date_button.val()},close:function(e){$(document.activeElement).blur()},set:function(t){if(t.update){let t=e.popup_from_date_input.val();""===t?e.from_picker.clear():e.to_picker.get("select")&&e.from_picker.set("select",t),e.to_picker.get("select"),e.from_picker.clear(),e.from_picker.set("select",t)}else if(t.select){let t,a,n,o,i,l,r,d,s,c,u,p,_=e.from_picker.get("select"),m=e.to_picker.get("select");if(_){let a=new Date(_.year,_.month,_.date);t=moment(a,"YYYY-MM-DD").format("YYYY-MM-DD"),n=moment(a,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD"),o=moment(a,"YYYY-MM-DD").subtract(1,"days").format("YYYY-MM-DD"),r=_.year,d=_.month,(s=_.date)&&!isNaN(parseInt(s))&&parseInt(s)<10&&(s="0"+s),d&&!isNaN(parseInt(d))&&(d+=1,parseInt(d)<10&&(d="0"+d)),e.updateFromDateSearch(t)}if(m)c=m.year,u=m.month,(p=m.date)&&!isNaN(parseInt(p))&&parseInt(p)<10&&(p="0"+p),u&&!isNaN(parseInt(u))&&(u+=1,parseInt(d)<10&&(u="0"+u)),a=moment(c+"-"+u+"-"+p,"YYYY-MM-DD").format("YYYY-MM-DD"),i=moment(c+"-"+u+"-"+p,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD"),l=moment(c+"-"+u+"-"+p,"YYYY-MM-DD").subtract(1,"days").format("YYYY-MM-DD");else{let t=moment(_).add(1,"day");e.to_picker.set("min",t),e.to_picker.set("max",!1)}n&&(e.from_picker.set("max",n),e.to_picker.set("min",n))}else"clear"in t&&(e.to_picker.clear(),e.from_picker.set("min",!1),e.from_picker.set("max",!1),e.to_picker.set("min",!1),e.to_picker.set("max",!1),e.resetToDateSearch(),e.resetFromDateSearch())}}),this.from_picker.get("value")&&e.to_picker.set("min",e.from_picker.get("select")),$('a[data-toggle="tab"]').on("shown.bs.tab",function(t){let a=t.target.dataset.categoryId&&!isNaN(parseInt(t.target.dataset.categoryId))?parseInt(t.target.dataset.categoryId):null;e.handleTabChange(a)});let a=document.createElement("li"),n=document.createElement("ul");a.classList.add("product-search-list-item"),a.classList.add("list-group-item"),a.classList.add("border-0"),n.classList.add("product-search-list-item"),a.appendChild(n),this.sort_by_name.addEventListener("click",function(t){console.groupCollapsed("sortByName:click(e)");t.target;console.log("e",t),console.log("e.target",t.target),console.log("e.target.classList",t.target.classList),console.log("e",t),$(e.sort_by_name).removeClass("asc"),$(e.sort_by_name).removeClass("desc"),$(e.sort_by_price).removeClass("asc"),$(e.sort_by_price).removeClass("desc"),console.groupEnd()}),this.sort_by_price.addEventListener("click",function(t){console.groupCollapsed("sortByPrice:click(e)"),console.log("$(_this.sort_by_name)",$(e.sort_by_name)),console.log("$(_this.sort_by_rating)",$(e.sort_by_rating)),console.log("$(_this.sort_by_price)",$(e.sort_by_price)),$(e.sort_by_name).removeClass("asc"),$(e.sort_by_name).removeClass("desc"),$(e.sort_by_rating).removeClass("asc"),$(e.sort_by_rating).removeClass("desc"),console.groupEnd()}),this.sort_by_rating.addEventListener("click",function(t){$(e.sort_by_name).removeClass("asc"),$(e.sort_by_name).removeClass("desc"),$(e.sort_by_price).removeClass("asc"),$(e.sort_by_price).removeClass("desc")}),this.search_results=new List("product-search-list",{valueNames:["name","address","rating","pricing",{data:["id"]},{name:"image",attr:"src"},{name:"viewLink",data:["id"]}],item:'\n\t\t\t<li class="list-group-item border-0" data-id="">\n\n\t\t\t\t<div class="card p-0 m-0 mb-1">\n\n\t\t\t\t\t<div class="row">\n\t\n\t\t\t\t\t\t<div class="col-12 col-md-3 col-xl-3">\n\t\t\t\t\t\t\t<img src="" alt="thumbnail" class="img-thumbnail m-1 image" />\n\t\t\t\t\t\t\t<ul class="rating mb-1 w-100" ></ul>\n\t\t\t\t\t\t</div>\n\t\t\n\t\t\t\t\t\t<div class="col-12 col-md-5 col-xl-7">\n\t\t\t\t\t\t\t<h5 class="font-weight-bold dark-grey-text mb-2 name"></h5>\n\t\t\t\t\t\t\t<address class="m-0 p-0 address"></address>\n\t\t\t\t\t\t\t<p class="averageprice"></p>\n\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t<div class="col-12 col-md-4 col-xl-2">\n\n\t\t\t\t\t\t\t<div class="text-right h-100 w-100">\n\t\t\t\t\t\t\t\t<a type="button" class="btn-floating deep-purple m-1" data-method="view" onclick="listCallBack(this)"><i class="fas fa-eye" aria-hidden="true"></i></a>\n\t\t\t\t\t\t\t\t<a type="button" class="btn-floating indigo m-1" data-method="edit" onclick="listCallBack(this)"><i class="fas fa-edit" aria-hidden="true"></i></a>\n\t\t\t\t\t\t\t\t<a type="button" class="btn-floating cyan m-1" data-method="add" onclick="listCallBack(this)"><i class="fas fa-plus" aria-hidden="true"></i></a>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<hr class="ml-3 mr-3 mt-2 mb-2 color-dark">\n\n\t\t\t\t\t<div class="w-100 mb-2 pricing" ></div>\n\n\t\t\t\t</div>\n\n\t\t\t</li>\n\t\t\t'}),console.groupEnd()},ProductSearch.prototype.handleSortClick=function(e){console.groupCollapsed("handleSortClick"),console.groupEnd()},ProductSearch.prototype.handleError=function(e,t,a){console.groupCollapsed("handleError"),e||(e="Product Search Error"),t||(t="Product Search"),a||(a="error"),toastr[a](`${e}`,t),console.groupEnd()},ProductSearch.prototype.handleNumberChange=function(e){console.groupCollapsed("handleNumberChange"),console.log("el",e);let t,a=this,n=e&&e.dataset&&e.dataset.direction?e.dataset.direction:null,o=e&&e.dataset&&e.dataset.type?e.dataset.type:null,i=e,l=0;switch(l=isNaN(parseInt(i.value))?0:parseInt(i.value),o){case"adult":t=i.min?parseInt(i.min):1,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.adult_count.value=l;break;case"child":t=i.min?parseInt(i.min):0,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.child_count.value=l;break;case"room":t=i.min?parseInt(i.min):1,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.room_count.value=l;break;default:console.log("default"),console.log("el",e),console.log("el.dataset",e.dataset),console.log("input",i),console.log("direction",n),console.log("type",o)}this.generateTravelersSearchContent(),console.groupEnd()},ProductSearch.prototype.handleTabChange=function(e){switch(console.groupCollapsed("handleTabChange"),e&&!isNaN(parseInt(e))||(e=null),this.category_id.value=e,this.clearBaseSearchFields(),e){case 1:$("[data-hotel-search='true']").show();break;case 2:$("[data-flight-search='true']").show();break;case 3:$("[data-car-search='true']").show();break;case 4:$("[data-rail-search='true']").show();break;case 5:$("[data-transport-search='true']").show();break;case 6:$("[data-tour-search='true']").show();break;case 7:$("[data-cruise-search='true']").show();break;case 8:$("[data-package-search='true']").show();break;case 9:$("[data-other-search='true']").show()}this.setDateTitle(),console.groupEnd()},ProductSearch.prototype.handleDateClear=function(e){console.groupCollapsed("handleDateClear");let t=e&&e.target&&e.target.dataset&&e.target.dataset.type?e.target.dataset.type:null;"from_date"===t?this.updateFromDateSearch():"to_date"===t&&this.updateToDateSearch(),console.groupEnd()},ProductSearch.prototype.handleDateBlur=function(e){console.groupCollapsed("handleDateBlur");e&&e.target&&e.target.dataset&&e.target.dataset.type&&e.target.dataset.type;console.groupEnd()},ProductSearch.prototype.handleDateChange=function(e){console.groupCollapsed("handleDateChange");let t=e&&e.target&&e.target.dataset&&e.target.dataset.type?e.target.dataset.type:null;"from_date"===t?this.updateFromDateSearch():"to_date"===t&&this.updateToDateSearch(),console.groupEnd()},ProductSearch.prototype.handleDateKeyUp=function(e){console.groupCollapsed("handleDateKeyUp");let t,a,n=e&&e.target&&e.target.dataset&&e.target.dataset.type?e.target.dataset.type:null;"from_date"===n?t=this.popup_from_date_input[0]:"to_date"===n&&(t=this.popup_to_date_input[0]),""===(a=t.value)?this.unSetDateError($(t)):this.validateDateFormat(t,e.keyCode),console.groupEnd()},ProductSearch.prototype.handleDateSelect=function(e){console.groupCollapsed("handleDateSelect");const t=e.target.selectionStart;t<5?e.target.setSelectionRange(0,4):t>=5&&t<8?e.target.setSelectionRange(5,7):t>=8&&t<11?e.target.setSelectionRange(8,10):e.target.setSelectionRange(0,e.target.value.length),console.groupEnd()},ProductSearch.prototype.handleProductNameSelect=function(e){console.groupCollapsed("handleProductNameSelect"),this.global_name_select=!0,this.name_button_content.html(e&&e.name?e.name:""),this.product_name.value=e&&e.name?e.name:"",this.product_id.value=e&&!isNaN(parseInt(e.id))?parseInt(e.id):"",this.name_button.addClass("active"),console.groupEnd()},ProductSearch.prototype.handleDateKeyDown=function(e){console.groupCollapsed("handleDateKeyDown");let t,a=e&&e.target&&e.target.dataset&&e.target.dataset.type?e.target.dataset.type:null;return"from_date"===a?t=this.popup_from_date_input[0]:"to_date"===a&&(t=this.popup_to_date_input[0]),e.keyCode,e.stopPropagation(),console.groupEnd(),n=t,o=e.keyCode,isNaN(parseInt(o))||(o=parseInt(o)),16===o&&(isShift=!0),(o>=48&&o<=57||o>=96&&o<=105||8===o||46===o)&&16!==o&&(4!==n.value.length&&7!==n.value.length||8===o||(n.value+="-"),!0);var n,o},ProductSearch.prototype.numberIncrease=function(e){console.groupCollapsed("numberIncrease"),console.log("el",e);let t,a=this,n=e&&e.dataset&&e.dataset.direction?e.dataset.direction:null,o=e&&e.dataset&&e.dataset.type?e.dataset.type:null,i=e.parentNode.querySelector("input[type=number]"),l=0;if(!i||!o||!n)return console.error("Missing Input"),console.log("input",i),console.log("direction",n),void console.log("type",o);switch(i.stepUp(),l=i.value,o){case"adult":t=i.min?parseInt(i.min):1,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.adult_count.value=l;break;case"child":t=i.min?parseInt(i.min):0,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.child_count.value=l;break;case"room":t=i.min?parseInt(i.min):1,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.room_count.value=l;break;default:console.log("default"),console.log("el",e),console.log("el.dataset",e.dataset),console.log("input",i),console.log("direction",n),console.log("type",o)}this.generateTravelersSearchContent(),console.groupEnd()},ProductSearch.prototype.numberDecrease=function(e){console.groupCollapsed("numberDecrease"),console.log("el",e);let t,a=this,n=e&&e.dataset&&e.dataset.direction?e.dataset.direction:null,o=e&&e.dataset&&e.dataset.type?e.dataset.type:null,i=e.parentNode.querySelector("input[type=number]"),l=0;if(!i||!o||!n)return console.error("Missing Input"),console.log("input",i),console.log("direction",n),void console.log("type",o);switch(i.stepDown(),l=isNaN(parseInt(i.value))?0:parseInt(i.value),o){case"adult":t=i.min?parseInt(i.min):1,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.adult_count.value=l;break;case"child":t=i.min?parseInt(i.min):0,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.child_count.value=l;break;case"room":t=i.min?parseInt(i.min):1,l=isNaN(parseInt(i.value))?t:parseInt(i.value)<t?parseInt(t):parseInt(i.value),a.room_count.value=l;break;default:console.log("default"),console.log("el",e),console.log("el.dataset",e.dataset),console.log("input",i),console.log("direction",n),console.log("type",o)}this.generateTravelersSearchContent(),console.groupEnd()},ProductSearch.prototype.createElements=function(e){console.groupCollapsed("createElements"),this.createHiddenFields(e),this.hidden_fields_container=$(this.hidden_fields_container),this.room_count.value=1,this.adult_count.value=1,this.child_count.value=0,this.createTabRow(e),this.createSearchElements(e),this.renderSearchElements(e),this.createSearchResultsBlock(),this.renderSearchResultsBlock(),this.popup_name_input=$(this.popup_name_input),this.popup_name_close_button=$(this.popup_name_close_button),this.popup_name_update_button=$(this.popup_name_update_button),this.popup_location_input=$(this.popup_location_input),this.popup_location_close_button=$(this.popup_location_close_button),this.popup_location_update_button=$(this.popup_location_update_button),this.popup_from_date_input=$(this.popup_from_date_input),this.popup_from_date_close_button=$(this.popup_from_date_close_button),this.popup_to_date_close_button=$(this.popup_to_date_close_button),this.popup_to_date_input=$(this.popup_to_date_input),this.product_search=$(this.product_search),this.product_search_reset=$(this.product_search_reset),this.travelers_search=$(this.travelers_search),this.popup_travelers_input=$(this.popup_travelers_input),this.popup_travelers_close_button=$(this.popup_travelers_close_button),this.popup_travelers_update_button=$(this.popup_travelers_update_button),this.assignEvents(e),console.groupEnd()},ProductSearch.prototype.createHiddenFields=function(){console.groupCollapsed("createHiddenFields");let e=this,t=this&&this.settings&&this.settings.hidden_elements?this.settings.hidden_elements:[],a=buildRow({classes:["row"]});console.groupCollapsed("hiddenElements"),$.each(t,function(t,n){a.appendChild(e.buildHiddenField(n))}),console.groupEnd(),this.hidden_fields_container.append(a),console.groupEnd()},ProductSearch.prototype.createTabRow=function(e){console.groupCollapsed("createTabRow",e);let t=this,a=0,n=this.categories?Array.from(this.categories.values()):[],o=$('<ul class="nav nav-justified tabs-primary" role="tablist"/>'),i=($('<div class="card"/>'),$("<div class='classic-tabs mx-0'/>")),l=$("<div class='tab-content card p-1'/>");console.groupCollapsed("categories"),$.each(n,function(e,n){0===a&&(t.category_id.value=n.id),o.append(function(e){if(console.groupCollapsed("buildTab"),!e||!e.id||!e.name)return void console.error("Missing category");let n=e.id?e.id:null,o=e.name?e.name:"",i=e.icon?e.icon:"",l=o.toSnakeCase(),r=(o.toCamelCase(),o.toUCWords()),d=t.baseId+"_panel_"+l,s=t.baseId+"_tab_"+l,c=t.baseId+"_link_"+l,u=0===a?"active show":"",p=0===a?"true":"false",_=$(`<li id="${s}" class="nav-item"/>`),m=`<a class="nav-link ${u}" id="${c}" data-toggle="tab" data-category-id="${n}" href="#${d}" role="tab" aria-controls="${d}" aria-selected="${p}"><i class="${i}"></i><br/>${r}</a>`;return t.tabs[l]=_,_.append(m),console.groupEnd(),_}(n)),l.append(function(e){if(console.groupCollapsed("buildContainer"),!e||!e.id||!e.name)return void console.error("Missing category");let n=e.id?e.id:null,o=e.name?e.name:"",i=(e.icon&&e.icon,o.toSnakeCase()),l=(o.toCamelCase(),o.toUCWords()),r=t.baseId+"_panel_"+i,d=t.baseId+"_link_"+i,s=$(`<div class="tab-pane fade ${0===a?"active show":""}" id="${r}" role="tabpanel" aria-labelledby="${d}"/>`),c=$(`<div class="card-body p-0 m-0" data-category-id="${n}" />`),u=$(`<h5 class="card-title"><span>${l}</span></h5>`),p=$('<div class="p-1"/>');return c.append(u),c.append(p),s.append(c),t.tab_content[i]=p[0],console.groupEnd(),s}(n)),a++}),console.groupEnd(),i.append(o),i.append(this.base_search_container),i.append(l),this.base_tab_row=o,this.container.append(i),console.groupEnd()},ProductSearch.prototype.createSearchElements=function(e){console.groupCollapsed("createSearchElements");this.createSearchElementsName(e),this.createSearchElementsLocation(e),this.createSearchElementsTravelers(e),this.createSearchElementsFromDate(e),this.createSearchElementsToDate(e),this.buildPopoverForm({type:"name",form_title:"Name",classes:"name-popover d-none",popover_content:this.popup_name_content,popover_title:this.popup_name_title}),this.buildPopoverForm({id:"popover_location_form",type:"location",classes:"d-none location-popover",form_title:"Going To",popover_content:this.popup_location_content,popover_title:this.popup_location_title}),this.buildPopoverForm({type:"from_date",form_title:"Check In",classes:"from-date-popover d-none",popover_content:this.popup_from_date_content,popover_title:this.popup_from_date_title}),this.buildPopoverForm({type:"to_date",form_title:"Check Out",classes:"to-date-popover d-none",popover_content:this.popup_to_date_content,popover_title:this.popup_to_date_title}),this.buildPopoverForm({type:"travelers",form_title:"Travelers",classes:"travelers-popover d-none",popover_content:this.popup_travelers_content,popover_title:this.popup_travelers_title}),this.location_search=this.buildLocationSearchButton(e),this.name_search=this.buildNameSearchButton(e),this.from_date_search=this.buildFromDateSearchButton(e),this.to_date_search=this.buildToDateSearchButton(e),this.travelers_search=this.buildTravelersSearchButton(e),this.product_search=this.buildProductSearchButton(e),this.product_search_reset=this.buildProductSearchResetButton(e),console.groupEnd()},ProductSearch.prototype.executeSearch=function(){console.groupCollapsed("executeSearch"),this.search_results.clear(),this.buildSearchCriteria(),console.groupEnd()},ProductSearch.prototype.resetSearch=function(){console.groupCollapsed("resetSearch"),this.resetNameSearch(),this.resetLocationSearch(),this.resetFromDateSearch(),this.resetToDateSearch(),this.resetTravelersSearch(),this.clearAllErrors(),this.resetSearchResultsBlock(),this.search_results.clear(),this.popup_name_input.val(""),this.popup_location_input.val(""),this.global_location_select=!1,this.global_name_select=!1,console.groupEnd()},ProductSearch.prototype.populateSearchResultsBlock=function(e){console.groupCollapsed("populateSearchResultsBlock"),console.log("results",e),console.groupEnd()},ProductSearch.prototype.resetSearchResultsBlock=function(){console.groupCollapsed("resetSearchResultsBlock"),this.clearSearchResultsBlock(),console.groupEnd()},ProductSearch.prototype.clearSearchResultsBlock=function(){console.groupCollapsed("clearSearchResultsBlock"),console.groupEnd()},ProductSearch.prototype.createSearchResultsBlock=function(){console.groupCollapsed("createSearchResultsBlock");let e=buildRow({classes:"card card-body"}),t=buildRow({classes:["row","mx-1"]}),a=buildColumn({classes:["col-12","col-sm-3","px-1"]}),n=buildColumn({classes:["col-12","col-sm-3","px-1"]}),o=buildColumn({classes:["col-12","col-sm-3","px-1"]}),i=buildColumn({classes:["col-12","col-sm-3","px-1"]}),l=document.createElement("div"),r=buildRow({classes:["row","mx-1"]}),d=buildColumn({classes:["col-12","col-md-4","col-lg-3","col-xl-2","px-1"]}),s=buildColumn({classes:["col-12","col-md-8","col-lg-9","col-xl-10","px-1"]});this.sort_by_name=document.createElement("button"),this.sort_by_price=document.createElement("button"),this.sort_by_rating=document.createElement("button"),this.filter_by_name=document.createElement("input"),this.product_search_results_element=document.createElement("ul"),this.product_search_results_element.classList.add("list"),this.product_search_results_element.setAttribute("id","product_search_form-container"),this.sort_by_name.classList.add("btn"),this.sort_by_name.classList.add("btn-outline-primary"),this.sort_by_name.classList.add("btn-sm"),this.sort_by_name.classList.add("waves-effect"),this.sort_by_name.classList.add("waves-light"),this.sort_by_name.classList.add("sort"),this.sort_by_name.setAttribute("data-sort","name"),this.sort_by_name.innerText="Sort by Name",this.sort_by_price.classList.add("btn"),this.sort_by_price.classList.add("btn-outline-primary"),this.sort_by_price.classList.add("btn-sm"),this.sort_by_price.classList.add("waves-effect"),this.sort_by_price.classList.add("waves-light"),this.sort_by_name.setAttribute("data-sort","averageprice"),this.sort_by_price.innerText="Sort by Price",this.sort_by_rating.classList.add("btn"),this.sort_by_rating.classList.add("btn-outline-primary"),this.sort_by_rating.classList.add("btn-sm"),this.sort_by_rating.classList.add("waves-effect"),this.sort_by_rating.classList.add("waves-light"),this.sort_by_name.setAttribute("data-sort","rating"),this.sort_by_rating.innerText="Sort by Rating",this.filter_by_name.setAttribute("type","search"),this.filter_by_name.setAttribute("placeholder","search"),this.filter_by_name.classList.add("form-control"),this.filter_by_name.classList.add("fuzzy-search"),a.appendChild(this.filter_by_name),n.appendChild(this.sort_by_name),o.appendChild(this.sort_by_price),i.appendChild(this.sort_by_rating),t.appendChild(a),t.appendChild(n),t.appendChild(o),t.appendChild(i),l.setAttribute("id","product-search-list"),l.appendChild(t),l.appendChild(this.product_search_results_element),s.appendChild(l),r.appendChild(d),r.appendChild(s),e.appendChild(r),this.search_results_wrapper=e,this.product_search_results_element=$(this.product_search_results_element),console.groupEnd()},ProductSearch.prototype.renderSearchResultsBlock=function(){console.groupCollapsed("renderSearchResultsBlock"),this.container.append(this.search_results_wrapper),console.groupEnd()},ProductSearch.prototype.buildHiddenField=function(e){if(console.groupCollapsed("buildHiddenField"),!e)return;let t=e&&e.id?this.baseId+e.id:null,a=e&&e.label?e.label:"Element:",n=buildColumn({classes:["col-sm-3"]}),o=document.createElement("input"),i=document.createElement("label");return o.setAttribute("type","hidden"),o.setAttribute("readonly","readonly"),o.setAttribute("id",t),o.setAttribute("name",t),o.classList.add("form-control"),o.classList.add("dev-element"),this[e.id]=o,i.setAttribute("for",this.baseId+"-city-id"),i.classList.add("dev-element"),i.classList.add("d-none"),i.innerText=a,n.appendChild(i),n.appendChild(o),console.groupEnd(),n},ProductSearch.prototype.buildPopoverForm=function(e){console.groupCollapsed("buildPopoverForm"),console.log("options",e);let t=e&&e.type?e.type:null,a=e&&e.type?"popover-"+e.type+"-body":null,n=e&&e.popover_title?e.popover_title:document.createElement("h3"),o=document.createElement("div"),i=document.createElement("div"),l=e&&e.classes?e.classes:["d-none"],r=e&&e.id?e.id:"popover-"+t+"-form";Array.isArray(l)||(l=l.split(" ")),console.log("popoverForm",o),console.groupCollapsed("classes"),console.log("classes",l),$.each(l,function(e,t){null!==t&&""!==t&&(console.log("className",t),o.classList.add(t))}),console.groupEnd(),o.setAttribute("id",r),i.classList.add("popover-body"),i.classList.add(a),i.appendChild(e&&e.popover_content?e.popover_content:document.createElement("div")),o.appendChild(n),o.appendChild(i),this[e.name]&&(this[e.name]=o),document.body.appendChild(o),this.popup_name_form=$(o),console.groupEnd()},ProductSearch.prototype.validateDateFormat=function(e,t){console.groupCollapsed("validateDateFormat");let a,n,o,i,l=e.dataset&&e.dataset.type?e.dataset.type:null,r=e&&null!==e.value?e.value:"",d=!1;if(16===t&&(d=!0),this.settings.regex.test(r)||0===r.length){if(this.unSetDateError(e),e&&$(e).attr("id")&&("from_date"===l?a=this.from_picker:"to_date"===l?a=this.to_picker:this.loadError(e,"Oops"),n=isNaN(parseInt(r.substring(0,4)))?null:parseInt(r.substring(0,4)),o=isNaN(parseInt(r.substring(5,7)))?null:parseInt(r.substring(5,7))-1,i=isNaN(parseInt(r.substring(8,10)))?null:parseInt(r.substring(8,10)),null!==n&&null!==o&&null!==i)){let e=new Date(n,o,i,0,0,0);a.set("update",{date:moment(e,"YYYY-MM-DD").format("YYYY-MM-DD")})}}else this.loadError(e),"from_date"===l?(this.from_date.value="",this.from_date_button_content.html(""),this.from_date_button.removeClass("active")):"to_date"===l&&(this.to_date.value="",this.to_date_button_content.html(""),this.to_date_button.removeClass("active"));console.groupEnd()},ProductSearch.prototype.unSetDateError=function(e){console.groupCollapsed("unSetDateError"),$(e).parents("div.form-element").find("div.error").html("").hide(),console.groupEnd()},ProductSearch.prototype.loadError=function(e,t){console.groupCollapsed("unSetDateError(input)",e);let a=t||"Invalid Date. Only YYYY-MM-DD format allowed.";$(e).parents("div.form-element").find("div.error").html(a).show(),console.groupEnd()},ProductSearch.prototype.setDateTitle=function(){console.groupCollapsed("setDateTitle");let e,t,a,n,o,i=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null;1===i?(e="Check In",t="Check Out",a="City",n="Name",o="Travelers"):2===i?(e="Date Departing",t="Date Arriving",a="City",n="Name",o="Travelers"):3===i?(e="From Date",t="To Date",a="City",n="Name",o="Travelers"):4===i?(e="Date Departing",t="Date Arriving",a="City",n="Name",o="Travelers"):5===i?(e="From Date",t="To Date",a="City",n="Name",o="Travelers"):6===i?(e="From Date",t="To Date",a="City",n="Name",o="Travelers"):7===i?(e="Date Departing",t="Date Arriving",a="City",n="Name",o="Travelers"):8===i?(e="From Date",t="To Date",a="City",n="Name",o="Travelers"):9===i?(e="From Date",t="To Date",a="City",n="Name",o="Travelers"):(e="Else From",t="Else To",a="City",n="Name",o="Travelers"),this.popup_to_date_heading_text.innerHTML=t,this.to_date_button_label.innerHTML=t,this.popup_from_date_heading_text.innerHTML=e,this.from_date_button_label.innerHTML=e,this.popup_location_heading_text.innerText=a,console.groupEnd()},ProductSearch.prototype.clearBaseSearchFields=function(){console.groupCollapsed("clearBaseSearchFields"),$("[data-hotel-search='true']").hide(),$("[data-flight-search='true']").hide(),$("[data-car-search='true']").hide(),$("[data-rail-search='true']").hide(),$("[data-transport-search='true']").hide(),$("[data-tour-search='true']").hide(),$("[data-cruise-search='true']").hide(),$("[data-package-search='true']").hide(),$("[data-other-search='true']").hide(),console.groupEnd()},ProductSearch.prototype.unSelectDateError=function(e){console.groupCollapsed("unSelectDateError"),$(e).parents("div.form-element").find("div.error").html("").hide(),console.groupEnd()},ProductSearch.prototype.renderSearchElements=function(){console.groupCollapsed("renderSearchElements");let e=buildRow({classes:"searchbar"});e.appendChild(this.name_search),e.appendChild(this.location_search),e.appendChild(this.travelers_search),e.appendChild(this.from_date_search),e.appendChild(this.to_date_search),e.appendChild(this.product_search),e.appendChild(this.product_search_reset),this.base_search_container.appendChild(e),this.container.append(this.hidden_fields_container),console.groupEnd()},ProductSearch.prototype.buildProductSearchButton=function(){console.groupCollapsed("buildProductSearchButton");let e=document.createElement("i"),t=document.createElement("span"),a=document.createElement("div"),n=document.createElement("button"),o=document.createElement("div");return o.classList.add("col-12"),o.classList.add("col-md-2"),o.classList.add("col-lg-2"),o.classList.add("col-xl-2"),o.classList.add("px-1"),o.classList.add("mx-0"),o.classList.add("mb-2"),o.dataset.hotelSearch="true",o.dataset.flightSearch="true",o.dataset.carSearch="true",o.dataset.railSearch="true",o.dataset.transportSearch="true",o.dataset.tourSearch="true",o.dataset.cruiseSearch="true",o.dataset.packageSearch="true",o.dataset.otherSearch="true",n.classList.add("btn"),n.classList.add("btn-outline-primary"),n.classList.add("btn-rounded"),n.classList.add("btn-block"),n.classList.add("m-0"),n.classList.add("px-2"),n.classList.add("d-fleox"),n.classList.add("justify-content-around"),n.classList.add("align-items-center"),n.classList.add("white"),n.classList.add("waves-effect"),n.classList.add("z-depth-0"),n.setAttribute("type","button"),n.dataset.hotelSearch="true",n.dataset.flightSearch="true",n.dataset.carSearch="true",n.dataset.railSearch="true",n.dataset.transportSearch="true",n.dataset.tourSearch="true",n.dataset.cruiseSearch="true",n.dataset.packageSearch="true",n.dataset.otherSearch="true",this.product_search_button=$(n),e.classList.add("fas"),e.classList.add("fa-search"),e.classList.add("mr-2"),e.classList.add("btn-product-search-picker-icon"),t.classList.add("btn-product-search-picker-label"),t.innerHTML="Search",a.classList.add("btn-product-search-content"),n.appendChild(e),n.appendChild(t),o.appendChild(n),this.product_search_button_content=$(a),console.groupEnd(),o},ProductSearch.prototype.buildProductSearchResetButton=function(){console.groupCollapsed("buildProductSearchResetButton");let e=document.createElement("i"),t=document.createElement("span"),a=document.createElement("div"),n=document.createElement("button"),o=document.createElement("div");return o.classList.add("col-12"),o.classList.add("col-md-2"),o.classList.add("col-lg-2"),o.classList.add("col-xl-2"),o.classList.add("px-1"),o.classList.add("mx-0"),o.classList.add("mb-2"),o.dataset.hotelSearch="true",o.dataset.flightSearch="true",o.dataset.carSearch="true",o.dataset.railSearch="true",o.dataset.transportSearch="true",o.dataset.tourSearch="true",o.dataset.cruiseSearch="true",o.dataset.packageSearch="true",o.dataset.otherSearch="true",n.classList.add("btn"),n.classList.add("btn-outline-secondary"),n.classList.add("btn-rounded"),n.classList.add("btn-block"),n.classList.add("m-0"),n.classList.add("px-2"),n.classList.add("d-fleox"),n.classList.add("justify-content-around"),n.classList.add("align-items-center"),n.classList.add("white"),n.classList.add("waves-effect"),n.classList.add("z-depth-0"),n.setAttribute("type","button"),n.dataset.hotelSearch="true",n.dataset.flightSearch="true",n.dataset.carSearch="true",n.dataset.railSearch="true",n.dataset.transportSearch="true",n.dataset.tourSearch="true",n.dataset.cruiseSearch="true",n.dataset.packageSearch="true",n.dataset.otherSearch="true",e.classList.add("fas"),e.classList.add("fa-eraser"),e.classList.add("mr-2"),e.classList.add("btn-product-search-reset-picker-icon"),t.classList.add("btn-product-search-reset-picker-label"),t.innerHTML="Reset",a.classList.add("btn-product-search-content"),n.appendChild(e),n.appendChild(t),o.appendChild(n),this.product_search_reset_button=$(n),console.groupEnd(),o},ProductSearch.prototype.clearAllErrors=function(){console.groupCollapsed("clearAllErrors"),this.unLoadError("name"),this.unLoadError("location"),this.unLoadError("travelers"),this.unLoadError("from-date"),this.unLoadError("to-date"),console.groupEnd()},ProductSearch.prototype.loadError=function(e,t){console.groupCollapsed("loadError");let a=t&&""!==t?t:"Field Invalid";if(e)switch(e){case"name":this.name_button.addClass("is-invalid"),this.name_button_error.html(a);break;case"location":this.location_button.addClass("is-invalid"),this.location_button_error.html(a);break;case"travelers":this.travelers_button.addClass("is-invalid"),this.travelers_button_error.html(a);break;case"from-date":this.from_date_button.addClass("is-invalid"),this.from_date_button_error.html(a);break;case"to-date":this.to_date_button.addClass("is-invalid"),this.to_date_button_error.html(a);break;default:console.log("Default")}console.groupEnd()},ProductSearch.prototype.unLoadError=function(e){if(console.groupCollapsed("unLoadError"),e)switch(e){case"name":this.name_button.removeClass("is-invalid"),this.name_button_error.html("&nbsp;");break;case"location":this.location_button.removeClass("is-invalid"),this.location_button_error.html("&nbsp;");break;case"travelers":this.travelers_button.removeClass("is-invalid"),this.travelers_button_error.html("&nbsp;");break;case"from-date":this.from_date_button.removeClass("is-invalid"),this.from_date_button_error.html("&nbsp;");break;case"to-date":this.to_date_button.removeClass("is-invalid"),this.to_date_button_error.html("&nbsp;")}console.groupEnd()},ProductSearch.prototype.buildSearchCriteria=function(){console.groupCollapsed("buildSearchCriteria");let e=[],t=this,a=this.product_name&&this.product_name.value?this.product_name.value:null,n=this.from_date&&this.from_date.value?this.from_date.value:null,o=this.to_date&&this.to_date.value?this.to_date.value:null,i=this.product_id&&!isNaN(parseInt(this.product_id.value))?parseInt(this.product_id.value):null,l=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null,r=this.country_id&&!isNaN(parseInt(this.country_id.value))?parseInt(this.country_id.value):null,d=this.province_id&&!isNaN(parseInt(this.province_id.value))?parseInt(this.province_id.value):null,s=this.city_id&&!isNaN(parseInt(this.city_id.value))?parseInt(this.city_id.value):null,c=this.adult_count&&!isNaN(parseInt(this.adult_count.value))?parseInt(this.adult_count.value):null,u=this.child_count&&!isNaN(parseInt(this.child_count.value))?parseInt(this.child_count.value):null,p=this.room_count&&!isNaN(parseInt(this.room_count.value))?parseInt(this.room_count.value):null;switch(this.clearAllErrors(),l){case 1:break;case 2:console.log("Flights");break;case 3:console.log("Cars");break;case 4:console.log("Rails");break;case 5:console.log("Transports");break;case 6:console.log("Tours");break;case 7:console.log("Cruises");break;case 8:console.log("Packages");break;case 9:console.log("Other");break;default:console.log("Default")}e.length>0?$.each(e,function(e,a){let n=a.el,o=a.message;t.loadError(n,o)}):this.sendSearchRequest(removeNulls({product_name:a,product_id:i,from_date:n,to_date:o,category_id:l,country_id:r,province_id:d,city_id:s,adult_count:c,child_count:u,room_count:p}),function(e){e&&e.length>0&&$.each(e,function(e,a){t.renderSearchRequestResults(a)})}),console.groupEnd()},ProductSearch.prototype.sendSearchRequest=function(e,t){console.groupCollapsed("sendSearchRequest");let a=this,n="/api/v1.0/search";switch(this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null){case 1:console.log("Hotels"),n+="/hotels";break;case 2:console.log("Flights"),n+="/flights";break;case 3:console.log("Cars"),n+="/cars";break;case 4:console.log("Rails"),n+="/rails";break;case 5:console.log("Transports"),n+="/transports";break;case 6:console.log("Tours"),n+="/tours";break;case 7:console.log("Cruises"),n+="/cruises";break;case 8:console.log("Packages"),n+="/packages";break;case 9:console.log("Other"),n+="/other";break;default:console.log("Default"),n+=""}if(e)try{sendGetRequest(n,e,function(e){return e&&e.length>0?t(e):(e=testData,t(e))})}catch(e){return console.log("error",e),a.handleError("Error Retrieving Images.","Image Manager","error")}console.groupEnd()},ProductSearch.prototype.renderSearchRequestResultFilters=function(e){console.groupCollapsed("renderSearchRequestResultFilters");let t=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null;console.log("categoryId",t),console.log("product",e),console.groupEnd()},ProductSearch.prototype.renderSearchRequestResults=function(e){console.groupCollapsed("renderSearchRequestResults");let t,a,n,o,i,l,r,d="",s=null,c="",u=0;this.renderSearchRequestResultFilters(e);e&&(t=e.address?e.address:null,a=e.name?e.name:null,s=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,o=e.rating&&!isNaN(parseInt(e.rating))?parseInt(e.rating):5,d=e.sku?e.sku:null,n=e.units?e.units:[]),$.each(n,function(e,t){let a=t&&t.name?t.name:null,n=t&&!isNaN(parseInt(t.id))?parseInt(t.id):0,o=function(e){let t,a=e&&e.dates?e.dates:[];return u=0,i=0,l=0,t='\n\t\t\t\t<div class="table-responsive text-nowrap">\n\t\t\t\t\t<div class="d-flex flex-nowrap">\n\t\t\t',$.each(a,function(e,a){let n=a.date?moment(a.date).format("MM/DD/YYYY"):null,o=a.price&&!isNaN(parseInt(a.price))?parseInt(a.price):0,d=a.cost&&!isNaN(parseInt(a.cost))?parseInt(a.cost):0;a.margin&&!isNaN(parseInt(a.margin))&&parseInt(a.margin),l+=d,r=i+=o,t+=`\n\t\t\t\t\t\t<div class="col-pricing">\n\t\t\t\t\t\t\t<div class="price">${o}</div>\n\t\t\t\t\t\t\t<div class="date">${n}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t`,u++}),t+="\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t",console.groupEnd(),t}(t),d="collapseUnit"+s+"-"+n;c+=`\n\t\t\t\t\t\n\t\t\t\t\t<div class="p-2" role="tab" id="headingOne1">\n\t\t\t\t\t\n\t\t\t\t\t\t<a data-toggle="collapse" href="#${d}" class="unit_collapse_header" aria-expanded="false" aria-controls="${d}">\n\t\t\t\t\t\n\t\t\t\t\t\t\t<div class="row">\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class="col-12 col-md-9">\n\t\t\t\t\t\t\t\t\t<h5 class="mb-0">\n\t\t\t\t\t\t\t\t\t  ${a}\n\t\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class="col-12 col-md-2">\n\t\t\t\t\t\t\t\t\t<h5 class="mb-0">\n\t\t\t\t\t\t\t\t\t    ${i}\n\t\t\t\t\t\t\t\t\t</h5>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class="col-12 col-md-1">\n\t\t\t\t\t\t\t\t\t<i class="fas fa-angle-down rotate-icon"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div id="${d}" class="collapse" >\n\t\t\t\t\t\t${o}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<hr class="ml-3 mr-3 mt-2 mb-2 color-dark"/>\n\n\t\t\t`,u++}),this.search_results.add({id:s,name:a,address:t,rating:function(e){console.groupCollapsed("buildRating"),console.log("rating",e);let t="";e=e&&!isNaN(parseInt(e))?parseInt(e):1;for(let a=0;a<e;a++)t+="<li><i class='fas fa-star yellow-text'></i></li>";return console.groupEnd(),t}(o),pricing:c,averageprice:"43.54",image:"/public/thumbs/placeholder.jpg"}),console.groupEnd()},ProductSearch.prototype.createSearchElementsLocation=function(e){console.groupCollapsed("createSearchElementsLocation");let t=this.baseId+"_location_form",a=e&&e.form_title?e.form_title:"Going To",n="formProductSearchLocation",o=a;this.popup_location_title=document.createElement("h5");let i=document.createElement("span");this.popup_location_close_button=document.createElement("a"),this.popup_location_update_button=document.createElement("button"),this.popup_location_heading_text=document.createElement("span");let l=document.createElement("label"),r=document.createElement("i"),d=document.createElement("div");this.popup_location_input=document.createElement("input");let s=document.createElement("div"),c=buildRow({classes:["row","mb-2"]}),u=buildRow({classes:["row","mb-2"]}),p=buildColumn({classes:["col-3"]}),_=buildColumn({classes:["col-9"]}),m=buildColumn({classes:["col-12"]}),g=document.createElement("form");this.popup_location_content=document.createElement("div"),this.popup_location_title.classList.add("popover-location-heading"),this.popup_location_title.classList.add("w-100"),this.popup_location_title.innerHTML=`${a}`,i.classList.add("cPZwQ"),i.innerHTML=`${a}`,this.popup_location_close_button.setAttribute("href","javascript:void(0);"),this.popup_location_close_button.setAttribute("aria-hidden","true"),this.popup_location_close_button.classList.add("popup-window-button-close"),this.popup_location_close_button.classList.add("fas"),this.popup_location_close_button.classList.add("fa-times"),this.popup_location_content.classList.add("w-100"),this.popup_location_content.classList.add("popover-location-body"),g.setAttribute("id",t),g.setAttribute("novalidate","novalidate"),g.classList.add("form-inline"),this.popup_location_update_button.setAttribute("id",n+"Submit"),this.popup_location_update_button.setAttribute("name",n+"Submit"),this.popup_location_update_button.innerText="update",this.popup_location_update_button.classList.add("btn"),this.popup_location_update_button.classList.add("popover-location-submit"),this.popup_location_update_button.classList.add("btn-sm"),this.popup_location_update_button.classList.add("btn-block"),this.popup_location_heading_text.innerText=o,l.setAttribute("id",n+"-label"),l.classList.add("form-label-popover"),l.classList.add("d-flex"),l.classList.add("justify-content-start"),l.classList.add("align-items-center"),l.setAttribute("for",n),s.setAttribute("type","search"),s.setAttribute("id",n+"-error"),s.classList.add("error"),s.classList.add("w-100"),s.classList.add("text-center"),this.popup_location_input.setAttribute("type","search"),this.popup_location_input.setAttribute("id",n),this.popup_location_input.setAttribute("name",n),this.popup_location_input.classList.add("form-control"),this.popup_location_input.classList.add("w-100"),r.classList.add("fas"),r.classList.add("fa-map-marker-alt"),r.classList.add("mr-3"),d.setAttribute("id",n+"-wrap"),d.classList.add("form-element"),l.appendChild(r),l.appendChild(this.popup_location_heading_text),d.appendChild(this.popup_location_input),d.appendChild(s),p.appendChild(l),_.appendChild(d),c.appendChild(p),c.appendChild(_),m.appendChild(this.popup_location_update_button),u.appendChild(m),this.popup_location_content.appendChild(c),this.popup_location_content.appendChild(u),g.appendChild(this.popup_location_content),this.popup_location_title.appendChild(this.popup_location_close_button),console.groupEnd()},ProductSearch.prototype.buildLocationSearchButton=function(){console.groupCollapsed("buildLocationSearchButton");let e=document.createElement("i"),t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("button"),o=document.createElement("div");return o.classList.add("col-12"),o.classList.add("col-md-6"),o.classList.add("col-lg-4"),o.classList.add("px-1"),o.classList.add("mx-0"),o.classList.add("mb-2"),o.dataset.hotelSearch="true",o.dataset.flightSearch="false",o.dataset.carSearch="true",o.dataset.railSearch="false",o.dataset.transportSearch="true",o.dataset.tourSearch="true",o.dataset.cruiseSearch="true",o.dataset.packageSearch="false",o.dataset.otherSearch="true",n.classList.add("btn"),n.classList.add("btn-search-bar"),n.classList.add("btn-location-picker"),n.setAttribute("type","button"),n.dataset.hotelSearch="true",n.dataset.flightSearch="false",n.dataset.carSearch="true",n.dataset.railSearch="false",n.dataset.transportSearch="true",n.dataset.tourSearch="true",n.dataset.cruiseSearch="true",n.dataset.packageSearch="false",n.dataset.otherSearch="true",e.classList.add("fas"),e.classList.add("fa-map-marker-alt"),e.classList.add("btn-location-picker-icon"),t.classList.add("picker-label"),t.classList.add("btn-location-picker-label"),t.innerHTML="Going To",a.classList.add("picker-content"),a.classList.add("btn-location-picker-content"),n.appendChild(e),n.appendChild(t),n.appendChild(a),o.appendChild(n),o.appendChild(this.location_button_error),this.location_button=$(n),this.location_button_error=$(this.location_button_error),this.location_button_content=$(a),console.groupEnd(),o},ProductSearch.prototype.clickOutsideLocationSearch=function(e){console.groupCollapsed("clickOutsideLocationSearch");$(e.target).parents("div.popover")[0]||e.target.className.includes("btn-location-picker")||(this.updateLocationSearch(),this.closeLocationSearch()),console.groupEnd()},ProductSearch.prototype.closeLocationSearch=function(){console.groupCollapsed("closeLocationSearch"),this.location_button&&this.location_button.popover("hide"),console.groupEnd()},ProductSearch.prototype.resetLocationSearch=function(){console.groupCollapsed("resetLocationSearch"),this.country_id.value="",this.province_id.value="",this.city_id.value="",this.location_button_content.html(""),this.location_button.removeClass("active"),this.global_location_select=!1,console.groupEnd()},ProductSearch.prototype.updateLocationSearch=function(){console.groupCollapsed("updateLocationSearch"),this.closeLocationSearch(),console.groupEnd()},ProductSearch.prototype.createSearchElementsFromDate=function(e){console.groupCollapsed("createSearchElementsFromDate",e);let t=this.baseId+"_from_date_form",a=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null;this.popup_from_date_title=document.createElement("h5"),this.popup_from_date_heading_text=document.createElement("span"),this.popup_from_date_close_button=document.createElement("a");let n=document.createElement("form");this.popup_from_date_content=document.createElement("div");let o,i=this.baseId+"_input_from-wrapper",l=this.baseId+"_input_from",r=this.baseId+"_input_from-label",d=this.baseId+"_from_date",s=this.baseId+"_from_date-label",c=this.baseId+"_from_date-error",u=document.createElement("div");o=1===a?"Check In":2===a?"Date Departing":3===a?"From Date":4===a?"Date Departing":5===a?"From Date":6===a?"From Date":7===a?"Check In":8===a?"Date Departing":9===a?"From Date":"Else",u.classList.add("input-group-append"),this.popup_from_date_wrapper=document.createElement("div"),this.popup_from_date_button_label=document.createElement("label"),this.popup_from_date_button=document.createElement("button"),this.popup_from_date_input_label=document.createElement("label"),this.popup_from_date_input=document.createElement("input"),this.popup_from_date_error=document.createElement("div"),this.popup_from_date_wrapper.setAttribute("id",i),this.popup_from_date_wrapper.classList.add("form-element"),this.popup_from_date_wrapper.classList.add("input-group"),this.popup_from_date_button_label.setAttribute("id",r),this.popup_from_date_button_label.classList.add("d-none"),this.popup_from_date_button_label.innerText="From:",this.popup_from_date_button.setAttribute("type","button"),this.popup_from_date_button.setAttribute("id",l),this.popup_from_date_button.setAttribute("name",l),this.popup_from_date_button.classList.add("input_from"),this.popup_from_date_button.classList.add("btn"),this.popup_from_date_button.classList.add("btn-md"),this.popup_from_date_button.classList.add("btn-outline-input-from"),this.popup_from_date_button.classList.add("m-0"),this.popup_from_date_button.classList.add("px-3"),this.popup_from_date_button.classList.add("py-2"),this.popup_from_date_button.classList.add("z-depth-0"),this.popup_from_date_button.classList.add("waves-effect"),this.popup_from_date_button.classList.add("waves-light"),this.popup_from_date_button.setAttribute("tab-index","-1"),this.popup_from_date_button.innerHTML='<i class="fas fa-calendar-day"></i>',u.appendChild(this.popup_from_date_button),this.popup_from_date_input_label.setAttribute("id",s),this.popup_from_date_input_label.classList.add("d-none"),this.popup_from_date_input_label.innerText="From:",this.popup_from_date_input.setAttribute("type","search"),this.popup_from_date_input.setAttribute("id",d),this.popup_from_date_input.setAttribute("name",d),this.popup_from_date_input.classList.add("form-control"),this.popup_from_date_input.classList.add("w-100"),this.popup_from_date_input.setAttribute("maxlength","10"),this.popup_from_date_input.setAttribute("placeholder","From Date"),this.popup_from_date_input.dataset.type="from_date",this.popup_from_date_error.setAttribute("id",c),this.popup_from_date_error.classList.add("error"),this.popup_from_date_error.classList.add("w-100"),this.popup_from_date_error.classList.add("text-center"),this.popup_from_date_wrapper.appendChild(this.popup_from_date_button_label),this.popup_from_date_wrapper.appendChild(this.popup_from_date_input_label),this.popup_from_date_wrapper.appendChild(this.popup_from_date_input),this.popup_from_date_wrapper.appendChild(u),this.popup_from_date_wrapper.appendChild(this.popup_from_date_error),this.popup_from_date_title.classList.add("popover-from-date-heading"),this.popup_from_date_title.classList.add("w-100"),this.popup_from_date_title.innerHTML=`${o}`,this.popup_from_date_heading_text.classList.add("cPZwQ"),this.popup_from_date_heading_text.innerHTML=o,this.popup_from_date_close_button.setAttribute("href","javascript:void(0);"),this.popup_from_date_close_button.setAttribute("aria-hidden","true"),this.popup_from_date_close_button.classList.add("popup-window-button-close"),this.popup_from_date_close_button.classList.add("fas"),this.popup_from_date_close_button.classList.add("fa-times"),this.popup_from_date_content.classList.add("w-100"),this.popup_from_date_content.classList.add("popover-from-date-body"),this.popup_from_date_content.appendChild(this.popup_from_date_wrapper),n.setAttribute("id",t),n.setAttribute("novalidate","novalidate"),n.classList.add("form-inline"),n.appendChild(this.popup_from_date_content),this.popup_from_date_title.appendChild(this.popup_from_date_close_button),console.groupEnd()},ProductSearch.prototype.buildFromDateSearchButton=function(e){console.groupCollapsed("buildFromDateSearchButton",e);let t,a=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null,n=document.createElement("div"),o=document.createElement("button"),i=document.createElement("i"),l=document.createElement("div");return t=1===a?"Check In":2===a?"Date Departing":3===a?"From Date":4===a?"Date Departing":5===a?"From Date":6===a?"From Date":7===a?"Check In":8===a?"Date Departing":9===a?"From Date":"Else",n.classList.add("col-6"),n.classList.add("col-md-3"),n.classList.add("col-lg-2"),n.classList.add("col-xl-2"),n.classList.add("px-1"),n.classList.add("mx-0"),n.classList.add("mb-2"),n.dataset.hotelSearch="true",n.dataset.flightSearch="true",n.dataset.carSearch="true",n.dataset.railSearch="true",n.dataset.transportSearch="true",n.dataset.tourSearch="true",n.dataset.cruiseSearch="true",n.dataset.packageSearch="true",n.dataset.otherSearch="false",o.classList.add("btn"),o.classList.add("btn-search-bar"),o.classList.add("btn-from-date-picker"),o.setAttribute("type","button"),o.dataset.hotelSearch="true",o.dataset.flightSearch="true",o.dataset.carSearch="true",o.dataset.railSearch="true",o.dataset.transportSearch="true",o.dataset.tourSearch="true",o.dataset.cruiseSearch="true",o.dataset.packageSearch="true",o.dataset.otherSearch="false",i.classList.add("fas"),i.classList.add("fa-calendar-day"),i.classList.add("btn-from-date-picker-icon"),this.from_date_button_label=document.createElement("div"),this.from_date_button_label.classList.add("picker-label"),this.from_date_button_label.classList.add("btn-from-date-picker-label"),this.from_date_button_label.innerHTML=`${t}`,l.classList.add("picker-content"),l.classList.add("btn-from-date-picker-content"),o.appendChild(i),o.appendChild(this.from_date_button_label),o.appendChild(l),n.appendChild(o),n.appendChild(this.from_date_button_error),this.from_date_button=$(o),this.from_date_button_error=$(this.from_date_button_error),this.from_date_button_content=$(l),console.groupEnd(),n},ProductSearch.prototype.handleFromPickerOpen=function(e){console.groupCollapsed("handleFromPickerOpen"),console.groupEnd()},ProductSearch.prototype.handleFromPickerClose=function(e){console.groupCollapsed("handleFromPickerClose");this.popup_from_date_button.val();console.groupEnd()},ProductSearch.prototype.handleFromPickerSet=function(e){console.groupCollapsed("handleFromPickerSet"),console.groupEnd()},ProductSearch.prototype.clickOutsideFromDateSearch=function(e){console.groupCollapsed("clickOutsideFromDateSearch");$(e.target).parents("div.popover")[0]||e.target.className.includes("btn-from-date-picker")||this.closeFromDateSearch(),console.groupEnd()},ProductSearch.prototype.closeFromDateSearch=function(){console.groupCollapsed("closeFromDateSearch"),this.from_date_button&&this.from_date_button.popover("hide"),console.groupEnd()},ProductSearch.prototype.resetFromDateSearch=function(){console.groupCollapsed("resetFromDateSearch"),this.popup_from_date_input.val(""),this.from_date.value="",this.from_date_button_content.html(""),this.from_date_button.removeClass("active"),this.from_picker.set("min",!1),this.from_picker.set("max",!!this.to_picker.get("select")&&this.to_picker.get("select")),console.groupEnd()},ProductSearch.prototype.updateFromDateSearch=function(e){console.groupCollapsed("updateFromDateSearch"),e?(this.from_date.value=e,this.popup_from_date_input.val(e),this.from_date_button_content.html(e),this.from_date_button.addClass("active")):this.resetFromDateSearch(),console.groupEnd()},ProductSearch.prototype.createSearchElementsToDate=function(e){console.groupCollapsed("createSearchElementsToDate");let t=this.baseId+"_to_date_form",a=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null;this.popup_to_date_title=document.createElement("h5"),this.popup_to_date_heading_text=document.createElement("span"),this.popup_to_date_close_button=document.createElement("a");let n=document.createElement("form");this.popup_to_date_content=document.createElement("div");let o,i=this.baseId+"_input_to-wrapper",l=this.baseId+"_input_to",r=this.baseId+"_input_to-label",d=this.baseId+"_to_date",s=this.baseId+"_to_date-label",c=this.baseId+"_to_date-error",u=document.createElement("div");o=1===a?"Check Out":2===a?"Date Arriving":3===a?"To Date":4===a?"Date Arriving":5===a?"To Date":6===a?"To Date":7===a?"Check Out":8===a?"Date Arriving":9===a?"To Date":"Else",u.classList.add("input-group-append"),this.popup_to_date_wrapper=document.createElement("div"),this.popup_to_date_button_label=document.createElement("label"),this.popup_to_date_button=document.createElement("button"),this.popup_to_date_input_label=document.createElement("label"),this.popup_to_date_input=document.createElement("input"),this.popup_to_date_error=document.createElement("div"),this.popup_to_date_wrapper.setAttribute("id",i),this.popup_to_date_wrapper.classList.add("form-element"),this.popup_to_date_wrapper.classList.add("input-group"),this.popup_to_date_button_label.setAttribute("id",r),this.popup_to_date_button_label.classList.add("d-none"),this.popup_to_date_button_label.innerText="To:",this.popup_to_date_button.setAttribute("type","button"),this.popup_to_date_button.setAttribute("id",l),this.popup_to_date_button.setAttribute("name",l),this.popup_to_date_button.classList.add("input_to"),this.popup_to_date_button.classList.add("btn"),this.popup_to_date_button.classList.add("btn-md"),this.popup_to_date_button.classList.add("btn-outline-input-to"),this.popup_to_date_button.classList.add("m-0"),this.popup_to_date_button.classList.add("px-3"),this.popup_to_date_button.classList.add("py-2"),this.popup_to_date_button.classList.add("z-depth-0"),this.popup_to_date_button.classList.add("waves-effect"),this.popup_to_date_button.classList.add("waves-light"),this.popup_to_date_button.setAttribute("tab-index","-1"),this.popup_to_date_button.innerHTML='<i class="fas fa-calendar-day"></i>',u.appendChild(this.popup_to_date_button),this.popup_to_date_input_label.setAttribute("id",s),this.popup_to_date_input_label.classList.add("d-none"),this.popup_to_date_input_label.innerText="To:",this.popup_to_date_input.setAttribute("type","search"),this.popup_to_date_input.setAttribute("id",d),this.popup_to_date_input.setAttribute("name",d),this.popup_to_date_input.classList.add("form-control"),this.popup_to_date_input.classList.add("w-100"),this.popup_to_date_input.setAttribute("maxlength","10"),this.popup_to_date_input.setAttribute("placeholder","To Date"),this.popup_to_date_input.dataset.type="to_date",this.popup_to_date_error.setAttribute("id",c),this.popup_to_date_error.classList.add("error"),this.popup_to_date_error.classList.add("w-100"),this.popup_to_date_error.classList.add("text-center"),this.popup_to_date_wrapper.appendChild(this.popup_to_date_button_label),this.popup_to_date_wrapper.appendChild(this.popup_to_date_input_label),this.popup_to_date_wrapper.appendChild(this.popup_to_date_input),this.popup_to_date_wrapper.appendChild(u),this.popup_to_date_wrapper.appendChild(this.popup_to_date_error),this.popup_to_date_title.classList.add("popover-to-date-heading"),this.popup_to_date_title.classList.add("w-100"),this.popup_to_date_title.innerHTML=`${o}`,this.popup_to_date_heading_text.classList.add("cPZwQ"),this.popup_to_date_heading_text.innerHTML=o,this.popup_to_date_close_button.setAttribute("href","javascript:void(0);"),this.popup_to_date_close_button.setAttribute("aria-hidden","true"),this.popup_to_date_close_button.classList.add("popup-window-button-close"),this.popup_to_date_close_button.classList.add("fas"),this.popup_to_date_close_button.classList.add("fa-times"),this.popup_to_date_content.classList.add("w-100"),this.popup_to_date_content.classList.add("popover-to-date-body"),this.popup_to_date_content.appendChild(this.popup_to_date_wrapper),n.setAttribute("id",t),n.setAttribute("novalidate","novalidate"),n.classList.add("form-inline"),n.appendChild(this.popup_to_date_content),this.popup_to_date_title.appendChild(this.popup_to_date_close_button),console.groupEnd()},ProductSearch.prototype.buildToDateSearchButton=function(e){console.groupCollapsed("buildToDateSearchButton",e);let t,a=this.category_id&&!isNaN(parseInt(this.category_id.value))?parseInt(this.category_id.value):null,n=document.createElement("div"),o=document.createElement("button"),i=document.createElement("i"),l=document.createElement("div");return t=1===a?"Check Out":2===a?"Date Arriving":3===a?"To Date":4===a?"Date Arriving":5===a?"To Date":6===a?"To Date":7===a?"Check In":8===a?"Date Arriving":9===a?"To Date":"Else",n.classList.add("col-6"),n.classList.add("col-md-3"),n.classList.add("col-lg-2"),n.classList.add("col-xl-2"),n.classList.add("px-1"),n.classList.add("mx-0"),n.classList.add("mb-2"),n.dataset.hotelSearch="true",n.dataset.flightSearch="true",n.dataset.carSearch="true",n.dataset.railSearch="true",n.dataset.transportSearch="true",n.dataset.tourSearch="false",n.dataset.cruiseSearch="true",n.dataset.packageSearch="true",n.dataset.otherSearch="false",o.classList.add("btn"),o.classList.add("btn-search-bar"),o.classList.add("btn-to-date-picker"),o.setAttribute("type","button"),o.dataset.hotelSearch="true",o.dataset.flightSearch="true",o.dataset.carSearch="true",o.dataset.railSearch="true",o.dataset.transportSearch="true",o.dataset.tourSearch="false",o.dataset.cruiseSearch="true",o.dataset.packageSearch="true",o.dataset.otherSearch="false",i.classList.add("fas"),i.classList.add("fa-calendar-day"),i.classList.add("btn-to-date-picker-icon"),this.to_date_button_label=document.createElement("div"),this.to_date_button_label.classList.add("picker-label"),this.to_date_button_label.classList.add("btn-to-date-picker-label"),this.to_date_button_label.innerHTML=`${t}`,l.classList.add("picker-content"),l.classList.add("btn-to-date-picker-content"),o.appendChild(i),o.appendChild(this.to_date_button_label),o.appendChild(l),n.appendChild(o),n.appendChild(this.to_date_button_error),this.to_date_button=$(o),this.to_date_button_error=$(this.to_date_button_error),this.to_date_button_content=$(l),console.groupEnd(),n},ProductSearch.prototype.handleToPickerOpen=function(e){console.groupCollapsed("handleToPickerOpen"),console.groupEnd()},ProductSearch.prototype.handleToPickerClose=function(e){console.groupCollapsed("handleToPickerClose");this.popup_to_date_button.val();console.groupEnd()},ProductSearch.prototype.handleToPickerSet=function(e){console.groupCollapsed("handleToPickerSet"),console.groupEnd()},ProductSearch.prototype.clickOutsideToDateSearch=function(e){console.groupCollapsed("clickOutsideToDateSearch");$(e.target).parents("div.popover")[0]||e.target.className.includes("btn-to-date-picker")||this.closeToDateSearch(),console.groupEnd()},ProductSearch.prototype.closeToDateSearch=function(){console.groupCollapsed("closeToDateSearch"),this.to_date_button&&this.to_date_button.popover("hide"),console.groupEnd()},ProductSearch.prototype.resetToDateSearch=function(){console.groupCollapsed("resetToDateSearch"),this.popup_to_date_input.val(""),this.to_date.value="",this.to_date_button_content.html(""),this.to_date_button.removeClass("active"),this.from_picker.set("max",!1),this.to_picker.set("max",!1),this.to_picker.set("min",!!this.from_picker.get("select")&&this.from_picker.get("select")),console.groupEnd()},ProductSearch.prototype.updateToDateSearch=function(e){console.groupCollapsed("updateToDateSearch"),e?(this.to_date.value=e,this.popup_to_date_input.val(e),this.to_date_button_content.html(e),this.to_date_button.addClass("active")):this.resetToDateSearch(),console.groupEnd()},ProductSearch.prototype.createSearchElementsName=function(e){console.groupCollapsed("createSearchElementsName");let t=this.baseId+"_name_form",a=e&&e.form_title?e.form_title:"Name",n="formProductSearchName",o=a;this.popup_name_title=document.createElement("h5"),this.popup_name_close_button=document.createElement("a"),this.popup_name_update_button=document.createElement("button"),this.popup_name_heading_text=document.createElement("span");let i=document.createElement("label"),l=document.createElement("i"),r=document.createElement("div");this.popup_name_input=document.createElement("input");let d=document.createElement("div"),s=buildRow({classes:["row","mb-2"]}),c=buildRow({classes:["row","mb-2"]}),u=buildColumn({classes:["col-3"]}),p=buildColumn({classes:["col-9"]}),_=buildColumn({classes:["col-12"]}),m=document.createElement("form");this.popup_name_content=document.createElement("div"),this.popup_name_title.classList.add("popover-name-heading"),this.popup_name_title.classList.add("w-100"),this.popup_name_title.innerHTML=`${a}`,this.popup_name_close_button.setAttribute("href","javascript:void(0);"),this.popup_name_close_button.setAttribute("aria-hidden","true"),this.popup_name_close_button.classList.add("popup-window-button-close"),this.popup_name_close_button.classList.add("fas"),this.popup_name_close_button.classList.add("fa-times"),this.popup_name_content.classList.add("popover-name-body"),this.popup_name_content.classList.add("w-100"),m.setAttribute("id",t),m.setAttribute("novalidate","novalidate"),m.classList.add("form-inline"),this.popup_name_update_button.setAttribute("id",n+"Submit"),this.popup_name_update_button.setAttribute("name",n+"Submit"),this.popup_name_update_button.innerText="update",this.popup_name_update_button.classList.add("btn"),this.popup_name_update_button.classList.add("popover-name-submit"),this.popup_name_update_button.classList.add("btn-sm"),this.popup_name_update_button.classList.add("btn-block"),this.popup_name_heading_text.innerText=o,i.setAttribute("id",n+"-label"),i.classList.add("form-label-popover"),i.classList.add("d-flex"),i.classList.add("justify-content-start"),i.classList.add("align-items-center"),i.setAttribute("for",n),d.setAttribute("id",n+"-error"),d.classList.add("error"),d.classList.add("w-100"),d.classList.add("text-center"),this.popup_name_input.setAttribute("type","search"),this.popup_name_input.setAttribute("id",n),this.popup_name_input.setAttribute("name",n),this.popup_name_input.classList.add("form-control"),this.popup_name_input.classList.add("w-100"),l.classList.add("fas"),l.classList.add("fa-map-marker-alt"),l.classList.add("mr-3"),r.setAttribute("id",n+"-wrap"),r.classList.add("form-element"),i.appendChild(l),i.appendChild(this.popup_name_heading_text),r.appendChild(this.popup_name_input),r.appendChild(d),u.appendChild(i),p.appendChild(r),s.appendChild(u),s.appendChild(p),_.appendChild(this.popup_name_update_button),c.appendChild(_),this.popup_name_content.appendChild(s),this.popup_name_content.appendChild(c),m.appendChild(this.popup_name_content),this.popup_name_title.appendChild(this.popup_name_close_button),console.groupEnd()},ProductSearch.prototype.buildNameSearchButton=function(){console.groupCollapsed("buildNameSearchButton");let e=document.createElement("i"),t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("button"),o=document.createElement("div");return o.classList.add("col-12"),o.classList.add("col-md-6"),o.classList.add("col-lg-4"),o.classList.add("px-1"),o.classList.add("mx-0"),o.classList.add("mb-2"),n.setAttribute("type","button"),o.dataset.hotelSearch="true",o.dataset.flightSearch="true",o.dataset.carSearch="true",o.dataset.railSearch="true",o.dataset.transportSearch="true",o.dataset.tourSearch="true",o.dataset.cruiseSearch="true",o.dataset.packageSearch="true",o.dataset.otherSearch="false",n.classList.add("btn"),n.classList.add("btn-search-bar"),n.classList.add("btn-name-picker"),n.dataset.hotelSearch="true",n.dataset.flightSearch="true",n.dataset.carSearch="true",n.dataset.railSearch="true",n.dataset.transportSearch="true",n.dataset.tourSearch="true",n.dataset.cruiseSearch="true",n.dataset.packageSearch="true",n.dataset.otherSearch="false",e.classList.add("fas"),e.classList.add("fa-atlas"),e.classList.add("btn-name-picker-icon"),t.classList.add("picker-label"),t.classList.add("btn-name-picker-label"),t.innerHTML="Name",a.classList.add("picker-content"),a.classList.add("btn-name-picker-content"),n.appendChild(e),n.appendChild(t),n.appendChild(a),o.appendChild(n),o.appendChild(this.name_button_error),this.name_button=$(n),this.name_button_error=$(this.name_button_error),this.name_button_content=$(a),console.groupEnd(),o},ProductSearch.prototype.clickOutsideNameSearch=function(e){console.groupCollapsed("clickOutsideNameSearch");$(e.target).parents("div.popover")[0]||e.target.className.includes("btn-name-picker")||(this.updateNameSearch(),this.closeNameSearch()),console.groupEnd()},ProductSearch.prototype.closeNameSearch=function(){console.groupCollapsed("closeNameSearch"),this.name_button&&this.name_button.popover("hide"),this.generateNameSearchContent(),console.groupEnd()},ProductSearch.prototype.resetNameSearch=function(){console.groupCollapsed("resetNameSearch"),this.product_name&&(this.product_name.value=""),this.product_id&&(this.product_id.value=""),this.generateNameSearchContent(),this.global_name_select=!1,console.groupEnd()},ProductSearch.prototype.updateNameSearch=function(){console.groupCollapsed("updateNameSearch"),this.generateNameSearchContent(),this.closeNameSearch(),console.groupEnd()},ProductSearch.prototype.generateNameSearchContent=function(){console.groupCollapsed("generateNameSearchContent");let e=this.product_name&&this.product_name.value?this.product_name.value:"",t=this.product_id&&!isNaN(parseInt(this.product_id.value))?parseInt(this.product_id.value):null,a=`${e}`;""!==e?(this.name_button.addClass("active"),this.name_button_content.html(a)):(this.name_button.removeClass("active"),this.name_button_content.html("")),console.log("productName",e),console.log("productId",t),console.groupEnd()},ProductSearch.prototype.createSearchElementsTravelers=function(e){console.groupCollapsed("createSearchElementsTravelers");let t=this,a=this.baseId+"_travelers_form",n=e&&e.form_title?e.form_title:"Travelers",o="formProductSearchTravelers",i=n,l=buildRow({classes:["row","mb-2"]}),r=buildRow({classes:["row","mb-2"]}),d=buildRow({classes:["row","mb-2"]}),s=buildRow({classes:["row","mb-2"]}),c=buildColumn({classes:["col-3"]}),u=buildColumn({classes:["col-9"]}),p=buildColumn({classes:["col-3"]}),_=buildColumn({classes:["col-9"]}),m=buildColumn({classes:["col-3"]}),g=buildColumn({classes:["col-9"]}),h=buildColumn({classes:["col-12"]}),f=document.createElement("label"),v=document.createElement("label"),y=document.createElement("label"),b=document.createElement("div"),I=document.createElement("div"),E=document.createElement("div"),$=document.createElement("div"),w=document.createElement("div"),C=document.createElement("div"),k=document.createElement("span"),S=document.createElement("span"),N=document.createElement("span"),B=document.createElement("span"),x=document.createElement("span"),L=document.createElement("span"),M=document.createElement("i"),P=document.createElement("i"),D=document.createElement("i"),F=document.createElement("i"),T=document.createElement("i"),R=document.createElement("i"),A=document.createElement("label"),q=document.createElement("i"),O=document.createElement("div"),Y=document.createElement("div"),U=document.createElement("form");f.classList.add("form-label-popover"),f.classList.add("d-flex"),f.classList.add("justify-content-start"),f.classList.add("align-items-center"),f.innerHTML='<i class="fas fa-user-friends mr-3"></i> <span>Adults</span>',v.classList.add("form-label-popover"),v.classList.add("d-flex"),v.classList.add("justify-content-start"),v.classList.add("align-items-center"),v.innerHTML='<i class="fas fa-user-friends mr-3"></i> <span>Children</span>',y.classList.add("form-label-popover"),y.classList.add("d-flex"),y.classList.add("justify-content-start"),y.classList.add("align-items-center"),y.innerHTML='<i class="fas fa-user-friends mr-3"></i> <span>Rooms</span>',$.classList.add("form-element"),$.classList.add("mb-0"),w.classList.add("form-element"),w.classList.add("mb-0"),C.classList.add("form-element"),C.classList.add("mb-0"),M.classList.add("fas"),P.classList.add("fas"),D.classList.add("fas"),T.classList.add("fas"),F.classList.add("fas"),R.classList.add("fas"),P.classList.add("fa-minus"),M.classList.add("fa-minus"),D.classList.add("fa-minus"),T.classList.add("fa-plus"),F.classList.add("fa-plus"),R.classList.add("fa-plus"),B.classList.add("input-group-text"),x.classList.add("input-group-text"),L.classList.add("input-group-text"),k.classList.add("input-group-text"),S.classList.add("input-group-text"),N.classList.add("input-group-text"),B.dataset.direction="dec",x.dataset.direction="dec",L.dataset.direction="dec",k.dataset.direction="inc",S.dataset.direction="inc",N.dataset.direction="inc",B.dataset.type="adult",x.dataset.type="child",L.dataset.type="room",k.dataset.type="adult",S.dataset.type="child",N.dataset.type="room",b.classList.add("input-group"),b.classList.add("d-flex"),b.classList.add("justify-content-end"),b.classList.add("number-input"),I.classList.add("input-group"),I.classList.add("d-flex"),I.classList.add("justify-content-end"),I.classList.add("number-input"),E.classList.add("input-group"),E.classList.add("d-flex"),E.classList.add("justify-content-end"),E.classList.add("number-input"),this.popup_travelers_adult_dec.classList.add("input-group-prepend"),this.popup_travelers_adult_dec.dataset.direction="dec",this.popup_travelers_adult_dec.dataset.type="adult",this.popup_travelers_adult_inc.classList.add("input-group-append"),this.popup_travelers_adult_inc.dataset.direction="inc",this.popup_travelers_adult_inc.dataset.type="adult",this.popup_travelers_child_dec.classList.add("input-group-prepend"),this.popup_travelers_child_dec.dataset.direction="dec",this.popup_travelers_child_dec.dataset.type="child",this.popup_travelers_child_inc.classList.add("input-group-append"),this.popup_travelers_child_inc.dataset.direction="inc",this.popup_travelers_child_inc.dataset.type="child",this.popup_travelers_room_dec.classList.add("input-group-prepend"),this.popup_travelers_room_dec.dataset.direction="dec",this.popup_travelers_room_dec.dataset.type="room",this.popup_travelers_room_inc.classList.add("input-group-append"),this.popup_travelers_room_inc.dataset.direction="inc",this.popup_travelers_room_inc.dataset.type="room",this.popup_travelers_adult_input.setAttribute("type","number"),this.popup_travelers_adult_input.setAttribute("min","1"),this.popup_travelers_adult_input.dataset.type="adult",this.popup_travelers_adult_input.value=1,this.popup_travelers_adult_input.classList.add("form-control"),this.popup_travelers_adult_input.classList.add("rounded-0"),this.popup_travelers_adult_input.classList.add("m-0"),this.popup_travelers_adult_input.classList.add("quantity"),this.popup_travelers_child_input.setAttribute("type","number"),this.popup_travelers_child_input.setAttribute("min","0"),this.popup_travelers_child_input.dataset.type="child",this.popup_travelers_child_input.value=0,this.popup_travelers_child_input.classList.add("form-control"),this.popup_travelers_child_input.classList.add("rounded-0"),this.popup_travelers_child_input.classList.add("m-0"),this.popup_travelers_child_input.classList.add("quantity"),this.popup_travelers_room_input.setAttribute("type","number"),this.popup_travelers_room_input.setAttribute("min","1"),this.popup_travelers_room_input.dataset.type="room",this.popup_travelers_room_input.value=1,this.popup_travelers_room_input.classList.add("form-control"),this.popup_travelers_room_input.classList.add("rounded-0"),this.popup_travelers_room_input.classList.add("m-0"),this.popup_travelers_room_input.classList.add("quantity"),this.popup_travelers_title=document.createElement("h5"),this.popup_travelers_close_button=document.createElement("a"),this.popup_travelers_update_button=document.createElement("button"),this.popup_travelers_heading_text=document.createElement("span"),this.popup_travelers_input=document.createElement("input"),this.popup_travelers_content=document.createElement("div"),this.popup_travelers_title.classList.add("popover-travelers-heading"),this.popup_travelers_title.classList.add("w-100"),this.popup_travelers_title.innerHTML=`${n}`,this.popup_travelers_close_button.setAttribute("href","javascript:void(0);"),this.popup_travelers_close_button.setAttribute("aria-hidden","true"),this.popup_travelers_close_button.classList.add("popup-window-button-close"),this.popup_travelers_close_button.classList.add("fas"),this.popup_travelers_close_button.classList.add("fa-times"),this.popup_travelers_content.classList.add("popover-travelers-body"),this.popup_travelers_content.classList.add("w-100"),U.setAttribute("id",a),U.setAttribute("novalidate","novalidate"),U.classList.add("form-inline"),this.popup_travelers_update_button.setAttribute("id",o+"Submit"),this.popup_travelers_update_button.setAttribute("name",o+"Submit"),this.popup_travelers_update_button.innerText="update",this.popup_travelers_update_button.classList.add("btn"),this.popup_travelers_update_button.classList.add("popover-travelers-submit"),this.popup_travelers_update_button.classList.add("btn-sm"),this.popup_travelers_update_button.classList.add("btn-block"),this.popup_travelers_heading_text.innerText=i,A.setAttribute("id",o+"-label"),A.classList.add("form-label-popover"),A.classList.add("d-flex"),A.classList.add("justify-content-start"),A.classList.add("align-items-center"),A.setAttribute("for",o),Y.setAttribute("id",o+"-error"),Y.classList.add("error"),Y.classList.add("w-100"),Y.classList.add("text-center"),this.popup_travelers_input.setAttribute("type","search"),this.popup_travelers_input.setAttribute("id",o),this.popup_travelers_input.setAttribute("name",o),this.popup_travelers_input.classList.add("form-control"),this.popup_travelers_input.classList.add("w-100"),q.classList.add("fas"),q.classList.add("fa-map-marker-alt"),q.classList.add("mr-3"),O.setAttribute("id",o+"-wrap"),O.classList.add("form-element"),A.appendChild(q),A.appendChild(t.popup_travelers_heading_text),O.appendChild(t.popup_travelers_input),O.appendChild(Y),B.appendChild(M),t.popup_travelers_adult_dec.appendChild(B),k.appendChild(F),t.popup_travelers_adult_inc.appendChild(k),$.appendChild(t.popup_travelers_adult_input),b.appendChild(t.popup_travelers_adult_dec),b.appendChild($),b.appendChild(t.popup_travelers_adult_inc),x.appendChild(P),t.popup_travelers_child_dec.appendChild(x),S.appendChild(T),t.popup_travelers_child_inc.appendChild(S),w.appendChild(t.popup_travelers_child_input),I.appendChild(t.popup_travelers_child_dec),I.appendChild(w),I.appendChild(t.popup_travelers_child_inc),L.appendChild(D),t.popup_travelers_room_dec.appendChild(L),N.appendChild(R),t.popup_travelers_room_inc.appendChild(N),C.appendChild(t.popup_travelers_room_input),E.appendChild(t.popup_travelers_room_dec),E.appendChild(C),E.appendChild(t.popup_travelers_room_inc),c.appendChild(f),u.appendChild(b),p.appendChild(v),_.appendChild(I),m.appendChild(y),g.appendChild(E),l.appendChild(c),l.appendChild(u),r.appendChild(p),r.appendChild(_),d.appendChild(m),d.appendChild(g),h.appendChild(t.popup_travelers_update_button),s.appendChild(h),t.popup_travelers_content.appendChild(l),t.popup_travelers_content.appendChild(r),t.popup_travelers_content.appendChild(d),t.popup_travelers_content.appendChild(s),U.appendChild(t.popup_travelers_content),t.popup_travelers_title.appendChild(t.popup_travelers_close_button),console.groupEnd()},ProductSearch.prototype.buildTravelersSearchButton=function(){console.groupCollapsed("buildTravelersSearchButton");let e=document.createElement("i"),t=document.createElement("div"),a=document.createElement("div"),n=document.createElement("button"),o=document.createElement("div");return o.classList.add("col-12"),o.classList.add("col-md-6"),o.classList.add("col-lg-4"),o.classList.add("px-1"),o.classList.add("mx-0"),o.classList.add("mb-2"),o.dataset.hotelSearch="true",o.dataset.flightSearch="true",o.dataset.carSearch="true",o.dataset.railSearch="true",o.dataset.transportSearch="true",o.dataset.tourSearch="true",o.dataset.cruiseSearch="true",o.dataset.packageSearch="true",o.dataset.otherSearch="true",n.classList.add("btn"),n.classList.add("btn-search-bar"),n.classList.add("btn-travelers-picker"),n.setAttribute("type","button"),n.dataset.hotelSearch="true",n.dataset.flightSearch="true",n.dataset.carSearch="true",n.dataset.railSearch="true",n.dataset.transportSearch="true",n.dataset.tourSearch="true",n.dataset.cruiseSearch="true",n.dataset.packageSearch="true",n.dataset.otherSearch="true",e.classList.add("fas"),e.classList.add("fa-users"),e.classList.add("btn-travelers-picker-icon"),t.classList.add("picker-label"),t.classList.add("btn-travelers-picker-label"),t.innerHTML="Travelers",a.classList.add("picker-content"),a.classList.add("btn-travelers-picker-content"),n.appendChild(e),n.appendChild(t),n.appendChild(a),o.appendChild(n),o.appendChild(this.travelers_button_error),this.travelers_button=$(n),this.travelers_button_error=$(this.travelers_button_error),this.travelers_button_content=$(a),console.groupEnd(),o},ProductSearch.prototype.clickOutsideTravelersSearch=function(e){console.groupCollapsed("clickOutsideTravelersSearch");$(e.target).parents("div.popover")[0]||e.target.className.includes("btn-travelers-picker")||(this.updateTravelersSearch(),this.closeTravelersSearch()),console.groupEnd()},ProductSearch.prototype.closeTravelersSearch=function(){console.groupCollapsed("closeTravelersSearch"),this.travelers_button&&this.travelers_button.popover("hide"),console.groupEnd()},ProductSearch.prototype.generateTravelersSearchContent=function(){console.groupCollapsed("generateTravelersSearchContent");let e=this.adult_count&&this.adult_count.value?parseInt(this.adult_count.value):1,t=this.child_count&&this.child_count.value?parseInt(this.child_count.value):0,a=this.room_count&&this.room_count.value?parseInt(this.room_count.value):1,n=`Rooms: ${a}, Adults: ${e}, Children: ${t}`;this.travelers_button.addClass("active"),this.travelers_button_content.html(n),console.log("roomCount",a),console.log("adultCount",e),console.log("childCount",t),console.groupEnd()},ProductSearch.prototype.resetTravelersSearch=function(){console.groupCollapsed("resetTravelersSearch"),this.popup_travelers_adult_input.value=1,this.popup_travelers_child_input.value=0,this.popup_travelers_room_input.value=1,this.adult_count.value=1,this.child_count.value=0,this.room_count.value=1,this.generateTravelersSearchContent(),this.global_travelers_select=!1,console.groupEnd()},ProductSearch.prototype.updateTravelersSearch=function(){console.groupCollapsed("updateTravelersSearch"),this.generateTravelersSearchContent(),this.closeTravelersSearch(),console.groupEnd()},$.fn.productSearch=function(e){return new ProductSearch(document.getElementById($(this).attr("id")),e)},$.fn.formFields=function(e){"use strict";let t=$(this).attr("id"),a=document.getElementById(t),n=a.elements,o=document.createElement("pre"),i=document.createElement("code"),l="",r="";i.id="constantFields",i.classList=["language-javascript"],o.appendChild(i),a.appendChild(o);for(var d=0;d<n.length;d++){let e=n[d];if(e.id){let t=e.id;l+=`const _${t} = document.getElementById('${t}')\n`,r+=`_${t}.value = ""\n`}}$(i).attr("data-prismjs-copy","Copy the JavaScript snipp"),i.innerHTML=l+"\n"+r,Prism.highlightElement(i)},jQuery(e=>{e.fn.dateSelect=function(t){const a=/(((19|20)\d\d)\-(0[1-9]|1[0-2])\-((0|1)[0-9]|2[0-9]|3[0-1]))$/;let n,o,i,l,r,d,s,c,u,p,_=e(this),m=_.attr("id"),g=(new Date).getFullYear()-1,h=g+5,f=(moment(g+"-01-01").format("YYYY-MM-DD"),moment(h+"-12-31").format("YYYY-MM-DD"),!1);_.attr("id","date-selector-"+m);let v={monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],showMonthsShort:!1,showWeekdaysFull:!1,today:"Today",clear:"Clear",close:"Close",labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd",hiddenSuffix:"_submit",hiddenName:void 0,editable:void 0,selectYears:5,selectMonths:!0,firstDay:1,min:void 0,max:void 0,disable:void 0,container:void 0,containerHidden:void 0,closeOnSelect:!0,closeOnClear:!0,onStart:void 0,onRender:void 0,onOpen:void 0,onClose:void 0,onSet:function(e){d.val(moment(e.select).format("YYYY-MM-DD")),$()},onStop:void 0},y={label:"Date",placeholder:"Select Date"};const b=function(t){e(t).parents("div.form-element").find("div.error").html("").hide()},I=function(t,n){let o=t.value;16===n&&(f=!0),a.test(o)||0===o.length?(b(t),w.picker.set("select",o,{format:"yyyy-mm-dd"}),w.picker.render()):function(t){e(t).parents("div.form-element").find("div.error").html("Invalid Date. Only YYYY-MM-DD format allowed.").show()}(t)},E=function(t,a){n=t,o=e("<div>").addClass("form-element"),i=e("<div>").addClass("input-group"),l=e("<div>").addClass("input-group-append"),r=e("<button type='button'>").attr("id","button-"+m).attr("type","button").addClass("btn btn-md btn-secondary m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-calendar-alt"></i>').on("click",function(e){e.preventDefault()}),u=e("<button type='button'>").attr("id","button-clear-"+m).addClass("btn btn-md btn-outline-danger m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-ban"></i>').on("click",function(){w.clear(),d.val("").trigger("change"),b(d[0])}),d=e("<input>").addClass("form-control date-format").attr("id",m).attr("type","text").attr("placeholder",y.placeholder).attr("maxlength","10").on("keydown",function(e){return t=this,a=e.keyCode,isNaN(parseInt(a))||(a=parseInt(a)),16===a&&(f=!0),(a>=48&&a<=57||a>=96&&a<=105||8===a||46===a)&&16!==a&&(4!==t.value.length&&7!==t.value.length||8===a||(t.value+="-"),!0);var t,a}).on("keyup",function(t){console.log("event",t.keyCode),""===e(this).val()?(w.clear(),b(d[0])):I(this,t.keyCode),$()}).on("change",function(t){console.log("DateSelect.input:change(e)"),e(this).val(),$()}).on("focus",function(e){}),s=e("<label>").attr("for",m).html(y.label),c=e("<div>").addClass("error w-100 text-center")},$=function(){if(""!==d.val()){u.show();let e=d.attr("id");clearError(document.getElementById(e))}else u.hide()},w={picker:null,val:null,fooListener:function(e){},registerNewListener:function(e){this.fooListener=e},set:function(){var e;e||(e={}),w.picker.set(e,{muted:!0})},value:function(e){return e||(e=null),(t=e)?(w.picker.set("select",t,{format:"yyyy-mm-dd"}),w.picker.render(),null):""===d.val()?null:d.val();var t},clear:function(){w.picker.clear()&&(w.picker.clear(),b(d[0])),d.val(""),r.val("")},init:function(e,t){C(e,t)}},C=function(t,a){var _;(_=a)&&e.each(_,function(e,t){v[e]=t}),y.label=e(t).attr("data-label")?e(t).attr("data-label"):"Date",y.placeholder=e(t).attr("data-placeholder")?e(t).attr("data-placeholder"):"Select Date",function(e,t){E(e),l.append(u,r),i.append(d,l),o.append(s,i,c),n.append(o),p=r.pickadate("picker")}(t),r.pickadate(v).on("change",function(){""===r.val()?d.val(""):d.val(e(this).val())}),p=r.pickadate("picker"),w.picker=r.pickadate("picker"),$()};return C(_,t),w}}),jQuery(e=>{e.fn.timeSelect=function(t){let a,n,o,i,l,r,d,s,c,u,p,_=e(this),m=_.attr("id");_.attr("id","time-selector-"+m);let g={clear:"Clear",format:"h:i A",formatLabel:void 0,formatSubmit:void 0,hiddenPrefix:void 0,hiddenSuffix:"_submit",editable:void 0,interval:30,min:void 0,max:void 0,container:void 0,containerHidden:void 0,closeOnSelect:!0,closeOnClear:!0,onStart:void 0,onRender:void 0,onOpen:void 0,onClose:void 0,onSet:void 0,onStop:void 0},h={label:"Time",placeholder:"Select Time"};const f=function(t){e(t).parents("div.form-element").find("div.error").html("").hide()};function v(t){var a=!0,n=t.split(":");if(2!==n.length)a=!1;else if((isNaN(n[0])||isNaN(n[1]))&&(a=!1),n[0]<24&&n[1]<60){if(!n[0]||!n[1]||isNaN(parseInt(n[0]))||isNaN(parseInt(n[1])))return!1;parseInt(n[0])<=9&&(n[0]="0"+n[0]),parseInt(n[1])<=9&&(n[0]="0"+n[0]),e(u).val(n[0]+":"+n[1])}else a=!1;return a}const y=function(t,a){v(t.value)?f(t):function(t){e(t).parents("div.form-element").find("div.error").html("Invalid Time. Only HH-MM format allowed.").show()}(t)},b=function(t,u){a=t,n=e("<div>").addClass("form-element"),o=e("<div>").addClass("input-group"),i=e("<div>").addClass("input-group-append"),l=e("<button type='button'>").attr("id","button-"+m).attr("type","button").addClass("btn btn-md btn-secondary m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-calendar-alt"></i>').on("click",function(e){e.preventDefault()}),c=e("<button type='button'>").attr("id","button-clear-"+m).addClass("btn btn-md btn-outline-danger m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-ban"></i>').on("click",function(){E.clear(),r.val("").trigger("change"),f(r[0])}),r=e("<input>").addClass("form-control time-format").attr("id",m).attr("type","text").attr("placeholder",h.placeholder).attr("maxlength","5").on("keydown",function(e){return t=this,a=e.keyCode,isNaN(parseInt(a))||(a=parseInt(a)),16===a&&(isShift=!0),(a>=48&&a<=57||a>=96&&a<=105||8===a||46===a)&&16!==a&&(2===t.value.length&&8!==a&&(t.value+=":"),!0);var t,a}).on("keyup",function(e){y(this,e.keyCode),I()}).on("change",function(){I()}),d=e("<label>").attr("for",m).html(h.label),s=e("<div>").addClass("error w-100 text-center")},I=function(){if(""!==r.val()){c.show();let e=r.attr("id");clearError(document.getElementById(e))}else c.hide()},E={picker:null,val:null,fooListener:function(e){},registerNewListener:function(e){this.fooListener=e},set:function(){var e;e||(e={}),E.picker.set(e,{muted:!0})},value:function(e){return e||(e=null),(t=e)?(E.picker.set("select",t,{format:"HH-i"}),E.picker.render(),null):""===r.val()?null:r.val();var t},clear:function(){E.picker.clear()&&(E.picker.clear(),E.picker.set("select",moment().format("YYYY-MM-DD"),{format:"HH-i"}),E.picker.render(),f(r[0]))},init:function(e,t){$(e,t)}},$=function(t,u){var _;(_=u)&&e.each(_,function(e,t){g[e]=t}),h.label=e(t).attr("data-label")?e(t).attr("data-label"):"Date",h.placeholder=e(t).attr("data-placeholder")?e(t).attr("data-placeholder"):"Select Date",function(e,t){b(e),i.append(c,l),o.append(r,i),n.append(d,o,s),a.append(n),p=l.pickatime("picker")}(t),l.pickatime(g).on("change",function(){""===e(this).val()?r.val(""):r.val(e(this).val()),r.trigger("change")}),p=l.pickatime("picker"),I(),E.picker=l.pickatime("picker")};return $(_,t),E}});const tinyEditor=function(){"use strict";let e;const t=function(e){tinymce.init({selector:"#"+e,menubar:!1,plugins:"print visualblocks visualchars charmap hr pagebreak advlist lists",content_css:["https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","/public/css/bootstrap.min.css","/public/css/style.css","/public/css/variant.min.css"],body_class:"p-2",font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Open Sans=Open Sans;Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",toolbar1:"undo redo | styleselect | fontselect fontsizeselect | removeformat | numlist bullist checklist | outdent indent ",toolbar2:"cut copy | bold italic underline strikethrough | forecolor | alignleft aligncenter alignright alignjustify | backcolor",content_style:'body { font-family:"Open Sans", sans-serif; font-size:14px; font-weight: 400 }',style_formats:[{title:"Headers",items:[{title:"h1",block:"h1"},{title:"h2",block:"h2"},{title:"h3",block:"h3"},{title:"h4",block:"h4"},{title:"h5",block:"h5"},{title:"h6",block:"h6"}]},{title:"Blocks",items:[{title:"p",block:"p"},{title:"div",block:"div"},{title:"pre",block:"pre"}]},{title:"Containers",items:[{title:"section",block:"section",wrapper:!0,merge_siblings:!1},{title:"article",block:"article",wrapper:!0,merge_siblings:!1},{title:"blockquote",block:"blockquote",wrapper:!0},{title:"hgroup",block:"hgroup",wrapper:!0},{title:"aside",block:"aside",wrapper:!0},{title:"figure",block:"figure",wrapper:!0}]}],branding:!1,resize:!1,setup:function(e){e.on("change",function(){e.save()})}}),$("html").css({overflow:"hidden"})};return{addTinyMCE:function(e){t(e)},init:function(){(e=document.querySelectorAll(".but_toggle")).forEach(e=>e.addEventListener("click",a=>{if(e.dataset.texted){let a,n=e&&e.dataset&&e.dataset.texted?e.dataset.texted:null,o=null!==n?$("#"+n):null,i=e&&$(e).parents("div.card")?$(e).parents("div.card"):null,l=e&&$(e).parents("section.card")?$(e).parents("section.card"):null;i?a=i:l&&(a=l),null!==n&&null!==i&&(tinyMCE.get(n)?(o.val(htmlEncode(o.val())),tinymce.remove("#"+n),a.removeClass("is-fullscreen"),$("html").css({overflow:"auto"})):(o.val(decodeHtml(o.val())),a.addClass("is-fullscreen"),t(n)))}}))}}}();$(document).ready(function(){$(function(){tinyEditor.init()})});const ContextMenu=function(){"use strict";let e;return{init:function(t){e=$.contextMenu({selector:".selected-day",callback:function(e,t){e.toLowerCase()},items:{edit:{name:"Assign Season To Days",icon:"edit"},cut:{name:"Cut",icon:"cut"},copy:{name:"Copy",icon:"copy"},paste:{name:"Paste",icon:"paste"},delete:{name:"Delete",icon:"delete"},sep1:"---------",quit:{name:"Quit",icon:function(){return"context-menu-icon context-menu-icon-quit"}}}}),$(".selected-day").on("click",function(e){})}}}(),Season=function(){"use strict";const e=document.getElementById("product_edit_season_display"),t=document.getElementById("edit_product_season"),a=document.getElementById("product_edit_season_form_edit_season_link"),n=document.getElementById("product_edit_season_form_season_name_filter"),o=document.getElementById("category_id"),i=document.getElementById("product_edit_season_form_season_color_scheme_id"),l=document.getElementById("product_edit_season_form_season_id"),r=document.getElementById("product_edit_season_form_season_name"),d=document.getElementById("product_edit_season_id_name_display"),s=document.getElementById("product_edit_season_form_season_enabled"),c=document.getElementById("edit_season_button"),u=document.getElementById("table_season_product_edit"),p=document.getElementById("button_clear_form_edit_season"),_=document.getElementById("display_product_season_name"),m=document.getElementById("button_submit_form_edit_season"),g=document.getElementById("product_id"),h=document.getElementById("panel_tab_season"),f=document.getElementById("button_remove_season_from_product"),v=document.getElementById("calendar_loader"),y=document.getElementById("table_season_product_edit_add_new_button");let b,I,E=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,w=new Map,C=!1;$(y).on("click",function(){W(),r.disabled=!1,r.readonly=!1,ColorScheme.enable()}),$(f).on("click",function(){let e={product_id:parseInt(g.value),season_id:parseInt(l.value)};confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&B(e)})}),$(a).on("click",function(){Y()}),$(c).on("click",function(){ColorScheme.enable()}),$(p).on("click",function(){n.value="",O(),U(),b.clearSelectedRows()}),$(m).on("click",function(){let e=L();confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&S(e)})}),$(h).on("hide.bs.tab",function(){n.value="",O(),U(),b&&b.clearSelectedRows()});const k=function(){console.groupCollapsed("Season.updateProgress"),0===Array.from(Season.all.values()).length?$(h).html('<span id="tab_span_season">Season</span> <span id="seasonNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>'):$(h).html('<span id="tab_span_season">Season</span>'),Product.updateProgress(),console.groupEnd()},S=function(e){console.groupCollapsed("Season.saveProductSeason"),e&&$(v).fadeIn("fast",function(){N(e,function(e){if(e){let t=e[0]?e[0]:e;q(t),F(t)}else YearCalendar.endLoading()})}),console.groupEnd()},N=function(e,t){console.groupCollapsed("Season.updateProductSeason");if(e)try{sendPostRequest("/api/v1.0/seasons/update",e,function(e,a,n){if(e)return t(e);x("Oops: 1")})}catch(e){}console.groupEnd()},B=function(e){console.groupCollapsed("Season.removeProductSeason"),e&&$(v).fadeIn("fast",function(){!function(e,t){console.groupCollapsed("Season.deleteProductSeason");if(e)try{sendPostRequest("/api/v1.0/seasons/remove",e,function(e,a,n){return e?t(e):x("Oops: 1")})}catch(e){return x(e)}console.groupEnd()}(e,function(t){t?A(e.season_id):YearCalendar.endLoading()})}),console.groupEnd()},x=function(e,t,a){console.groupCollapsed("Season.handleSeasonError"),e||(e="Season Error"),t||(t="Season"),a||(a="error"),toastr[a](`${e}`,t),console.groupEnd()},L=function(){console.groupCollapsed("Season.buildUpdateRecord");let e=remove_nulls({product_id:isNaN(parseInt(g.value))?null:parseInt(g.value),season_id:isNaN(parseInt(l.value))?null:parseInt(l.value),disabled_dow:formatListOfIds(I.disabled_dows)});return console.groupEnd(),e},M=function(){console.groupCollapsed("Season.defaultDetail");let e={id:null,color_scheme_id:null,name:null,view_product_index:1,view_product_index_filter:1,view_product_index_search:1,view_product_edit:1,view_product_package_edit:1,view_product_package_index:1,enabled:1,date_created:formatDateMySQL(),created_by:E,date_modified:formatDateMySQL(),modified_by:E,note:null,category_id:null,color_scheme:{id:null,name:null,background_color:null,border_color:null,text_color:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:E,date_modified:formatDateMySQL(),modified_by:E,note:null},product_season_detail:{created_by:E,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),disabled_dow:null,enabled:1,id:null,modified_by:E,note:null,product_id:null,season_id:null,seasons_background:null,seasons_border:null,seasons_text:null}};return console.groupEnd(),e},P=function(e){console.groupCollapsed("Season.loadTypes"),w=new Map,e&&$.each(e,function(e,t){Season.types.set(t.id,function(e){console.groupCollapsed("Season.formatSeasonType");let t=M(),a=isNaN(parseInt(e.category_id))?null:parseInt(e.category_id);return t.id=isNaN(parseInt(e.id))?null:parseInt(e.id),t.color_scheme_id=isNaN(parseInt(e.color_scheme_id))?null:parseInt(e.color_scheme_id),t.name=e.name?e.name:null,t.view_product_index=e.view_product_index?e.view_product_index:1,t.view_product_index_filter=e.view_product_index_filter?e.view_product_index_filter:1,t.view_product_index_search=e.view_product_index_search?e.view_product_index_search:1,t.view_product_edit=e.view_product_edit?e.view_product_edit:1,t.view_product_package_edit=e.view_product_package_edit?e.view_product_package_edit:1,t.view_product_package_index=e.view_product_package_index?e.view_product_package_index:1,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=isNaN(parseInt(e.created_by))?E:parseInt(e.created_by),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=isNaN(parseInt(e.modified_by))?E:parseInt(e.modified_by),t.note=e.note?e.note:null,t.category_id=isNaN(parseInt(e.category_id))?null:parseInt(e.category_id),t.color_scheme.id=isNaN(parseInt(e.color_scheme.id))?null:parseInt(e.color_scheme.id),t.color_scheme.name=e.color_scheme.name,t.color_scheme.background_color=e.color_scheme.background_color,t.color_scheme.border_color=e.color_scheme.border_color,t.color_scheme.text_color=e.color_scheme.text_color,t.color_scheme.sort_order=isNaN(parseInt(e.color_scheme.sort_order))?999:parseInt(e.color_scheme.sort_order),t.color_scheme.enabled=e.color_scheme.enabled,t.color_scheme.date_created=e.color_scheme.date_created?e.color_scheme.date_created:formatDateMySQL(),t.color_scheme.created_by=isNaN(parseInt(e.color_scheme.created_by))?E:parseInt(e.color_scheme.created_by),t.color_scheme.date_modified=e.color_scheme.date_modified?e.color_scheme.date_modified:formatDateMySQL(),t.color_scheme.modified_by=isNaN(parseInt(e.color_scheme.modified_by))?E:parseInt(e.color_scheme.modified_by),t.color_scheme.note=e.color_scheme.note,w.get(a)||w.set(a,{seasons:[]}),console.groupEnd(),t}(t))}),console.groupEnd()},D=function(e){let t,a;if(console.groupCollapsed("Season.clearProductOverview"),!e||!e.color_scheme||!e.product_season_detail)return;t=e.color_scheme,a=e.product_season_detail;e.color_scheme&&e.color_scheme.background_color&&e.color_scheme.background_color,e.color_scheme&&e.color_scheme.text_color&&e.color_scheme.text_color,e.color_scheme&&e.color_scheme.border_color&&e.color_scheme.border_color,e.product_season_detail&&getListOfIds(e.product_season_detail.disabled_dow),e.name&&e.name;let n=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null;n&&$(`#disabledDOWDisplay${n}`).remove(),console.groupEnd()},F=function(t){let a,n;if(console.groupCollapsed("Season.buildProductOverview"),!t||!t.color_scheme||!t.product_season_detail)return;a=t.color_scheme,n=t.product_season_detail;let o=t.color_scheme&&t.color_scheme.background_color?t.color_scheme.background_color:"#fff",i=t.color_scheme&&t.color_scheme.text_color?t.color_scheme.text_color:"#0a070d",l=t.color_scheme&&t.color_scheme.border_color?t.color_scheme.border_color:"#0a070d",r=t.product_season_detail?getListOfIds(t.product_season_detail.disabled_dow):[],d=[],s="",c=t.name?t.name:null,u=t.id&&!isNaN(parseInt(t.id))?parseInt(t.id):null;for(let e=0;e<r.length;e++){let t=days[e];t.short&&d.push(t.short.toUpperCase())}s=d.join(", "),o=shadeColor(o,30),l=shadeColor(l,-30),Season.all.get(u)&&D(Season.all.get(u)),$(e).append(`\n            <div class="col-12 col-sm-12 col-md-4 px-1" id="disabledDOWDisplay${u}">\n        \n                <div class="card card-body mb-2" style="background:${o};color:${i};border-color:${l};">\n                \n                    <h5 class="card-title" style="color:${i};">${c}</h5>\n                    <h6 class="card-subtitle">\n                        <p class="m-0 mb-1" style="font-size:.85rem;font-weight:400;color:#0a070d;">Disabled Days:</p>\n                        <p class="m-0 mb-1" style="font-size:.75rem;color:${l};">${s}</p>\n                    </h6>\n                \n                </div>\n            </div>\n        `),console.groupEnd()},T=function(e){console.groupCollapsed("Season.set");let t=M();return e&&(t=e),console.groupEnd(),t},R=function(){console.groupCollapsed("Season.buildProductEditTable"),b=$(u).table({table_type:"display_list",data:Season.all,columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Color Scheme",targets:2,data:"color_scheme",render:function(e,t,a,n){return`\n                            <div style="font-size:14px; line-height:1.25;padding-left:.5rem;background:${e.background_color};color:${e.text_color}; border:solid 1px ${e.border_color}">${e.name}</div>\n                        `}},{title:"Disabled DOW",targets:3,data:"product_season_detail",render:function(e,t,a,n){let o=e.disabled_dow?getListOfIds(e.disabled_dow):[],i=[];for(let e=0;e<o.length;e++)i.push(dow_short[o[e]]);return`\n                            <span>${e=i.join(", ")}</span>\n                        `}}],rowClick:Season.edit}),console.groupEnd()},A=function(e){if(console.groupCollapsed("Season.deleteProductSeasonTableRow"),e){let t=Season.all.get(e);t&&(Season.all.delete(e),b.deleteRow(t),b.clearSelectedRows(),n.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),k(),O(),U(),D(t),toastr.warning(`Season: ${t.name} - has been deleted`,"Season"),YearCalendar.endLoading())}console.groupEnd()},q=function(e){if(console.groupCollapsed("Season.addProductSeasonTableRow"),e){let t=T(e);Season.all.get(t.id)?b.updateRow(t):b.insertRow(t),Season.all.set(t.id,t),b.loadRow(t),b.jumpToRow(t),b.clearSelectedRows(),n.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),k(),O(),U(),toastr.success(`Season: ${t.name} - has been updated`),YearCalendar.endLoading()}console.groupEnd()},O=function(){console.groupCollapsed("Season.resetForm"),l.value="",r.value="",d.value="",s.checked=!0,k(),ColorScheme.load(),console.groupEnd()},Y=function(){console.groupCollapsed("Season.loadEditSeasonForm"),console.groupEnd()},U=function(){console.groupCollapsed("Season.clearProductSeasonForm"),I.init([]),Q(),console.groupEnd()},W=function(e){console.groupCollapsed("Season.loadProductSeasonForm");let a=[],o="Details";if(e){let t=e.color_scheme?e.color_scheme:{};o=e.name?e.name:"Detail",e.product_season_detail&&e.product_season_detail.disabled_dow&&(a=getListOfIds(e.product_season_detail.disabled_dow)),ColorScheme.load(t),ColorScheme.disable(),l.value=e.id,r.value=e.name,i.value=e.color_scheme_id,s.checked=1===e.enabled,s.disabled=!0,n.disabled=!0}n.disabled=!0,_.innerText=o,I.init(a),$(t).show(),console.groupEnd()},Q=function(){console.groupCollapsed("Season.unloadProductSeasonForm"),n.disabled=!1,r.disabled=!0,$(t).hide(),console.groupEnd()},V=function(e){console.groupCollapsed("Season.seasonExists");let t=isNaN(parseInt(o.value))?null:parseInt(o.value);if(e&&""!==e&&t){let a={name:e,category_id:t};!function(e,t){console.groupCollapsed("Season.fetchByName");if(e)try{sendGetRequest("/api/v1.0/seasons/validate",e,function(e,a,n){if(e)return t(e);x("Oops: 1")})}catch(e){x("Error Validating Airport")}else x("Error Loading Airport - Missing Data");console.groupEnd()}(a,function(t){let o=null;if(t&&(o=t,t[0]&&(o=t[0])),o&&o.id){C=!0;let e=o.color_scheme?o.color_scheme:{},t=Season.all.get(o.id);b.clearSelectedRows(),l.value=o.id,r.value=o.name,i.value=o.color_scheme_id,s.checked=1===o.enabled,s.disabled=!0,ColorScheme.load(e),ColorScheme.disable(),t?(W(t),b.loadRow(t)):W(o)}else confirmDialog(`The season: ${e} does not exist exists. Would you like to create it?`,e=>{e?function(e,t){console.groupCollapsed("Season.addSeason");if(!e)return x("Error Loading Airport - Missing Data");try{sendPostRequest("/api/v1.0/seasons/add",e,function(e,a,n){if(e)return t(e);x("Oops: 1")})}catch(e){return x("Error Validating Airport")}console.groupEnd()}(a,function(e){let t=null;if(e&&(t=e,e[0]&&(t=e[0])),t&&t.id){let e=t.color_scheme?t.color_scheme:{},a=Season.all.get(t.id);b.clearSelectedRows(),l.value=t.id,r.value=t.name,i.value=t.color_scheme_id,s.checked=1===t.enabled,s.disabled=!0,ColorScheme.load(e),ColorScheme.disable(),a?(W(a),b.loadRow(a)):W(t)}}):(b.clearSelectedRows(),O(),n.value="")})})}console.groupEnd()},j=function(a){console.groupCollapsed("Season.init");let d=[];a&&(d=a,a.seasons&&(d=a.seasons)),P(d),n&&($(e).empty(),function(){console.groupCollapsed("Season.initAutoComplete");let e=isNaN(parseInt(o.value))?null:parseInt(o.value);$(n).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){b.clearSelectedRows(),O()}).on("change",function(){setTimeout(function(){""===n.value?(b.clearSelectedRows(),O()):V(n.value)},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/seasons",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:e},onSelect:function(e){if(!e.data)return;let t=e.data,a=t.color_scheme?t.color_scheme:{},n=Season.all.get(t.id);b.clearSelectedRows(),l.value=t.id,r.value=t.name,i.value=t.color_scheme_id,s.checked=1===t.enabled,s.disabled=!0,ColorScheme.load(a),ColorScheme.disable(),n?(W(n),b.loadRow(n)):W(t)}}),console.groupEnd()}(),O()),document.getElementById("season_disabled_dow")&&(I=$("#season_disabled_dow").DisabledDOW({name:"season_disabled_dow",label:"Disabled DOW"})),t&&Q(),console.groupEnd()};return{types:new Map,all:new Map,edit:function(e){!function(e){console.groupCollapsed("Season.edit"),e&&e.id&&(e.id,l&&(isNaN(parseInt(l.value))||parseInt(l.value)));U(),W(e),console.groupEnd()}(e)},loadTypes:function(e){P(e)},init:function(e){j(e)},loadAll:function(e){!function(e){console.groupCollapsed("Season.loadAll"),Season.all=new Map,u&&R(),e||(e=[]),$.each(e,function(e,t){let a=T(t);isNaN(parseInt(a.id))||(b.insertRow(a),Season.all.set(parseInt(a.id),a),F(a))}),k(),console.groupEnd()}(e)}}}(),Page=function(){"use strict";const e=document.getElementById("modal_new_page"),t=document.getElementById("button_add_page_heading"),a=document.getElementById("table_pages_index"),n=document.getElementById("page_index_section"),o=document.getElementById("modal_new_page_id"),i=document.getElementById("modal_new_page_menu_id"),l=document.getElementById("modal_new_page_path"),r=document.getElementById("modal_new_page_title"),d=document.getElementById("modal_new_page_sub_title"),s=document.getElementById("modal_new_page_heading"),c=document.getElementById("modal_new_page_sub_heading"),u=document.getElementById("modal_new_page_description"),p=document.getElementById("modal_new_page_keywords"),_=document.getElementById("modal_new_page_enabled"),m=document.getElementById("modal_new_page_form"),g=document.getElementById("modal_new_page_save_button"),h=document.getElementById("modal_new_page_cancel_button"),f=document.getElementById("modal_new_page_clear_button"),v={rules:{modal_new_page_path:{required:!0}},messages:{modal_new_page_path:{required:"Fields Required"}}};let y,b,I=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,E=null;$(t).on("click",function(){x(),N()}),$(g).on("click",function(){P()}),$(h).on("click",function(){x(),B()}),$(f).on("click",function(){x()});const w=function(e,t){t||(t="Error"),toastr.error(e,t)},C=function(e){let t=k();return e&&(Page.detail.id=isNaN(parseInt(e.id))?null:parseInt(e.id),Page.detail.menu_id=isNaN(parseInt(e.menu_id))?null:parseInt(e.menu_id),Page.detail.path=e.path?e.path:null,Page.detail.title=e.title?e.title:null,Page.detail.sub_title=e.sub_title?e.sub_title:null,Page.detail.heading=e.heading?e.heading:null,Page.detail.sub_heading=e.sub_heading?e.sub_heading:null,Page.detail.description=e.description?e.description:null,Page.detail.keywords=e.keywords&&""!==e.keywords?e.keywords.toString().replace(/,\s/g,",").trim().split(","):[],Page.detail.enabled=e.enabled&&1===e.enabled?1:0,Page.detail.date_created=e.date_created?e.date_created:formatDateMySQL(),Page.detail.created_by=e.created_by?e.created_by:I,Page.detail.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),Page.detail.modified_by=e.modified_by?e.modified_by:I,Page.detail.note=e.note?e.note:null,t.id=Page.detail.id,t.menu_id=Page.detail.menu_id,t.path=Page.detail.path,t.title=Page.detail.title,t.sub_title=Page.detail.sub_title,t.heading=Page.detail.heading,t.sub_heading=Page.detail.sub_heading,t.description=Page.detail.description,t.keywords=Page.detail.keywords,t.enabled=Page.detail.enabled,t.date_created=Page.detail.date_created,t.created_by=Page.detail.created_by,t.date_modified=Page.detail.date_modified,t.modified_by=Page.detail.modified_by,t.note=Page.detail.note),t},k=function(){return Page.detail.id=null,Page.detail.menu_id=null,Page.detail.path=null,Page.detail.title=null,Page.detail.sub_title=null,Page.detail.heading=null,Page.detail.sub_heading=null,Page.detail.description=null,Page.detail.keywords=[],Page.detail.enabled=1,Page.detail.date_created=formatDateMySQL(),Page.detail.created_by=I,Page.detail.date_modified=formatDateMySQL(),Page.detail.modified_by=I,Page.detail.note=null,{id:null,menu_id:null,path:null,title:null,sub_title:null,heading:null,sub_heading:null,description:null,keywords:[],enabled:1,date_created:formatDateMySQL(),created_by:I,date_modified:formatDateMySQL(),modified_by:I,note:null}},S=function(e){if(i){let t='<option value="" disabled selected>-- Menu --</option>';$(i).empty(),$.each(e,function(e,a){let n=isNaN(parseInt(a.id))?null:parseInt(a.id),o=a.label?a.label:null,i=a.sub_menus;t+=`<option  value="${n}">${o}</option>`,$.each(i,function(e,a){let n=isNaN(parseInt(a.id))?null:parseInt(a.id),o=a.label?a.label:null;t+=`<option value="${n}">${o}</option>`})}),$(i).html(t)}},N=function(){e&&$(e).modal("show")},B=function(){e&&$(e).modal("hide")},x=function(){o.value="",i.value="",l.value="",r.value="",d.value="",s.value="",c.value="",u.value="",b.clear(),_.checked=!0},L=function(e){if(e){let t=C(e);x(),function(e){e&&(Page.menus.get(Page.detail.menu_id)&&Page.menus.get(Page.detail.menu_id),i.value=Page.detail.menu_id,o.value=Page.detail.id,l.value=Page.detail.path,r.value=Page.detail.title,d.value=Page.detail.sub_title,s.value=Page.detail.heading,c.value=Page.detail.sub_heading,u.value=Page.detail.description,b.set(Page.detail.keywords),_.checked=Page.detail.enabled&&1===Page.detail.enabled)}(t),N()}},M=function(e){if(Page.all=new Map,e&&e.length){let t=0;E=null,$.each(e,function(e,a){let n=C(a);0===t&&(E=n),n.id&&(Page.all.set(n.id,n),function(e){y.insertRow(e)}(n)),t++})}else E=null;null!==E&&(y.clearSelectedRows(),y.jumpToRow(E))},P=function(){if($(m).valid()){let e=removeNulls({id:isNaN(parseInt(o.value))?null:parseInt(o.value),menu_id:isNaN(parseInt(i.value))?null:parseInt(i.value),path:l&&""!==l.value?l.value:null,title:r&&""!==r.value?r.value:null,sub_title:d&&""!==d.value?d.value:null,heading:s&&""!==s.value?s.value:null,sub_heading:c&&""!==c.value?c.value:null,description:u&&""!==u.value?u.value:null,keywords:b.build(),enabled:_&&!0===_.checked?1:0});e&&confirmDialog(`Page: ${e.title} does not exist. Would you like to create it?`,t=>{t&&function(e,t){if(!e)return w("Error Loading Page - Missing Data","Save Error");try{sendPostRequest("/api/v1.0/pages/save",e,function(e,a,n){return e?t(e):w("Oops: 1","Save Error")})}catch(e){return w("Error Validating Page","Save Error")}}(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);C(t)}})})}},D=function(e){var t;n&&(a&&(y=$(a).table({table_type:"display_list",data:Array.from(Page.all.values()),columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Title",targets:1,data:"title",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Path",targets:2,data:"path",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Page.edit})),e&&(e.pages&&M(e.pages),e.menus&&(t=e.menus,Page.menus=new Map,Page.sub_menus=new Map,t&&t.length&&$.each(t,function(e,t){let a=t.sub_menus?t.sub_menus:[];$.each(a,function(e,t){Page.menus.set(t.id,t)}),Page.menus.set(t.id,t)}),S(e.menus)),b=$(p).BuildKeyword([]),initializeValidator(v),Page.validator=$(m).validate()))};return{menus:new Map,sub_menus:new Map,detail:{id:null,menu_id:null,path:null,title:null,sub_title:null,heading:null,sub_heading:null,description:null,keywords:null,enabled:1,date_created:formatDateMySQL(),created_by:I,date_modified:formatDateMySQL(),modified_by:I,note:null},all:new Map,buildMenuDropDown:function(){S()},edit:function(e){!function(e){e&&L(e)}(e)},init:function(e){D(e)}}}(),PricingStrategy=function(){"use strict";const e=document.getElementById("pricing_strategy_types_id"),t=document.getElementById("pricing_strategy_unit_id"),a=document.getElementById("pricing_strategy_season_id"),n=document.getElementById("panel_tab_pricing");$(e).on("change",function(){}),$(a).on("change",function(){});return{all:new Map,unitSeasons:new Map,updateStatus:function(){$(n).find("span").remove()},init:function(e){},updatePrice:function(e){!function(e){let t=document.getElementById(e);document.getElementById(e.replace("cost","price")).value=(isNaN(parseInt(t.value))?0:parseInt(t.value))+!isNaN(parseInt(t.value))?parseInt(t.value):0}(e)},clearUnitSelection:function(){$(t).val([]).trigger("change")},clearSeasonSelection:function(){$(a).val([]).trigger("change")},buildUnitSeasonValues:function(){PricingStrategy.unitSeasons=new Map,$.each(Array.from(Unit.all.values()),function(e,t){PricingStrategy.unitSeasons.set(t.id,{id:t.id,name:t.name,seasons:Season.all})})}}}();document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("div.panel").forEach(e=>{const t=$(e),a=t.find("div.panel-heading").find("div.panel-actions.panel-actions-keep").find("a.panel-action");$.each(a,function(e,a){let n=$(a).attr("data-toggle");if(n)switch(n){case"panel-refresh":break;case"panel-hide":a.addEventListener("click",function(){let e=$(a).attr("data-loadonhide");$(e).show(),$(a).parents("div.pre_display").find("div.pre_display_el").hide()});break;case"panel-collapse":break;case"panel-fullscreen":a.addEventListener("click",function(){$(a).hasClass("fa-expand")?($(a).removeClass("fa-expand"),$(a).addClass("fa-compress"),t.addClass("is-fullscreen")):$(a).hasClass("fa-compress")&&($(a).removeClass("fa-compress"),$(a).addClass("fa-expand"),t.removeClass("is-fullscreen"))})}})})}),$.fn.table=function(e){"use strict";let t,a,n=[],o="display_list",i=$(this).attr("id");const l=document.getElementById(i);if($.fn.DataTable.isDataTable("#"+i))return;e&&(e.columnDefs&&(t=e.columnDefs),e.table_type&&(o=e.table_type),e.data&&(n=e.data));const r=function(){let e=$("#"+i+"_wrapper .dataTables_filter"),t=$("#"+i+"_wrapper .dataTables_length"),a=$("#"+i+"_wrapper .dataTables_info"),n=$("#"+i+"_wrapper .dataTables_paginate"),l=$("#"+i+"_wrapper"),r=$("#"+i+"_wrapper select");$("#"+i).parent("div").removeClass("col-sm-12").addClass("p-0 m-0 w-100 h-100"),l.find("label").each(function(){$(this).parent().append($(this).children())}),l.find("div.row").removeClass("row").addClass("d-flex justify-content-between"),e.find("input").each(function(){const e=$(this);e.attr("placeholder","Search"),e.removeClass("form-control-sm")}),e.find("label").remove(),e.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),a.parent("div").removeClass("col-sm-12 col-md-5").addClass("w-50 d-flex align-content-center flex-wrap px-0"),a.addClass("py-0"),n.parent("div").removeClass("col-sm-12 col-md-7").addClass("w-50 px-0"),n.addClass("py-0"),n.find("ul.pagination").addClass("mb-0"),t.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),t.find("label").each(function(){$(this).addClass("mb-0 pb-0 mr-3 d-inline-block")}),r.removeClass("custom-select custom-select-sm form-control form-control-sm"),r.addClass("form-control d-inline-block"),"display_list"===o&&$("#"+i+">tbody>tr").css({cursor:"pointer"})},d=function(e){if(e)try{$("#"+i+"_tr_"+e.id).addClass("selected"),a.page.jumpToData(e.id,0)}catch(e){}},s=function(){try{let e=$("#"+i+"> tbody  > tr");$.each(e,function(e,t){$(t).removeClass("selected")})}catch(e){}};if(l)try{a=$(this).DataTable({pageLength:5,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],data:n,searching:!0,columnDefs:t}),e.rowClick&&a.on("click","tr",function(t){if($(this).find("td").hasClass("dataTables_empty"));else if(s(),"TH"===t.target.nodeName);else{$(this).addClass("selected");let t=a.row(this).data();e.rowClick(t)}}),r()}catch(e){}return{insertRow:function(e){!function(e){if(e)try{a.row.add(e).node().id=i+"_tr_"+e.id,a.draw(!1),a.page.jumpToData(e.id,0),r()}catch(e){}}(e)},clearSelectedRows:function(){s()},deleteRow:function(e){!function(e){if(e)try{let t="#"+i+"_tr_"+e.id;a.row(t).remove().draw()}catch(e){}}(e)},loadRow:function(e){d(e)},updateRow(e){!function(e){if(e)try{let t="#"+i+"_tr_"+e.id;a.row(t).data(e).draw(),d(e.id)}catch(e){}r()}(e)},jumpToRow:function(e){!function(e){if(console.log("table:jumpToRow(row_data)",e),e)try{a.page.jumpToData(e.id,0)}catch(e){console.log("error",e)}}(e)}}},$.fn.BuildKeyword=function(e){let t,a,n,o,i,l,r,d,s=0,c=null,u=new Map;if(!$(this).hasClass("keyword")||!$(this).attr("id"))return;if(t=(n=$(this).attr("id"))+"_search",a=n+"_container",o=document.getElementById(n),i=document.getElementById(t),!(l=document.getElementById(a))||!i||!o)return console.log("|__ MISSING FIELDS: _container - ",l),console.log("|__ MISSING FIELDS: _input - ",i),void console.log("|__ MISSING FIELDS: _chips - ",o);r=$(i),d=$(l),e||(e=[]),"string"==typeof e&&(e=e.split(",").map(function(e){return e.trim()})),jQuery.event.special.destroyed={remove:function(e){e.handler&&e.handler()}},r.on("keydown",function(e){console.log("|__ e.keyCode",e.keyCode),console.log("|__ e.which",e.which),13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),h(),c=null),9===e.which&&(h(),c=null)});const p=function(e){if(e){let t=e,a=t.text();u.get(a)&&(t.remove(),u.delete(a))}},_=function(e){},m=function(e){let t=u.get(e);if(t)toastr.error(`A tag for ${e} already exists`),u.set(e,t);else{let t=function(e){if(s+=1,e){let t=$("<div>"),a=$("<i>");return a.addClass("close fas fa-times").on("click",function(e){e.stopPropagation();let t=$(this).parents("div.chip");var a;a=(e=>{e&&($id=t.attr("id"),p(t))}),$('\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-danger" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">Would you like to delete?</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-times fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-danger btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-danger waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    ').appendTo("body"),$("#modalConfirm").modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){a(!0),$("#modalConfirm").modal("hide")}),$(".btn-no").click(function(){a(!1),$("#modalConfirm").modal("hide")}),$("#modalConfirm").on("hidden.bs.modal",function(){$("#modalConfirm").remove()})}),t.addClass("chip blue lighten-4 waves-effect").text(e).append(a).attr("id",n+"_"+s).on("click",function(e){let t=$(this);c=u.get(t.text());let a=t.attr("id");_(a)}),t}}(e);t&&(u.set(e,t),d&&d.append(t))}},g=function(e){$.each(e,function(e,t){t&&h(t)})},h=function(e){e||(e=r.val()),""!==e&&(m(e),r.val(""))};return g(e),{readOnly:function(e){!function(e){!0===e?(i.disabled=!0,$(i).addClass("disabled"),$(l).addClass("disabled")):(i.disabled=!1,$(i).removeClass("disabled"),$(l).removeClass("disabled"))}(e)},clear:function(){u=new Map,r.val(""),d.empty()},add:function(e){m(e)},delete:function(e){p(e)},build:function(){let e=[],t=Array.from(u.values());for(let a=0;a<t.length;a++){let n=t[a].text();e.push(n)}return e.join(",")},set:function(e){!function(e){let t;t="string"==typeof e?""!==e?e.toString().replace(/,\s/g,",").trim().split(","):[]:"object"==typeof e?e:[],d&&d.empty(),$.each(t,function(e,t){h(t)})}(e)},init:function(){g()}}};const InventoryProfile=function(){"use strict";const e=document.getElementById("panel_tab_inventory"),t=document.getElementById("table_profile_product_edit_add_new_button"),a=document.getElementById("product_edit_profile_form_profile_transfer_sales_types_id_block"),n=document.getElementById("product_edit_profile_form_profile_allot_by_id_block"),o=document.getElementById("table_profile_product_edit"),i=document.getElementById("product_edit_profile_form_profile_days_out_block"),l=document.getElementById("product_edit_profile_form_profile_expires_block"),r=document.getElementById("product_edit_profile_form_profile_quantity_block"),d=document.getElementById("product_edit_profile_form_profile_release_amt_block"),s=document.getElementById("product_edit_profile_form"),c=document.getElementById("product_edit_profile_form_profile_id"),u=document.getElementById("product_edit_profile_form_profile_name"),p=document.getElementById("product_edit_profile_form_profile_enabled"),_=document.getElementById("product_edit_profile_form_profile_sales_types_id"),m=document.getElementById("product_edit_profile_form_profile_allot_by_id"),g=document.getElementById("product_edit_profile_form_profile_transfer_sales_types_id"),h=document.getElementById("product_edit_profile_form_profile_days_out"),f=document.getElementById("product_edit_profile_form_profile_quantity"),v=document.getElementById("product_edit_profile_form_profile_release_amt"),y=document.getElementById("product_edit_profile_form_profile_min_length_days"),b=document.getElementById("product_edit_profile_form_profile_min_duration"),I=document.getElementById("product_edit_profile_form_profile_max_duration"),E=document.getElementById("product_edit_profile_form_profile_equal_duration"),w=document.getElementById("product_edit_profile_form_profile_advanced_booking_min"),C=document.getElementById("product_edit_profile_form_profile_advanced_booking_max"),k=document.getElementById("product_edit_profile_form_profile_checkin_dow"),S=document.getElementById("product_edit_profile_form_profile_checkout_dow"),N=document.getElementById("product_edit_profile_form_profile_departure_dow"),B=document.getElementById("product_edit_profile_form_profile_return_dow"),x=document.getElementById("product_edit_profile_form_profile_inc_days_dow"),L=document.getElementById("product_edit_profile_form_profile_weekday_dow"),M=document.getElementById("product_edit_profile_form_close_button"),P=document.getElementById("button_add_product_profile"),D=document.getElementById("product_edit_profile_form_clear_button"),F=document.getElementById("product_edit_profile_form_submit_button"),T=document.getElementById("product_id"),R=document.getElementById("button_remove_profile_from_product");let A,q,O,Y,U,W,Q=$(o),V=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,j={rules:{product_edit_profile_form_profile_sales_types_id:{required:!0},product_edit_profile_form_profile_allot_by_id:{required:function(e){return""!==$(_).val()&&1===$(_).val()||"1"===$(_).val()}},profile_expires:{required:function(e){return""!==$(m).val()&&1===$(m).val()||"1"===$(m).val()}},product_edit_profile_form_profile_days_out:{required:function(e){return""!==$(m).val()&&2===$(m).val()||"2"===$(m).val()},number:!0,min:1},product_edit_profile_form_profile_name:{required:!0}},messages:{product_edit_profile_form_profile_sales_types_id:{required:"Field Required"},product_edit_profile_form_profile_allot_by_id:{required:"Field Required"},profile_expires:{required:"Field Required"},product_edit_profile_form_profile_days_out:{required:"Field Required"},product_edit_profile_form_profile_name:{required:"Field Required"}}};$(P).on("click",function(){le()}),$(t).on("click",function(){Q.clearSelectedRows(),le()}),$(D).on("click",function(){Q.clearSelectedRows(),ne(),ee()}),$(F).on("click",function(){de()}),$(M).on("click",function(){Q.clearSelectedRows(),ne(),J(),ee()}),$(_).on("change",function(){J(),InventoryProfile.expiration_date.value(""),h.value="",m.value=""}),$(m).on("change",function(){J(),InventoryProfile.expiration_date.value(""),h.value=""}),$(g).on("change",function(){}),$(R).on("click",function(){H()}),$(e).on("hide.bs.tab",function(){Q.clearSelectedRows(),ne(),J(),ee()});const z=function(){0===Array.from(InventoryProfile.all.values()).length?$(e).html('Inventory <span id="profileNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>'):$(e).html("Inventory"),Product.updateProgress()},H=function(){let e={product_id:parseInt(T.value),profile_id:parseInt(c.value)};e&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&function(e,t){if(e){let a="/api/v1.0/profiles/remove";try{sendPostRequest(a,e,function(e,a,n){return e?t(e):se("Oops: 1")})}catch(e){}}}(e,function(t){if(t){let t=re(InventoryProfile.all.get(e.profile_id));InventoryProfile.all.delete(t.id),Q.deleteRow(t),Q.clearSelectedRows(),PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.resetForm(),PricingWorksheet.status(),z(),le(),ee(),toastr.success(`InventoryProfile: ${t.name} - has been removed`),YearCalendar.endLoading()}})})},K=function(){Q=$(o).table({table_type:"display_list",data:[],columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Sales Types",targets:1,data:"sales_types_details",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+(e.name?e.name:"N/A")+"</span>"}},{title:"Allot By",targets:2,data:"allot_by_id",render:function(e,t,a,n){let o="N/A";return"<span style='white-space: nowrap;'>"+(o=null===e?"N/A":(o=Types.allot_by.get(e))?o.name:"N/A")+"</span>"}},{title:"Expires",targets:3,data:"expires",render:function(e,t,a,n){let o;if(null===e)o="N/A";else{let t=e.replace(/-|\s/g,"");o=moment(t).format("YYYY-MM-DD")}return"<span style='white-space: nowrap;'>"+o+"</span>"}},{title:"Release",targets:4,data:"release_amt",render:function(e,t,a,n){let o="N/A";return e&&(o=e),"<span style='white-space: nowrap;'>"+o+"</span>"}}],rowClick:InventoryProfile.edit})},G=function(e){InventoryProfile.all=new Map,e||(e=[]),$.each(e,function(e,t){let a=re(t);isNaN(parseInt(a.id))||(o&&Q.insertRow(a),InventoryProfile.all.set(parseInt(a.id),a))}),Pricing.loadProfileDropdown(),z()},J=function(){let e=isNaN(parseInt(_.value))?null:parseInt(_.value);if(X(),e)switch(e){case 1:Z()}},Z=function(){let e=isNaN(parseInt(m.value))?null:parseInt(m.value);if(e)switch(e){case 1:$(i).hide(),$(l).show();break;case 2:$(i).show(),$(l).hide();break;case 3:default:$(i).hide(),$(l).hide()}$(a).show(),$(r).show(),$(d).show(),$(n).show()},X=function(){$(i).hide(),$(l).hide(),$(n).hide(),$(a).hide(),$(r).hide(),$(d).hide(),$("#accordionEx").collapse("hide")},ee=function(){s&&(X(),$(s).hide(),$("#accordionEx").collapse("hide"),z())},te=function(){s&&$(s).show()},ae=function(){ne(),ie()},ne=function(){ie(),c.value="",u.value="",p.checked=!0,_.value="",m.value="",g.value="",h.value="",f.value="",v.value="",y.value="",b.value="",I.value="",E.value="",w.value="",C.value="",InventoryProfile.checkin_dow.init([0,1,2,3,4,5,6]),InventoryProfile.checkout_dow.init([0,1,2,3,4,5,6]),InventoryProfile.departure_dow.init([0,1,2,3,4,5,6]),InventoryProfile.return_dow.init([0,1,2,3,4,5,6]),InventoryProfile.weekday_dow.init([0,1,2,3,4,5,6]),InventoryProfile.inc_days_dow.init([0,1,2,3,4,5,6]),InventoryProfile.expiration_date.value(""),InventoryProfile.advanced_booking_date.value(""),J()},oe=function(){let e=$(s).valid();if(e){if(1===(isNaN(parseInt(m.value))?3:parseInt(m.value))){let t=InventoryProfile.expiration_date.value();null===t||""===t?(setError(document.getElementById("profile_expires"),"Field Required"),e=!1):clearError(document.getElementById("profile_expires"))}}return e},ie=function(){u.disabled=!1},le=function(e){ne(),e&&(c.value=e.id?e.id:"",u.value=e.name?e.name:"",p.checked=0!==e.enabled,_.value=e.sales_types_id?e.sales_types_id:"",m.value=e.allot_by_id?e.allot_by_id:"",g.value=e.transfer_sales_types_id?e.transfer_sales_types_id:"",h.value=e.days_out?e.days_out:"",f.value=e.quantity?e.quantity:"",v.value=e.release_amt?e.release_amt:"",y.value=e.min_length_days?e.min_length_days:"",b.value=e.min_duration?e.min_duration:"",I.value=e.max_duration?e.max_duration:"",E.value=e.equal_duration?e.equal_duration:"",w.value=e.advanced_booking_min?e.advanced_booking_min:"",C.value=e.advanced_booking_max?e.advanced_booking_max:"",InventoryProfile.checkin_dow.init(e.checkin_dow?e.checkin_dow:[0,1,2,3,4,5,6]),InventoryProfile.checkout_dow.init(e.checkout_dow?e.checkout_dow:[0,1,2,3,4,5,6]),InventoryProfile.departure_dow.init(e.departure_dow?e.departure_dow:[0,1,2,3,4,5,6]),InventoryProfile.return_dow.init(e.return_dow?e.return_dow:[0,1,2,3,4,5,6]),InventoryProfile.weekday_dow.init(e.weekday_dow?e.weekday_dow:[0,1,2,3,4,5,6]),InventoryProfile.inc_days_dow.init(e.inc_days_dow?e.inc_days_dow:[0,1,2,3,4,5,6]),InventoryProfile.expiration_date.value(e.expires?e.expires:""),InventoryProfile.advanced_booking_date.value(e.advanced_booking_date?e.advanced_booking_date:"")),J(),te()},re=function(e){let t,a,n,o={id:null,allot_by_id:null,sales_types_id:null,name:null,quantity:null,expires:null,transfer_sales_types_id:null,release_amt:null,min_length_days:null,checkin_dow:[0,1,2,3,4,5,6],checkout_dow:[0,1,2,3,4,5,6],departure_dow:[0,1,2,3,4,5,6],return_dow:[0,1,2,3,4,5,6],inc_days_dow:[0,1,2,3,4,5,6],weekday_dow:[0,1,2,3,4,5,6],min_duration:null,max_duration:null,equal_duration:null,advanced_booking_min:null,advanced_booking_max:null,advanced_booking_date:null,days_out:null,enabled:1,date_created:formatDateMySQL(),created_by:V,date_modified:formatDateMySQL(),modified_by:V,note:null,sales_types_details:{},allot_by_details:{},tranfer_sales_type_details:{}};if(e){let i=getListOfIds(e.checkin_dow),l=getListOfIds(e.checkout_dow),r=getListOfIds(e.departure_dow),d=getListOfIds(e.return_dow),s=getListOfIds(e.inc_days_dow),c=getListOfIds(e.weekday_dow);t=Types.sales_types.get(isNaN(parseInt(e.sales_types_id))?null:parseInt(e.sales_types_id)),a=Types.allot_by.get(isNaN(parseInt(e.allot_by_id))?null:parseInt(e.allot_by_id)),n=Types.sales_types.get(isNaN(parseInt(e.transfer_sales_types_id))?null:parseInt(e.transfer_sales_types_id)),o.id=isNaN(parseInt(e.id))?null:parseInt(e.id),o.allot_by_id=isNaN(parseInt(e.allot_by_id))?null:parseInt(e.allot_by_id),o.sales_types_id=isNaN(parseInt(e.sales_types_id))?null:parseInt(e.sales_types_id),o.name=e.name?e.name:null,o.quantity=isNaN(parseInt(e.quantity))?null:parseInt(e.quantity),o.expires=e.expires?e.expires:null,o.transfer_sales_types_id=isNaN(parseInt(e.transfer_sales_types_id))?null:parseInt(e.transfer_sales_types_id),o.release_amt=e.release_amt?e.release_amt:null,o.min_length_days=e.min_length_days?e.min_length_days:null,o.min_duration=e.min_duration?e.min_duration:null,o.max_duration=e.max_duration?e.max_duration:null,o.equal_duration=e.equal_duration?e.equal_duration:null,o.advanced_booking_min=e.advanced_booking_min?e.advanced_booking_min:null,o.advanced_booking_max=e.advanced_booking_max?e.advanced_booking_max:null,o.advanced_booking_date=e.advanced_booking_date?e.advanced_booking_date:null,o.checkin_dow=i,o.checkout_dow=l,o.departure_dow=r,o.return_dow=d,o.inc_days_dow=s,o.weekday_dow=c,o.days_out=e.days_out?e.days_out:null,o.enabled=e.enabled?e.enabled:1,o.date_created=e.date_created?e.date_created:formatDateMySQL(),o.created_by=isNaN(parseInt(e.created_by))?V:parseInt(e.created_by),o.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),o.modified_by=isNaN(parseInt(e.modified_by))?V:parseInt(e.modified_by),o.note=e.note?e.note:null,o.sales_types_details=t,o.allot_by_details=a,o.tranfer_sales_type_details=n}return InventoryProfile.detail=o,o},de=function(){let e=!!oe()&&remove_nulls({id:isNaN(parseInt(c.value))?null:parseInt(c.value),name:""!==u.value?u.value:null,product_id:isNaN(parseInt(T.value))?null:parseInt(T.value),sales_types_id:isNaN(parseInt(_.value))?null:parseInt(_.value),transfer_sales_types_id:isNaN(parseInt(g.value))?null:parseInt(g.value),allot_by_id:isNaN(parseInt(m.value))?3:parseInt(m.value),enabled:!0===p.checked?1:0,expires:InventoryProfile.expiration_date.value(),advanced_booking_date:InventoryProfile.advanced_booking_date.value(),checkin_dow:null===formatListOfIds(InventoryProfile.checkin_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.checkin_dow.disabled_dows),checkout_dow:""===formatListOfIds(InventoryProfile.checkout_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.checkout_dow.disabled_dows),departure_dow:""===formatListOfIds(InventoryProfile.departure_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.departure_dow.disabled_dows),return_dow:""===formatListOfIds(InventoryProfile.return_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.return_dow.disabled_dows),weekday_dow:""===formatListOfIds(InventoryProfile.weekday_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.weekday_dow.disabled_dows),inc_days_dow:""===formatListOfIds(InventoryProfile.inc_days_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.inc_days_dow.disabled_dows),days_out:isNaN(parseInt(h.value))?null:parseInt(h.value),release_amt:isNaN(parseInt(v.value))?null:parseInt(v.value),min_length_days:isNaN(parseInt(y.value))?"":parseInt(y.value),min_duration:isNaN(parseInt(b.value))?null:parseInt(b.value),max_duration:isNaN(parseInt(I.value))?null:parseInt(I.value),equal_duration:isNaN(parseInt(E.value))?null:parseInt(E.value),advanced_booking_min:isNaN(parseInt(w.value))?null:parseInt(w.value),advanced_booking_max:isNaN(parseInt(C.value))?null:parseInt(C.value)});e&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&ce(e,function(e){if(e){let t=re(e[0]?e[0]:e);InventoryProfile.all.get(t.id)?Q.updateRow(t):Q.insertRow(t),InventoryProfile.all.set(t.id,t),Q.loadRow(t),Q.jumpToRow(t),Q.clearSelectedRows(),PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),z(),le(),ee(),toastr.success(`InventoryProfile: ${t.name} - has been updated`),YearCalendar.endLoading()}})})},se=function(e){toastr.error(e)},ce=function(e,t){if(e){let a="/api/v1.0/profiles/update";try{sendPostRequest(a,e,function(e,a,n){return e?t(e):se("Oops: 1")})}catch(e){}}};return{validator:null,all:new Map,detail:{},expiration_date:null,advanced_booking_date:null,checkin_dow:null,checkout_dow:null,departure_dow:null,return_dow:null,weekday_dow:null,inc_days_dow:null,initProductEdit:function(e){!function(e){let t=[];e&&e.profiles&&(t=e.profiles),A=$(k).DisabledDOW({name:"checkin_dow",label:"Checkin DOW"}),q=$(S).DisabledDOW({name:"checkout_dow",label:"Checkout DOW"}),O=$(N).DisabledDOW({name:"departure_dow",label:"Departure DOW"}),Y=$(B).DisabledDOW({name:"return_dow",label:"Return DOW"}),W=$(x).DisabledDOW({name:"inc_days_dow",label:"Included Days"}),U=$(L).DisabledDOW({name:"weekday_dow",label:"Weekdays"}),InventoryProfile.checkin_dow=A,InventoryProfile.checkout_dow=q,InventoryProfile.departure_dow=O,InventoryProfile.return_dow=Y,InventoryProfile.weekday_dow=U,InventoryProfile.inc_days_dow=W,InventoryProfile.advanced_booking_date=$("#profile_advanced_booking_date").dateSelect({onStart:function(){}}),InventoryProfile.expiration_date=$("#profile_expires").dateSelect({onStart:function(){}}),o&&K(),s&&(validator_init(j),InventoryProfile.validator=$(s).validate(),ae(),ee()),G(t)}(e)},init:function(e){!function(e){let t=[];e&&e.profiles&&(t=e.profiles),A=$(k).DisabledDOW({name:"checkin_dow",label:"Checkin DOW"}),q=$(S).DisabledDOW({name:"checkout_dow",label:"Checkout DOW"}),O=$(N).DisabledDOW({name:"departure_dow",label:"Departure DOW"}),Y=$(B).DisabledDOW({name:"return_dow",label:"Return DOW"}),W=$(x).DisabledDOW({name:"inc_days_dow",label:"Included Days"}),U=$(L).DisabledDOW({name:"weekday_dow",label:"Weekdays"}),InventoryProfile.checkin_dow=A,InventoryProfile.checkout_dow=q,InventoryProfile.departure_dow=O,InventoryProfile.return_dow=Y,InventoryProfile.weekday_dow=U,InventoryProfile.inc_days_dow=W,InventoryProfile.advanced_booking_date=$("#profile_advanced_booking_date").dateSelect({onStart:function(){}}),InventoryProfile.expiration_date=$("#profile_expires").dateSelect({onStart:function(){}}),$(document).ready(function(){o&&K(),s&&(validator_init(j),InventoryProfile.validator=$(s).validate(),ae(),ee()),G(t)})}(e)},initAutoComplete:function(){isNaN(parseInt(T.value))||parseInt(T.value)},edit:function(e){!function(e){if(e){Q.clearSelectedRows();let t=re(e);te(),Q.loadRow(t),le(t)}}(e)}}}(),PricingWorksheet=function(){"use strict";const e=document.getElementById("product_edit_matrix_form"),t=["sun","mon","tue","wed","thu","fri","sat"],a=document.getElementById("product_edit_pricing_section_reset_filters"),n=document.getElementById("pricing_strategy_types_id"),o=document.getElementById("product_id"),i=document.getElementById("pricing_strategy_unit_id"),l=document.getElementById("pricing_strategy_season_id"),r=document.getElementById("button_collapse_seasons"),d=document.getElementById("button_collapse_units"),s=document.getElementById("button_toggle_completed_pricings"),c=document.getElementById("button_toggle_completed_matrices"),u=document.getElementById("product_edit_pricing_section_reload_worksheet");let p,_,m,g,h,f=!1,v='<span class="badge badge-pill badge-success">Completed</span>',y='<span class="badge badge-pill badge-danger">Incomplete</span>',b=[],I=[],E=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(u).on("click",function(){$(n).val(PricingWorksheet.pricingStrategyId).trigger("change")}),$(a).on("click",function(){x()}),$(n).on("change",function(){}),$(i).on("change",function(){L()}),$(l).on("change",function(){M()}),$(a).on("click",function(){x()}),$(s).on("click",function(){S()}),$(c).on("click",function(){k()}),$(r).on("click",function(){B()}),$(d).on("click",function(){N()});const w=function(){console.groupCollapsed("PricingWorksheet.status");let e=!1,t="complete",a=Array.from(PricingWorksheet.incompletePricings.values()),n=Array.from(PricingWorksheet.incompleteMatrices.values());return(a.length>0||n.length>0)&&(e=!0),$("<span>",{class:"badge rounded-pill badge-notification bg-danger tab-badge",alt:"Notification",css:{color:"rgb(255, 255, 255) !important"},text:"!"}),!0===e?(t="incomplete",$("#panel_tab_pricing").html("Pricing<span class='badge rounded-pill badge-notification bg-danger tab-badge' style='color:#fff!important'>!</span>")):(t="complete",$("#panel_tab_pricing").html("Pricing")),console.groupEnd(),t},C=function(e,a){let n,o;console.groupCollapsed("PricingWorksheet.isDisabled");let i=-1,l=[],r={};return a&&e&&(n=Season.all.get(a))&&(r=n.product_season_detail?n.product_season_detail:{},l=getListOfIds(r.disabled_dow.trim()),o=t.indexOf(e),i=l.indexOf(o)),console.groupEnd(),i>=0},k=function(e){console.groupCollapsed("PricingWorksheet.toggleCompletedMatrices");let t=!0;e&&(t=e),$(c).attr("data-shown")||$(c).attr("data-shown",!0===t?"true":"false"),"false"===$(c).attr("data-shown")?($(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices"),t=!0):($(c).attr("data-shown","false"),$(c).text("Show Completed Matrices"),t=!1),t?($("[data-matrixcomplete='true']").show(),_=!1):(_=!0,$("[data-matrixcomplete='true']").hide()),console.groupEnd()},S=function(){console.groupCollapsed("PricingWorksheet.toggleCompletedPricings");let e=!0;$(s).attr("data-shown")||$(s).attr("data-shown",!0===e?"true":"false"),"false"===$(s).attr("data-shown")?($(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings"),e=!0):($(s).attr("data-shown","false"),$(s).text("Show Completed Pricings"),e=!1),e?($("[data-pricingcomplete='true']").show(),p=!1):($("[data-pricingcomplete='true']").hide(),p=!0),console.groupEnd()},N=function(){console.groupCollapsed("PricingWorksheet.toggleUnitFilter");let e,t=document.querySelectorAll("[data-type='unit']");$(d).attr("data-shown")||($(d).attr("data-shown","true"),e=!0),"false"===$(d).attr("data-shown")?($(d).attr("data-shown","true"),$(d).text("Collapse Units"),e=!0):($(d).attr("data-shown","false"),$(d).text("Expand Units"),e=!1);for(let a=0;a<t.length;a++){let n=t[a],o=$(n).attr("id");$("#"+o).collapse(!0===e?"show":"hide"),m=!0===e}console.groupEnd()},B=function(){console.groupCollapsed("PricingWorksheet.toggleSeasonFilter");let e=document.querySelectorAll("[data-type='season']"),t=!0;$(r).attr("data-shown")||$(r).attr("data-shown","true"),"false"===$(r).attr("data-shown")?($(r).attr("data-shown","true"),$(r).text("Collapse Seasons"),t=!0):($(r).attr("data-shown","false"),$(r).text("Expand Seasons"),t=!1);for(let a=0;a<e.length;a++){let n=e[a],o=$(n).attr("id");$("#"+o).collapse(!0===t?"show":"hide"),f=!0===t}console.groupEnd()},x=function(){var e;console.groupCollapsed("PricingWorksheet.resetFilters"),$(a).html("<span class='spinner-border spinner-border-sm' role='status' aria-hidden='true'></span> Loading..."),e=function(e){e&&$(a).html("Reset Filters")},console.groupCollapsed("PricingWorksheet.filtersReset"),$("[data-matrixcomplete='true']").show(),$(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices"),$("[data-pricingcomplete='true']").show(),$(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings"),$(l).val([]).trigger("change"),$(i).val([]).trigger("change"),$(d).attr("data-shown","false"),$(d).text("Expand Units"),N(),$(r).attr("data-shown","false"),$(r).text("Expand Seasons"),B(),console.groupEnd(),e(1),console.groupEnd()},L=function(){console.groupCollapsed("PricingWorksheet.filterUnits"),function(){console.groupCollapsed("PricingWorksheet.hideAllFilterUnits");let e=Array.from(Unit.all.values());$.each(e,function(e,t){let a="unit-"+t.id,n=document.querySelectorAll(`[data-sectiontype='${a}']`);$.each(n,function(e,t){$(t).hide()})}),console.groupEnd()}();let e=getListOfIds($(i).val());e.length?$.each(e,function(e,t){let a="unit-"+t,n=document.querySelectorAll(`[data-sectiontype='${a}']`);$.each(n,function(e,t){$(t).show()})}):function(){console.groupCollapsed("PricingWorksheet.showAllFilterUnits");let e=Array.from(Unit.all.values());$.each(e,function(e,t){let a="unit-"+t.id,n=document.querySelectorAll(`[data-sectiontype='${a}']`);$.each(n,function(e,t){$(t).show()})}),console.groupEnd()}(),console.groupEnd()},M=function(){console.groupCollapsed("PricingWorksheet.filterSeasons"),function(){console.groupCollapsed("PricingWorksheet.hideAllFilterSeasons");let e=Array.from(Season.all.values());$.each(e,function(e,t){let a="season-"+t.id,n=document.querySelectorAll(`[data-sectiontype='${a}']`);$.each(n,function(e,t){$(t).hide()})}),console.groupEnd()}();let e=getListOfIds($(l).val());e.length?$.each(e,function(e,t){let a="season-"+t,n=document.querySelectorAll(`[data-sectiontype='${a}']`);$.each(n,function(e,t){$(t).show()})}):function(){console.groupCollapsed("PricingWorksheet.showAllFilterSeasons");let e=Array.from(Season.all.values());$.each(e,function(e,t){let a="season-"+t.id,n=document.querySelectorAll(`[data-sectiontype='${a}']`);$.each(n,function(e,t){$(t).show()})}),console.groupEnd()}(),console.groupEnd()},P=function(e){console.groupCollapsed("PricingWorksheet.getRowValues");let t,a,n,o,i=null,l=[],r={monCost:null,tueCost:null,wedCost:null,thuCost:null,friCost:null,satCost:null,sunCost:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null};if("true"!==$(e).attr("data-dowrow"))return o=$(e).attr("data-matrixid")?isNaN(parseInt($(e).attr("data-matrixid")))?null:parseInt($(e).attr("data-matrixid")):null,t=$(e).attr("data-pricingid")?isNaN(parseInt($(e).attr("data-pricingid")))?null:parseInt($(e).attr("data-pricingid")):null,a=$(e).attr("data-variantid")?isNaN(parseInt($(e).attr("data-variantid")))?null:parseInt($(e).attr("data-variantid")):null,n=$(e).attr("data-pricingcode")?$(e).attr("data-pricingcode"):null,i=$(e).attr("data-pricingcount")?isNaN(parseInt($(e).attr("data-pricingcount")))?null:parseInt($(e).attr("data-pricingcount")):null,l=e.getElementsByTagName("input"),$.each(l,function(e,t){let a=t.name?t.name:null,n=!!t.disabled&&t.disabled,o=t.value?t.value:null;is_null(a)||is_null(n)||n||(r[a]=isNaN(parseInt(o))?null:parseInt(o))}),console.groupEnd(),remove_nulls({id:t,matrix_id:o,variant_id:a,code:n,count:i,mon:r.monCost,tue:r.tueCost,wed:r.wedCost,thu:r.thuCost,fri:r.friCost,sat:r.satCost,sun:r.sunCost,monMargin:r.monMargin,tueMargin:r.tueMargin,wedMargin:r.wedMargin,thuMargin:r.thuMargin,friMargin:r.friMargin,satMargin:r.satMargin,sunMargin:r.sunMargin,enabled:1,note:null})},D=function(e){if(console.groupCollapsed("PricingWorksheet.getFormValues"),!e)return;let t=e.id,a=document.getElementById(t+"-table"),n=$(a).attr("data-productid"),o=$(a).attr("data-seasonid"),i=$(a).attr("data-unitid"),l=($(a).attr("data-matrixid"),{id:null,code:""!==e.elements.baseMatrixCode.value?e.elements.baseMatrixCode.value:"",product_id:isNaN(parseInt(n))?null:parseInt(n),season_id:isNaN(parseInt(o))?null:parseInt(o),unit_id:isNaN(parseInt(i))?null:parseInt(i),name:""!==e.elements.baseMatrixName.value?e.elements.baseMatrixName.value:"",cost:""!==e.elements.baseCost.value?parseInt(e.elements.baseCost.value):null,margin:""!==e.elements.baseMargin.value?parseInt(e.elements.baseMargin.value):null,has_pricing:1,been_saved:1,enabled:1,pricings:[],price:null});return l.id=$(a).attr("data-matrixid")?parseInt($(a).attr("data-matrixid")):null,l.pricings=function(e,t){console.groupCollapsed("PricingWorksheet.buildPricingData");let a=[];$(e).attr("data-productid"),$(e).attr("data-seasonid"),$(e).attr("data-unitid"),$(e).attr("data-matrixid");for(let n of e.rows){P(n);let e,o,i,l=null,r=[],d={monCost:null,tueCost:null,wedCost:null,thuCost:null,friCost:null,satCost:null,sunCost:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null};"true"!==$(n).attr("data-dowrow")&&(e=$(n).attr("data-pricingid")?isNaN(parseInt($(n).attr("data-pricingid")))?null:parseInt($(n).attr("data-pricingid")):null,o=$(n).attr("data-variantid")?isNaN(parseInt($(n).attr("data-variantid")))?null:parseInt($(n).attr("data-variantid")):null,i=$(n).attr("data-pricingcode")?$(n).attr("data-pricingcode"):null,l=$(n).attr("data-pricingcount")?isNaN(parseInt($(n).attr("data-pricingcount")))?null:parseInt($(n).attr("data-pricingcount")):null,r=n.getElementsByTagName("input"),$.each(r,function(e,t){let a=t.name?t.name:null,n=!!t.disabled&&t.disabled,o=t.value?t.value:null;is_null(a)||is_null(n)||n||(d[a]=isNaN(parseInt(o))?null:parseInt(o))}),a.push(remove_nulls({id:e,matrix_id:t.id,variant_id:o,code:i,count:l,mon:d.monCost,tue:d.tueCost,wed:d.wedCost,thu:d.thuCost,fri:d.friCost,sat:d.satCost,sun:d.sunCost,monMargin:d.monMargin,tueMargin:d.tueMargin,wedMargin:d.wedMargin,thuMargin:d.thuMargin,friMargin:d.friMargin,satMargin:d.satMargin,sunMargin:d.sunMargin,enabled:1,note:null})))}return console.groupEnd(),a}(a,l),console.groupEnd(),remove_nulls(l)},F=function(e,t,a){console.groupCollapsed("PricingWorksheet.handlePricingWorksheetError"),e||(e="There was an error."),t||(t="Pricing Worksheet"),a||(a="error"),toastr[a](e,t),console.groupEnd()},T=function(e,t){console.groupCollapsed("PricingWorksheet.sendUpdateRequest");if(e)try{sendPostRequest("/api/v1.0/matrices/update",e,function(e,a,n){return e?t(e):F("Oops: 1")})}catch(e){}console.groupEnd()},R=function(e,t){console.groupCollapsed("PricingWorksheet.sendUpdateRequestPricing");if(e)try{sendPostRequest("/api/v1.0/pricings/update",e,function(e,a,n){return e?t(e):F("Oops: 1")})}catch(e){}console.groupEnd()},A=function(e){console.groupCollapsed("PricingWorksheet.updateMatrix");let t=D(document.getElementById($(e).attr("data-targetform")));confirmDialog("Would you like to update?",e=>{e&&function(e){console.groupCollapsed("PricingWorksheet.update"),e&&T(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);let a=t.pricings?t.pricings:[];new Map,Matrix.all.set(t.code,t),$.each(a,function(e,t){Pricing.all.set(t.code,t)}),PricingWorksheet.pricingWorksheet(),Product.updateProgress(),toastr.success(`Matrix: ${t.name} - has been updated`,"Pricing Worksheet")}}),console.groupEnd()}(t)}),console.groupEnd()},q=function(e,t){console.groupCollapsed("PricingWorksheet.updatePricing");let a=P(t);confirmDialog("Would you like to update?",e=>{e&&function(e){console.groupCollapsed("PricingWorksheet.pricingUpdate"),e&&R(e,function(e){let t;e&&(t=e,e[0]&&(t=e[0]),Pricing.all.set(t.code,t),PricingWorksheet.pricingWorksheet(),f&&($(r).attr("data-shown","false"),$(r).text("Expand Seasons"),B()),m&&($(d).attr("data-shown","false"),$(d).text("Expand Units"),N()),_&&($("[data-matrixcomplete='true']").show(),$(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices")),p&&($("[data-pricingcomplete='true']").show(),$(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings")),toastr.success(`Pricing: ${t.name} - has been updated`))}),console.groupEnd()}(a)}),console.groupEnd()},O=function(e){console.groupCollapsed("PricingWorksheet.buildPricingRow");let a=isNaN(parseInt(o.value))?null:parseInt(o.value),i=e.matrix_code,l=$("<form/>",{id:"pricingMatrixForm-"+i,class:"card card-body border border-dark rounded-lg mb-2 mt-2 p-0 ",attr:{novalidate:"novalidate"}});e&&e.been_saved&&1===e.been_saved?(l.attr("data-matrixcomplete","true"),PricingWorksheet.incompleteMatrices.get(i)&&PricingWorksheet.incompleteMatrices.delete(i)):(PricingWorksheet.incompleteMatrices.set(i,e),l.attr("data-matrixcomplete","false"));let r=$("<div/>",{class:"pl-1 pr-1"}),d=$("<div/>",{class:"row"}),s=$("<div/>",{class:"col-12"}),c=function(e){console.groupCollapsed("PricingWorksheet.buildTableVariantHeadingBaseInputs");let t=$("<div/>",{class:"p-2"}),a=$("<div/>",{class:"row"});if(e){let n,o=e.matrix_code,i=Matrix.all.get(o),l="",r=e.name?e.name:"",d=!1,s=null;i&&(l=i.id?i.id:null,s=i.margin?i.margin:null,n=i.cost?i.cost:null,d=1===e.been_saved);let c=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),u=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),p=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),_=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),m=$("<label/>",{class:"",for:"base_cost_"+o,text:"Cost"}),g=$("<label/>",{class:"",for:"base_margin_"+o,text:"Margin"}),h=$("<label/>",{class:"dev-element d-none",for:"base_matrix_id_"+o,text:"Matrix Id:"}),f=$("<div/>",{class:"form-element"}),v=$("<label/>",{class:"dev-element d-none",for:"base_matrix_name_"+o,text:"Matrix Name:"}),y=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixName",readonly:"readonly",disabled:"disabled",id:"base_matrix_name_"+o}).val(r),b=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixId",readonly:"readonly",disabled:"disabled",id:"base_matrix_id_"+o}).val(l),I=$("<input/>",{class:"form-control",id:"base_cost_"+o,name:"baseCost",attr:{"data-targetform":"pricingMatrixForm-"+o}}).on("keyup",function(){let e=document.getElementById($(this).attr("data-targetform"));this.value,e.querySelectorAll(".cost").forEach(e=>{e.disabled||($(e).val(this.value),""!==this.value?$(e).parent("div").find("label").addClass("active"):$(e).parent("div").find("label").removeClass("active"))})}).on("click",function(){$(this).select()}).val(n),E=$("<input/>",{class:"form-control",id:"base_margin_"+o,name:"baseMargin",attr:{"data-targetform":"pricingMatrixForm-"+o}}).on("keyup",function(){document.getElementById($(this).attr("data-targetform")).querySelectorAll(".margin").forEach(e=>{e.disabled||($(e).val(this.value),""!==this.value?$(e).parent("div").find("label").addClass("active"):$(e).parent("div").find("label").removeClass("active"))})}).on("click",function(){$(this).select()}).val(s),w=$("<div/>",{class:"form-element"}),C=$("<div/>",{class:"form-element"}),k=$("<div/>",{class:"form-element"}),S=$("<label/>",{class:"dev-element d-none",for:"base_matrix_code_"+o,text:"Matrix Code:"}),N=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixCode",readonly:"readonly",disabled:"disabled",id:"base_matrix_code_"+o}).val(o),B=$("<div/>",{class:"form-element"}),x=$("<div/>",{class:"error w-100 text-center"}),L=$("<div/>",{class:"error w-100 text-center"});C.append(h,b),w.append(m,I,x),B.append(g,E,L),k.append(S,N),f.append(v,y),c.append(w),u.append(B),p.append(C),_.append(k,f),a.append(c,u,p,_),t.append(a)}return console.groupEnd(),t}(e),u=function(e){console.groupCollapsed("PricingWorksheet.buildPricingButtonRow");let t=e.matrix_code,a=$("<div/>",{class:"row"}),n=$("<div/>",{class:"col-12 col-md-6 mb-2 text-left"}),o=$("<div/>",{class:"col-12 col-md-6 mb-2 text-right"}),i=$("<button/>",{class:"btn btn-primary btn-sm submit-pricing-matrix-form waves-effect waves-light",text:"Update",type:"button",id:"submitPricingMatrixForm-"+t,attr:{"data-targetform":"pricingMatrixForm-"+t}}).on("click",function(){A(this)});return o.append(i),console.groupEnd(),a.append(n,o)}(e),p=$("<table/>",{class:"table table-bordered table-sm",id:"pricingMatrixForm-"+i+"-table",attr:{"data-matrixcode":i,"data-productid":a,"data-unitid":e.unit_id,"data-seasonid":e.season_id,"data-name":e.name}});e.id&&p.attr("data-matrixid",e.id);let _=$("<tbody/>",{}),m=$("<thead/>",{}).append(function(e){console.groupCollapsed("PricingWorksheet.tableDOW");let a=$("<tr/>"),n=$("<th/>",{html:"&nbsp;"}),o=$("<th/>",{css:{width:"120px"}});if(a.attr("data-dowrow","true"),a.append(o),e){let o=!1,i=Matrix.all.get(e.pricing_code);i&&(o=!(!i.been_saved||1!==i.been_saved));for(let n=0;n<t.length;n++){let o="",i=ucwords(t[n]);C(n,e.season_id)&&(o="disabled",i=ucwords(t[n])+" (disabled)");let l=$("<th/>",{class:""+o,text:i});a.append(l)}a.append(n)}return console.groupEnd(),a}(e));for(let n=0;n<e.variants.length;n++){let o=e.variants[n],l=y;o.matrix_code=i;let r=$("<tr/>"),d=$("<i/>",{class:"far fa-edit"});r.attr({id:"tr-"+o.code,"data-variantid":o.variant_id?o.variant_id:null,"data-pricingid":o.id?o.id:null,"data-pricingcode":o.code?o.code:null,"data-matrixcode":o.matrix_code?o.matrix_code:null,"data-pricingcount":o.count?o.count:null,"data-productid":a,"data-targetform":"pricingMatrixForm-"+o.matrix_code,"data-seasonid":o.season_id?o.season_id:null,"data-name":o.name?o.name:null}),1===o.been_saved?(r.attr("data-pricingcomplete","true"),l=v):(r.attr("data-pricingcomplete","false"),PricingWorksheet.incompletePricings.set(o.pricing_code,o));let s=$(`\n                        <td style="padding:0;">\n                            <div class="d-flex flex-column">\n                                <div class="p-1">\n                                    ${l}\n                                </div>\n                                <div class="p-1">\n                                    <span class="table-variant-title">${e.name}</span>\n                                </div>\n                               \n                            </div>\n                        </td>\n                    `);r.append(s);let c=$("<button/>",{class:"btn btn-sm editRow btn-sm btn-teal waves-effect waves-light",type:"button",attr:{"data-variantid":o.variant_id?o.variant_id:null,"data-pricingid":o.id?o.id:null,"data-pricingcode":o.code?o.code:null,"data-matrixcode":o.matrix_code?o.matrix_code:null,"data-pricingcount":o.count?o.count:null,"data-productid":a,"data-targetform":"pricingMatrixForm-"+o.matrix_code,"data-seasonid":o.season_id?o.season_id:null,"data-name":o.name?o.name:null}}).append(d);o.matrix_id&&c.attr("data-matrixid",o.matrix_id),c.on("click",function(){let e=document.getElementById("tr-"+o.code);e&&q(0,e)});for(let e=0;e<t.length;e++){let a=$("<td/>");a.append(U(o,t[e]),Y(o,t[e])),r.append(a)}let u=$("<td/>",{class:"text-center td-editor"}).append(c);r.append(u),_.append(r)}p.append(m,_),r.append(p),s.append(r),d.append(s);let g=function(e){let t;console.groupCollapsed("PricingWorksheet.tableVariantHeading");let a=$("<h5/>",{class:"card-title d-flex justify-content-between m-2"});e&&((t=Matrix.all.get(e.pricing_code))||(t=Matrix.set()));let o=e.name?e.name:"Pricing";1===parseInt(n.value)?o="Unit Pricing":3===parseInt(n.value)&&(o="Daily Pricing");let i=$("<span/>",{class:"",text:o||"Pricing Variant"});return e&&e.been_saved&&1===e.been_saved?a.append(i,v):a.append(i,y),console.groupEnd(),a}(e),h=$("<hr/>",{class:"ml-3 mr-3 mt-1 mb-3 color-dark"});return console.groupEnd(),l.append(g,h,c,d,u)},Y=function(e,t){console.groupCollapsed("PricingWorksheet.buildMarginElement");let a=e.matrix_code,n=a+"-"+e.variant_id+"-"+e.count,o=Pricing.all.get(n);if(o||((o=Pricing.set()).note="generated form"),o.product_id=e.product_id,o.season_id=e.product_id,o.unit_id=e.product_id,o.variant_id=e.variant_id,o.matrix_code=a,o.pricing_code=n,o.name=e.name,o.code=n,t){C(t,e.season_id);let a=t+"Margin",i=o[a]?o[a]:null,l=$("<input/>",{type:"text",id:"cm-"+n+"-"+t,name:a,class:"form-control margin m-0"}).attr("data-element","margin"),r=$("<div/>",{class:"md-form md-outline form-sm input-with-post-icon mb-2 mt-3"}),d=$("<label/>",{text:"Margin",for:"cm-"+n+"-"+t}),s=$("<i/>",{class:"fas fa-percentage input-prefix"});return C(t,e.season_id)?(l.attr("disabled","disabled"),l.val(""),d.removeClass("active"),r.addClass("disabled")):(r.removeClass("disabled"),i>0&&(l.val(i),d.addClass("active"))),r.append(s,l,d),r}console.groupEnd()},U=function(e,t){console.groupCollapsed("PricingWorksheet.buildCostElement");let a=e.matrix_code,n=a+"-"+e.variant_id+"-"+e.count,o=Pricing.all.get(n);if(o||((o=Pricing.set()).note="generated form"),o.product_id=e.product_id,o.season_id=e.product_id,o.unit_id=e.product_id,o.variant_id=e.variant_id,o.matrix_code=a,o.pricing_code=n,o.name=e.name,o.code=n,t){let a=t+"Cost",i=o[t]?o[t]:0,l=$("<input/>",{type:"text",name:a,id:"ce-"+n+"-"+t,class:"form-control cost m-0"}).attr("data-element","cost"),r=$("<div/>",{class:"md-form md-outline form-sm input-with-pre-icon mt-2 mb-3"}),d=$("<label/>",{text:"Cost",for:"ce-"+n+"-"+t}),s=$("<i/>",{class:"fas fa-dollar-sign input-prefix"});return C(t,e.season_id)?(l.attr("disabled","disabled"),l.val(""),d.removeClass("active"),r.addClass("disabled")):(r.removeClass("disabled"),i>0&&(l.val(i),d.addClass("active"))),r.append(s,l,d),r}console.groupEnd()},W=function(e){console.groupCollapsed("PricingWorksheet.buildPricingTables");let t=(console.groupCollapsed("PricingWorksheet.buildMatrixWrapper"),console.groupEnd(),$("<div/>",{}));if(e&&e.units){let a=0;$.each(e.units,function(e,n){let i=n.seasons,l=function(e,t){console.groupCollapsed("PricingWorksheet.buildUnitWrapper");let a=e.id+"-"+t;return $("<div/>",{class:"accordion md-accordion card card-body p-1 mb-2",id:"accordionUnit-"+a,role:"tablist","aria-multiselectable":"true"}).attr("data-sectiontype","unit-"+e.id)}(n,a),r=function(e,t){console.groupCollapsed("PricingWorksheet.buildUnitHeading");let a=e.id+"-"+t,n=e.name?e.name:null,o=isNaN(parseInt(e.id))?null:parseInt(e.id);if(Unit.all.get(o)){let e=$("<div/>",{class:"card-header p-0",role:"tab",id:"unitHeading-"+a}),t=$("<i/>",{class:"fas fa-angle-down rotate-icon"}),o=$("<a/>",{href:"#unitCollapse-"+a,"aria-controls":"unitCollapse-"+a,"data-toggle":"collapse","aria-expanded":"true"}),i=$("<span/>",{text:n}),l=$("<h5/>",{class:"mb-0 w-100 d-flex align-items-center justify-content-between p-1"});return e.append(o.append(l.append(i,t))),e}console.groupEnd()}(n,a),d=$("<div/>",{class:"card border border-0"}),s=$("<div/>",{class:"collapse show",role:"tabpanel","data-parent":"#accordionUnit-"+n.id+"-"+a,id:"unitCollapse-"+n.id+"-"+a,"aria-labelledby":"unitHeading-"+n.id+"-"+a}).attr("data-type","unit"),c=$("<div/>",{class:"card-body px-1"}),u=0;$.each(i,function(e,t){let a,i,l,r=o.value+"-"+n.id+"-"+t.season_id,d=t.pricings,p=t.season_id?t.season_id:null,_=Season.all.get(p),m=function(e,t,a){return console.groupCollapsed("PricingWorksheet.buildSeasonWrapper"),$("<div/>",{class:"accordion md-accordion",id:"accordionEx"+t+"-"+a,role:"tablist","aria-multiselectable":"true"}).attr("data-sectiontype","season-"+e.season_id)}(t,r,u),g=function(e,t,a){let n,o,i;if(console.groupCollapsed("PricingWorksheet.buildSeasonHeading"),e){let l=e.season_name?e.season_name:null,r=e.season_id?e.season_id:null,d=Season.all.get(r);d&&(n=d.color_scheme.background_color?d.color_scheme.background_color:null,o=d.color_scheme.text_color?d.color_scheme.text_color:null,i=d.color_scheme.border_color?d.color_scheme.border_color:null);let s=$("<div/>",{class:"card-header p-0",role:"tab",id:"seasonHeading"+t+"-"+a}),c=$("<i/>",{class:"fas fa-angle-down rotate-icon"}),u=$("<a/>",{href:"#collapse"+t+"-"+a,"aria-controls":"collapse"+t+"-"+a,"data-toggle":"collapse","aria-expanded":"true"}),p=$("<span/>",{text:l}),_=$("<h5/>",{class:"mb-0 w-100 d-flex align-items-center justify-content-between p-1",css:{"background-color":`${n}`,border:`solid 1px ${i}`,color:`${o}`}});return s.append(u.append(_.append(p,c))),s}console.groupEnd()}(t,r,u),h=$("<div/>",{class:"card"}),f=$("<div/>",{class:"collapse show",role:"tabpanel","data-parent":"#accordionEx"+r+"-"+u,id:"collapse"+r+"-"+u,"aria-labelledby":"seasonHeading"+r+"-"+u}).attr("data-type","season");_&&(a=hexToRgb(_.color_scheme.background_color),i=_.color_scheme.text_color,l=_.color_scheme.border_color);let v=$("<div/>",{class:"card-body p-1",css:{background:`rgba(${a.join(",")}, .15)`,color:i}});$.each(d,function(e,t){v.append(O(t)),f.append(v)}),h.append(g,f),m.append(h),c.append(m),s.append(c),u+=1}),d.append(r,s),l.append(d),t.append(l),a+=1})}return console.groupEnd(),t},Q=function(){console.groupCollapsed("PricingWorksheet.getVariants");let e=[];switch(isNaN(parseInt(n.value))?null:parseInt(n.value)){case 1:e=[36];break;case 2:let t=Array.from(Variant.all.values());for(let a=0;a<t.length;a++)t[a].used_in_pricing&&e.push(t[a].id);break;default:e=[36]}return console.groupEnd(),e},V=function(e){console.groupCollapsed("PricingWorksheet.getVariantDetails");let t="";1===parseInt(n.value)?t="Unit Pricing":3===parseInt(n.value)&&(t="Daily Pricing");let a={category_id:1,code:"VA-00000000036-OTHR",created_by:E,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:36,max_age:null,min_age:null,modified_by:E,name:t,note:null,used_in_pricing:1},o=Variant.all.get(e);return o&&(a=Variant.set(o)),console.groupEnd(),a},j=function(e,t,a,n){console.groupCollapsed("PricingWorksheet.addVariantList");let i=n.trim().split("-").map(Number),l=parseInt(t.id),r=parseInt(e.id),d=isNaN(parseInt(o.value))?null:parseInt(o.value),s=new Map;$.each(i,function(i,c){let u=V(c);if(u){let i=s.get(c);if(i){let n=i.count;n+=1,i.count=n,i.name=n+" "+pluralize(u.name);let s=a.toString()+"-"+c+"-"+n,p=Pricing.all.get(s);p?(p.aaa=1,p.has_pricing=1,p.been_saved=1):p={aaa:"ok here 2",been_saved:0,has_pricing:0,code:a.toString()+"-"+c.toString()+"-"+n.toString(),count:n,created_by:E,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,fri:null,friMargin:null,id:null,matrix_code:a.toString(),matrix_id:null,modified_by:E,mon:null,monMargin:null,name:u.name+" "+n,note:"generated form",pricing_code:s,product_id:d,sat:null,satMargin:null,season_id:l,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:r,variant_id:c,wed:null,wedMargin:null},i.variants.push({aaa:"ok here",matrix_code:a.toString(),been_saved:5,has_pricing:p.has_pricing?p.has_pricing:0,code:a.toString()+"-"+c.toString()+"-"+n.toString(),count:n,created_by:p.created_by?p.created_by:E,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:p.enabled?p.enabled:1,fri:p.fri?p.fri:null,friMargin:p.friMargin?p.friMargin:null,id:p.id?p.id:null,matrix_id:p.matrix_id?p.matrix_id:null,modified_by:p.modified_by?p.matrix_id:E,mon:p.mon?p.mon:null,monMargin:p.monMargin?p.monMargin:null,name:u.name+" "+n,note:"generated form",pricing_code:a.toString()+"-"+c.toString()+"-"+n.toString(),product_id:isNaN(parseInt(o.value))?null:parseInt(o.value),sat:p.sat?p.sat:null,satMargin:p.satMargin?p.satMargin:null,season_id:parseInt(t.id),sun:p.sun?p.sun:null,sunMargin:p.sunMargin?p.sunMargin:null,thu:p.thu?p.thu:null,thuMargin:p.thuMargin?p.thuMargin:null,tue:p.tue?p.tue:null,tueMargin:p.tueMargin?p.tueMargin:null,unit_id:e.id,variant_id:c,wed:p.wed?p.wed:null,wedMargin:p.wedMargin?p.wedMargin:null})}else{let t=1,o=a.toString()+"-"+c+"-"+t,s=Pricing.all.get(o);s?(s.aaa="hasPricing",s.been_saved=1,s.has_pricing=1):s={aaa:"ok here 1",has_pricing:0,been_saved:0,code:o,count:t,created_by:E,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,fri:null,friMargin:null,id:null,matrix_code:a,pricing_code:o,matrix_id:null,modified_by:E,mon:null,monMargin:null,name:u.name+" "+t,note:"generated form",product_id:d,sat:null,satMargin:null,season_id:l,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:r,variant_id:u.id,wed:null,wedMargin:null},i={name:t+" "+u.name,variant_combo_id:n.trim(),count:t,variants:[{aaa:s.aaa?s.aaa:"ghg",code:o,has_pricing:s.has_pricing?s.has_pricing:0,variant_id:c,name:u.name+" "+t,count:t,created_by:s.created_by,date_created:s.date_created?s.date_created:formatDateMySQL(),date_modified:s.date_modified?s.date_modified:formatDateMySQL(),enabled:s.enabled?s.enabled:1,fri:null,friMargin:null,id:s.id?s.id:null,matrix_code:a,matrix_id:s.matrix_id?parseInt(s.matrix_id):null,modified_by:s.modified_by?parseInt(s.modified_by):E,mon:s.mon?parseInt(s.mon):null,monMargin:null,note:"fff",pricing_code:a+"-"+c+"-"+t,product_id:null,sat:null,satMargin:null,season_id:null,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:e.id,wed:null,wedMargin:null}]}}s.set(c,i)}else 36===parseInt(c)&&(u={category_id:1,code:"VA-00000000036-OTHR",created_by:4,date_created:"2022-01-18 08:08:22",date_modified:"2022-01-18 12:02:26",enabled:1,id:36,max_age:null,min_age:null,modified_by:4,name:"Other",note:null,used_in_pricing:1})});let c,u,p,_,m=0,g=[],h=[],f=null;$.each(Array.from(s.values()),function(e,t){h.push(t.name),t.variants&&$.each(t.variants,function(e,t){u=a+"-"+t.variant_id+"-"+t.count,p=a;let n=V(t.variant_id),o=Matrix.all.get(p),i=Pricing.all.get(u),s=(Season.all.get(l),null),h=null,v=null,y=null,b=null,I=null,$=null,w=null,C=null,k=null,S=null,N=null,B=null,x=null,L=1,M=null,P=formatDateMySQL(),D=formatDateMySQL(),F=E,T=E;o&&(_=o.id,c=1),i&&(f=i.id,m=1,s=i.sun,h=i.mon,v=i.tue,y=i.wed,b=i.thu,I=i.fri,$=i.sat,w=i.sunMargin,C=i.monMargin,k=i.tueMargin,S=i.wedMargin,N=i.thuMargin,B=i.friMargin,x=i.satMargin,L=i.enabled,M=i.note,P=i.date_created,D=i.date_modified,F=i.created_by,T=i.modified_by);let R={count:t.count,been_saved:m,code:u,pricing_code:u,product_id:d,unit_id:r,season_id:l,variant_id:t.variant_id,matrix_id:_,name:n.name+" "+t.count,id:f,sun:s,mon:h,tue:v,wed:y,thu:b,fri:I,sat:$,sunMargin:w,monMargin:C,tueMargin:k,wedMargin:S,thuMargin:N,friMargin:B,satMargin:x,enable:L,note:M,date_created:P,date_modified:D,created_by:F,modified_by:T,matrix_code:"H"};g.push(R)})}),h=h.join(" - ");let v=0,y=null,b=null,I=Matrix.all.get(a);return I&&(v=1,y=I.cost,b=I.margin),console.groupEnd(),{name:h,cost:y,margin:b,season_id:l,unit_id:r,product_id:d,been_saved:v,matrix_code:a,id:_||null,variants:g}},z=function(e,t,a){console.groupCollapsed("PricingWorksheet.getVariantCombinations");for(let n=0;n<a.length;n++)if(1===e){let e=t+a[n],o=e.split("-").map(function(e){return parseInt(e,10)});o=o.sort().join("-"),I.indexOf(e)<0&&I.push(o)}else{a[n];z(e-1,t+a[n]+"-",a)}console.groupEnd()},H=function(){console.groupCollapsed("PricingWorksheet.buildPricingWorksheet");let e=isNaN(parseInt(o.value))?null:parseInt(o.value),t={id:null,units:[]};b=Q(),g=function(){console.groupCollapsed("PricingWorksheet.getSeasons");var e=[],t=Array.from(Season.all.values());for(let a=0;a<t.length;a++)e.push(t[a]);return console.groupEnd(),e}(),h=function(){console.groupCollapsed("PricingWorksheet.getUnits");var e=[],t=Array.from(Unit.all.values());for(let a=0;a<t.length;a++)e.push(t[a]);return console.groupEnd(),e}();for(let a=0;a<h.length;a++){I=[];let o=h[a],i=parseInt(o.id),l=o.max_pax?parseInt(o.max_pax):5,r=o.min_pax?parseInt(o.min_pax):1;switch(isNaN(parseInt(n.value))?null:parseInt(n.value)){case 1:r=1,l=1;break;case 2:if(r>l){let e=l;l=r,r=e}break;default:r=1,l=1}for(let e=r;e<=l;e++)z(e,"",Q());let d=I,s={id:o.id,name:o.name,seasons:[]};for(let t=0;t<g.length;t++){let a=g[t],n=e+"-"+i+"-"+(isNaN(parseInt(a.id))?null:parseInt(a.id)),l=Matrix.all.get(n);l?l.pricings=[]:l={been_saved:0,code:n,cost:0,created_by:4,date_created:"2022-01-14 09:00:39",date_modified:"2022-01-14 09:00:39",enabled:1,has_pricing:1,id:null,margin:0,modified_by:4,note:null,price:201,pricings:[]};let r={been_saved:l.been_saved,code:l.code,cost:l.cost,created_by:l.created_by,date_created:l.date_created,date_modified:l.date_modified,enabled:l.enabled,has_pricing:l.has_pricing,id:l.id,margin:l.margin,modified_by:l.modified_by,note:l.note,price:l.price,season_id:a.id,season_name:a.name,matrix_code:n,pricings:[]};$.each(d,function(e,t){r.matrix_code=n+"-"+t,r.pricings.push(j(o,a,n+"-"+t,t))}),s.seasons.push(r)}t.units.push(s)}return console.groupEnd(),t},K=function(){console.groupCollapsed("PricingWorksheet.pricingWorksheet"),x(),console.groupCollapsed("PricingWorksheet.emptyPricingMatrix"),PricingWorksheet.incompletePricings=new Map,PricingWorksheet.incompleteMatrices=new Map,$(e).empty(),$(e).html('\n                <div style="top:0;left:0;width:100%;height:500px;background:rgba(0,0,0,.25);" class="flex-center">\n                    <div class="preloader-wrapper active">\n                        <div class="spinner-layer spinner-blue-only">\n                            <div class="circle-clipper left">\n                                <div class="circle"></div>\n                            </div>\n                            <div class="gap-patch">\n                                <div class="circle"></div>\n                            </div>\n                            <div class="circle-clipper right">\n                                <div class="circle"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            '),console.groupEnd(),I=[],$(e).empty().append(W(PricingWorksheet.buildPricingWorksheet())),w()};return{pricingStrategyId:null,incompleteMatrices:new Map,incompletePricings:new Map,init:function(e){!function(e){console.groupCollapsed("PricingWorksheet.init");let t=null;e&&(console.log("settings",e),e.pricing_strategy&&e.pricing_strategy.pricing_strategy_types_id&&(t=isNaN(parseInt(e.pricing_strategy.pricing_strategy_types_id))?null:parseInt(e.pricing_strategy.pricing_strategy_types_id))),PricingWorksheet.pricingStrategyId=t,n&&$(n).val(PricingWorksheet.pricingStrategyId).trigger("change"),console.groupEnd()}(e)},pricingWorksheet:function(){K()},buildPricingWorksheet:function(){return H()},status:function(){return w()}}}(),Upload=function(e){this.file=e},_image_manager_is_cover=document.getElementById("image_manager_is_cover"),_image_manager_title=document.getElementById("image_manager_title"),_image_manager_caption=document.getElementById("image_manager_caption"),_image_manager_upload=document.getElementById("image_manager_upload"),_image_manager_alt_text=document.getElementById("image_manager_alt_text"),_image_manager_form_data=document.getElementById("image_manager_form_data"),_image_manager_image_id=document.getElementById("image_manager_id"),_provider_edit=document.getElementById("provider_edit"),_vendor_edit=document.getElementById("vendor_edit"),_provider_company_id=document.getElementById("provider_company_id"),_vendor_company_id=document.getElementById("vendor_company_id");Upload.prototype.getType=function(){return this.file.type},Upload.prototype.getSize=function(){return this.file.size},Upload.prototype.getName=function(){return this.file.name},Upload.prototype.doUpload=function(){let e=this,t=new FormData;t.append("file",this.file,this.getName()),t.append("upload_file",!0),t.append("title",""!==_image_manager_title.value?_image_manager_title.value:null),t.append("caption",""!==_image_manager_caption.value?_image_manager_caption.value:null),t.append("is_cover",!0!==_image_manager_is_cover.checked?parseInt(0):parseInt(1)),t.append("alt",""!==_image_manager_alt_text.value?_image_manager_alt_text.value:null),_provider_edit&&(t.append("directory_id",parseInt(_provider_company_id.value)),t.append("directory","company")),_vendor_edit&&(t.append("directory_id",parseInt(_vendor_company_id.value)),t.append("directory","company")),$.ajax({type:"POST",url:"/api/v1.0/images/update",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",e.progressHandling,!1),t},success:function(e){let t,a=null;if(e&&e.result&&(a=e.result)[0]&&(t=a[0]),t){let e;_provider_edit&&(e=$("#companyImages").imageManager()),_vendor_edit&&(e=$("#companyImages").imageManager()),e.addImage(t),toastr.success("Image Uploaded"),Upload.prototype.resetForm(),$("button.dropify-clear").click()}},error:function(e){toastr.error("Error")},async:!0,data:t,cache:!1,contentType:!1,processData:!1,timeout:6e4})},Upload.prototype.progressHandling=function(e){var t=0,a=e.loaded||e.position,n=e.total;e.lengthComputable&&(t=Math.ceil(a/n*100)),$("#progress-wrp .progress-bar").css("width",+t+"%"),$("#progress-wrp .status").text(t+"%")},Upload.prototype.progressReset=function(){$("#progress-wrp .progress-bar").css("width","0%"),$("#progress-wrp .status").text("0%")},Upload.prototype.resetForm=function(){Upload.prototype.progressReset(),_image_manager_is_cover.checked=!1,_image_manager_image_id.value="",_image_manager_title.value="",_image_manager_upload.value="",_image_manager_caption.value="",_image_manager_alt_text.value="",_image_manager_upload.disabled=!1,$(_image_manager_form_data).hide()},Upload.prototype.populateForm=function(e){Upload.prototype.progressReset();e.path,e.name,e.extension;_image_manager_is_cover.checked=1===e.is_cover,_image_manager_image_id.value=e.id,_image_manager_title.value=e.title,_image_manager_caption.value=e.caption,_image_manager_alt_text.value=e.alt,$("button.dropify-clear").click(),_image_manager_upload.disabled=!0,$(_image_manager_form_data).show()},$("#image_manager_upload").on("change",function(){_image_manager_is_cover.checked=!1,_image_manager_image_id.value="",_image_manager_title.value="",_image_manager_caption.value="",_image_manager_alt_text.value="",$(_image_manager_form_data).show()}),$("#image_manager_clear_button").on("click",function(){Upload.prototype.resetForm()}),$.fn.YearCalendar=function(e){console.groupCollapsed("YearCalendar");document.getElementById("calendar_filter_ranges");const t=document.getElementById("product_id"),a=document.getElementById("calendar_display_select_all_days"),n=document.getElementById("calendar_display_clear_selected_days");let o,i="season",l=null,r=$(this).attr("id"),d=document.getElementById(r),s=[],c=new Map,u=parseInt(t.value);$(a).on("click",function(){p()}),$(n).on("click",function(){h()});const p=function(){h();const e=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),11,31);let a=moment(e).format("YYYY-MM-DD"),n=moment(t).format("YYYY-MM-DD");v(this,a,n)},_=function(e){return e<10?"0"+e.toString():e.toString()},m=function(e){let t=document.createElement("div");return t.classList="row gx-1",t},g=function(e){let t=function(e){let t=document.createElement("div");return t.classList=["card card-block p-1 z-depth-0"],t}(),a=function(e){let t=document.createElement("div");return t.classList="flex-fill col-6 p-1",t}(),n=document.createElement("div"),o="calendar_block_"+e;return n.classList="my_calendar",n.id=o,a.appendChild(t),t.appendChild(n),s.push(n),a},h=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("selected-day"),$(this).attr("data-selected","false")}),YearCalendar.selectedDates=new Map},f=function(e,t){$(e).hasClass("selected-day")?($(e).removeClass("selected-day"),$("td.fc-day-top[data-date='"+moment(t).format("YYYY-MM-DD")+"']").removeClass("selected-day"),YearCalendar.selectedDates.delete(t)):($(e).addClass("selected-day"),$("td.fc-day-top[data-date='"+moment(t).format("YYYY-MM-DD")+"']").addClass("selected-day"),YearCalendar.selectedDates.set(t,t),o=t,l=null)},v=function(e,t,a){let n=new Date(moment(t).format("MM/DD/YYYY")),o=new Date(moment(a).format("MM/DD/YYYY")),i=new Date(n);for($("td.fc-day[data-date='"+moment(a).format("YYYY-MM-DD")+"']").removeClass("selected-day"),$("td.fc-day[data-date='"+moment(t).format("YYYY-MM-DD")+"']").removeClass("selected-day"),$("td.fc-day-top[data-date='"+moment(a).format("YYYY-MM-DD")+"']").removeClass("selected-day");i<=o;){f($("td.fc-day[data-date='"+moment(i).format("YYYY-MM-DD")+"']"),moment(i).format("YYYY-MM-DD"));let e=i.setDate(i.getDate()+1);i=new Date(e)}},y=function(e){YearCalendar.season_events=new Map;let t=new Date;d.appendChild(function(){let e=document.createElement("div"),t=m();e.classList=["calendarContainer container-fluid"],e.id="calendar_block_container";for(let a=0;a<12;a++){let n=a+1;a%2==0&&a>0&&(e.appendChild(t),t=m()),t.appendChild(g(n))}return e.appendChild(t),e}()),YearCalendar.start=e&&e.start?e.start:t.getFullYear(),YearCalendar.events=e&&e.events?e.events:[],YearCalendar.getTitle(),$.each(s,function(e,t){let a=(n=YearCalendar.start,moment(n+"-"+_(0+e+1)+"-"+_(1)).format("YYYY-MM-DD"));var n;let i=$(t).fullCalendar({selectable:!1,showNonCurrentDates:!1,defaultDate:a,initialView:"dayGridMonth",displayEventTime:!1,eventLimit:3,header:{left:"",center:"title",right:""},views:{month:{titleFormat:"MMMM"}},dayRender:function(e,t){let a=moment(e).format("YYYYMMDD"),n=moment(e).format("YYYY-MM-DD"),o="s"+a,i=moment(e).month(),l=moment(e).year(),r=moment(e).day(),d=$(`td.fc-day-top[data-date='${n}']`);$(`td.fc-day-top[data-date='${n}'] > span.fc-day-number`);$(t).hasClass("fc-disabled-day")||($(d).attr("season","true"),$(d).attr("data-date",n),$(d).attr("id",o),$(d).attr("day",a),$(d).attr("month",i),$(d).attr("year",l),$(d).attr("dow",r),$(t).attr("season","true"),$(t).attr("data-date",n),$(t).attr("id",o),$(t).attr("day",a),$(t).attr("month",i),$(t).attr("year",l),$(t).attr("dow",r),$(t).attr("data-selected","false"))},dayClick:function(e,t,a){let n=moment(e).format("YYYY-MM-DD");if(t.originalEvent.shiftKey){if(null!==o){if(l=n,moment(l)<moment(o)){let e=moment(o).format("YYYY-MM-DD"),t=moment(l).format("YYYY-MM-DD"),a=$("td.fc-day[data-date='"+t+"'][season='true']"),n=$("td.fc-day[data-date='"+e+"'][season='true']");$(a).removeClass("is-selected"),n.removeClass("is-selected"),v(this,t,e),o=e,l=t}else v(this,o,l);o=null,l=null}}else if(t.originalEvent.ctrlKey)this.hasClass("selected-day")?(this.removeClass("selected-day"),YearCalendar.selectedDates.delete(n),o=null,l=null):(YearCalendar.selectedDates.set(n,n),o=n,l=null,this.addClass("selected-day"));else{Array.from(YearCalendar.selectedDates.values());h(),f(this,n),o=n,l=n,this.addClass("selected-day")}},eventRender:function(e,t,a){$(t).attr("season","true");let n=moment(e.start).format("YYYY-MM-DD"),o=$("td.fc-day-top[data-date='"+n+"']"),i=$("td.fc-day[data-date='"+n+"'][season='true']"),l=c.get(n),r=e.textColor,d=(e.backgroundColor,e.borderColor,hexToRgb(e.backgroundColor));d.push(.6);let s="rgba("+d.join(", ")+")";if("background"===e.rendering){if($(t).hasClass("fc-disabled-day"))return;YearCalendar.season_events.set(n,"true"),o.addClass("background_event").attr("data",e);let a=document.querySelectorAll(`td.fc-day[season='true'][data-date='${n}']`);l&&($(i).addClass("has-event"),$(i).attr("seasons_types_id",e.id),$(i).data("season","true"),$(i).attr("data-seasonid",e.id)),$(a).addClass("background_event").attr("data",e).css({background:s,color:r}),$(t).attr("data-sid",e.id),$(t).attr("data-date",n),$(t).attr("season","true"),$(t).attr("seasonid",e.id),$(t).addClass("background_event"),$(t).attr("data",e),$(t).css({background:s,color:r})}},eventClick:function(e,t,a){},events:YearCalendar.events});YearCalendar.activeCalendars.push(i);let r=isNaN(parseInt($(document.getElementById("calendar_block_1")).actual("width")))?600:parseInt($(document.getElementById("calendar_block_1")).actual("width"));$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("option","contentHeight",r)})})};return function(e){console.group("YearCalendar.init"),s=[],e&&e.calendarType&&(i=e.calendarType);let t={product_id:u};console.group("fetchCalendarEvents"),function(e,t){if(console.groupCollapsed("YearCalendar.fetchCalendarEvents"),!e)return t([]);try{sendGetRequest("/api/v1.0/calendars",e,function(e,a,n){return t(e||[])})}catch(e){return t([])}console.groupEnd()}(t,function(e){e||(e=[]),YearCalendar.start=(new Date).getFullYear(),YearCalendar.loadSeasonDropdown(),YearCalendar.loadProfileDropdown(),YearCalendar.loadUnitDropdown(),y({events:e,start:YearCalendar.start}),YearCalendar.endLoading()}),$(function(){YearCalendar.init(e)}),console.groupEnd()}(e),console.groupEnd(),{calendars:[]}};const YearCalendar=function(){"use strict";const e=document.getElementById("calendar_display_remove"),t=document.getElementById("calendar_loader"),a=document.getElementById("seasonCalendarModal"),n=document.getElementById("calendar_display_year"),o=document.getElementById("calendar_display_next_year"),i=document.getElementById("calendar_display_prev_year"),l=document.getElementById("calendar_filter_season_id"),r=document.getElementById("product_id"),d=document.getElementById("calendar_filter_profile_id"),s=document.getElementById("calendar_filter_unit_id"),c=(document.getElementById("calendar_filter_profile_id_assign"),document.getElementById("calendar_filter_profile_id_clear")),u=document.getElementById("calendar_filter_unit_id_assign"),p=document.getElementById("calendar_filter_unit_id_clear"),_=document.getElementById("calendar_filter_season_id_assign"),m=document.getElementById("calendar_filter_season_id_clear"),g=document.getElementById("calendar_display_refresh");$(e).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.remove(),y()})}),$(g).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.refresh(),y()})}),$(o).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.start=(parseInt(YearCalendar.start)+1).toString(),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("nextYear")}),L(),YearCalendar.endLoading()})}),$(i).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.start=(parseInt(YearCalendar.start)-1).toString(),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("prevYear")}),YearCalendar.getTitle(),YearCalendar.endLoading()})}),$(l).on("change",function(){let e,t,a,n=isNaN(parseInt(l.value))?null:parseInt(l.value);is_null(n),is_null(n)?(_.disabled=!0,d.disabled=!1,u.disabled=!0):((t=Season.all.get(n))&&t.product_season_detail&&(e=t.product_season_detail),e.disabled_dow&&(a=getListOfIds(e.disabled_dow)),d.value="",d.disabled=!0,u.disabled=!0,_.disabled=!1,d.value="",$(s).val([])),S(a)}),$(s).on("change",function(){let e=$(s).val();u.disabled=e.length<=0}).on("click",function(){let e=$(s).val();u.disabled=e.length<=0}),$(d).on("change",function(){null!==(isNaN(parseInt(d.value))?null:parseInt(d.value))?(s.disabled=!1,l.disabled=!0):($(s).val([]),s.disabled=!0,l.disabled=!1)}),$(_).on("click",function(){b()}),$(u).on("click",function(){E()}),$(m).on("click",function(){$(l).val("").trigger("change"),y()}),$(p).on("click",function(){$(s).val([]).trigger("change"),y()}),$(c).on("click",function(){$(d).val("").trigger("change"),y()}),$(a).on("shown.bs.modal",function(){y(),$("html").css({overflow:"hidden"})}).on("hidden.bs.modal",function(){k(),$("html").css({overflow:"auto"})}).on("click",function(){YearCalendar.checkProgress()});const h=function(){let e=Season&&Season.all?Array.from(Season.all.values()):[],t="<option value='' disabled readonly selected>-- Seasons --</option>",a="";$.each(e,function(e,n){let o=n.name,i=n.id;t+=`<option value="${i}">${o}</option>`,a+=`<option value="${i}">${o}</option>`}),$(l).empty(),$(l).html(t),$(l).val("").trigger("change")},f=function(){let e=InventoryProfile&&InventoryProfile.all?Array.from(InventoryProfile.all.values()):[],t="<option value='' disabled readonly selected>-- Profiles --</option>";$.each(e,function(e,a){let n=a.name,o=a.id;t+=`<option value="${o}">${n}</option>`}),$(d).empty(),$(d).html(t),$(d).val("").trigger("change")},v=function(){let e=Unit&&Unit.all?Array.from(Unit.all.values()):[],t="";$.each(e,function(e,a){let n=a.name,o=a.id;t+=`<option value="${o}">${n}</option>`}),$(s).empty(),$(s).html(t),$(s).val([]).trigger("change")},y=function(){N()},b=function(){let e=parseInt(r.value),a=parseInt(l.value),n=Season.all.get(a),o=[],i={season_id:a,product_id:e,days:[]},d=Array.from(YearCalendar.selectedDates.values());n&&n.product_season_detail&&(o=getListOfIds(n.product_season_detail.disabled_dow)),$.each(d,function(e,t){const a=moment(t).day();o.indexOf(a)<0&&i.days.push(t)}),confirmDialog("Would you like to assign? This change may affect your Pricing Worksheets.",e=>{e&&$(t).fadeIn("slow",function(){C(i,function(e){e&&(B(),N(),D(),toastr.success("Dates Assigned.")),x()})})})},I=function(e){toastr.error(e)},E=function(){let e=function(){let e,t=d&&!is_null(parseInt(d.value))?parseInt(d.value):null,a=r&&!isNaN(parseInt(r.value))?parseInt(r.value):null,n=s?$(s).val().map(Number):[],o=[],i=Array.from(YearCalendar.selectedDates.values());if(a&&t&&(e=InventoryProfile.all.get(t))&&$.each(n,function(e,n){let l={product_id:a,profile_id:t,unit_id:n,quantity_released:0,quantity_used:0,days:[]};$.each(i,function(e,t){YearCalendar.season_events.get(t)&&l.days.push(t)}),l.days.length>0&&o.push(l)}),o.length>0)return o}();e?confirmDialog("Would you like to assign? This change may affect your Pricing Worksheets.",a=>{a&&$(t).fadeIn("slow",function(){w(e,function(e){e&&(B(),N(),D(),toastr.success("Dates Assigned.","Inventory Profile")),x()})})}):(toastr.warning("No Profiles to update.","Inventory Profile"),x())},w=function(e,t){if(e)try{sendPostRequest("/api/v1.0/products/assign_profiles",{params:e},function(e,a,n){if(e)return t(e);I("Oops: 1"),x()})}catch(e){I("Oops: 2"),x()}},C=function(e,t){if(e)try{sendPostRequest("/api/v1.0/products/assign_seasons",e,function(e,a,n){return e?t(e):I("Oops: 1")})}catch(e){return I("Oops: 1")}},k=function(){B(),N(),h(),v(),f()},S=function(e){e||(e=[]),N(),$.each(e,function(e,t){let a=t.toString();$(`td[season='true'][dow='${a}']`).each(function(e,t){let a=$(t).attr("data-date");$("td[data-date='"+a+"']").addClass("disabled-dow"),$(t).addClass("disabled-dow")})})},N=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("disabled-dow")})},B=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("selected-day"),$(this).attr("selected","false")}),YearCalendar.selectedDates=new Map},x=function(){y(),$(t).hide()},L=function(){n.innerText=YearCalendar.start},M=function(){YearCalendar.events=[],document.querySelectorAll("td[season='true']").forEach(e=>{$(e).css({background:"initial","background-color":"initial",color:"initial","border-color":"#ddd"})}),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("removeEvents")}),YearCalendar.endLoading()},P=function(){$(t).fadeIn("slow",function(){let e=isNaN(parseInt(r.value))?null:parseInt(r.value);B(),N(),M(),function(e,t){if(e)try{sendGetRequest("/api/v1.0/calendars",e,function(e,a,n){return t(e||[])})}catch(e){}}({product_id:e},function(e){YearCalendar.events=e,$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("removeEvents"),$(t).fullCalendar("addEventSource",YearCalendar.events),$(t).fullCalendar("rerenderEvents")}),YearCalendar.endLoading()})})},D=function(){k(),P()};return{calendarContextMenu:null,calendars:new Map,events:[],start:(new Date).getFullYear(),selectedDates:new Map,activeCalendars:[],season_events:[],refresh:function(){D()},remove:function(){B(),N(),M()},checkProgress:function(){},endLoading:function(){x()},loadSeasonDropdown:function(){h()},loadProfileDropdown:function(){f()},loadUnitDropdown:function(){v()},getTitle:function(){L()},clearSelected:function(){B()},init:function(e){console.groupCollapsed("YearCalendar.init"),s.disabled=!0,_.disabled=!0,u.disabled=!0,v(),f(),h(),console.groupEnd()},resetForm:function(){k()}}}(),ImageManager=function(){"use strict";const e=document.getElementById("button_product_images_toggle"),t=document.getElementById("imageManagerCancel"),a=document.getElementById("imageManagerFormRemoveButton"),n=document.getElementById("fileDimensions"),o=document.getElementById("fileWidth"),i=document.getElementById("fileHeight"),l=document.getElementById("fileRatio"),r=document.getElementById("imageManagerForm"),d=document.getElementById("imageManagerFormImagesBlock"),s=document.getElementById("imageManagerFormSubmitButton"),c=document.getElementById("imageManagerFormCancelButton"),u=document.getElementById("imageManagerFormClearButton"),p=document.getElementById("imageManagerFormDetails"),_=document.getElementById("fileName"),m=document.getElementById("fileType"),g=document.getElementById("fileExtension"),h=document.getElementById("fileSize"),f=document.getElementById("image_id"),v=document.getElementById("image_name"),y=document.getElementById("image_title"),b=document.getElementById("image_alt"),I=document.getElementById("image_caption"),E=document.getElementById("fileToUpload"),w=document.getElementById("image_enabled"),C=document.getElementById("image_is_cover"),k=document.getElementById("image_is_shown"),S=document.getElementById("imageManagerPreview");let N,B,x=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,L=new Map,M={rules:{image_name:{required:!0},image_title:{required:!0},image_alt:{required:!0},image_caption:{required:!0}},messages:{image_name:{required:"Field Required"},image_title:{required:"Field Required"},image_alt:{required:"Field Required"},image_caption:{required:"Field Required"}}},P=null,D=null,F=null;L.set("png","image/png"),L.set("jpg","image/jpeg"),L.set("gif","image/gif"),L.set("webp","image/webp"),$(E).on("change",function(e){""!==$(this).val()?G(e):z(e)}),$(s).on("click",function(e){q(e)}),$(u).on("click",function(){H()}),$(c).on("click",function(){H(),J()}),$(t).on("click",function(){H(),J()}),$(a).on("click",function(){let e=isNaN(parseInt(f.value))?null:parseInt(f.value);null!==e&&confirmDialog("Would you like to delete this image?",t=>{t&&R(e)})}),$(k).on("change",function(){let e=isNaN(parseInt(f.value))?null:parseInt(f.value),t=document.getElementById("image_"+e);P=e,k.checked?(F=!1,$(t).addClass("is-shown")):(C.checked&&(D=e,C.checked=!1,$(t).removeClass("is-cover-image")),$(t).removeClass("is-shown"),F=!0)}),$(C).on("change",function(){let e=isNaN(parseInt(f.value))?null:parseInt(f.value),t=document.getElementById("image_"+e);D=isNaN(parseInt($(".img-thumbnail.is-cover-image").data("id")))?null:parseInt($(".img-thumbnail.is-cover-image").data("id")),F=k?k.checked:null,C.checked&&(k.checked||(k.checked=!0),$(".img-thumbnail.is-cover-image").removeClass("is-cover-image"),$(t).addClass("is-cover-image is-shown"))}),$("#button_product_images_toggle").on("click",function(){$(E).trigger("click")});const T=function(e,t,a){console.groupCollapsed("ImageManager.handleImageManagerError"),t||(t="Image"),a||(a="success"),toastr[a](`${e}`,t),console.groupEnd()},R=function(e){if(console.groupCollapsed("ImageManager.remove"),!e||!ImageManager.source||!ImageManager.sourceId)return;let t={image_id:e,source:ImageManager.source,source_id:ImageManager.sourceId};console.log("dataToSend",t),A({image_id:e,source:ImageManager.source,source_id:ImageManager.sourceId},function(e){e&&console.log("data",e)}),console.groupEnd()},A=function(e,t){if(console.groupCollapsed("ImageManager.sendRemoveRequest"),e){let a="/api/v1.0/images/remove";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){return console.log("error",e),T("Error Removing Image.","Image Manager","error")}}console.groupEnd()},q=function(e){console.groupCollapsed("ImageManager.submit"),O()&&confirmDialog("Would you like to update?",t=>{t&&Y(e)}),console.groupEnd()},O=function(){return console.groupCollapsed("ImageManager.validate"),console.groupEnd(),$(r).valid()},Y=function(e){console.groupCollapsed("ImageManager.uploadFile");const t=document.getElementById("fileToUpload");let a,n,o,i,l,r,d,s,c,u,p,_,m,g,h,v,E,$,S=null,N=new FormData,B=new XMLHttpRequest;if($=f&&!isNaN(parseInt(f.value))?parseInt(f.value):null,g=I&&""!==I.value?I.value:null,_=y&&""!==y.value?y.value:null,m=b&&""!==b.value?b.value:null,h=k&&!0===k.checked?1:0,E=w&&!0===w.checked?1:0,v=C&&!0===C.checked?1:0,null!==$){r=document.getElementById("fileName").innerText,l=document.getElementById("fileExtension")?document.getElementById("fileExtension").innerText:null,i=document.getElementById("fileSize")?document.getElementById("fileSize").innerText:null,c=document.getElementById("fileDimensions")?document.getElementById("fileDimensions").innerText:null,o=document.getElementById("fileWidth")?isNaN(parseInt(document.getElementById("fileWidth").innerText))?null:parseInt(document.getElementById("fileWidth").innerText):null,n=document.getElementById("fileHeight")?isNaN(parseInt(document.getElementById("fileHeight").innerText))?null:parseInt(document.getElementById("fileHeight").innerText):null;let e=removeNulls({id:$,name:r,alt:m,title:_,caption:g,is_cover:v,path:`/public/img/${ImageManager.source}/${ImageManager.sourceId}`,thumbs_path:`/public/thumbs/${ImageManager.source}/${ImageManager.sourceId}`,extension:l,dimensions:c,size:i,height:n,width:o,enabled:E,directory:ImageManager.source,directory_id:ImageManager.sourceId,is_shown:h});console.log("dataToSend",e),function(e,t){if(console.groupCollapsed("ImageManager.sendUpdateRequest"),e){let a="/api/v1.0/images/update";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){return console.log("error",e),T("Error","Image Manager","error")}}console.groupEnd()}(e,function(e){if(e){let t=j(e[0]?e[0]:e);console.log("detail",t);let a=ImageManager.all.get(t.id);console.log("image",a),ImageManager.all.set(t.id,t),toastr.success(`Image Manager: ${t.name} - has been updated`,"Image Manager")}})}else K(e,function(e){switch(console.log("data",e),u=e.source,p=e.source_id,a=e.path?e.path:null,n=isNaN(parseInt(e.height))?null:parseInt(e.height),o=isNaN(parseInt(e.width))?null:parseInt(e.width),r=e.name?e.name:null,l=e.extension?e.extension:null,i=e.size?e.size:null,s=e.ratio?e.ratio:null,d=e.type?e.type:null,S=e.thumbs_path,c=e.dimensions?e.dimensions:null,N.append("dimensions",c),N.append("extension",l),N.append("file",t.files[0],`${r}.${l}`),N.append("height",n),N.append("name",r),N.append("path",a),N.append("thumbs_path",S),N.append("ratio",s),N.append("size",i),N.append("type",d),N.append("width",o),N.append("directory",u),N.append("directory_id",p),N.append("title",_),N.append("enabled",E),N.append("is_shown",h),N.append("is_cover",v),N.append("alt",m),N.append("caption",g),B.upload.addEventListener("progress",U,!1),B.addEventListener("load",W,!1),B.addEventListener("error",Q,!1),B.addEventListener("abort",V,!1),u.toLowerCase()){case"product":B.open("POST","/api/v1.0/upload/product"),B.send(N);break;case"unit":console.log("unit");break;case"company":console.log("company");break;case"user":console.log("user");break;default:return}});console.groupEnd()},U=function(e){if(console.groupCollapsed("ImageManager.uploadProgress"),e.lengthComputable){let t=Math.round(100*e.loaded/e.total);document.getElementById("progressNumber").innerHTML=t.toString()+"%"}else document.getElementById("progressNumber").innerHTML="unable to compute";console.groupEnd()},W=function(e){console.groupCollapsed("ImageManager.uploadComplete");let t=null;if(e&&e.target&&e.target.responseText){const a=JSON.parse(e.target.responseText);if(a&&a.status&&"success"===a.status&&a.result){t=a.result,1===a.result.length&&(t=a.result[0]);let e=j(t);Array.from(ImageManager.all.values()).length;console.log("image",e),$(d).append(te(e)),ImageManager.all.set(e.id,e),console.log("ImageManager.all",ImageManager.all),console.log("detail",e),H(),J(),toastr.success("Image was added.","Image Manager")}}console.groupEnd()},Q=function(e){console.groupCollapsed("ImageManager.uploadFailed"),console.log("ImageManager.uploadFailed"),console.log("There was an error attempting to upload this file."),console.groupEnd()},V=function(e){console.groupCollapsed("ImageManager.uploadCanceled"),console.log("ImageManager.uploadCanceled"),console.log("This upload has been canceled by the user or the browser dropped the connection."),console.groupEnd()},j=function(e){console.groupCollapsed("ImageManager.set");let t=(console.groupCollapsed("ImageManager.defaultDetail"),{alt:null,caption:null,created_by:x,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),dimensions:null,enabled:1,extension:null,height:null,id:null,is_cover:0,is_shown:1,modified_by:x,name:null,note:null,path:null,size:null,thumbs_path:null,title:null,width:null});return e&&(t.alt=e.alt?e.alt:null,t.caption=e.caption?e.caption:null,t.created_by=e.created_by?e.created_by:x,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.dimensions=e.dimensions?e.dimensions:null,t.enabled=isNaN(parseInt(e.enabled))?1:parseInt(e.enabled),t.extension=e.extension?e.extension:null,t.height=e.height?e.height:null,t.id=isNaN(parseInt(e.id))?null:parseInt(e.id),t.is_cover=e.is_cover?e.is_cover:0,t.is_shown=e.is_shown&&1===e.is_shown?1:0,t.modified_by=e.modified_by?e.modified_by:x,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.path=e.path?e.path:null,t.size=e.size?e.size:null,t.thumbs_path=e.thumbs_path?e.thumbs_path:null,t.title=e.title?e.title:null,t.width=e.width?e.width:null),console.groupEnd(),ImageManager.detail=t,t},z=function(e){console.groupCollapsed("ImageManager.resetFileInput");document.getElementById("fileToUpload");let t=document.getElementById("fileName"),a=document.getElementById("fileSize"),n=document.getElementById("fileType"),o=document.getElementById("fileExtension"),i=document.getElementById("imageManagerPreview"),l=document.getElementById("fileToUploadDisplay");$(t).html("&nbsp;"),$(a).html("&nbsp;"),$(n).html("&nbsp;"),$(o).html("&nbsp;"),$(l).html("CHOOSE FILE"),$(i).attr("src","/public/img/placeholder.jpg"),k.checked=!0,console.groupEnd()},H=function(){console.groupCollapsed("ImageManager.clear"),z(),X(),$("img.img-thumbnail").removeClass("selected"),console.groupEnd()},K=function(e,t){console.groupCollapsed("ImageManager.buildImageObject");const a=document.getElementById("fileToUpload"),n=document.getElementById("imageManagerPreview"),o=document.getElementById("imageManagerForm"),i=new FileReader,l=new Image;let r,d,s,c,u,p,_,m,g,h,f,v,y,b,I,E=null;if(e&&o&&o.dataset.source&&(v=o.dataset.source?o.dataset.source:null,y=o.dataset.sourceId&&!isNaN(parseInt(o.dataset.sourceId))?parseInt(o.dataset.sourceId):null,r=`/public/img/${v}/${y}`,b=`/public/thumbs/${v}/${y}`,a)){let o=a.files[0];if(console.log("file",o),$(n).attr("src",e.result),o){let e=function(e){console.groupCollapsed("ImageManager.getFileName");let t,a=null,n=[];if(e&&e.name){let o=e.name.split(".");if(o.length){a=o[o.length-1];for(let e=0;e<o.length-1;e++)n.push(o[e]);t=n.join(".")}}return console.groupEnd(),removeNulls({name:t,extension:a})}(o);console.log("fileNameParts",e),u=e.extension?e.extension:null,p=e.name?e.name:null,c=function(e){console.groupCollapsed("ImageManager.getFileSize");let t=null;return t=e.size>1048576?(Math.round(100*e.size/1048576)/100).toString()+"MB":(Math.round(100*e.size/1024)/100).toString()+"KB",console.groupEnd(),t}(o),_=function(e){console.groupCollapsed("ImageManager.getFileType");let t=null;return e&&e.type&&(t=e.type),console.groupEnd(),t}(o),I=r+"/"+p+"."+u,E=b+"/"+p+"."+u,i.onload=function(e){l.onload=function(){if(d=this.height?this.height:null,s=this.width?this.width:null,is_null(s)||is_null(d))console.error("Missing Height or Width");else{let e=gcd(s,d);f=`${s} x ${d}`,m=`${h=s/e}:${g=d/e}`}return t({file:o,source:v,source_id:isNaN(parseInt(y))?null:parseInt(y),name:is_null(p)?null:p,height:isNaN(parseInt(d))?null:parseInt(d),width:isNaN(parseInt(s))?null:parseInt(s),path:is_null(r)?null:r,full_path:is_null(I)?null:I,full_thumbs_path:is_null(E)?null:E,thumbs_path:is_null(b)?null:b,size:is_null(c)?null:c,extension:is_null(u)?null:u,type:is_null(_)?null:_,ratio:is_null(m)?null:m,dimensions:is_null(f)?null:f})},l.src=e.target.result},i.readAsDataURL(a.files[0])}}console.groupEnd()},G=function(e){console.groupCollapsed("ImageManager.fileSelected"),H();let t=document.getElementById("fileToUpload"),a=document.getElementById("fileName"),r=document.getElementById("fileSize"),d=document.getElementById("fileType"),s=document.getElementById("fileExtension"),c=document.getElementById("imageManagerPreview"),u=document.getElementById("fileToUploadDisplay");K(e,function(e){if(e){console.log("data",e);let p=e.name?e.name:null,_=e.size?e.size:null,m=e.type?e.type:null,g=e.extension?e.extension:null,h=e.ratio?e.ratio:null,y=e.dimensions?e.dimensions:null,b=e.width?e.width:null,I=e.height?e.height:null,E=new FileReader;$(a).html(p),$(r).html(_),$(d).html(m),$(s).html(g),$(u).html(p),$(l).html(h),$(o).html(b),$(i).html(I),$(n).html(y),$(c).attr("src"),$(f).val(""),$(v).val(p),E.onload=function(e){$(c).attr("src",e.target.result)},E.readAsDataURL(t.files[0]),Z()}}),console.groupEnd()},J=function(){console.groupCollapsed("ImageManager.hideImageForm"),$(E).removeClass("disabled"),$(e).removeClass("disabled"),E.disabled=!1,e.disabled=!1,s.innerText="choose file",$(p).hide(),console.groupEnd()},Z=function(){console.groupCollapsed("ImageManager.renderImageForm"),$(E).addClass("disabled"),$(e).addClass("disabled"),E.disabled=!0,e.disabled=!0,$("#imageManagerFormDetails").show(),console.groupEnd()},X=function(){console.groupCollapsed("ImageManager.resetImageForm");if(_.innerHTML="&nbsp;",m.innerHTML="&nbsp;",g.innerHTML="&nbsp;",h.innerHTML="&nbsp;",l.innerHTML="&nbsp;",o.innerHTML="&nbsp;",i.innerHTML="&nbsp;",n.innerHTML="&nbsp;",f.value="",v.value="",y.value="",b.value="",I.value="",w.checked=!0,C.checked=!1,k.checked=!0,$(S).attr("src","/public/img/placeholder.jpg"),null!==P){let e=null!==D&&!0===D?"is-cover-image":"",t=null!==D&&!0===D?"is-shown":"";$(".img-thumbnail.is-cover-image").removeClass("is-cover-image"),$("#image_"+P).addClass(`${e} ${t}`),P=null,D=null,F=null}$("img.img-thumbnail").removeClass("selected"),console.groupEnd()},ee=function(e){if(console.groupCollapsed("ImageManager.edit"),e){H();let t=isNaN(parseInt(e.id))?null:e.id,a=t?"image_"+t.toString():null,r=document.getElementById(a);r&&($(r).addClass("selected"),function(e){if(console.groupCollapsed("ImageManager.populateImageForm"),e){console.log(e);let t=e.extension?L.get(e.extension):null,a=e.alt?e.alt:null,r=e.caption?e.caption:null,d=(isNaN(parseInt(e.created_by))||parseInt(e.created_by),e.date_created?e.date_created:formatDateMySQL(),e.date_modified?e.date_modified:formatDateMySQL(),e.dimensions?e.dimensions:null),s=e.enabled&&1===e.enabled,c=e.extension?e.extension:null,u=isNaN(parseInt(e.height))?null:parseInt(e.height),p=isNaN(parseInt(e.id))?null:parseInt(e.id),E=!(!e.is_cover||1!==e.is_cover),N=!(!e.is_shown||1!==e.is_shown),B=(isNaN(parseInt(e.modified_by))||parseInt(e.modified_by),e.name?e.name:null),x=(e.note&&e.note,e.path?e.path:null),M=e.size?e.size:null,P=e.title?e.title:null,D=isNaN(parseInt(e.width))?null:parseInt(e.width),F=gcd(D,u),T=`${D/F}:${u/F}`,R=`${x}/${B}.${c}`;_.innerHTML=B,m.innerHTML=t,g.innerHTML=c,h.innerHTML=M,l.innerHTML=T,n.innerHTML=d,o.innerHTML=D,i.innerHTML=u,f.value=p,v.value=B,y.value=P,b.value=a,I.value=r,w.checked=s,C.checked=E,k.checked=N,$(S).attr("src",R),Z()}console.groupEnd()}(e),s.innerText="Save")}console.groupEnd()},te=function(e){console.groupCollapsed("ImageManager.buildImageThumbnail");let t="",a="";if(e){e.path&&e.path;let n=e.alt?e.alt:null,o=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,i=!(!e.is_cover||1!==e.is_cover),l=!(!e.is_shown||1!==e.is_shown),r=e.thumbs_path?e.thumbs_path:null,d=e.path?e.path:null,s=e.name?e.name:null,c=e.extension?e.extension:null;if(i&&(t="is-cover-image"),l&&(a="is-shown"),null!==r&&null!==d&&null!==s&&null!==c){let e=$("<img/>",{id:"image_"+o,attr:{"data-id":o},class:`img-thumbnail ${t} ${a}`,alt:n,src:`${r}/${s}.${c}`}).on("click",function(){let e=this.dataset.id&&!isNaN(parseInt(this.dataset.id))?parseInt(this.dataset.id):null;if(e){let t=ImageManager.all.get(e);t?ee(t):console.log("ImageManager.all",ImageManager.all)}else console.log("nope")});return $("<div/>",{class:"col-12 col-md-4 mb-2"}).append(e)}}console.groupEnd()},ae=function(e){console.groupCollapsed("ImageManager.init"),e&&e.source&&(N=e.source?e.source:null,B=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,$(d).empty(),J(),initializeValidator(M),ImageManager.source=N,ImageManager.sourceId=B,ImageManager.validator=$(r).validate(),function(e,t){if(console.groupCollapsed("ImageManager.get"),e){let a=`/api/v1.0/images/${ImageManager.source}/${ImageManager.sourceId}`;try{sendGetRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){return console.log("error",e),T("Error Retrieving Images.","Image Manager","error")}}console.groupEnd()}({},function(e){!function(e){console.groupCollapsed("ImageManager.loadAll"),ImageManager.all=new Map,e&&$.each(e,function(e,t){let a=j(t);ImageManager.all.set(a.id,a),$(d).append(te(a))});console.groupEnd()}(e)})),console.groupEnd()};return{source:null,sourceId:null,detail:{},all:new Map,init:function(e){return ae(e)}}}(),LocationTypes=function(){"use strict";document.getElementById("input_location_types_id"),document.getElementById("input_location_types_name"),document.getElementById("input_location_types_icon"),document.getElementById("input_location_types_sort_order"),document.getElementById("input_location_types_enabled"),document.getElementById("input_location_types_date_created"),document.getElementById("input_location_types_created_by"),document.getElementById("input_location_types_date_modified"),document.getElementById("input_location_types_modified_by"),document.getElementById("input_location_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,icon:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.icon=t.icon?t.icon:null,a.sort_order=t.sort_order?t.sort_order:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),LocationTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,LocationTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);LocationTypes.all.set("id",n)})},save:function(e){},init:function(){}}}(),AddressTypes=function(){"use strict";document.getElementById("input_address_types_id"),document.getElementById("input_address_types_name"),document.getElementById("input_address_types_sort_order"),document.getElementById("input_address_types_enabled"),document.getElementById("input_address_types_date_created"),document.getElementById("input_address_types_created_by"),document.getElementById("input_address_types_date_modified"),document.getElementById("input_address_types_modified_by"),document.getElementById("input_address_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.sort_order=t.sort_order?t.sort_order:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),AddressTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,AddressTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);AddressTypes.all.set("id",n)})},save:function(e){},init:function(){}}}(),City=function(){"use strict";const e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,t=document.getElementById("product_location_departing_airport_city_search"),a=document.getElementById("product_location_departing_airport_city_id"),n=document.getElementById("product_location_arriving_airport_city_id"),o=document.getElementById("product_edit_location_city_id"),i=document.getElementById("product_location_arriving_airport_city_search"),l=document.getElementById("modal_product_city_id"),r=document.getElementById("modal_product_province_id"),d=document.getElementById("modal_product_country_id"),s=document.getElementById("modal_product_arrive_to_airport_city"),c=document.getElementById("modal_product_arrive_to_airport_country_id"),u=document.getElementById("modal_product_arrive_to_airport_province_id"),p=document.getElementById("modal_product_arrive_to_airport_city_id"),_=document.getElementById("modal_product_depart_from_airport_city"),m=document.getElementById("modal_product_depart_from_airport_country_id"),g=document.getElementById("modal_product_depart_from_airport_province_id"),h=document.getElementById("modal_product_depart_from_airport_city_id"),f=document.getElementById("modal_product_arrive_to_station_country_id"),v=document.getElementById("modal_product_arrive_to_station_province_id"),y=document.getElementById("modal_product_arrive_to_station_city_id"),b=document.getElementById("modal_product_depart_from_station_country_id"),I=document.getElementById("modal_product_depart_from_station_province_id"),E=document.getElementById("modal_product_depart_from_station_city_id");$("#product_location_transport_city_search").on("change",function(){setTimeout(function(){},200)}).on("search",function(){o.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;o.value=t.id}}),$("#product_location_cars_city_search").on("change",function(){setTimeout(function(){},200)}).on("search",function(){o.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;o.value=t.id}}),$("#product_location_arriving_airport_city_search").on("change",function(){setTimeout(function(){""===$("#product_location_arriving_airport_city_search").val()&&(n.value="")},200)}).on("search",function(){n.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;i.value=e.value,n.value=t.id}}),$("#product_location_departing_airport_city_search").on("change",function(){setTimeout(function(){""===$("#product_location_departing_airport_city_search").val()&&(o.value="",a.value="")},200)}).on("search",function(){o.value="",a.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let n=e.data;t.value=e.value,a.value=n.id,o.value=n.id}}),$("#form_product_search_hotel_product_location").on("change",function(){setTimeout(function(){},200)}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){}}),$(l).on("change",function(){l.value}),$("#modal_product_depart_from_airport_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(_).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;l.value=t.id,$(l).val(t.id?t.id:"").trigger("change"),m.value=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),g.value=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),h.value=isNaN(parseInt(t.id))?null:parseInt(t.id)}}),$("#modal_product_arrive_to_airport_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(s).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;c.value=t.country.id?t.country.id:null,u.value=t.province.id?t.province.id:null,p.value=t.id?t.id:null}}),$("#modal_product_depart_from_station_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(d).val(""),$(r).val(""),$(l).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;d.value=t.id,r.value=t.province.id,l.value=t.country.id,b.value=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),I.value=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),E.value=isNaN(parseInt(t.id))?null:parseInt(t.id),$(l).val(t.id?t.id:"").trigger("change")}}),$("#modal_product_arrive_to_station_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(l).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;f.value=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),v.value=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),y.value=isNaN(parseInt(t.id))?null:parseInt(t.id)}}),$("#modal_product_city").on("change",function(){setTimeout(function(){""===$("#modal_product_city").val()&&$(l).val("").trigger("change")},200)}).on("search",function(){l&&$(l).val("").trigger("change"),r&&(r.value=""),d&&(d.value="")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data,a=isNaN(parseInt(t.id))?null:parseInt(t.id),n=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),o=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id);l&&a&&(l.value=a),r&&n&&(r.value=n),d&&o&&(d.value=o)}}),$("#modal_product_city_cars").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(l).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;l.value=t.id,$(l).val(t.id?t.id:"").trigger("change")}}),$("#modal_product_city_transports").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(l).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data,a=t.province?t.province:{},n=t.country?t.country:{},o=n.id&&!isNaN(parseInt(n.id))?parseInt(n.id):null,i=a.id&&!isNaN(parseInt(a.id))?parseInt(a.id):null,s=t.id&&!isNaN(parseInt(t.id))?parseInt(t.id):null;console.log("|__ country",n),console.log("|__ province",a),console.log("|__ city",t),console.log("|__ countryId",o),console.log("|__ provinceId",i),console.log("|__ cityId",s),d.value=o,r.value=i,$(l).val(s).trigger("change")}}),$("#modal_product_city_tours").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(l).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data,a=t.country?t.country:{},n=t.province?t.province:{};d.value=a&&!isNaN(parseInt(a.id))?parseInt(a.id):null,r.value=n&&!isNaN(parseInt(n.id))?parseInt(n.id):null,l.value=t.id,$(l).val(t.id?t.id:"").trigger("change")}});const w=function(e,t,a){console.groupCollapsed("City.handleCityError"),t||(t="City"),a||(a="error"),e||(e="Error"),toastr[a](`${e}`,t),console.groupEnd()},C=e=>{console.groupCollapsed("City.onClickOutside"),$(e.target).parents("div.form-new-city")[0]||e.target.className.includes("select-add-option")||City.close(),console.groupEnd()},k=function(t){let a={id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:1,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),note:null},n=null;return t&&(n=validInt(t.id),a={id:validInt(t.id),province_id:validInt(t.province_id),created_by:t.created_by?t.created_by:e,modified_by:t.created_by?t.created_by:e,sort_order:t.sort_order?t.sort_order:null,name:t.name?t.name:null,enabled:t.enabled?t.enabled:1,date_created:t.date_created?t.date_created:formatDateMySQL(),date_modified:t.date_modified?t.date_modified:formatDateMySQL(),note:t.note?t.note:null}),City.detail=a,a},S=function(e,t,a){console.groupCollapsed("City.get"),City.all=new Map;let n=null;if(null!==City.id&&(n=City.id),a)return e&&t&&a?(function(e,t){if(console.groupCollapsed("City.handleCityError"),!e)return w("Error Loading Province- Missing Data");try{sendGetRequest("/api/v1.0/cities",e,function(e,a,n){return e?t(e):w("Oops: 1")})}catch(e){return w("Error Validating City")}console.groupEnd()}({country_id:parseInt(e),province_id:parseInt(t)},function(e){e&&(x(e),$(a).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),""!==n&&null!==n&&$(a).val(n).trigger("change"))}),void console.groupEnd()):($(a).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),$(a).val("").trigger("change"),void console.groupEnd())},N=function(e,t,a){console.groupCollapsed("City.add"),e&&(!function(e,t,a){console.groupCollapsed("City.build_form"),console.log("elem",e),console.log("val",t),console.log("dropdown_id",a);let n=$(e).attr("id"),o=$(e).parents("div.row"),i="";if(t&&(i=t),!n||!o[0])return;if(document.getElementById("form_new_city"))return;let l=document.createElement("div"),r=document.createElement("div"),d=document.createElement("div"),s=document.createElement("div"),c=document.createElement("h5"),u=document.createElement("div"),p=document.createElement("div"),_=document.createElement("div"),m=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),f=(document.createElement("div"),document.createElement("div")),v=document.createElement("div"),y=document.createElement("div"),b=document.createElement("div"),I=document.createElement("div"),E=document.createElement("div"),w=document.createElement("input"),k=document.createElement("label"),S=document.createElement("button"),N=document.createElement("button");l.id="form_new_city",l.classList.add("card"),l.classList.add("w-100"),l.classList.add("m-2"),l.classList.add("form-new-city"),r.classList.add("card-heading"),r.classList.add("p-1"),d.classList.add("card-body"),d.classList.add("p-1"),s.classList.add("card-footer"),s.classList.add("p-1"),c.classList.add("card-title"),c.innerText="City Details",w.id="city_name",w.name="city_name",w.type="text",w.classList.add("form-control"),k.htmlFor="city_name",k.innerHTML="Name:",E.id="city_name-error",S.classList=["btn btn-primary btn-sm waves-effect waves-light"],S.innerText="save",S.type="button",S.addEventListener("click",t=>{City.save(e,a)}),N.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],N.innerText="cancel",N.type="button",N.addEventListener("click",e=>{City.close()}),u.classList.add("row"),p.classList.add("row"),_.classList.add("row"),u.classList.add("mx-1"),p.classList.add("mx-1"),_.classList.add("mx-1"),m.classList=["col-lg-4 p-1 mb-1"],g.classList=["col-lg-4 p-1 mb-1"],h.classList=["col-lg-4 p-1 mb-1"],f.classList=["col-12 mb-1 text-right"],v.classList=["form-element"],y.classList=["form-element"],b.classList=["form-element"],I.classList=["form-element"],E.classList=["error w-100 text-center"],v.appendChild(k),v.appendChild(w),v.appendChild(E),m.appendChild(v),u.appendChild(m),u.appendChild(g),u.appendChild(h),f.append(N),f.appendChild(S),p.appendChild(f),r.appendChild(c),d.appendChild(u),s.appendChild(p),l.appendChild(r),l.appendChild(d),l.appendChild(s),o[0].appendChild(l),w.value=i,w.focus({preventScroll:!1}),window.addEventListener("click",C),console.groupEnd()}(e,t,a),console.groupEnd())},B=function(e,t){console.groupCollapsed("City.save");let a={},n=document.getElementById("city_name"),o=document.getElementById(t.replace(/city_id/g,"")+"province_id"),i=document.getElementById(t.replace(/city_id/g,"")+"country_id");if(!isNaN(parseInt(i.value))&&!isNaN(parseInt(o.value))&&n&&o&&i){a.name=n.value,a.country_id=parseInt(i.value),a.province_id=parseInt(o.value),!0===confirm("Are you sure you want to edit this record?")&&function(e,t){if(console.groupCollapsed("City.update_city_record"),!t)return w("Error: Missing Data");try{sendPostRequest("/api/v1.0/cities/update",t,function(t,a,n){if(!t||!t[0])return w("Error: 1");{let a=t[0];City.all.set(a.id,a);let n=$("select[data-type='city']");City.id=a.id,n.each(function(e,t){var n=new Option(a.name,a.id,!1,!1);$(t).append(n).trigger("change")}),$(e).val(a.id).trigger("change"),City.close(),toastr.success("City: "+a.id+" updated")}})}catch(e){return w("Error: Validating City")}console.groupEnd()}(e,remove_nulls(a))}console.groupEnd()},x=function(e){console.groupCollapsed("City.load_all"),City.all=new Map,e&&$.each(e,function(e,t){let a=k(t);City.all.set(a.id,a)}),console.groupEnd()},L=function(e){console.groupCollapsed("City.init"),function(e){console.groupCollapsed("City.handleCityError"),e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let a=document.getElementById(t);a&&$(a).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let n=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(n[0]){let e=n[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_city_add_icon")){let n=document.createElement("i");n.classList="select-add-option fas fa-plus filter_city_add",n.id="filter_city_add_icon",n.addEventListener("click",n=>{let o=e.value;$(a).select2("close"),City.add(this,o,t)}),e.after(n)}$(".filter_city_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_city_add").show():$(".filter_city_add").hide()})}}).on("change",function(){$(this).attr("id").replace("city","city")})}),console.groupEnd()}(e),console.groupEnd()};return{id:null,detail:{id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:null,date_created:null,date_modified:null,note:null},all:[],close:function(){!function(){console.groupCollapsed("City.destroy_form");let e=document.getElementById("form_new_city");e&&(e.parentNode.removeChild(e),window.removeEventListener("click",C)),console.groupEnd()}()},save:function(e,t){B(e,t)},get:function(e,t,a){S(e,t,a)},add:function(e,t,a){N(e,t,a)},set_detail:function(e){k(e)},init:function(e){L(e)},loadAll:function(e){!function(e){console.groupCollapsed("City.loadAll"),City.all=new Map,e&&$.each(e,function(e,t){let a=k(t);City.all.set(a.id,a)}),console.groupEnd()}(e)}}}(),Station=function(){"use strict";const t=document.getElementById("modal_product_depart_from_station_cancel_button"),a=document.getElementById("modal_product_depart_from_station_submit_button"),n=document.getElementById("modal_product_depart_from_station_iata_code"),o=document.getElementById("modal_product_depart_from_station_country_id"),i=document.getElementById("modal_product_depart_from_station_province_id"),l=document.getElementById("modal_product_depart_from_station_city_id"),r=document.getElementById("modal_product_depart_from_station_city"),d=document.getElementById("modal_product_depart_from_station"),s=document.getElementById("modal_product_depart_from_station_id"),c=document.getElementById("modal_product_depart_from_station_add_block"),u=document.getElementById("modal_product_depart_from_station_postal_code"),p=document.getElementById("modal_product_depart_from_station_street_1"),_=document.getElementById("modal_product_depart_from_station_street_2"),m=document.getElementById("modal_product_depart_from_station_edit_link"),g=document.getElementById("modal_product_depart_from_new_station_id"),h=document.getElementById("modal_product_depart_from_station_gps_code"),f=document.getElementById("modal_product_depart_from_station_local_code"),v=document.getElementById("modal_product_depart_from_station_home_link"),y=document.getElementById("modal_product_depart_from_station_wikipedia_link"),b=document.getElementById("modal_product_arrive_to_station_add_block"),I=document.getElementById("modal_product_arrive_to_station_cancel_button"),E=document.getElementById("modal_product_arrive_to_station_submit_button"),w=document.getElementById("modal_product_arrive_to_station_edit_link"),C=document.getElementById("modal_product_arrive_to_station"),k=document.getElementById("modal_product_arrive_to_station_city"),S=document.getElementById("modal_product_arrive_to_station_id"),N=document.getElementById("modal_product_arrive_to_new_station_id"),B=document.getElementById("modal_product_arrive_to_station_street_1"),x=document.getElementById("modal_product_arrive_to_station_street_2"),L=document.getElementById("modal_product_arrive_to_station_postal_code"),M=document.getElementById("modal_product_arrive_to_station_iata_code"),P=document.getElementById("modal_product_arrive_to_station_country_id"),D=document.getElementById("modal_product_arrive_to_station_province_id"),F=document.getElementById("modal_product_arrive_to_station_city_id"),T=document.getElementById("modal_product_arrive_to_station_gps_code"),R=document.getElementById("modal_product_arrive_to_station_local_code"),A=document.getElementById("modal_product_arrive_to_station_home_link"),q=document.getElementById("modal_product_arrive_to_station_wikipedia_link"),O=document.getElementById("modal_product_depart_from_station_add_block_close_button"),Y=document.getElementById("modal_product_arrive_to_station_add_block_close_button"),U=document.getElementById("modal_product_day_span"),W=document.getElementById("modal_product_station_day_span"),Q=document.getElementById("modal_product_country_id"),V=document.getElementById("modal_product_province_id"),j=document.getElementById("modal_product_city_id");let z=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,H=!1,K=!1;$(O).on("click",function(){ae("depart_from"),se("arrive_to"),se("depart_from"),m.innerText="Edit",w.innerText="Edit",C.disabled=!1,d.disabled=!1}),$(Y).on("click",function(){ae("arrive_to"),se("arrive_to"),se("depart_from"),m.innerText="Edit",w.innerText="Edit",C.disabled=!1,d.disabled=!1}),$(W).on("change",function(e){let t=$(this).val();""===t||isNaN(parseInt(t))?t=1:t<1&&(t=1),W.value=t,U.value=t}),$(m).on("click",function(){"Edit"===m.innerText?(ne("depart_from"),se("arrive_to"),m.innerText="Cancel",w.innerText="Edit",d.disabled=!0,C.disabled=!1):(ae("depart_from"),se("arrive_to"),se("depart_from"),m.innerText="Edit",w.innerText="Edit",C.disabled=!1,d.disabled=!1)}),$(w).on("click",function(){"Edit"===w.innerText?(ne("arrive_to"),se("depart_from"),m.innerText="Edit",w.innerText="Cancel",C.disabled=!0,d.disabled=!1):(ae("arrive_to"),se("arrive_to"),se("depart_from"),m.innerText="Edit",w.innerText="Edit",C.disabled=!1,d.disabled=!1)}),$(c).on("change",function(){ee()}).on("keyup",function(){ee()}),$(t).on("click",function(){ae("depart_from"),m.innerText="Edit"}),$(I).on("click",function(){ae("arrive_to"),w.innerText="Edit"}),$(a).on("click",function(){Z("depart_from")}),$(E).on("click",function(){Z("arrive_to")});const G=function(){console.groupCollapsed("Station.clearDepartFromFields"),c&&(Station.departFromKeywords&&Station.departFromKeywords.clear(),h.value="",f.value="",v.value="",y.value="",s.value="",o.value="",i.value="",l.value="",d.value="",Q.value="",V.value="",j.value="",m.dataset.stationId="",se("depart_from"),me("depart_from"),$(d).trigger("change")),console.groupEnd()},J=function(){console.groupCollapsed("Station.clearArriveToFields");Station.arriveToKeywords&&Station.arriveToKeywords.clear(),T.value="",R.value="",A.value="",q.value="",N.value="",M.value="",k.value="",F.value="",P.value="",D.value="",L.value="",B.value="",x.value="",S.value="",C.disabled=!1,w.dataset.stationId="",clearAllValidation(),se("arrive_to"),me("arrive_to"),$(C).trigger("change"),console.groupEnd()},Z=function(e){if(console.groupCollapsed("Station.save"),e){let t=te(e);if(!t)return;confirmDialog("Would you like to update?",a=>{a&&(console.log("dataToSend",t),X(t,function(t){let a;if(console.log("data",t),t&&(a=t,t[0]&&(a=t[0])),a){let t=isNaN(parseInt(a.id))?null:parseInt(a.id);null!==t?(Station.all.set(t,a),e?("depart_from"===e?Station.departingStation=a:Station.arrivingStation=a,ae(e),se(e),ue(),le(`Station ${t} has been updated.`,"Station","success"),m.innerText="Edit",w.innerText="Edit",C.disabled=!1,d.disabled=!1):le(`Station ${t} missing type.`,"Station","warning")):le("Missing Fields","Station","error")}}))})}console.groupEnd()},X=function(e,t){if(console.groupCollapsed("Station.sendSaveRequest"),e){let a="/api/v1.0/stations/update";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e);le("Oops: 1")})}catch(e){}}console.groupEnd()},ee=function(){console.groupCollapsed("Station.validDepartFromRecord");let e=!0;return""===n.value?($(n).showError("Field Required"),e=!1):$(n).hideError(),isNaN(parseInt(l.value))?($(r).showError("Field Required"),e=!1):$(r).hideError(),console.groupEnd(),e},te=function(e){let t;if(console.groupCollapsed("Station.buildAddStationRecord"),c&&b&&e)if("depart_from"===e){if(ee()){let e={gps_code:""!==h.value?h.value:null,local_code:""!==f.value?f.value:null,home_link:""!==v.value?v.value:null,wikipedia_link:""!==y.value?y.value:null,scheduled_service:1,keywords:Station.departFromKeywords.build(),id:g&&!isNaN(parseInt(g.value))?parseInt(g.value):null,postal_code:""!==u.value?u.value:null,street_1:""!==p.value?p.value:null,street_2:""!==_.value?_.value:null,city_id:isNaN(parseInt(l.value))?null:parseInt(l.value),name:""!==d.value?d.value:null,iata_code:""!==n.value?n.value:null,enabled:1};t=removeNulls(e)}}else if("arrive_to"===e&&function(){console.groupCollapsed("Station.validArriveToRecord");let e=!0;return""===M.value?($(M).showError("Field Required"),e=!1):$(M).hideError(),isNaN(parseInt(F.value))?($(k).showError("Field Required"),e=!1):$(k).hideError(),console.groupEnd(),e}()){let e={gps_code:""!==T.value?T.value:null,local_code:""!==R.value?R.value:null,home_link:""!==A.value?A.value:null,wikipedia_link:""!==q.value?q.value:null,scheduled_service:1,keywords:Station.arriveToKeywords.build(),id:N&&!isNaN(parseInt(N.value))?parseInt(N.value):null,postal_code:""!==L.value?L.value:null,street_1:""!==B.value?B.value:null,street_2:""!==x.value?x.value:null,city_id:isNaN(parseInt(F.value))?null:parseInt(F.value),name:""!==C.value?C.value:null,iata_code:""!==M.value?M.value:null,enabled:1};t=removeNulls(e)}return console.groupEnd(),t},ae=function(e){if(console.groupCollapsed("Station.cancelAddStationRecord"),e){switch(e){case"depart_from":_e(e),pe(Station.departingStation,e);break;case"arrive_to":_e(e),pe(Station.arrivingStation,e)}se(e),console.groupEnd()}},ne=function(e){console.groupCollapsed("Station.showStationForm"),e&&c&&b&&(d.disabled=!1,C.disabled=!1,"depart_from"===e?(d.disabled=!0,$(c).show(),$(b).hide(),me(e)):"arrive_to"===e&&(C.disabled=!0,$(b).show(),$(c).hide(),me(e)),console.groupEnd())},oe=function(e,t){if(console.groupCollapsed("Station.stationExists"),e&&""!==e){ie({name:e},function(a){let n=null;if(a&&(n=a,a[0]&&(n=a[0])),n&&n.id){let e=n.country?n.country:{},a=n.province?n.province:{},o=n.city?n.city:{},i=n&&!isNaN(parseInt(n.id))?parseInt(n.id):null,l=e&&!isNaN(parseInt(e.id))?parseInt(e.id):null,r=a&&!isNaN(parseInt(a.id))?parseInt(a.id):null,d=o&&!isNaN(parseInt(o.id))?parseInt(o.id):null;_e(t),pe(n,t),se(t),me(t),"depart_from"===t?(H=!0,Q.value=l,V.value=r,j.value=d,m.dataset.stationId=i):"arrive_to"===t&&(K=!0,C.value=n.name,S.value=n.id,w.dataset.stationId=n.id)}else confirmDialog(`The station: ${e} does not exist exists. Would you like to create it?`,a=>{a?("depart_from"===t?H=!1:K=!1,_e(t),pe({name:e},t),ne(t)):"depart_from"===t?(j&&(j.value=""),s&&(s.value=""),d&&(d.value="")):(S&&(S.value=""),C&&(C.value=""))})})}console.groupEnd()},ie=function(e,t){console.groupCollapsed("Station.fetchByName");if(e)try{sendGetRequest("/api/v1.0/stations/validate",e,function(e,a,n){if(e)return t(e);le("Oops: 1")})}catch(e){le("Error Validating Station")}else le("Error Loading Station - Missing Data");console.groupEnd()},le=function(e,t,a){console.groupCollapsed("Station.handleStationError"),e||(e="There was an error."),t||(t="Station"),a||(a="error"),toastr[a](e,t),console.groupEnd()},re=function(e){console.groupCollapsed("Station.setDetail");let t=function(){console.groupCollapsed("Station.defaultDetail");let e={city:{id:null,country_id:null,province_id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:z,date_modified:formatDateMySQL(),modified_by:z,note:null},country:{id:null,name:null,sort_order:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:z,date_modified:formatDateMySQL(),modified_by:z,note:null},created_by:z,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),display_long:null,display_medium:null,display_short:null,enabled:1,iata_code:null,id:null,keywords:null,gps_code:null,wikipedia_link:null,home_link:null,local_code:null,modified_by:z,name:null,note:null,postal_code:null,province:{id:null,name:null,sort_order:null,country_id:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:z,date_modified:formatDateMySQL(),modified_by:z,note:null},street_1:null,street_2:null};return console.groupEnd(),e}();return e&&(t.city=e.city?e.city:{id:null,country_id:null,province_id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:z,date_modified:formatDateMySQL(),modified_by:z,note:null},t.country=e.country?e.country:{id:null,name:null,sort_order:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:z,date_modified:formatDateMySQL(),modified_by:z,note:null},t.province=e.province?e.province:{id:null,name:null,sort_order:null,country_id:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:z,date_modified:formatDateMySQL(),modified_by:z,note:null},t.created_by=e.created_by?e.created_by:z,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null,t.enabled=e.enabled?e.enabled:1,t.iata_code=e.iata_code?e.iata_code:null,t.id=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,t.keywords=e.keywords?e.keywords:[],t.modified_by=e.modified_by?e.modified_by:z,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.postal_code=e.postal_code?e.postal_code:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.local_code=e.local_code?e.local_code:null,t.gps_code=e.gps_code?e.gps_code:null,t.home_link=e.home_link?e.home_link:null,t.wikipedia_link=e.wikipedia_link?e.wikipedia_link:null),console.groupEnd(),t},de=function(e){console.groupCollapsed("Station.resetStationForm"),c&&b&&e&&(C.disabled=!1,d.disabled=!1,_e(e),se("depart_from"),se("arrive_to")),console.groupEnd()},se=function(e){console.groupCollapsed("Station.hideStationForm"),e&&c&&b&&("depart_from"===e?($(c).hide(),d.disabled=!1,me(e)):"arrive_to"===e&&($(b).hide(),C.disabled=!1,me(e)),d.disabled=!1,C.disabled=!1,console.groupEnd())},ce=function(e){console.groupCollapsed("Station.loadAll"),Station.all=new Map,$.each(e,function(e,t){let a=re(t),n=a&&!isNaN(parseInt(a.id))?parseInt(a.id):null;Station.all.set(n,a)}),console.groupEnd()},ue=function(){console.groupCollapsed("Station.initAutocomplete"),d&&$(d).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){G()}).on("keyup",function(){H=!1}).on("change",function(){setTimeout(function(){let e=d.value;!1===H&&(""===e?(H=!1,G()):oe(e,"depart_from"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/stations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;let t=e.data,a="depart_from";t[0]&&(t=t[0]),H=!0,t?(console.log("station",t),pe(t,a),me(a)):(de(a),ne(a),me(a))}}),C&&$(C).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keyup",function(){K=!1}).on("search",function(){J()}).on("change",function(){setTimeout(function(){let e=C.value;!1===K&&(""===e?(J(),K=!1):oe(e,"arrive_to"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/stations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;let t=e.data,a="arrive_to";t[0]&&(t=t[0]),H=!0,t?(console.log("station",t),pe(t,a),me(a)):(de(a),ne(a),me(a))}}),console.groupEnd()},pe=function(e,t){if(console.groupCollapsed("Station.populateStationForm"),!t||!c||!b)return;let a=e&&e.country&&e.country.id&&!isNaN(parseInt(e.country.id))?parseInt(e.country.id):null,o=e&&e.province&&e.province.id&&!isNaN(parseInt(e.province.id))?parseInt(e.province.id):null,i=e&&e.province?e.province.name:null,I=e&&e.country?e.country.name:null,E=e&&e.city&&e.city.id&&!isNaN(parseInt(e.city.id))?parseInt(e.city.id):null,$=e&&e.city&&e.city.name?e.city.name:null,P=e&&e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,D=e&&e.name?e.name:null,O=e&&e.iata_code?e.iata_code:null,Y=e&&e.street_1?e.street_1:null,U=e&&e.street_2?e.street_2:null,W=e&&e.postal_code?e.postal_code:null,z=e&&e.gps_code?e.gps_code:null,H=e&&e.home_link?e.home_link:null,K=e&&e.wikipedia_link?e.wikipedia_link:null,G=e&&e.keywords?e.keywords:[],J="",Z=e&&e.local_code?e.local_code:null;null!==$&&null!==i&&null!==I&&(J=`${$} (${i}, ${I})`),"depart_from"===t?(Station.departingStation=e,Q.value=a,V.value=o,j.value=E,d.value=D,n.value=O,u.value=W,p.value=Y,_.value=U,h.value=z,v.value=H,y.value=K,r.value=J,s.value=P,l.value=E,g.value=P,m.dataset.stationId=P,f.value=Z,Station.departFromKeywords.set(G)):"arrive_to"===t&&(Station.arrivingStation=e,C.value=D,M.value=O,L.value=W,B.value=Y,x.value=U,T.value=z,A.value=H,q.value=K,k.value=J,S.value=P,F.value=E,N.value=P,w.dataset.stationId=P,R.value=Z,Station.arriveToKeywords.set(G)),console.groupEnd()},_e=function(e){if(console.groupCollapsed("Station.clearStationForm"),e){if($(W).val("1").trigger("change"),"depart_from"===e){if(!c)return;Station.departFromKeywords&&Station.departFromKeywords.clear(),g.value="",n.value="",r.value="",l.value="",o.value="",i.value="",u.value="",p.value="",_.value="",s.value="",Q.value="",V.value="",j.value="",d.disabled=!1,m.dataset.stationId="",clearAllValidation()}else if("arrive_to"===e){if(!b)return;Station.arriveToKeywords&&Station.arriveToKeywords.clear(),N.value="",M.value="",k.value="",F.value="",P.value="",D.value="",L.value="",B.value="",x.value="",S.value="",C.disabled=!1,w.dataset.stationId="",clearAllValidation()}else m.dataset.toggle="hidden",w.dataset.toggle="hidden",$(m).hide(),$(w).hide();console.groupEnd()}},me=function(e){if(console.groupCollapsed("Station.toggleEditFormLink"),e)if("depart_from"===e&&m){m.dataset.toggle&&m.dataset.toggle;g&&d&&l&&""!==g.value&&""!==d.value&&""!==l.value?(m.dataset.toggle="shown",$(m).show()):(m.dataset.toggle="hidden",$(m).hide())}else if("arrive_to"===e&&w){w.dataset.toggle&&w.dataset.toggle;N&&C&&F&&""!==N.value&&""!==C.value&&""!==F.value?(w.dataset.toggle="shown",$(w).show()):(w.dataset.toggle="hidden",$(w).hide())}else m.dataset.toggle="hidden",w.dataset.toggle="hidden",$(m).hide(),$(w).hide();console.groupEnd()};return{departingStation:null,departFromKeywords:null,arriveToKeywords:null,resetStationForm:function(e){de(e)},init:function(e){!function(e){console.groupCollapsed("Station.init");let t=e&&e.stations?e.stations:[];(d||C)&&(de("depart_from"),de("arrive_to"),se("depart_from"),se("arrive_to"),ce(t),ue()),console.groupEnd()}(e)}}}(),Province=function(){"use strict";const e="form-new-province",t="form_new_province";let a=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const n=function(e){toastr.error(e)},o=t=>{$(t.target).parents("div."+e)[0]||t.target.className.includes("select-add-option")||Province.close()},i=function(e){console.groupCollapsed("Province.update_select");let t=l(),n=null;return e&&(n=validInt(e.id),console.log("province",e),t={id:validInt(e.id),name:e.name?e.name:null,sort_order:e.sort_order?e.sort_order:9999999,country_id:validInt(e.country_id),iso2:e.iso2?e.iso2:null,iso3:e.iso3?e.iso3:null,enabled:e.enabled?e.enabled:1,date_created:e.date_created?e.date_created:formatDateMySQL(),created_by:e.created_by?e.created_by:a,date_modified:e.date_modified?e.date_modified:formatDateMySQL(),modified_by:e.modified_by?e.modified_by:a,note:e.note?e.note:null}),Province.id=n,Province.detail=t,console.groupEnd(),t},l=function(){return{id:null,name:null,sort_order:9999999,iso2:null,iso3:null,enabled:1,note:null,created_by:a,modified_by:a,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},r=function(){let e=document.getElementById(t);e&&(e.parentNode.removeChild(e),window.removeEventListener("click",o))},d=function(e,t){if(Province.all=new Map,!t)return;let a="";if(null!==Province.id&&(a=Province.id),!e)return $(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),void $(t).val("").trigger("change");!function(e,t){if(!e)return n("Error Loading Province- Missing Data");try{sendGetRequest("/api/v1.0/provinces",e,function(e,a,n){if(e)return t(e)})}catch(e){return n("Error Validating Province")}}({country_id:e},function(e){e&&(s(e),$(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(t).val(a).trigger("change"))})},s=function(e){console.groupCollapsed("Province.loadAll"),Province.all=new Map,e&&$.each(e,function(e,t){let a=i(t);console.log("province",t),console.log("detail",a),Province.all.set(a.id,a)}),console.groupEnd()},c=function(a,n,i){a&&function(a,n,i){console.groupCollapsed("Province.buildForm");let l=$(a).attr("id"),d=$(a).parents("div.row"),s="";if(n&&(s=n),!l||!d[0])return;if(document.getElementById(t))return;let c=document.createElement("div"),u=document.createElement("div"),p=document.createElement("div"),_=document.createElement("div"),m=document.createElement("h5"),g=document.createElement("div"),h=document.createElement("div"),f=document.createElement("div"),v=document.createElement("div"),y=document.createElement("div"),b=document.createElement("div"),I=document.createElement("div"),E=document.createElement("div"),w=document.createElement("div"),C=document.createElement("div"),k=document.createElement("div"),S=document.createElement("div"),N=document.createElement("div"),B=document.createElement("div"),x=document.createElement("div"),L=document.createElement("div"),M=document.createElement("input"),P=document.createElement("label"),D=document.createElement("input"),F=document.createElement("label"),T=document.createElement("input"),R=document.createElement("label"),A=document.createElement("button"),q=document.createElement("button");c.id=t,c.classList.add("card"),c.classList.add("w-100"),c.classList.add("m-2"),c.classList.add(e),u.classList.add("card-heading"),u.classList.add("p-1"),p.classList.add("card-body"),p.classList.add("p-1"),_.classList.add("card-footer"),_.classList.add("p-1"),m.classList.add("card-title"),m.innerText="Province Details",M.id="province_name",M.name="province_name",M.type="text",M.classList.add("form-control"),M.classList.add(e),P.htmlFor="province_name",P.innerHTML="Name:",B.id="province_name-error",D.id="province_iso2",D.name="province_iso2",D.type="text",D.maxLength=2,D.classList.add("form-control"),D.classList.add(e),F.htmlFor="province_iso2",F.innerHTML="ISO2:",x.id="province_iso2-error",T.id="province_iso3",T.name="province_iso3",T.type="text",T.maxLength=3,T.classList.add("form-control"),T.classList.add(e),R.htmlFor="province_iso3",R.innerHTML="ISO3:",L.id="province_iso3-error",A.classList.add("btn"),A.classList.add("btn-primary"),A.classList.add("btn-sm"),A.classList.add("waves-effect"),A.classList.add("waves-light"),A.innerText="save",A.type="button",A.addEventListener("click",e=>{Province.save(a,i)}),q.classList.add("btn"),q.classList.add("btn-outline-danger"),q.classList.add("btn-sm"),q.classList.add("waves-effect"),q.classList.add("waves-light"),q.innerText="cancel",q.type="button",q.addEventListener("click",e=>{r()}),g.classList.add("row"),g.classList.add("mx-1"),h.classList.add("row"),h.classList.add("mx-1"),f.classList.add("row"),f.classList.add("mx-1"),v.classList.add("col-4"),v.classList.add("col-md-4"),v.classList.add("col-lg-4"),v.classList.add("col-xl-4"),v.classList.add("mb-1"),v.classList.add("p-1"),y.classList.add("col-4"),y.classList.add("col-md-4"),y.classList.add("col-lg-4"),y.classList.add("col-xl-4"),y.classList.add("mb-1"),y.classList.add("p-1"),b.classList.add("col-4"),b.classList.add("col-md-4"),b.classList.add("col-lg-4"),b.classList.add("col-xl-4"),b.classList.add("mb-1"),b.classList.add("p-1"),I.classList.add("col-lg-3"),I.classList.add("mb-1"),I.classList.add("p-1"),E.classList.add("col-12"),E.classList.add("mb-1"),E.classList.add("text-right"),E.classList.add("p-1"),w.classList.add("col-12"),w.classList.add("mb-1"),w.classList.add("p-1");let O=document.createElement("section");document.createElement("div"),document.createElement("h5"),document.createElement("a"),document.createElement("div"),document.createElement("div"),document.createElement("div"),document.createElement("textarea"),document.createElement("div");O.classList.add("card"),O.classList.add("card-body"),O.classList.add("border"),O.classList.add("border-medium"),O.classList.add("z-depth-0"),O.classList.add("rounded-lg"),O.classList.add("p-0"),O.classList.add("mb-2"),C.classList.add("form-element"),k.classList.add("form-element"),S.classList.add("form-element"),N.classList.add("form-element"),B.classList.add("error"),B.classList.add("w-100"),B.classList.add("text-center"),x.classList.add("error"),x.classList.add("w-100"),x.classList.add("text-center"),L.classList.add("error"),L.classList.add("w-100"),L.classList.add("text-center"),C.appendChild(P),C.appendChild(M),C.appendChild(B),v.appendChild(C),k.appendChild(F),k.appendChild(D),k.appendChild(x),y.appendChild(k),S.appendChild(R),S.appendChild(T),S.appendChild(L),b.appendChild(S),g.appendChild(v),g.appendChild(y),g.appendChild(b),E.append(q),E.appendChild(A),w.appendChild(O),h.appendChild(E),f.appendChild(w),u.appendChild(m),p.appendChild(g),p.appendChild(f),_.appendChild(h),c.appendChild(u),c.appendChild(p),c.appendChild(_),d[0].appendChild(c),M.value=s,M.focus({preventScroll:!1}),window.addEventListener("click",o),console.groupEnd()}(a,n,i)},u=function(e,t){let a={},n=document.getElementById("province_name"),o=document.getElementById("province_iso2"),i=document.getElementById("province_iso3"),l=document.getElementById(t.replace(/province_id/g,"")+"country_id");isNaN(parseInt(l.value))||n&&o&&i&&l&&function(){let e=document.getElementById("province_name"),t=document.getElementById("province_iso2"),a=document.getElementById("province_iso3"),n=!0;return e&&t&&a?(""===e.value?($(e).addClass("is-invalid"),$("#province_name-error").text("Required: Field is required").show(),n=!1):($(e).removeClass("is-invalid"),$("#province_name-error").text("").hide()),""===t.value?($(t).addClass("is-invalid"),$("#province_iso2-error").text("Required: Field is required").show(),n=!1):($(t).removeClass("is-invalid"),$("#province_iso2-error").text("").hide()),""===a.value?($(a).addClass("is-invalid"),$("#province_iso3-error").text("Required: Field is required").show(),n=!1):($(a).removeClass("is-invalid"),$("#province_iso3-error").text("").hide()),n):(handle_country_error("Error Processing Data"),!1)}()&&(a.name=n.value,a.iso2=o.value,a.iso3=i.value,a.country_id=parseInt(l.value),confirmDialog("Would you like to update?",t=>{t&&p(e,remove_nulls(a))}))},p=function(e,t){if(t)try{sendPostRequest("/api/v1.0/provinces/update",t,function(t,a,o){if(!t||!t[0])return n("Error: 1");{let a=t[0],n=$("select[data-type='province']");Province.all.set(a.id,a),Province.id=a.id,City.id=null,n.each(function(e,t){let n=new Option(a.name,a.id,!1,!1);$(t).append(n).trigger("change")}),$(e).val(a.id).trigger("change"),Province.close(),toastr.success("Province: "+a.id+" updated")}})}catch(e){n("Error: Validating Province")}else n("Error: Missing Data")},_=function(e){console.groupCollapsed("Province.init"),function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let a=Country.id,n=(Province.id,document.getElementById(t));n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_province_add_icon")){let a=document.createElement("i");a.classList="select-add-option fas fa-plus filter_province_add",a.id="filter_province_add_icon",a.addEventListener("click",a=>{let o=e.value;$(n).select2("close"),Province.add(this,o,t)}),e.after(a)}$(".filter_province_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_province_add").show():$(".filter_province_add").hide()})}}).on("change",function(){let e=$(this).attr("id").replace("province","city"),t=$(this).attr("id").replace("province","country"),n=document.getElementById(e),o=document.getElementById(t);n&&o&&(a=parseInt(o.value),isNaN(parseInt(o.value))?(City.id=null,City.get(null,null,n)):isNaN(parseInt($(this).val()))?(City.id=null,City.get(a,null,n),City.id):City.get(a,parseInt($(this).val()),n)),City.id=null,Province.id=null})})}(e),console.groupEnd()};return{detail:{},all:new Map,id:null,set_detail:function(e){i(e)},update_select:function(e,t){},close:function(){r()},save:function(e,t){u(e,t)},get:function(e,t){d(e,t)},add:function(e,t,a){c(e,t,a)},init:function(e){_(e)},loadAll:function(e){s(e)}}}(),Country=function(){"use strict";const e="form_new_country",t=document.getElementById("country_iso3"),a=document.getElementById("country_iso2"),n=document.getElementById("country_name"),o=document.getElementById("form_new_country"),i=document.getElementById("new_country_submit_button"),l=document.getElementById("new_country_cancel_button"),r=document.getElementById("modal_product_country_cars"),d=document.getElementById("modal_product_country_id"),s=document.getElementById("modal_product_province_id"),c=document.getElementById("modal_product_city_id"),u=document.getElementById("modal_product_location_id"),p=document.getElementById("modal_new_product");let _=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,m=!1;$(i).on("click",function(){C(this)}),$(l).on("click",function(){y()});const g=function(){o&&(r&&(r.value=""),y(),v(),$(o).on("change",function(){console.log("Country.form_new_country:change()"),f()})),r&&$(r).on("search",function(){y(),b(),r&&(r.value="")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keyup",function(){let e=r.value;m=!1,""===e&&I()}).on("change",function(){let e=$(this).val();m=!1,setTimeout(function(){""===e?I():E(e)},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/countries",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=S(e.data),a=t&&!isNaN(parseInt(t.id))?parseInt(t.id):null;Country.all.get(a);m=!0,b(t)}})},h=function(){$(n).hideError(),$(a).hideError(),$(t).hideError()},f=function(){let e=!0,o=n&&""!==n.value?n.value:null,i=t&&""!==t.value?t.value:null,l=a&&""!==a.value?a.value:null;if(is_null(o)?(e=!1,$(n).showError("oops")):$(n).hideError(),is_null(i)?(e=!1,$(t).showError("oops")):$(t).hideError(),is_null(l)?(e=!1,$(a).showError("oops")):$(a).hideError(),e)return{name:o,iso2:l,iso3:i,sort_order:null,enabled:1,currency_id:5}},v=function(){o&&(n&&(n.disabled=!0),a&&(a.disabled=!0),t&&(t.disabled=!0),$(o).hide())},y=function(){d&&(d.value=""),s&&(s.value=""),c&&(c.value=""),t&&(t.value=""),a&&(a.value=""),n&&(n.value=""),m=!1,h()},b=function(e){let o,i,l,p="";e?(p=isNaN(parseInt(e.id))?"":parseInt(e.id),o=e.name?e.name:"",i=e.iso2?e.iso2:"",l=e.iso3?e.iso3:""):r&&(o=r.value,i="",l="",p=""),u&&(u.value=p),d&&(d.value=p),s&&(s.value=""),c&&(c.value=""),t&&(t.value=l),a&&(a.value=i),n&&(n.value=o),r&&(r.value=o)},I=function(){n&&(n.value=""),a&&(a.value=""),t&&(t.value=""),d&&(d.value=""),s&&(s.value=""),c&&(c.value=""),u&&(u.value=""),m=!1,h()},E=function(e){if(!1===m)if(e&&""!==e){!function(e,t){if(!e)return w("Error Loading Country - Missing Data");try{sendGetRequest("/api/v1.0/countries/validate",e,function(e){if(console.log("|__ data",e),e)return t(e);w("Oops: 1")})}catch(e){return console.log("error",e),w("Error Validating Country")}}({name:e},function(n){let i;n&&n.length&&(i=n,n[0]&&(i=n[0])),i&&i.length?(m=!0,y(),b(i)):(m=!1,confirmDialog(`The country: ${e} does not exist exists. Would you like to create it?`,e=>{e?(y(),b(),o&&(a&&(a.disabled=!1),t&&(t.disabled=!1),$(o).show())):(I(),r&&(r.value=""))}))})}else w("here")},w=function(e,t,a){let n=t||"Country";toastr[a||"error"](e,n)},C=function(e){if(n&&o&&a&&t){if(f()){let o={};o.name=n&&""!==n.value?n.value:null,o.iso2=a&&""!==a.value?a.value:null,o.iso3=t&&""!==t.value?t.value:null,o.enabled=1,o.sort_order=null,confirmDialog("Would you like to update?",t=>{t&&k(e,remove_nulls(o))})}}else toastr.error("Error: 2")},k=function(e,t){if(!t)return console.log("Error: Missing Data"),w("Error: Missing Data");try{sendPostRequest("/api/v1.0/countries/update",t,function(t){let a,n,i,l=$("select[data-type='country']");if(!t)return w("Error: 1");(a=S(t[0]?t[0]:t))&&(i=a.name?a.name:null,null!==(n=a.id?a.id:null)&&null!==i&&(Country.all.set(n,a),l.each(function(e,t){let a=new Option(i,n,!1,!1);null!==i&&null!==n&&$(t).append(a).trigger("change")}),$(e).val(n).trigger("change"),p&&o?(g(),b(a),r&&(r.value=i)):Country.close(),w(i+" was updated","Country","success")))})}catch(e){return console.log("error",e),w("Error: Validating Country")}},S=function(e){let t=N(),a=null;return e&&(a=validInt(e.id),t.id=validInt(e.id),t.name=e.name?e.name:null,t.sort_order=e.sort_order?e.sort_order:null,t.iso2=e.iso2?e.iso2:null,t.iso3=e.iso3?e.iso3:null,t.currency_id=validInt(e.currency_id),t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:_,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:_,t.note=e.note?e.note:null,t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null),Country.id=a,Country.detail=t,t},N=function(){return{id:null,name:null,sort_order:null,iso2:null,iso3:null,currency_id:null,enabled:1,note:null,created_by:_,modified_by:_,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),display_long:null,display_medium:null,display_short:null}},B=e=>{$(e.target).parents("div.form-new-country")[0]||e.target.className.includes("select-add-option")||Country.close()},x=function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let a=document.getElementById(t);a&&$(a).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let n=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(n[0]){let e=n[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_country_add_icon")){let t=document.createElement("i");t.classList="select-add-option fas fa-plus filter_country_add",t.id="filter_country_add_icon",t.addEventListener("click",t=>{let n=e.value;$(a).select2("close"),Country.add(this,n)}),e.after(t)}$(".filter_country_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_country_add").show():$(".filter_country_add").hide()})}}).on("change",function(){isNaN(parseInt($(this).val()))||parseInt($(this).val());let e=$(this).attr("id").replace("country","province"),t=document.getElementById(e),a=$(this).attr("id").replace("country","city");document.getElementById(a);isNaN(parseInt($(this).val()))?Province.get(null,t):t&&Province.get(parseInt($(this).val()),t)})})},L=function(e){!function(e,t){if(!e)return w("Error Loading Country- Missing Data");try{$.ajax({type:"GET",url:"/api/v1.0/countries",data:e,async:!1}).done(function(e){return e?t(e):w("Oops: 1")})}catch(e){return console.log("error",e),w("Error Validating Country")}}({},function(t){t&&(Country.all=t,x(e))})},M=function(t,a){t&&function(t,a){let n=$(t).attr("id"),o=$(t).parents("div.row"),i="";if(a&&(i=a),!n||!o[0])return;if(document.getElementById(e))return;let l=document.createElement("div"),r=document.createElement("h5"),d=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),p=document.createElement("div"),_=document.createElement("div"),m=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),f=document.createElement("div"),v=document.createElement("div"),y=document.createElement("div"),b=document.createElement("div"),I=document.createElement("div"),E=document.createElement("input"),w=document.createElement("label"),C=document.createElement("input"),k=document.createElement("label"),S=document.createElement("input"),N=document.createElement("label"),x=document.createElement("button"),L=document.createElement("button");r.classList="card-title",r.innerText="Country Details",l.id=e,l.classList=["card card-body m-3 form-new-country"],E.id="country_name",E.name="country_name",E.type="text",E.classList=["form-control "],w.htmlFor="country_name",w.innerHTML="Name:",y.id="country_name-error",C.id="country_iso2",C.name="country_iso2",C.type="text",C.maxLength=2,C.classList=["form-control "],k.htmlFor="country_iso2",k.innerHTML="ISO2:",b.id="country_iso2-error",S.id="country_iso3",S.name="country_iso3",S.type="text",S.maxLength=3,S.classList=["form-control "],N.htmlFor="country_iso3",N.innerHTML="ISO3:",I.id="country_iso3-error",x.classList=["btn btn-primary btn-sm waves-effect waves-light"],x.innerText="save",x.type="button",x.addEventListener("click",e=>{Country.save(t)}),L.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],L.innerText="cancel",L.type="button",L.addEventListener("click",e=>{Country.close()}),d.classList=["row"],s.classList=["row"],c.classList=["col-lg-3 mb-1"],u.classList=["col-lg-3 mb-1"],p.classList=["col-lg-3 mb-1"],_.classList=["col-lg-3 mb-1"],m.classList=["col-12 mb-1 text-right"],g.classList=["form-element"],h.classList=["form-element"],f.classList=["form-element"],v.classList=["form-element"],y.classList=["error w-100 text-center"],b.classList=["error w-100 text-center"],I.classList=["error w-100 text-center"],g.appendChild(w),g.appendChild(E),g.appendChild(y),c.appendChild(g),h.appendChild(k),h.appendChild(C),h.appendChild(b),u.appendChild(h),f.appendChild(N),f.appendChild(S),f.appendChild(I),p.appendChild(f),d.appendChild(c),d.appendChild(u),d.appendChild(p),d.appendChild(_),m.append(L),m.appendChild(x),s.appendChild(m),l.appendChild(r),l.appendChild(d),l.appendChild(s),o[0].appendChild(l),E.value=i,E.focus({preventScroll:!1}),window.addEventListener("click",B)}(t,a)};return{detail:{},all:new Map,buildCountryDropDown:function(){},close:function(){!function(){let t=document.getElementById(e);t&&(t.parentNode.removeChild(t),window.removeEventListener("click",B))}()},add:function(e,t){M(e,t)},save:function(e){C(e)},set:function(e){set(e)},set_detail:function(e){S(e)},load_all:function(e){!function(e){Country.all=new Map,e&&$.each(e,function(e,t){let a=S(t);Country.all.set(a.id,a)})}(e)},get:function(e){L(e)},init:function(e){!function(e){x(e)}(e)},initAutocomplete:function(){g()}}}(),Location=function(){"use strict";const e=document.getElementById("form_edit_location"),t=document.getElementById("form_location_details"),a=document.getElementById("location_types_id"),n=document.getElementById("location_name_filter"),o=document.getElementById("location_city_id"),i=document.getElementById("location_country_id"),l=document.getElementById("location_province_id"),r=document.getElementById("location_id"),d=document.getElementById("location_street_1"),s=document.getElementById("location_street_2"),c=document.getElementById("location_zipcode"),u=document.getElementById("location_name"),p=document.getElementById("location_enabled"),_=document.getElementById("button_clear_form_edit_location"),m=document.getElementById("button_submit_form_edit_location"),g=document.getElementById("button_edit_location"),h=document.getElementById("button_close_edit_location_form"),f=document.getElementById("form_edit_location_filter"),v=document.getElementById("location_name_filter_id"),y={groups:{locationGroup:"location_name_filter location_name_filter_id"},rules:{location_name_filter:{required:!0},location_name_filter_id:{required:!0,digits:!0}},messages:{location_name_filter:{required:"Field Required"},location_name_filter_id:{required:"Field Required",digits:"invalid"}}},b={rules:{location_types_id:{required:!0},location_city_id:{required:!0,digits:!0},location_country_id:{required:!0,digits:!0},location_province_id:{required:!0,digits:!0},location_name:{required:!0}},messages:{location_types_id:{required:"Field Required"},location_city_id:{required:"Field Required",digits:"invalid"},location_country_id:{required:"Field Required",digits:"invalid"},location_province_id:{required:"Field Required",digits:"invalid"},location_id:{required:"Field Required",digits:"invalid"},location_name:{required:"Field Required"}}},I=document.getElementById("form_product_edit_location"),E=document.getElementById("button_edit_product_location"),w=document.getElementById("button_clear_form_edit_product_location"),C=document.getElementById("button_submit_form_edit_product_location"),k=document.getElementById("button_close_edit_product_location_form"),S=document.getElementById("product_location_search"),N=document.getElementById("card_product_edit_location");let B,x,L={},M=!1,P=!1,D="medium",F=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$('a[data-toggle="tab"]').on("hide.bs.tab",function(e){z()});const T=function(){r.value="",a.value="",u.value="",d.value="",s.value="",c.value="",$(i).val("").trigger("change")},R=function(e){T();let t={},n={},o={},l={};if(e){S.value=e.display_medium?e.display_medium:"",u.value=e.name,$(r).val(e.id).trigger("change"),d.value=e.street_1,s.value=e.street_2,c.value=e.zipcode;let p="";e.type&&(p=(l=e.type).id),$(a).val(p),e.country&&(t=e.country,Country.id=t.id?t.id.toString():null),e.province&&(n=e.province,Province.id=n.id?n.id.toString():null),e.city&&(o=e.city,City.id=o.id?o.id:null),$(i).val(t.id?t.id:"").trigger("change")}},A=function(e){T(),$(N).hide()},q=function(e){T(),R(e),$(N).show()};$(C).on("click",function(){q()}),$(E).on("click",function(){Location.detail&&q(Location.detail)}),$(C).on("click",function(){}),$(w).on("click",function(){A()}),$(k).on("click",function(){A()}),$(S).on("click",function(){$(this).select()}).on("change",function(){P=!1,setTimeout(function(){S.value},200)}).on("search",function(){P=!1}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/locations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{default_display:D},onSelect:function(e){e&&e.data&&(P=!0)},onSearchComplete:function(e,t){}}),$(h).on("click",function(){H(),K(L),n.value=L.display_medium,$(r).val(L.id).trigger("change"),z()}),$(_).on("click",function(){H(),K()}),$(m).on("click",function(){Z()}),$(g).on("click",function(){r.value,j()}),$("input[name='location_display']").on("change",function(){let e=$("input[name='location_display']:checked").val();D=e,O(),null!==Location.detail["display_"+e]&&(n.value=Location.detail["display_"+e])}),$(u).on("change",function(){setTimeout(function(){let e=u.value;U(e)},200)}),$(r).on("change",function(){$(v).val($(r).val())});const O=function(){$(n).on("click",function(){$(this).select()}).on("change",function(){setTimeout(function(){let e=n.value;!1===P&&(""===n.value?(n.value="",$(r).val("").trigger("change"),H()):W(e))},200)}).on("search",function(){P=!1,$(r).val("").trigger("change"),n.value="",M=!0,G(),H(),K()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/locations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{default_display:D},onSelect:function(t){if(t&&t.data&&t.data.country&&t.data.province&&t.data.city){P=!0,H();let e=t.data;Location.detail=e,L=e,K(e)}e&&clearValidation(e)},onSearchComplete:function(e,t){}})},Y=function(e){toastr.error(e)},U=function(e){if(e&&""!==e){V({name:e,default_display:D},function(t){if(t&&t[0])if(confirm(`Location: ${e} all ready exists. Would you like to use it?`)){let e=t[0];H(),K(e)}else H(),K()})}},W=function(e){if(e&&""!==e){V({name:e,default_display:D},function(t){if(t&&t[0]){let e=t[0];P=!0,H(),K(e)}else P=!1,confirmDialog(`Location: ${e} does not exist. Would you like to create it?`,t=>{t?Q(e):(H(),K(L),z())})})}},Q=function(e){!1===P&&e&&(H(),K(),j(),u.value=e,u.disabled=!0)},V=function(e,t){if(!e)return Y("Error Loading Location- Missing Data");try{sendGetRequest("/api/v1.0/locations/validate",e,function(e,a,n){return e?t(e):Y("Oops: 1")})}catch(e){return Y("Error Validating Location")}},j=function(){!function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!0}),n.disabled=!0,g.disabled=!0}(),$(t).show()},z=function(){if(!t)return;let e=G(L);K(e),function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!1}),n.disabled=!1,g.disabled=!1}(),$(t).hide()},H=function(){u.disabled=!1,u.value="",n.value="",$(r).val("").trigger("change"),a.value="",d.value="",s.value="",c.value="",$(i).val("").trigger("change"),document.getElementById("location_display_medium").checked=!0},K=function(e){let t={},o={},l={},_={};if(e){n.value=e.display_medium?e.display_medium:"",p.checked=1===e.enabled,u.value=e.name,$(r).val(e.id).trigger("change"),d.value=e.street_1,s.value=e.street_2,c.value=e.zipcode;let m="";e.type&&(m=(_=e.type).id),$(a).val(m),e.country&&(t=e.country,Country.id=t.id?t.id.toString():null),e.province&&(o=e.province,Province.id=o.id?o.id.toString():null),e.city&&(l=e.city,City.id=l.id?l.id.toString():null),$(i).val(t.id?t.id:"").trigger("change")}},G=function(e){let t={id:null,display_long:null,display_medium:null,display_short:null,location_types_id:null,name:null,street_1:null,street_2:null,zipcode:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null,city:{id:null,name:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},province:{created_by:F,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,iso2:null,iso3:null,modified_by:F,name:null,name_long:null,note:null,sort_order:999},country:{created_by:F,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),currency_id:null,enabled:1,id:null,iso2:null,iso3:null,modified_by:F,name:null,name_long:null,note:null,sort_order:999},type:{created_by:F,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,icon:null,id:null,modified_by:F,name:null,note:null,sort_order:999}};L=t;let a={},n={},o={},i={};return e?(e.country&&(a=e.country),e.province&&(n=e.province),e.city&&(o=e.city),e.type&&(i=e.type)):e={},t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.zipcode=e.zipcode?e.zipcode:null,t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:F,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:F,t.note=e.note?e.note:null,t.country={created_by:a.created_by?a.created_by:F,date_created:a.date_created?a.date_created:formatDateMySQL(),date_modified:a.date_modified?a.date_modified:formatDateMySQL(),currency_id:a.currency_id?a.currency_id:null,enabled:a.enabled?a.enabled:1,id:a.id?a.id:null,iso2:a.iso2?a.iso2:null,iso3:a.iso3?a.iso3:null,modified_by:a.modified_by?a.modified_by:F,name:a.name?a.name:null,name_long:a.name_long?a.name_long:null,note:a.note?a.note:null,sort_order:a.sort_order?a.sort_order:999},t.province={created_by:n.created_by?n.created_by:F,date_created:n.date_created?n.date_created:formatDateMySQL(),date_modified:n.date_modified?n.date_modified:formatDateMySQL(),enabled:n.enabled?n.enabled:1,id:n.id?n.id:null,iso2:n.iso2?n.iso2:null,iso3:n.iso3?n.iso3:null,modified_by:n.modified_by?n.modified_by:F,name:n.name?n.name:null,name_long:n.name_long?n.name_long:null,note:n.note?n.note:null,sort_order:n.sort_order?n.sort_order:999},t.city={created_by:o.created_by?o.created_by:F,date_created:o.date_created?o.date_created:formatDateMySQL(),date_modified:o.date_modified?o.date_modified:formatDateMySQL(),enabled:o.enabled?o.enabled:1,id:o.id?o.id:null,modified_by:o.modified_by?o.modified_by:F,name:o.name?o.name:null,note:o.note?o.note:null,sort_order:o.sort_order?o.sort_order:999},t.type={created_by:i.created_by?i.created_by:F,date_created:i.date_created?i.date_created:formatDateMySQL(),date_modified:i.date_modified?i.date_modified:formatDateMySQL(),enabled:i.enabled?i.enabled:1,icon:i.icon?i.icon:null,id:i.id?i.id:null,modified_by:i.modified_by?i.modified_by:F,name:i.name?i.name:null,note:i.note?i.note:null,sort_order:i.sort_order?i.sort_order:999},Province.set_detail(t.province),Country.set_detail(t.country),City.set_detail(t.city),Location.detail=t,t},J=function(t){let a={};t&&(a=function(e){return G(e)}(t),L=a),e&&(validator_init(b),B=$(e).validate(),validator_init(y),x=$(f).validate(),$(i).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(l).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(o).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),H(),K(a),z()),I&&($(i).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(l).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(o).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),Location.detail=a,R(a)),n&&O()},Z=function(){$(e).valid()&&confirmDialog("Would you like to update?",e=>{e&&function(e,t){e&&sendPostRequest("/api/v1.0/locations/update",e,function(e,a,n){return e?t(e):Y("Oops: 1")})}(X(),function(e){let t;if(e&&e[0]){let a="medium";t=e[0],L=t;let o=document.getElementsByName("location_display");for(let e=0;e<o.length;e++)o[e].checked&&(a=o[e].value);r.value=t.id,n.value=t["display_"+a],z()}})})},X=function(){return remove_nulls({id:isNaN(parseInt(r.value))?null:parseInt(r.value),city_id:isNaN(parseInt(o.value))?null:parseInt(o.value),province_id:isNaN(parseInt(l.value))?null:parseInt(l.value),country_id:isNaN(parseInt(l.value))?null:parseInt(i.value),location_types_id:isNaN(parseInt(a.value))?null:parseInt(a.value),name:u&&""!==u.value?u.value:null,street_1:d&&""!==d.value?d.value:null,street_2:s&&""!==s.value?s.value:null,zipcode:c&&""!==c.value?c.value:null,enabled:1,note:null})};return{validator:null,detail:{},all:new Map,types:new Map,get:function(e){},load_all:function(e){load_all(e)},save:function(e){Z(e)},init:function(e){J(e)},populate_form:function(e){K(e)},set_detail:function(e){return G(e)},build:function(){if($(f).valid())return X()}}}(),Variant=function(){"use strict";const e=document.getElementById("button_remove_variant_from_product"),t=document.getElementById("product_edit_variant_section"),a=document.getElementById("panel_tab_variant"),n=document.getElementById("category_id"),o=document.getElementById("product_id"),i=document.getElementById("product_edit_variant_form_variant_name_filter"),l=document.getElementById("table_variant_product_edit"),r=document.getElementById("product_edit_variant_form"),d=document.getElementById("display_product_variant_name"),s=document.getElementById("product_edit_variant_form_variant_id"),c=document.getElementById("product_edit_variant_form_variant_name"),u=document.getElementById("product_edit_variant_form_variant_enabled"),p=document.getElementById("product_edit_variant_form_variant_code"),_=document.getElementById("product_edit_variant_form_variant_min_age"),m=document.getElementById("product_edit_variant_form_variant_max_age"),g=document.getElementById("product_edit_variant_form_submit_button"),h=document.getElementById("product_edit_variant_form_clear_button"),f=document.getElementById("product_edit_variant_form_close_button"),v=document.getElementById("product_edit_variant_form_variant_used_in_pricing"),y=document.getElementById("table_variant_product_edit_add_new_button"),b=document.getElementById("product_edit_variant_display");let I=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,E=$(l),w=!1,C={rules:{product_edit_variant_form_variant_name:{required:!0},product_edit_variant_form_variant_min_age:{number:!0,min:0},product_edit_variant_form_variant_max_age:{number:!0,min:1}},messages:{product_edit_variant_form_variant_name:{required:"Field Required"},product_edit_variant_form_variant_min_age:{number:"Field Invalid",min:"Field Invalid"},product_edit_variant_form_variant_max_age:{number:"Field Invalid",min:"Field Invalid"}}};$(e).on("click",function(){N()}),$(t).on("change",function(){x()}),$(y).on("click",function(){console.groupCollapsed("table_variant_product_edit_add_new_button:click"),E.clearSelectedRows(),F(),c.disabled=!1,console.groupEnd()}),$(h).on("click",function(){console.groupCollapsed("product_edit_variant_form_clear_button:click"),P(),E.clearSelectedRows(),console.groupEnd()}),$(f).on("click",function(){console.groupCollapsed("product_edit_variant_form_close_button:click"),P(),E.clearSelectedRows(),console.groupEnd()}),$(g).on("click",function(){console.groupCollapsed("Variant.product_edit_variant_form_submit_button:click()",this),O()}),$(a).on("hide.bs.tab",function(){P(),E.clearSelectedRows(),i.value="",i.disabled=!1});const k=function(e){if(console.groupCollapsed("Variant.clearProductOverview"),!e)return;let t=isNaN(parseInt(e.id))?null:parseInt(e.id);t&&$(`#product_edit_variant_display_${t}`).remove(),console.groupEnd()},S=function(e){if(console.groupCollapsed("Variant.buildProductOverview"),!e)return;let t=isNaN(parseInt(e.id))?null:parseInt(e.id),a=isNaN(parseInt(e.max_age))?null:parseInt(e.max_age),n=isNaN(parseInt(e.min_age))?null:parseInt(e.min_age),o=e.name?e.name:null,i=e.code?e.code:null;Variant.all.get(t)&&k(Variant.all.get(t)),$(b).append(`\n            <div id="product_edit_variant_display_${t}" class="col-12 col-sm-12 col-md-4 px-1">\n                <div class="card">\n                    <div class="card-body">\n                    \n                        <h5 class="card-title">${o}</h5>\n                        <h6 class="card-subtitle my-2 text-muted">${i}</h6>\n                        <p class="card-text"></p>\n       \n                        <table class="table table-sm">\n                            <thead>\n                                <tr>\n                                    <th>&nbsp;</th>\n                                    <th>Min</th>\n                                    <th>Max</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <tr>\n                                    <td>Age</td>\n                                    <td>${n}</td>\n                                    <td>${a}</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        `),console.groupEnd()},N=function(){console.groupCollapsed("Variant.remove"),confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e={variant_id:parseInt(s.value),product_id:parseInt(o.value)};B(e,function(t){if(t){let t=U(Variant.all.get(e.variant_id));Variant.all.delete(e.variant_id),E.deleteRow(t),E.clearSelectedRows(),i.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),x(),P(),YearCalendar.endLoading(),k(t),toastr.warning(`Variant: ${t.name} - has been removed`,"Variant")}})}else P(),E.clearSelectedRows(),i.value="",i.disabled=!1}),console.groupEnd()},B=function(e,t){if(console.groupCollapsed("Variant.removeProductVariant"),e){let a="/api/v1.0/variants/remove";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e);L("Oops: 1")})}catch(e){}}console.groupEnd()},x=function(){if(console.groupCollapsed("Variant.updateProgress"),0===Array.from(Variant.all.values()).length){$("<span/>",{class:"badge badge-danger  ml-2",text:"!",id:"variantNeedsAttention"});$(a).html('<span id="tab_span_variant">Variant</span> <span id="variantNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>')}else $(a).html('<span id="tab_span_variant">Variant</span>');Product.updateProgress(),console.groupEnd()},L=function(e,t,a){console.groupCollapsed("Variant.handleVariantError"),e||(e="Variant Error"),t||(t="Variant"),a||(a="error"),toastr[a](`${e}`,t),console.groupEnd()},M=function(e){if(console.groupCollapsed("Variant.nameExists"),e&&""!==e){let t=remove_nulls({name:e,category_id:isNaN(parseInt(n.value))?null:parseInt(n.value)});!function(e,t){console.groupCollapsed("Variant.fetchByName");if(e)try{sendGetRequest("/api/v1.0/variants/validate",e,function(e,a,n){if(e)return t(e);L("Oops: 1")})}catch(e){L("Error Validating Variant")}else L("Error Loading Variant - Missing Data");console.groupEnd()}(t,function(a){let n=null;if(a&&a[0]&&(n=a,a[0]&&(n=a[0])),n){let e,t=Variant.all.get(parseInt(n.id));t?(e=U(t),E.loadRow(e)):e=U(n),F(e),c.disabled=!0}else confirmDialog(`The variant: ${e} does not exist exists. Would you like to create it?`,a=>{if(a){let a="/api/v1.0/variants/new";try{sendPostRequest(a,t,function(t,a,n){if(!t)return L("Oops: 1");{let a=t;t[0]&&(a=t[0]);let n=U(a);D(),E.clearSelectedRows(),w=!1,c.value=e,d.innerText=e,F(n),A()}})}catch(e){}}})})}console.groupEnd()},P=function(){console.groupCollapsed("Variant.resetForm"),D(),q(),T(),console.groupEnd()},D=function(){console.groupCollapsed("Variant.clearForm"),clearValidation(r),d.innerText="&nbsp;",s.value="",c.value="",u.checked=!0,p.value="",_.value=0,m.value="",v.checked=!0,console.groupEnd()},F=function(e){console.groupCollapsed("Variant.populateForm"),D(),e&&(v.checked=1===e.used_in_pricing,d.innerText=e.name?e.name:"&nbsp;",s.value=isNaN(parseInt(e.id))?"":parseInt(e.id),c.value=e.name?e.name:"&nbsp;",u.checked=!(e.enabled&&0===e.enabled),p.value=e.name?e.name:"&nbsp;",_.value=isNaN(parseInt(e.min_age))?1:parseInt(e.min_age),m.value=isNaN(parseInt(e.max_age))?"":parseInt(e.max_age)),A(),R(),console.groupEnd()},T=function(){console.groupCollapsed("Variant.hideForm"),x(),i.disabled=!1,i.value="",$(r).hide(),console.groupEnd()},R=function(){console.groupCollapsed("Variant.loadForm"),i.disabled=!0,$(r).show(),console.groupEnd()},A=function(){console.groupCollapsed("Variant.enableFormFields"),v.disabled=!1,s.disabled=!0,c.disabled=!0,u.disabled=!0,p.disabled=!0,_.disabled=!1,m.disabled=!1,g.disabled=!1,console.groupEnd()},q=function(){console.groupCollapsed("Variant.disableFormFields"),v.disabled=!0,s.disabled=!0,c.disabled=!0,u.disabled=!0,p.disabled=!0,_.disabled=!0,m.disabled=!0,g.disabled=!0,console.groupEnd()},O=function(){console.groupCollapsed("Variant.save"),function(){console.groupCollapsed("Variant.validVariantRecord");let e=$(r).valid(),t=isNaN(parseInt(_.value))?null:parseInt(_.value),a=isNaN(parseInt(m.value))?null:parseInt(m.value);return null!==t&&null!==a&&parseInt(a)<parseInt(t)&&(setError(m,"Age is greater than minimum"),e=!1),console.groupEnd(),e}()&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){!function(e,t){if(console.groupCollapsed("Variant.saveProductVariant"),e){let a="/api/v1.0/variants/update";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e);L("Oops: 1")})}catch(e){}}console.groupEnd()}(function(){console.groupCollapsed("Variant.buildVariantRecord");let e={id:isNaN(parseInt(s.value))?null:parseInt(s.value),category_id:isNaN(parseInt(n.value))?null:parseInt(n.value),product_id:isNaN(parseInt(o.value))?null:parseInt(o.value),name:c&&""!==c.value?c.value:null,code:p&&""!==p.value?p.value:null,min_age:isNaN(parseInt(_.value))?null:parseInt(_.value),max_age:isNaN(parseInt(m.value))?null:parseInt(m.value),used_in_pricing:!0===v.checked?1:0};return console.groupEnd(),remove_nulls(e)}(),function(e){if(e){let t=U(e[0]?e[0]:e);Variant.all.get(t.id)?E.updateRow(t):E.insertRow(t),Variant.all.set(t.id,t),E.loadRow(t),E.jumpToRow(t),E.clearSelectedRows(),i.disabled=!1,i.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),x(),P(),S(t),YearCalendar.endLoading(),toastr.success(`Variant: ${t.name} - has been updated`,"Variant")}})}else P(),E.clearSelectedRows(),i.value="",i.disabled=!1}),console.groupEnd()},Y=function(e){console.groupCollapsed("Variant.init");let t=[];e&&(console.log("settings",e),e&&(t=e)),l&&(console.groupCollapsed("Variant.buildProductEditTable"),E=$(l).table({table_type:"display_list",data:Variant.all,columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Code",targets:1,data:"code",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Min Age",targets:2,data:"min_age",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Max Age",targets:3,data:"max_age",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Variant.edit}),console.groupEnd()),function(e){console.groupCollapsed("Variant.loadAll"),Variant.all=new Map,e&&$.each(e,function(e,t){let a=U(t);Variant.all.set(a.id,a),E.insertRow(a),S(a)}),console.groupEnd()}(t),i&&function(){console.groupCollapsed("Variant.initAutoComplete");let e=isNaN(parseInt(n.value))?null:parseInt(n.value);$(i).on("click",function(){$(this).select()}).on("search",function(){w=!1,P(),E.clearSelectedRows()}).on("change",function(){setTimeout(function(){let e=i.value;E.clearSelectedRows(),!1===w&&(""===e?(i.value="",w=!1,P()):M(e))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/variants",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:e},onSelect:function(e){if(E.clearSelectedRows(),!e||!e.data)return;let t,a=e.data,n=Variant.all.get(parseInt(a.id));n?(t=U(n),E.loadRow(t)):(t=U(a)).used_in_pricing=1,F(t),c.disabled=!0}}),console.groupEnd()}(),r&&(validator_init(C),Variant.validator=$(r).validate(),P(),x()),console.groupEnd()},U=function(e){console.groupCollapsed("Variant.set");let t=function(){console.groupCollapsed("Variant.defaultDetail");let e={id:null,category_id:null,name:null,min_age:null,max_age:null,enabled:1,date_created:formatDateMySQL(),created_by:I,date_modified:formatDateMySQL(),modified_by:I,used_in_pricing:1,note:null};return console.groupEnd(),e}();return e&&(t.id=e.id?e.id:null,t.category_id=e.category_id?e.category_id:null,t.name=e.name?e.name:null,t.code=e.code?e.code:null,t.min_age=e.min_age?e.min_age.toString():null,t.max_age=e.max_age?e.max_age:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:I,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:I,t.used_in_pricing=1===e.used_in_pricing?1:0,t.note=e.note?e.note:null),Product.detail=t,console.groupEnd(),t};return{validator:null,all:new Map,set:function(e){return U(e)},edit:function(e){!function(e){if(console.groupCollapsed("Variant.edit"),e){let t=U(e);F(t)}console.groupEnd()}(e)},init:function(e){Y(e)}}}(),Unit=function(){"use strict";const e=document.getElementById("panel_tab_unit"),t=document.getElementById("button_remove_unit_from_product"),a=document.getElementById("category_id"),n=document.getElementById("product_id"),o=document.getElementById("product_edit_unit_form"),i=document.getElementById("product_edit_unit_form_submit_button"),l=document.getElementById("edit_product_unit"),r=document.getElementById("product_edit_unit_form_unit_name_filter"),d=document.getElementById("table_unit_product_edit"),s=document.getElementById("product_edit_unit_form_unit_id"),c=document.getElementById("product_edit_unit_form_unit_name"),u=document.getElementById("product_edit_unit_form_unit_room_code"),p=document.getElementById("product_edit_unit_form_unit_min_nights"),_=document.getElementById("product_edit_unit_form_unit_max_nights"),m=document.getElementById("product_edit_unit_form_unit_min_pax"),g=document.getElementById("product_edit_unit_form_unit_max_pax"),h=document.getElementById("product_edit_unit_form_unit_description_short"),f=document.getElementById("product_edit_unit_form_unit_description_long"),v=document.getElementById("product_edit_unit_form_unit_enabled"),y=document.getElementById("display_product_unit_name"),b=document.getElementById("product_edit_unit_form_clear_button"),I=document.getElementById("product_edit_unit_form_close_button"),E=document.getElementById("table_unit_product_edit_add_new_button"),w=document.getElementById("unit_keywords"),C=document.getElementById("unit_amenities"),k=document.getElementById("product_edit_unit_display"),S=document.getElementById("unit_images");let N,B,x,L=1,M="Unit",P="Nights",D="Pax",F=null,T=1,R=null,A=1,q=null,O=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,Y=$(d),U=!1,W={rules:{file_manager_unit_form_alt:{required:!1},product_edit_unit_form_unit_min_nights:{required:!0,number:!0,min:1},product_edit_unit_form_unit_max_nights:{required:!0,number:!0,min:1},product_edit_unit_form_unit_min_pax:{required:!0,number:!0,min:1},product_edit_unit_form_unit_max_pax:{required:!0,number:!0,min:1}},messages:{product_edit_unit_form_unit_min_nights:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"},product_edit_unit_form_unit_min_pax:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"},product_edit_unit_form_unit_max_pax:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"},product_edit_unit_form_unit_max_nights:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"}}};$(t).on("click",function(){Q()}),$(i).on("click",function(){Z()}),$(b).on("click",function(){console.log("Unit.product_edit_unit_form_clear_button:click()"),oe(),Y.clearSelectedRows(),r.value="",r.disabled=!1,c.disabled=!0}),$(I).on("click",function(){console.log("Unit.product_edit_unit_form_close_button:click()"),oe(),Y.clearSelectedRows(),r.value="",r.disabled=!1,c.disabled=!0}),$(E).on("click",function(){oe(),Y.clearSelectedRows(),ee(),re(),ie(),r.value="",c.value="",c.disabled=!1,r.disabled=!0}),$(e).on("hide.bs.tab",function(){oe(),Y.clearSelectedRows(),r.value="",r.disabled=!1,c.disabled=!0});const Q=function(){console.groupCollapsed("Unit.remove"),confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e={unit_id:parseInt(s.value),product_id:parseInt(n.value)};!function(e,t){if(console.groupCollapsed("Unit.removeProductUnit"),e){let a="/api/v1.0/units/remove";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e);z("Oops: 1")})}catch(e){}}console.groupEnd()}(e,function(t){let a=e.unit_id;if(t){let e=Unit.all.get(a);e&&Y.deleteRow(e),Unit.all.delete(a),Y.clearSelectedRows(),r.value="",r.disabled=!1,PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),V(),ae(),ne(),G(e),YearCalendar.endLoading(),toastr.warning(`Unit: ${e.name} - has been removed`,"Unit")}})}}),console.groupEnd()},V=function(){console.groupCollapsed("Unit.updateProgress"),0===Array.from(Unit.all.values()).length?$(e).html(`<span id="tab_span_unit">${M}</span> <span id="unitNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>`):$(e).html(`<span id="tab_span_unit">${M}</span>`),Product.updateProgress(),console.groupEnd()},j=function(e){if(console.groupCollapsed("Unit.nameExists"),e&&""!==e){H({name:e},function(t){let n=null;if(t&&t[0]&&(n=t,t[0]&&(n=t[0])),n){let e,t=Unit.all.get(parseInt(n.id));t?(e=K(t),Y.loadRow(e)):e=K(n),le(e)}else confirmDialog(`The unit: ${e} does not exist exists. Would you like to create it?`,t=>{if(t){let t=isNaN(parseInt(a.value))?null:parseInt(a.value),n=removeNulls({category_id:t,name:e||null});try{sendPostRequest("/api/v1.0/units/new",n,function(e,t,a){if(e){let t=e;e[0]&&(t=e[0]);let a=K(t);Y.clearSelectedRows(),U=!1,ae(),le(a),re()}})}catch(e){}}else oe(),Y.clearSelectedRows(),r.value="",r.disabled=!1,c.disabled=!0})})}console.groupEnd()},z=function(e,t,a){console.groupCollapsed("Unit.handleUnitError"),e||(e="Unit Error"),t||(t="Unit"),a||(a="error"),toastr[a](`${e}`,t),console.groupEnd()},H=function(e,t){console.groupCollapsed("Unit.fetchByName");if(e)try{sendGetRequest("/api/v1.0/units/validate",e,function(e,a,n){if(e)return t(e);z("Oops: 1")})}catch(e){z("Error Validating Unit")}else z("Error Loading Unit - Missing Data");console.groupEnd()},K=function(e){console.groupCollapsed("Unit.set");let t=(console.groupCollapsed("Unit.defaultDetail"),{api_id:null,blurb:null,category_id:1,cover_image:"/public/img/unit_cover_placeholder.jpg",created_by:O,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),description_long:null,description_short:null,enabled:1,end_time:null,id:null,max_nights:null,max_pax:null,meeting_point:null,min_nights:1,min_pax:1,modified_by:O,name:null,note:null,room_code:null,start_time:null,time_notes:null,keywords:[],amenities:[],images:[]});return e&&(t.api_id=e.api_id?e.api_id:null,t.blurb=e.blurb?e.blurb:null,t.category_id=e.category_id?e.category_id:null,t.cover_image=e.cover_image?e.cover_image:"/public/img/unit_cover_placeholder.jpg",t.created_by=e.created_by?e.created_by:O,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.description_long=e.description_long?e.description_long:null,t.description_short=e.description_short?e.description_short:null,t.enabled=e.enabled?e.enabled:1,t.end_time=e.end_time?e.end_time:null,t.id=e.id?e.id:null,t.max_nights=e.max_nights?e.max_nights:null,t.max_pax=e.max_pax?e.max_pax:null,t.meeting_point=e.meeting_point?e.meeting_point:null,t.min_nights=e.min_nights?e.min_nights:1,t.min_pax=e.min_pax?e.min_pax:1,t.modified_by=e.modified_by?e.modified_by:O,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.room_code=e.room_code?e.room_code:null,t.start_time=e.start_time?e.start_time:null,t.time_notes=e.time_notes?e.time_notes:null,t.amenities=e.amenities?e.amenities:null,t.keywords=e.keywords?e.keywords:null,t.images=e.images?e.images:[]),console.groupEnd(),t},G=function(e){if(console.groupCollapsed("Unit.clearProductOverview"),!e)return;let t=isNaN(parseInt(e.id))?null:parseInt(e.id);t&&$(`#product_edit_unit_display_${t}`).remove(),console.groupEnd()},J=function(e){if(console.groupCollapsed("Unit.buildProductOverview"),!e)return;e.ammenities&&getListOfIds(e.ammenities),isNaN(parseInt(e.category_id))||parseInt(e.category_id);let t=isNaN(parseInt(e.id))?null:parseInt(e.id),a=(e.keywords&&getListOfIds(e.keywords),isNaN(parseInt(e.max_nights))?null:parseInt(e.max_nights)),n=isNaN(parseInt(e.max_pax))?null:parseInt(e.max_pax),o=isNaN(parseInt(e.min_nights))?null:parseInt(e.min_nights),i=isNaN(parseInt(e.min_pax))?null:parseInt(e.min_pax),l=e.name?e.name:null,r=e.room_code?e.room_code:null,d=(e.start_time&&e.start_time,e.time_notes&&e.time_notes,L),s=colorScheme.get(d);L>=16&&(L=0),L++;let c=s&&s.backGround?s.backGround:"#fff",u=s&&s.textColor?s.textColor:"#0a070d",p=s&&s.borderColor?s.borderColor:"#0a070d";c=shadeColor(c,30),p=shadeColor(p,-30);let _=Unit.all.get(t);_&&G(_),$(k).append(`\n            <div id="product_edit_unit_display_${t}" class="col-12 col-sm-12 col-md-4 px-1">\n                <div class="card card-body mb-2" style="background-color:${c}; color:${u};border:solid 1px ${p};">\n                    <h5 class="card-title w-100 text-truncate" style="color:${u};border-color:${p}">${l}</h5>\n                    <h6 class="card-subtitle my-2 text-muted" style="color:${u}">${r}</h6>\n                    <table class="table table-sm" style="color:${u};border-color:${p}">\n                        <thead>\n                            <tr style="font-size:.85rem;font-weight:400;color:#0a070d;">\n                                <th style="font-size:.85rem;font-weight:400;color:#0a070d;">&nbsp;</th>\n                                <th style="font-size:.85rem;font-weight:400;color:#0a070d;">Min</th>\n                                <th style="font-size:.85rem;font-weight:400;color:#0a070d;">Max</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr style="border-top-color: ${p} !important;">\n                                <th style="border-top-color: ${p} !important;">Pax:</th>\n                                <td>${i}</td>\n                                <td>${n}</td>\n                            </tr>\n                            <tr>\n                                <th>Nights:</th>\n                                <td>${o}</td>\n                                <td>${a}</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        `),console.groupEnd()},Z=function(){console.groupCollapsed("Unit.save"),function(){console.groupCollapsed("Unit.validUnitRecord");let e=!0,t=isNaN(parseInt(m.value))?null:parseInt(m.value),a=isNaN(parseInt(g.value))?null:parseInt(g.value),n=isNaN(parseInt(p.value))?null:parseInt(p.value),i=isNaN(parseInt(_.value))?null:parseInt(_.value);return null!==t&&null!==a&&(parseInt(a)<parseInt(t)?(setError(g,"Pax is greater than minimum"),e=!1):(console.log("clearError"),clearError(g))),null!==n&&null!==i&&(parseInt(i)<parseInt(n)?(setError(_,"Nights is greater than minimum"),e=!1):(console.log("clearError"),clearError(_))),console.log("valid",fetchFormErrors($(o),W)),console.groupEnd(),e}()&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e=function(){console.groupCollapsed("Unit.buildUnitRecord");let e={id:isNaN(parseInt(s.value))?null:parseInt(s.value),product_id:isNaN(parseInt(n.value))?null:parseInt(n.value),category_id:isNaN(parseInt(a.value))?null:parseInt(a.value),min_pax:parseInt(m.value)?parseInt(m.value):null,max_pax:parseInt(g.value)?parseInt(g.value):null,min_nights:parseInt(p.value)?parseInt(p.value):null,max_nights:parseInt(_.value)?parseInt(_.value):null,api_id:null,name:c.value?c.value:null,room_code:u.value?u.value:null,blurb:null,cover_image:"",meeting_point:null,time_notes:null,start_time:null,end_time:null,description_short:h.value?h.value:null,description_long:f.value?f.value:null,enabled:!0===v.checked?1:0,keywords:N.build(),amenities:B.build()};return console.groupEnd(),remove_nulls(e)}();X(e,function(e){if(e){let t=K(e[0]?e[0]:e);Unit.all.get(t.id)?Y.updateRow(t):Y.insertRow(t),J(t),Unit.all.set(t.id,t),PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),oe(),V(),Y.clearSelectedRows(),r.value="",r.disabled=!1,c.disabled=!0,toastr.success(`Unit: ${t.name} - has been updated`,"Unit"),YearCalendar.endLoading()}})}}),console.groupEnd()},X=function(e,t){if(console.groupCollapsed("Unit.saveProductUnit"),e){let a="/api/v1.0/units/update";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){return z("Error")}}console.groupEnd()},ee=function(){console.groupCollapsed("Unit.disableFormFields"),s.disabled=!0,u.disabled=!0,p.disabled=!0,m.disabled=!0,c.disabled=!1,_.disabled=!1,g.disabled=!1,h.disabled=!1,f.disabled=!1,v.disabled=!1,console.groupEnd()},te=function(e){console.groupCollapsed("Unit.init");let n=[];e&&(console.log("settings",e),n=e.units?e.units:[]),o&&(console.groupCollapsed("Unit.initAutoComplete"),x=isNaN(parseInt(a.value))?null:parseInt(a.value),$(r).on("click",function(){$(this).select()}).on("search",function(){U=!1,ae(),ne()}).on("change",function(){setTimeout(function(){let e=r.value;!1===U&&(""===e?(U=!1,ae(),ne()):j(e))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/units",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:x},onSelect:function(e){if(Y.clearSelectedRows(),!e||!e.data)return;let a,n=e.data,o=Unit.all.get(parseInt(n.id));o?(a=K(o),Y.loadRow(a),le(a),r.disabled=!0,t.disabled=!1,$(t).removeClass("disabled"),c.disabled=!0):(a=K(n),le(a),r.disabled=!0,t.disabled=!0,$(t).addClass("disabled"),c.disabled=!0)}}),console.groupEnd(),validator_init(W),Unit.validator=$(o).validate(),function(){console.groupCollapsed("Unit.initForm");let e=document.getElementById("category_id")&&!isNaN(parseInt(document.getElementById("category_id").value))?parseInt(document.getElementById("category_id").value):null;if(e){switch(e){case 1:F=null,T=1,R=null,A=1,D="Pax",P="Nights",M="Units";break;case 2:F=1,T=1,R=1,A=1,D="Pax",P="Days",M="Seat";break;case 3:F=null,T=1,R=null,A=1,D="Pax",P="Days",M="Units";break;case 4:case 5:F=null,T=1,R=null,A=1,D="Pax",P="Nights",M="Units";break;default:F=null,T=1,R=null,A=1,D="Pax",P="Nights",M="Units"}N=$(w).BuildKeyword([]),B=$(C).BuildKeyword([])}console.groupEnd()}()),S&&(Unit.unitImages=$("#unit_images").fileManager({height:400,source:"unit",images:[]})),r&&(console.groupCollapsed("Unit.buildProductEditTable"),1===(x=isNaN(parseInt(a.value))?null:parseInt(a.value))?(Unit.byValue="Night",Unit.paxValue="Pax"):(Unit.byValue="Day",Unit.paxValue="Pax"),Y=$(d).table({table_type:"display_list",data:[],columnDefs:[{title:"Room Code",targets:0,data:"room_code",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Min "+Unit.byValue+"(s)",targets:2,data:"min_nights",render:function(e,t,a,n){let o=1;return"<span style='white-space: nowrap;'>"+(o=null===e?"null":e)+"</span>"}},{title:"Max "+Unit.byValue+"(s)",targets:3,data:"max_nights",render:function(e,t,a,n){let o=1;return"<span style='white-space: nowrap;'>"+(o=null===e?"&infin;":e)+"</span>"}},{title:"Min "+Unit.paxValue,targets:4,data:"min_pax",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Max "+Unit.paxValue,targets:5,data:"max_pax",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Unit.edit}),console.groupEnd(),function(e){console.groupCollapsed("Unit.loadAll"),Unit.all=new Map,e||(e=[]),$.each(e,function(e,t){console.log("unit",t);let a=K(t);Y.insertRow(a),J(a),Unit.all.set(a.id,a)}),V(),console.groupEnd()}(n)),l&&(oe(),V()),console.groupEnd()},ae=function(){console.groupCollapsed("Unit.clearForm"),s.value="",c.value="",u.value="",p.value=1,_.value="",m.value=1,g.value="",h.value="",f.value="",v.checked=!0,console.groupEnd()},ne=function(){console.groupCollapsed("Unit.hideForm"),l&&($(l).hide(),r.disabled=!1,V()),console.groupEnd()},oe=function(){console.groupCollapsed("Unit.resetForm");let e,t,n,o,i,l,r,d,s,c,h,f,v,y,b=isNaN(parseInt(a.value))?null:parseInt(a.value);switch(ae(),ne(),b){case 1:e="Minimum Pax:",t="Maximum Pax:",n="Minimum Nights:",o="Maximum Nights:",v="Room Code:",i=!1,l=!1,r=!1,d=!1,y=!1,s=1,c="",h=1,f="";break;case 2:e="Minimum Pax:",t="Maximum Pax:",n="Minimum Days:",o="Maximum Days:",v="Seat Code:",s=1,c=1,h=1,f=1;break;case 3:e="Minimum Pax:",t="Maximum Pax:",n="Minimum Days:",o="Maximum Days:",v="Unit Code:",s=1,c=1,h=1,f=1;break;case 4:e="Minimum Pax:",t="Maximum Pax:",n="Minimum Days:",o="Maximum Days:",v="Seat Code:",s=1,c=1,h=1,f=1;break;default:e="Minimum Pax:",t="Maximum Pax:",n="Minimum Nights:",o="Maximum Nights:",i=!1,l=!1,r=!1,d=!1,s=1,c="",h=1,f=""}let I=document.getElementsByTagName("LABEL");for(let e=0;e<I.length;e++)if(""!==I[e].htmlFor){let t=document.getElementById(I[e].htmlFor);t&&(t.label=I[e])}p.value=h,_.value=f,m.value=s,g.value=c,p.label.innerHTML=n,_.label.innerHTML=o,m.label.innerHTML=e,g.label.innerHTML=t,u.label.innerHTML=v,p.disabled=r,_.disabled=d,m.disabled=i,g.disabled=l,B.clear(),N.clear(),console.groupEnd()},ie=function(){console.groupCollapsed("Unit.loadForm"),l&&($('label[for="product_edit_unit_form_unit_min_nights"]').html(`Minimum ${P}`),$('label[for="product_edit_unit_form_unit_max_nights"]').html(`Maximum ${P}`),$('label[for="product_edit_unit_form_unit_min_pax"]').html(`Minimum ${D}`),$('label[for="product_edit_unit_form_unit_max_pax"]').html(`Maximum ${D}`),$(l).show(),r.disabled=!0),console.groupEnd()},le=function(e){if(console.groupCollapsed("Unit.populateForm"),oe(),e){let t=isNaN(parseInt(a.value))?null:parseInt(a.value),n=e.keywords?e.keywords:[],o=e.amenities?e.amenities:[];2===t||4===t?(p.value=e.min_nights?e.min_nights:1,_.value=e.max_nights?e.max_nights:1,m.value=e.min_pax?e.min_pax:1,g.value=e.max_pax?e.max_pax:1,p.disabled=!0,_.disabled=!0,m.disabled=!0,g.disabled=!0,u.disabled=!0):(p.value=e.min_nights?e.min_nights:1,_.value=e.max_nights?e.max_nights:null,m.value=e.min_pax?e.min_pax:1,g.value=e.max_pax?e.max_pax:null,p.disabled=!1,_.disabled=!1,m.disabled=!1,g.disabled=!1,u.disabled=!1),r.value=e.name?e.name:"",s.value=e.id?e.id:"",c.value=e.name?e.name:"",u.value=e.room_code?e.room_code:"",h.value=e.description_short?e.description_short:"",f.value=e.description_long?e.description_long:"",v.checked=!0,y.innerText=e.name?e.name:"",N.set(n),B.set(o)}ie(),console.groupEnd()},re=function(){console.groupCollapsed("Unit.enableFormFields"),ee(),s.disabled=!0,c.disabled=!0,u.disabled=!0,v.disabled=!0,h.disabled=!1,f.disabled=!1,console.groupEnd()};return{unitImages:null,all:new Map,byValue:"Night",paxValue:"Pax",validator:null,edit:function(e){!function(e){console.groupCollapsed("Unit.edit");let t=q&&q.id&&!isNaN(parseInt(q.id))?parseInt(q.id):null,a=e&&e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null;t&&a&&t===a||(q=e,le(e),Unit.unitImages.load({height:400,source:"unit",sourceId:e.id,images:e.images}),re(),console.groupEnd())}(e)},init:function(e){te(e)}}}(),Address=function(){"use strict";const e=document.getElementById("button_add_address_table"),t=document.getElementById("button_close_edit_address_form"),a=document.getElementById("button_clear_form_edit_address"),n=document.getElementById("button_submit_form_edit_address"),o=document.getElementById("form_edit_address"),i=document.getElementById("card_edit_address_form"),l=document.getElementById("table_address"),r=document.getElementById("address_id"),d=document.getElementById("company_id"),s=document.getElementById("address_enabled"),c=document.getElementById("address_street_1"),u=document.getElementById("address_street_2"),p=document.getElementById("address_street_3"),_=document.getElementById("address_country_id"),m=document.getElementById("address_types_id"),g=document.getElementById("address_province_id"),h=document.getElementById("address_city_id"),f=document.getElementById("address_postal_code"),v=document.getElementById("address_company_id"),y=document.getElementById("clear_address_table");let b,I=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,E=$(l),w={},C={groups:{cityGroup:"address_country_id address_province_id address_city_id"},rules:{address_types_id:{required:!0},address_company_id:{required:!0},address_country_id:{required:!0},address_province_id:{required:!0},address_city_id:{required:!0}},messages:{address_company_id:{required:"Field Required"},address_types_id:{required:"Field Required"},address_country_id:{required:"Field Required"},address_province_id:{required:"Field Required"},address_city_id:{required:"Field Required"}}};$(e).on("click",function(){E.clearSelectedRows(),L(),P()}),$(a).on("click",function(){E.clearSelectedRows(),L()}),$(n).on("click",function(){let e=S();e&&confirmDialog("Would you like to update?",t=>{t&&k(e)})}),$(t).on("click",function(){E.clearSelectedRows(),L(),M()}),$(y).on("click",function(){Address.clearTable()});const k=function(e){e&&N(e,function(e){if(e&&e[0]){let t=e[0],a=T(t);Address.all.get(a.id)?E.updateRow(a):E.insertRow(a),Address.all.set(a.id,a),E.clearSelectedRows(),L(),M(),toastr.success("Address Updated")}})},S=function(){if(B()){let e={company_id:isNaN(parseInt(v.value))?null:parseInt(v.value),street_1:""!==c.value?c.value:null,street_2:""!==u.value?u.value:null,street_3:""!==p.value?p.value:null,postal_code:""!==f.value?f.value:null,country_id:isNaN(_.value)?null:parseInt(_.value),province_id:isNaN(g.value)?null:parseInt(g.value),city_id:isNaN(h.value)?null:parseInt(h.value),address_types_id:toNumbers(getListOfIds($(m).val())),enabled:!0===s.checked?1:0,id:isNaN(parseInt(r.value))?null:parseInt(r.value)};return remove_nulls(e)}},N=function(e,t){e&&sendPostRequest("/api/v1.0/addresses/update",e,function(e,a,n){return e?t(e):x("Oops: 1")})},B=function(){return $(o).valid()},x=function(e){toastr.error(e)},L=function(){r.value="",s.checked=!0,c.value="",u.value="",p.value="",f.value="",$(m).val([]),$(_).val("").trigger("change")},M=function(){i&&$(i).hide()},P=function(e){i&&(r.value="",v.value=d.value,$(m).val([]),s.checked=!0,c.value="",u.value="",p.value="",_.value="",g.value="",h.value="",f.value="",function(e){e&&(r.value=e.id?e.id:null,v.value=e.company_id?e.company_id:null,$(m).val(e.address_types_id?e.address_types_id:[]),s.checked=1===e.enabled,c.value=e.street_1?e.street_1:null,u.value=e.street_2?e.street_2:null,p.value=e.street_3?e.street_3:null,f.value=e.postal_code?e.postal_code:null,Province.id=e.province.id,Country.id=e.country.id,City.id=e.city.id,$(_).val(e.country.id?e.country.id:"").trigger("change"))}(e),$(i).show())},D=function(e){if(Address.all=new Map,!e)return;let t,a=0;$.each(e,function(e,n){let o=T(n);0===a&&(t=o),Address.all.set(o.id,o),E.insertRow(o),a++}),l&&(t&&E.loadRow(t),E.clearSelectedRows()),i&&(L(),M())},F=function(e){l&&($.fn.DataTable.isDataTable(l)||(E=$(l).table({table_type:"display_list",data:Array.from(Address.all.values()),columnDefs:[{title:"ID",targets:0,data:"id",render:function(e,t,a,n){return e}},{title:"Address",targets:1,data:"medium_address_formatted",render:function(e,t,a,n){return e}},{title:"Types",targets:2,data:"formatted_types",render:function(e,t,a,n){return e}}],rowClick:Address.navigate}))),e&&D(e),o&&(validator_init(C),b=$(o).validate(),$(_).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(g).BuildDropDown({data:[],title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(h).BuildDropDown({data:[],title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["address_country_id"]}),Province.init({dropdowns:["address_province_id"]}),City.init({dropdowns:["address_city_id"]}))},T=function(e){let t={id:null,company_id:null,street_1:null,street_2:null,street_3:null,postal_code:null,enabled:1,address_types_id:[],date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null,short_address_formatted:null,medium_address_formatted:null,long_address_formatted:null,country:{id:null,name:null,iso2:null,iso3:null,currency_id:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},province:{id:null,country_id:null,name:null,iso2:null,iso3:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},city:{id:null,province_id:null,name:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},formatted_types:""};return e&&(t.country={id:parseInt(e.country.id?e.country.id:null),name:e.country.name?e.country.name:null,name_long:e.country.name_long?e.country.name_long:null,currency_id:parseInt(e.country.currency_id?e.country.currency_id:null),iso2:e.country.iso2?e.country.iso2:null,iso3:e.country.iso3?e.country.iso3:null,sort_order:parseInt(e.country.sort_order?e.country.sort_order:999),enabled:parseInt(e.country.enabled?e.country.enabled:1),date_created:e.country.date_created?e.country.date_created:formatDateMySQL(),created_by:parseInt(e.country.created_by?e.country.created_by:I),date_modified:e.country.date_modified?e.country.date_modified:formatDateMySQL(),modified_by:parseInt(e.country.modified_by?e.country.modified_by:I),note:e.country.note?e.country.note:null},t.province={id:parseInt(e.province.id?e.province.id:null),country_id:parseInt(e.country.id?e.country.id:null),name:e.province.name?e.province.name:null,iso2:e.province.iso2?e.province.iso2:null,iso3:e.province.iso3?e.province.iso3:null,sort_order:parseInt(e.province.sort_order?e.province.sort_order:999),enabled:parseInt(e.province.enabled?e.province.enabled:1),date_created:e.province.date_created?e.province.date_created:formatDateMySQL(),created_by:parseInt(e.province.created_by?e.province.created_by:I),date_modified:e.province.date_modified?e.province.date_modified:formatDateMySQL(),modified_by:parseInt(e.province.modified_by?e.province.modified_by:I),note:e.province.note?e.province.note:null},t.city={id:parseInt(e.city.id?e.city.id:null),province_id:parseInt(e.province.id?e.province.id:null),name:e.city.name?e.city.name:null,sort_order:parseInt(e.city.sort_order?e.city.sort_order:999),enabled:parseInt(e.city.enabled?e.city.enabled:1),date_created:e.city.date_created?e.city.date_created:formatDateMySQL(),created_by:parseInt(e.city.created_by?e.city.created_by:I),date_modified:e.city.date_modified?e.city.date_modified:formatDateMySQL(),modified_by:parseInt(e.city.modified_by?e.city.modified_by:I),note:e.city.note?e.city.note:null},t.id=parseInt(e.id?e.id:null),t.company_id=parseInt(e.company_id?e.company_id:null),t.address_types_id=getListOfIds(e.address_types_id),t.short_address_formatted=e.short_address_formatted?e.short_address_formatted:null,t.medium_address_formatted=e.medium_address_formatted?e.medium_address_formatted:null,t.long_address_formatted=e.long_address_formatted?e.long_address_formatted:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.street_3=e.street_3?e.street_3:null,t.postal_code=e.postal_code?e.postal_code:null,t.enabled=parseInt(e.enabled?e.enabled:1),t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=parseInt(e.created_by?e.created_by:I),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=parseInt(e.modified_by?e.modified_by:I),t.note=e.note?e.note:null,t.formatted_types=e.formatted_types?e.formatted_types:""),w=t,Address.detail=t,t},R=function(){let e=Array.from(Address.all.values());$.each(e,function(e,t){E.deleteRow(t)}),Address.all=new Map},A=function(e){e&&function(e,t){if(!e)return x("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/addresses",e,function(e,a,n){return e?t(e):x("Oops: 1")})}catch(e){return x("Error Validating Company")}}({company_id:e},function(e){if(e){let t=e;R(),function(e){if(l){let t;Address.all=new Map;let a=0;$.each(e,function(e,n){0===a&&(t=n),n.address_types_id=getListOfIds(n.address_types_id),Address.all.set(n.id,n),E.insertRow(n),a++}),l&&(t&&E.loadRow(t),E.clearSelectedRows())}}(t)}})};return{validator:null,detail:{},all:new Map,get_by_company_id:function(e){A(e)},get:function(e){},navigate:function(e){!function(e){e&&P(e)}(e)},load_all:function(e){D(e)},save:function(e){k(e)},clearTable:function(){R()},init:function(e){F(e)},buildAddressDisplay:function(e){return function(e){console.log("Address.buildAddressDisplay(address)",e);return""}(e)}}}(),Register=function(){"use strict";return{init:function(e){}}}();$.fn.DisabledDOW=function(e){"use strict";let t=this.attr("id"),a="Disabled DOW",n=t+"_";e&&(e.name&&""!==e.name&&(n=e.name),e&&e.label&&""!==e.label&&(a=e.label));const o=document.getElementById(t),i=$(o);i.on("change",function(){});const l=function(){let e=Array.from(s.days_of_week.values()),t=document.createElement("div");return t.classList.add("col-12"),t.classList.add("col-md-10"),t.classList.add("px-1"),$.each(e,function(e,a){let n=function(){let e=document.createElement("div");return e.classList.add("custom-control"),e.classList.add("custom-checkbox"),e.classList.add("custom-control-inline"),e}(),o=function(e){let t=document.createElement("label");return t.classList.add("custom-control-label"),t.htmlFor=e.for,t.innerText=e.label,t}(a),i=function(e){let t=document.createElement("input");return t.type="checkbox",t.classList=e.class,t.id=e.for,t.name=e.for,t.value=e.value,t.addEventListener("click",e=>{let a=t.id?t.id:"";d(t,a)}),t}(a);n.appendChild(i),n.appendChild(o),t.appendChild(n)}),t},r=function(){$.each(Array.from(s.days_of_week.values()),function(e,t){document.getElementById(t.for).checked=!1}),$.each(s.disabled_dows,function(e,t){let a="number"==typeof t?t.toString():t,n=s.days_of_week.get(a);n&&n.for&&(document.getElementById(n.for).checked=!0)}),7===s.disabled_dows.length&&(document.getElementById(n+"dow_select_all").checked=!0)},d=function(e,t){let a,o;switch(t){case n+"dow_select_all":!0===e.checked?s.disabled_dows=[0,1,2,3,4,5,6]:s.disabled_dows=[],s.disabled_dows.sort();break;case n+"dow_select_sun":a=0,o=s.disabled_dows.indexOf(a),!0===e.checked?!o>-1&&s.disabled_dows.push(a):o>-1&&s.disabled_dows.splice(o,1),s.disabled_dows.sort();break;case n+"dow_select_mon":a=1,o=s.disabled_dows.indexOf(a),!0===e.checked?!o>-1&&s.disabled_dows.push(a):o>-1&&s.disabled_dows.splice(o,1),s.disabled_dows.sort();break;case n+"dow_select_tue":a=2,o=s.disabled_dows.indexOf(a),!0===e.checked?!o>-1&&s.disabled_dows.push(a):o>-1&&s.disabled_dows.splice(o,1),s.disabled_dows.sort();break;case n+"dow_select_wed":a=3,o=s.disabled_dows.indexOf(a),!0===e.checked?!o>-1&&s.disabled_dows.push(a):o>-1&&s.disabled_dows.splice(o,1),s.disabled_dows.sort();break;case n+"dow_select_thu":a=4,o=s.disabled_dows.indexOf(a),!0===e.checked?!o>-1&&s.disabled_dows.push(a):o>-1&&s.disabled_dows.splice(o,1),s.disabled_dows.sort();break;case n+"dow_select_fri":a=5,o=s.disabled_dows.indexOf(a),!0===e.checked?!o>-1&&s.disabled_dows.push(a):o>-1&&s.disabled_dows.splice(o,1),s.disabled_dows.sort();break;case n+"dow_select_sat":a=6,o=s.disabled_dows.indexOf(a),!0===e.checked?!o>-1&&s.disabled_dows.push(a):o>-1&&s.disabled_dows.splice(o,1),s.disabled_dows.sort()}r()},s={days_of_week:[],disabled_dows:[],el:null,value:function(e){},els:[],init:function(e){!function(e){let t=[];if(e){if(e===[]||null===e||""===e)return s.disabled_dows=[],[];t="string"==typeof e?getListOfIds(e.replace(/\s/g,"")):e}s.disabled_dows=t,r()}(e)}};return function(){i.empty(),s.days_of_week=new Map,s.days_of_week.set("*",{label:"All",for:n+"dow_select_all",value:"*",class:"custom-control-input dow_select"}),s.days_of_week.set("0",{label:"Sun",for:n+"dow_select_sun",value:0,class:"custom-control-input dow_select"}),s.days_of_week.set("1",{label:"Mon",for:n+"dow_select_mon",value:1,class:"custom-control-input dow_select"}),s.days_of_week.set("2",{label:"Tue",for:n+"dow_select_tue",value:2,class:"custom-control-input dow_select"}),s.days_of_week.set("3",{label:"Wed",for:n+"dow_select_wed",value:3,class:"custom-control-input dow_select"}),s.days_of_week.set("4",{label:"Thu",for:n+"dow_select_thu",value:4,class:"custom-control-input dow_select"}),s.days_of_week.set("5",{label:"Fri",for:n+"dow_select_fri",value:5,class:"custom-control-input dow_select"}),s.days_of_week.set("6",{label:"Sat",for:n+"dow_select_sat",value:6,class:"custom-control-input dow_select"});let e=function(){let e=document.createElement("div");return e.classList="row",e}(),t=function(){let e=document.createElement("div"),t=document.createElement("label");return t.innerText=a+":",e.classList.add("col-12"),e.classList.add("col-md-2"),e.classList.add("px-1"),e.appendChild(t),e}(),r=l();e.appendChild(t),e.appendChild(r),o.appendChild(e)}(),s};const ColorScheme=function(){"use strict";document.getElementById("product_edit_season_id");const e=document.getElementById("season_id"),t=document.getElementById("edit_scheme"),a=(document.getElementById("form_edit_scheme"),document.getElementById("product_edit_season_id_name_display")),n=document.getElementById("button_close_edit_scheme");let o;$(n).on("click",function(){$(t).hide()}),$(e).on("click",function(){$(t).show()});const i=function(e){var t;e&&e.swatches&&(t=e.swatches,ColorScheme.all=new Map,t&&$.each(t,function(e,t){ColorScheme.all.set(parseInt(t.id),t)})),(o=document.querySelectorAll(".season_toggle_item")).forEach(e=>e.addEventListener("click",t=>{let a=parseInt(e.dataset.colorschemeid),n=ColorScheme.all.get(a);n&&l(n)}))},l=function(e){if(e){let t=e.background_color?e.background_color:null,n=e.border_color?e.border_color:null,o=parseInt(e.id),i=e.text_color?e.text_color:null,l=e.name?e.name:null,r=document.querySelector("#product_edit_season_id");$(a).text(`\n                    ${l}\n                `),$("a.dropdown-item.season_toggle_item").removeClass("active"),$(`a#${o}`).addClass("active"),r.style.setProperty("color",i,"important"),r.style.setProperty("background-color",t,"important"),r.style.setProperty("border-color",n,"important")}},r=function(){let e=document.querySelector("#product_edit_season_id");$(e).addClass("disabled")};return{all:new Map,disable:function(){r()},enable:function(){!function(){let e=document.querySelector("#product_edit_season_id");$(e).removeClass("disabled")}()},load:function(e){l(e)},edit:function(e){!function(e){$(".color_scheme_block").removeClass("active"),$(e).addClass("active")}(e)},change:function(e){},init:function(e){i(e),r()}}}();$.fn.ColorScheme=function(e){};const Car=function(){"use strict";const e=document.getElementById("category_id");let t,a;return{id:null,detail:{id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:null,date_created:null,date_modified:null,note:null},all:new Map,init:function(n){!function(n){console.log("Car.init(settings)",n),t=isNaN(parseInt(e.value))?null:parseInt(e.value),a=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4}(n)}}}(),Airport=function(){"use strict";const t=document.getElementById("category_id"),a=document.getElementById("product_edit_location_section"),n=document.getElementById("modal_product_depart_from_airport_local_code"),o=document.getElementById("modal_product_depart_from_airport_home_link"),i=document.getElementById("modal_product_depart_from_airport_cancel_button"),l=document.getElementById("modal_product_depart_from_airport_submit_button"),r=document.getElementById("modal_product_depart_from_airport_iata_code"),d=document.getElementById("modal_product_depart_from_airport_country_id"),s=document.getElementById("modal_product_depart_from_airport_province_id"),c=document.getElementById("modal_product_depart_from_airport_city_id"),u=document.getElementById("modal_product_depart_from_airport_city"),p=document.getElementById("modal_product_depart_from_airport"),_=document.getElementById("modal_product_depart_from_airport_id"),m=document.getElementById("modal_product_depart_from_airport_add_block"),g=document.getElementById("modal_product_depart_from_airport_types_id"),h=document.getElementById("modal_product_depart_from_new_airport_id"),f=document.getElementById("modal_product_arrive_to_airport_cancel_button"),v=document.getElementById("modal_product_arrive_to_new_airport_id"),y=document.getElementById("modal_product_arrive_to_airport_submit_button"),b=document.getElementById("modal_product_arrive_to_airport_iata_code"),I=document.getElementById("modal_product_arrive_to_airport_country_id"),E=document.getElementById("modal_product_arrive_to_airport_province_id"),w=document.getElementById("modal_product_arrive_to_airport_city_id"),C=document.getElementById("modal_product_arrive_to_airport_city"),k=document.getElementById("modal_product_arrive_to_airport"),S=document.getElementById("modal_product_arrive_to_airport_id"),N=document.getElementById("modal_product_arrive_to_airport_add_block"),B=document.getElementById("modal_product_arrive_to_airport_types_id"),x=document.getElementById("modal_product_province_id"),L=document.getElementById("modal_product_country_id"),M=document.getElementById("modal_product_city_id"),P=document.getElementById("product_edit_location_city_id"),D=document.getElementById("product_location_departing_airport_form"),F=document.getElementById("product_location_departing_airport_search"),T=document.getElementById("product_location_departing_airport_id"),R=document.getElementById("product_location_departing_airport_airport_types_id"),A=document.getElementById("product_location_departing_airport_city_id"),q=document.getElementById("product_location_departing_airport_name"),O=document.getElementById("product_location_departing_airport_iata_code"),Y=document.getElementById("product_location_departing_airport_edit_button"),U=document.getElementById("product_location_departing_airport_home_link"),W=document.getElementById("product_location_departing_airport_wikipedia_link"),Q=document.getElementById("product_location_departing_airport_enabled"),V=document.getElementById("product_location_departing_airport_city_search"),j=document.getElementById("product_location_departing_airport_remove_button"),z=document.getElementById("product_location_departing_airport_clear_button"),H=document.getElementById("product_location_departing_airport_save_button"),K=document.getElementById("modal_product_depart_from_airport_add_block_close_button"),G=document.getElementById("product_location_arriving_airport_edit_button"),J=document.getElementById("product_location_arriving_airport_form"),Z=document.getElementById("product_location_arriving_airport_search"),X=document.getElementById("product_location_arriving_airport_id"),ee=document.getElementById("product_location_arriving_airport_airport_types_id"),te=document.getElementById("product_location_arriving_airport_city_id"),ae=document.getElementById("product_location_arriving_airport_name"),ne=document.getElementById("product_location_arriving_airport_iata_code"),oe=document.getElementById("product_location_arriving_airport_home_link"),ie=document.getElementById("product_location_arriving_airport_wikipedia_link"),le=document.getElementById("product_location_arriving_airport_enabled"),re=document.getElementById("modal_product_arrive_to_airport_local_code"),de=document.getElementById("product_location_arriving_airport_city_search"),se=document.getElementById("product_location_arriving_airport_remove_button"),ce=document.getElementById("product_location_arriving_airport_clear_button"),ue=document.getElementById("product_location_arriving_airport_save_button"),pe=document.getElementById("modal_product_arrive_to_airport_add_block_close_button"),_e=document.getElementById("modal_product_arrive_to_airport_postal_code"),me=document.getElementById("modal_product_arrive_to_airport_street_1"),ge=document.getElementById("modal_product_arrive_to_airport_street_2"),he=document.getElementById("modal_product_depart_from_airport_postal_code"),fe=document.getElementById("modal_product_depart_from_airport_street_1"),ve=document.getElementById("modal_product_depart_from_airport_street_2"),ye=document.getElementById("modal_product_depart_from_airport_edit_link"),be=document.getElementById("modal_product_arrive_to_airport_edit_link"),Ie=document.getElementById("modal_product_depart_from_airport_gps_code"),Ee=document.getElementById("modal_product_depart_from_airport_wikipedia_link"),$e=document.getElementById("modal_product_arrive_to_airport_gps_code"),we=document.getElementById("modal_product_arrive_to_airport_home_link"),Ce=document.getElementById("modal_product_arrive_to_airport_wikipedia_link"),ke=document.getElementById("modal_product_day_span_airport"),Se=document.getElementById("modal_product_day_span");let Ne=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,Be={groups:{locationGroup:"product_location_departing_airport_city_search product_location_departing_airport_city_id"},rules:{product_location_departing_airport_name:{required:!0},product_location_departing_airport_iata_code:{required:!0},product_location_departing_airport_airport_types_id:{required:!0},product_location_departing_airport_city_search:{required:!0},product_location_departing_airport_city_id:{required:!0},product_location_departing_airport_home_link:{url:!0},product_location_departing_airport_wikipedia_link:{url:!0}},messages:{product_location_departing_airport_name:{required:"Field Required"},product_location_departing_airport_iata_code:{required:"Field Required"},product_location_departing_airport_airport_types_id:{required:"Field Required"},product_location_departing_airport_city_search:{required:"Field Required"},product_location_departing_airport_city_id:{required:"Field Required"},product_location_departing_airport_home_link:{url:"Field Invalid"},product_location_departing_airport_wikipedia_link:{url:"Field Invalid"}}},xe={groups:{locationGroup:"product_location_arriving_airport_city_search product_location_arriving_airport_city_id"},rules:{product_location_arriving_airport_name:{required:!0},product_location_arriving_airport_iata_code:{required:!0},product_location_arriving_airport_airport_types_id:{required:!0},product_location_arriving_airport_city_search:{required:!0},product_location_arriving_airport_city_id:{required:!0},product_location_arriving_airport_home_link:{url:!0},product_location_arriving_airport_wikipedia_link:{url:!0}},messages:{product_location_arriving_airport_name:{required:"Field Required"},product_location_arriving_airport_iata_code:{required:"Field Required"},product_location_arriving_airport_airport_types_id:{required:"Field Required"},product_location_arriving_airport_city_search:{required:"Field Required"},product_location_arriving_airport_city_id:{required:"Field Required"},product_location_arriving_airport_home_link:{url:"Field Invalid"},product_location_arriving_airport_wikipedia_link:{url:"Field Invalid"}}},Le=!1,Me=!1;$(ke).on("change",function(){let e=$(this).val();""===e||isNaN(parseInt(e))?e=1:e<1&&(e=1),ke.value=e,Se.value=e}),$(Y).on("click",function(){F.disabled=!0,Ye("depart_from"),Oe("arrive_to")}),$(G).on("click",function(){Z.disabled=!0,Ye("arrive_to"),Oe("depart_from")}),$(j).on("click",function(){let e=Airport.departingAirport;We(e,"depart_from"),Oe("depart_from"),clearValidation(D)}),$(se).on("click",function(){let e=Airport.arrivingAirport;We(e,"arrive_to"),Oe("arrive_to"),clearValidation(J)}),$(z).on("click",function(){Ue("depart_from")}),$(ce).on("click",function(){Ue("arrive_to")}),$(H).on("click",function(){ze("depart_from")}),$(ue).on("click",function(){ze("arrive_to")}),$(m).on("change",function(){Fe()}).on("keyup",function(){Fe()}),$(K).on("click",function(){Oe("depart_from"),p.disabled=!1,ye.innerText="Edit"}),$(pe).on("click",function(){Oe("arrive_to"),k.disabled=!1,be.innerText="Edit"}),$(i).on("click",function(){De("depart_from")}),$(f).on("click",function(){De("arrive_to")}),$(l).on("click",function(){He("depart_from")}),$(y).on("click",function(){He("arrive_to")}),$(ye).on("click",function(){let e=ye.innerText;"Edit"===e?(ye.innerText="Cancel",p.disabled=!0,k.disabled=!1,be.innerText="Edit",Ye("depart_from"),Oe("arrive_to")):"Cancel"===e&&(ye.innerText="Edit",p.disabled=!1,k.disabled=!1,Oe("depart_from"),Oe("arrive_to"))}),$(be).on("click",function(){let e=be.innerText;"Edit"===e?(be.innerText="Cancel",ye.innerText="Edit",k.disabled=!0,p.disabled=!1,Ye("arrive_to"),Oe("depart_from")):"Cancel"===e&&(be.innerText="Edit",ye.innerText="Edit",k.disabled=!1,p.disabled=!1,Oe("arrive_to"),Oe("depart_from"))});const Pe=function(e){console.groupCollapsed("Airport.toggleEditFormLink");if(e){if("depart_from"===e&&ye){ye.dataset.toggle&&ye.dataset.toggle;h&&p&&c&&""!==h.value&&""!==p.value&&""!==c.value?(ye.dataset.toggle="shown",$(ye).show()):(ye.dataset.toggle="hidden",$(ye).hide())}if("arrive_to"===e&&be){be.dataset.toggle&&be.dataset.toggle;v&&k&&w&&""!==v.value&&""!==k.value&&""!==w.value?(be.dataset.toggle="shown",be.innerText="Edit",$(be).show()):(be.dataset.toggle="hidden",$(be).hide())}}console.groupEnd()},De=function(e){console.groupCollapsed("Airport.cancelAddAirportRecord"),m&&N&&e&&("depart_from"===e?(""===h.value&&(p.value="",Ae(e)),ye.innerText="Edit"):"arrive_to"===e&&(""===v.value&&(k.value="",Ae(e)),be.innerText="Edit"),p.disabled=!1,k.disabled=!1,Oe(e),Pe(e)),console.groupEnd()},Fe=function(){console.groupCollapsed("Airport.validDepartFromRecord");let e=!0;return""===r.value?($(r).showError("Field Required"),e=!1):$(r).hideError(),""===g.value?($(g).showError("Field Required"),e=!1):$(g).hideError(),isNaN(parseInt(c.value))?($(u).showError("Field Required"),e=!1):$(u).hideError(),console.groupEnd(),e},Te=function(e){if(console.groupCollapsed("Airport.buildAddAirportRecord"),m&&N&&e)if("depart_from"===e){if(Fe()){let e=fe&&""!==fe.value?fe.value:null,t=ve&&""!==ve.value?ve.value:null,a=he&&""!==he.value?he.value:null,i=Airport.departFromKeywords.build(),l=Ie&&""!==Ie.value?Ie.value:null,d=o&&""!==o.value?o.value:null,s=Ee&&""!==Ee.value?Ee.value:null,u=n&&""!==n.value?n.value:null,_={airport_types_id:isNaN(parseInt(g.value))?null:parseInt(g.value),city_id:isNaN(parseInt(c.value))?null:parseInt(c.value),name:""!==p.value?p.value:null,street_1:e,street_2:t,postal_code:a,local_code:u,wikipedia_link:s,gps_code:l,keywords:i,home_link:d,iata_code:""!==r.value?r.value:null};return removeNulls(_)}}else if("arrive_to"===e&&function(){console.groupCollapsed("Airport.validArriveToRecord");let e=!0;return""===b.value?($(b).showError("Field Required"),e=!1):$(b).hideError(),""===B.value?($(B).showError("Field Required"),e=!1):$(B).hideError(),isNaN(parseInt(w.value))?($(C).showError("Field Required"),e=!1):$(C).hideError(),console.groupEnd(),e}()){let e=me&&""!==me.value?me.value:null,t=ge&&""!==ge.value?ge.value:null,a=_e&&""!==_e.value?_e.value:null,n=Airport.arriveToKeywords.build(),o=$e&&""!==$e.value?$e.value:null,i=we&&""!==we.value?we.value:null,l=Ce&&""!==Ce.value?Ce.value:null,r=re&&""!==re.value?re.value:null,d={airport_types_id:isNaN(parseInt(B.value))?null:parseInt(B.value),city_id:isNaN(parseInt(w.value))?null:parseInt(w.value),name:""!==k.value?k.value:null,street_1:e,street_2:t,postal_code:a,local_code:r,wikipedia_link:l,gps_code:o,keywords:n,home_link:i,iata_code:""!==b.value?b.value:null};return removeNulls(d)}console.groupEnd()},Re=function(e,t){if(console.groupCollapsed("Airport.populateAirportForm"),!t||!m||!N)return;Ae(t);let a=e&&e.name?e.name:null,n=e&&!isNaN(parseInt(e.id))?parseInt(e.id):null,i=e&&!isNaN(parseInt(e.airport_types_id))?parseInt(e.airport_types_id):"",l=e&&e.country&&!isNaN(parseInt(e.country.id))?parseInt(e.country.id):null,_=e&&e.province&&!isNaN(parseInt(e.province.id))?parseInt(e.province.id):null,f=e&&e.city&&!isNaN(parseInt(e.city.id))?parseInt(e.city.id):null,y=e&&e.city&&e.city.name?e.city.name:null,$=e&&e.province?e.province.name:null,S=e&&e.country?e.country.name:null,P=e&&e.iata_code?e.iata_code:null,D=e&&e.gps_code?e.gps_code:null,F=e&&e.home_link?e.home_link:null,T=e&&e.wikipedia_link?e.wikipedia_link:null,R=e&&e.street_1?e.street_1:null,A=e&&e.street_2?e.street_2:null,q=e&&e.postal_code?e.postal_code:null,O=e&&e.keywords?e.keywords:[],Y="";null!==y&&null!==$&&null!==S&&(Y=`${y} (${$}, ${S})`),"depart_from"===t?(h.value=n,p.value=a,g.value=i,Ie.value=D,o.value=F,Ee.value=T,r.value=P,u.value=Y,d.value=l,s.value=_,c.value=f,he.value=q,fe.value=R,ve.value=A,L.value=l,x.value=_,M.value=f,Airport.departFromKeywords.set(O)):"arrive_to"===t&&(v.value=n,k.value=a,B.value=i,$e.value=D,we.value=F,Ce.value=T,b.value=P,C.value=Y,I.value=l,E.value=_,w.value=f,_e.value=q,me.value=R,ge.value=A,Airport.arriveToKeywords.set(O)),console.groupEnd()},Ae=function(e){console.groupCollapsed("Airport.clearAirportForm"),m&&N&&e&&("depart_from"===e?(r.value="",u.value="",c.value="",d.value="",s.value="",c.value="",g.value="",he.value="",fe.value="",ve.value="",ye.dataset.airportId="",Airport.departFromKeywords&&Airport.departFromKeywords.clear(),p.disabled=!1):"arrive_to"===e&&(b.value="",C.value="",w.value="",I.value="",E.value="",w.value="",B.value="",_e.value="",me.value="",ge.value="",be.dataset.airportId="",Airport.arriveToKeywords&&Airport.arriveToKeywords.clear(),k.disabled=!1),clearAllValidation(),Pe(e)),console.groupEnd()},qe=function(e){console.groupCollapsed("Airport.resetAirportForm"),m&&N&&(e&&(k.disabled=!1,p.disabled=!1,Ae(e),Oe("depart_from"),Oe("arrive_to")),Pe(e)),console.groupEnd()},Oe=function(e){console.groupCollapsed("Airport.hideAirportForm"),m&&N&&e&&("depart_from"===e?$(m).hide():"arrive_to"===e&&$(N).hide()),a&&e&&("depart_from"===e&&D&&($(D).hide(),F.disabled=!1),"arrive_to"===e&&J&&($(J).hide(),Z.disabled=!1)),console.groupEnd()},Ye=function(e){console.groupCollapsed("Airport.showAirportForm"),m&&N&&e&&("depart_from"===e?(p.disabled=!0,k.disabled=!1,$(m).show(),$(N).hide()):"arrive_to"===e&&(k.disabled=!0,p.disabled=!1,$(N).show(),$(m).hide())),a&&e&&("depart_from"===e&&D&&($(D).show(),F.disabled=!0),"arrive_to"===e&&J&&($(J).show(),Z.disabled=!0)),console.groupEnd()},Ue=function(e){console.groupCollapsed("Airport.clearLocationAirportForm"),e&&("depart_from"===e&&(R.value="",q.value="",A.value="",F.value="",T.value="",U.value="",W.value="",V.value="",Q.checked=!0,O.value="",j.disabled=!0,H.disabled=!0,z.disabled=!0,P.value=""),"arrive_to"===e&&(ee.value="",ae.value="",te.value="",Z.value="",X.value="",oe.value="",ie.value="",de.value="",le.checked=!0,ne.value="",se.disabled=!0,ue.disabled=!0,ce.disabled=!0)),console.groupEnd()},We=function(e,t){if(console.groupCollapsed("Airport.setLocationAirportForm"),t&&(Ue(t),e&&e.city)){e.city.name,e.province.name,e.country.name;let a=`${e.city.name} (${e.province.name}, ${e.country.name})`,n=(e.city.name,e.province.name,e.country.name,"");if(n=e.name&&e.iata_code?`${e.iata_code} - ${e.name}`:e.name&&!e.iata_code?`${e.name}`:!e.name&&e.iata_code?`${e.iata_code}`:"Airport Name","depart_from"===t){let t=isNaN(parseInt(e.city.id))?null:parseInt(e.city.id);R.value=e.airport_types_id?e.airport_types_id:"",q.value=e.name?e.name:null,A.value=isNaN(parseInt(e.city.id))?null:parseInt(e.city.id),F.value=n,T.value=isNaN(parseInt(e.id))?null:parseInt(e.id),U.value=e.home_link?e.home_link:null,W.value=e.wikipedia_link?e.wikipedia_link:null,Q.checked=e.enabled&&1===e.enabled,O.value=e.iata_code?e.iata_code:null,j.disabled=!1,H.disabled=!1,z.disabled=!1,P.value=t,V.value=a}"arrive_to"===t&&(ee.value=e.airport_types_id?e.airport_types_id:"",ae.value=e.name?e.name:null,te.value=isNaN(parseInt(e.city.id))?null:parseInt(e.city.id),Z.value=n,X.value=isNaN(parseInt(e.id))?null:parseInt(e.id),oe.value=e.home_link?e.home_link:null,ie.value=e.wikipedia_link?e.wikipedia_link:null,le.checked=e.enabled&&1===e.enabled,ne.value=e.iata_code?e.iata_code:null,se.disabled=!1,ue.disabled=!1,ce.disabled=!1,de.value=a)}console.groupEnd()},Qe=function(e,t){if(console.groupCollapsed("Airport.airportExists"),e&&""!==e){Ve({name:e},function(a){let n=null;if(a&&(n=a,a[0]&&(n=a[0])),n&&n.id){if("depart_from"===t){let e=isNaN(parseInt(n.id))?null:parseInt(n.id),a=(isNaN(parseInt(n.airport_types_id))||parseInt(n.airport_types_id),isNaN(parseInt(n.country.id))?null:parseInt(n.country.id)),o=isNaN(parseInt(n.province.id))?null:parseInt(n.province.id),i=isNaN(parseInt(n.city.id))?null:parseInt(n.city.id);Le=!0,ye.dataset.airportId=e.toString(),L.value=a,x.value=o,M.value=i,Re(n,t),_.value=e,Pe(t)}else if("arrive_to"===t){let e=isNaN(parseInt(n.id))?null:parseInt(n.id);isNaN(parseInt(n.airport_types_id))||parseInt(n.airport_types_id);Me=!0,be.dataset.airportId=e.toString(),S.value=e,Re(n,t),Pe(t)}}else confirmDialog(`The airport: ${e} does not exist exists. Would you like to create it?`,a=>{a?("depart_from"===t?(Le=!1,p.disabled=!0,k.disabled=!1):"arrive_to"===t&&(Me=!1,p.disabled=!1,k.disabled=!0),Re({name:e},t),Ye(t),Pe(t)):"depart_from"===t?(L&&(L.value=""),x&&(x.value=""),M&&(M.value=""),_&&(_.value=""),p&&(p.value=""),Pe(t)):(S&&(S.value=""),k&&(k.value=""),Pe("arrive_to"))});Pe(t)})}console.groupEnd()},Ve=function(e,t){console.groupCollapsed("Airport.fetchByName");if(e)try{sendGetRequest("/api/v1.0/airports/validate",e,function(e,a,n){if(e)return t(e);je("Oops: 1")})}catch(e){je("Error Validating Airport")}else je("Error Loading Airport - Missing Data");console.groupEnd()},je=function(e,t,a){console.groupCollapsed("Airport.handleAirportError"),e||(e="There was an error."),t||(t="Category"),a||(a="error"),toastr[a](e,t),console.groupEnd()},ze=function(e){console.groupCollapsed("Airport.update"),function(e){if(console.groupCollapsed("Airport.validAirport"),e){if("depart_from"===e)return $(D).valid();if("arrive_to"===e)return $(J).valid()}console.groupEnd()}(e)&&confirmDialog("Would you like to update?",t=>{t&&function(e,t){if(console.groupCollapsed("Airport.sendUpdateRequest"),e){let a="/api/v1.0/airports/update";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){}}console.groupEnd()}(function(e){console.groupCollapsed("Airport.buildAirportUpdateRecord");let t={};if(e)if("depart_from"===e){let e=fe&&""!==fe.value?fe.value:null,a=ve&&""!==ve.value?ve.value:null,n=he&&""!==he.value?he.value:null;t.id=isNaN(parseInt(T.value))?null:parseInt(T.value),t.airport_types_id=isNaN(parseInt(R.value))?null:parseInt(R.value),t.city_id=isNaN(parseInt(A.value))?null:parseInt(A.value),t.name=""===q.value?null:q.value,t.iata_code=""===O.value?null:O.value,t.home_link=""===U.value?null:U.value,t.wikipedia_link=""===W.value?null:W.value,t.enabled=!0===Q.checked?1:0,t.street_1=e,t.street_2=a,t.postal_code=n}else if("arrive_to"===e){let e=me&&""!==me.value?me.value:null,a=ge&&""!==ge.value?ge.value:null,n=_e&&""!==_e.value?_e.value:null;t.id=isNaN(parseInt(X.value))?null:parseInt(X.value),t.airport_types_id=isNaN(parseInt(ee.value))?null:parseInt(ee.value),t.city_id=isNaN(parseInt(te.value))?null:parseInt(te.value),t.name=""===ae.value?null:ae.value,t.iata_code=""===ne.value?null:ne.value,t.home_link=""===oe.value?null:oe.value,t.wikipedia_link=""===ie.value?null:ie.value,t.enabled=!0===le.checked?1:0,t.street_1=e,t.street_2=a,t.postal_code=n}return console.groupEnd(),t}(e),function(e){let t;if(e){t=e,e[0]&&(t=e[0]);let a=t.name?t.name:null;toastr.success(`Airport ${a} has been updated`,"Airport Updated")}})}),console.groupEnd()},He=function(e){if(console.groupCollapsed("Airport.save"),e){let t=Te(e);t&&confirmDialog("Would you like to update?",a=>{a&&function(e,t){if(console.groupCollapsed("Airport.sendSaveRequest"),e){let a="/api/v1.0/airports/update";try{sendPostRequest(a,e,function(e){if(e)return t(e);je("Oops: 1")})}catch(e){}}console.groupEnd()}(t,function(t){let a;t&&(a=t,t[0]&&(a=t[0])),a&&("depart_from"===e&&(p&&(p.value=a.name?a.name:""),h&&(h.value=isNaN(parseInt(a.id))?"":parseInt(a.id)),_&&(_.value=isNaN(parseInt(a.id))?"":parseInt(a.id)),L&&(L.value=isNaN(parseInt(a.country.id))?"":parseInt(a.country.id)),x&&(x.value=isNaN(parseInt(a.province.id))?"":parseInt(a.province.id)),M&&(M.value=isNaN(parseInt(a.city.id))?"":parseInt(a.city.id))),"arrive_to"===e&&(k&&(k.value=a.name?a.name:""),v&&(v.value=isNaN(parseInt(a.id))?"":parseInt(a.id)),S&&(S.value=isNaN(parseInt(a.id))?"":parseInt(a.id))),Re(a,e),Ge(),Oe(e),Pe(e),je(`${a.name} was created`,"Airport","success"))})})}console.groupEnd()},Ke=function(e){console.groupCollapsed("Airport.setDetail");let t=function(){console.groupCollapsed("Airport.defaultDetail");let e={display_short:null,display_medium:null,display_long:null,id:null,airport_types_id:null,city_id:null,name:null,street_1:null,street_2:null,postal_code:null,iata_code:null,gps_code:null,local_code:null,home_link:null,wikipedia_link:null,scheduled_service:1,keywords:[],enabled:1,date_created:formatDateMySQL(),created_by:Ne,date_modified:formatDateMySQL(),modified_by:Ne,note:null,city:{},province:{},country:{},type:{}};return console.groupEnd(),e}();return e&&(t.id=isNaN(parseInt(e.id))?null:parseInt(e.id),t.airport_types_id=isNaN(parseInt(e.airport_types_id))?null:parseInt(e.airport_types_id),t.city_id=isNaN(parseInt(e.city.id))?null:parseInt(e.city.id),t.name=e.name?e.name:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.postal_code=e.postal_code?e.postal_code:null,t.iata_code=e.iata_code?e.iata_code:null,t.gps_code=e.gps_code?e.gps_code:null,t.local_code=e.local_code?e.local_code:null,t.home_link=e.home_link?e.home_link:null,t.wikipedia_link=e.wikipedia_link?e.wikipedia_link:null,t.scheduled_service=1,t.keywords=e.keywords?e.keywords:[],t.enabled=isNaN(parseInt(e.enabled))?1:parseInt(e.enabled),t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=isNaN(parseInt(e.created_by))?Ne:parseInt(e.created_by),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=isNaN(parseInt(e.modified_by))?Ne:parseInt(e.modified_by),t.note=e.note?e.note:null,t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null,t.city=e.city?e.city:{},t.country=e.country?e.country:{},t.province=e.province?e.province:{},t.type=e.type?e.type:{}),Airport.detail=t,console.groupEnd(),t},Ge=function(){console.groupCollapsed("Airport.initAutocomplete"),F&&$(F).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){T&&(T.value=""),F&&(F.value=""),Ue("depart_from")}).on("keyup",function(){Le=!1}).on("change",function(){setTimeout(function(){let e=F.value;!1===Le&&(""===e?(F.value="",T.value="",Le=!1):Qe(e,"depart_from"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;Le=!0;let t=e.data;t&&(We(t,"depart_from"),T&&(T.value=t.id),A&&(A.value=t.city.id,P.value=t.city.id),F&&(F.value=e.value))}}),Z&&$(Z).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){T&&(T.value=""),F&&(F.value=""),Ue("arrive_to")}).on("keyup",function(){Le=!1}).on("change",function(){}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;Le=!0;let t=e.data;t&&(We(t,"arrive_to"),X&&(X.value=t.id),te&&(te.value=t.city.id),Z&&(Z.value=e.value))}}),p&&$(p).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){_&&(_.value=""),p&&(p.value=""),L&&(L.value=""),x&&(x.value=""),M&&(M.value=""),Pe("depart_from")}).on("keyup",function(){Le=!1}).on("change",function(){setTimeout(function(){let e=p.value;!1===Le&&(""===e?(p.value="",_.value="",L&&(L.value=""),x&&(x.value=""),M&&(M.value=""),Le=!1,Pe("depart_from")):Qe(e,"depart_from"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;let t=e.data,a="depart_from";if(t){console.log("|__ airport",t);let e=isNaN(parseInt(t.id))?null:parseInt(t.id);Le=!0;isNaN(parseInt(t.airport_types_id))||parseInt(t.airport_types_id);let n=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),o=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),i=isNaN(parseInt(t.city.id))?null:parseInt(t.city.id);Re(t,a),_.value=e,ye.dataset.airportId=e.toString(),L.value=n,x.value=o,M.value=i}else qe(a),Ye(a);Pe(a)}}),k&&$(k).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keyup",function(){Me=!1}).on("search",function(){S&&(S.value=""),k&&(k.value=""),Pe("arrive_to")}).on("change",function(){setTimeout(function(){let e=k.value;!1===Me&&(""===e?(k.value="",S.value="",Me=!1,Pe("arrive_to")):Qe(e,"arrive_to"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;let t=e.data,a="arrive_to";if(t){console.log("|__ airport",t);let e=isNaN(parseInt(t.id))?null:parseInt(t.id);Me=!0,Re(t,a);isNaN(parseInt(t.airport_types_id))||parseInt(t.airport_types_id),isNaN(parseInt(t.country.id))||parseInt(t.country.id),isNaN(parseInt(t.province.id))||parseInt(t.province.id),isNaN(parseInt(t.city.id))||parseInt(t.city.id);S.value=e,be.dataset.airportId=e.toString(),Pe(a)}else qe(a),Ye(a);Pe(a)}}),console.groupEnd()},Je=function(e){if(console.groupCollapsed("Airport.init"),function(e){console.groupCollapsed("Airport.loadAll"),Airport.all=new Map,e&&$.each(e,function(e,t){let a=Ke(t);Airport.all.set(a.id,a)}),console.groupEnd()}(e&&e.airports?e.airports:[]),(p||k)&&(Ge(),qe("depart_from"),qe("arrive_to")),e){let n=t&&!isNaN(parseInt(t.value))?parseInt(t.value):null;if(a&&2===n){if(Ge(),Ue("depart_from"),Ue("arrive_to"),e.product){let t=e.product;if(t.arriving_location){Airport.arrivingAirport=t.arriving_location;let e=t.arriving_location;We(e,"arrive_to")}else Airport.arrivingAirport=null;if(t.departing_location){let e=t.departing_location;Airport.departingAirport=t.departing_location,We(e,"depart_from")}else Airport.departingAirport=null}initializeValidator(Be),Airport.airportDepartValidator=$(D).validate(),initializeValidator(xe),Airport.airportArriveValidator=$(J).validate()}}Oe("depart_from"),Oe("arrive_to"),console.groupEnd()};return{arriveToKeywords:null,departFromKeywords:null,airportDepartValidator:null,airportArriveValidator:null,arrivingAirport:null,departingAirport:null,resetAirportForm:function(e){qe(e)},init:function(e){Je(e)}}}(),AirportTypes=function(){"use strict";document.getElementById("input_airport_types_id"),document.getElementById("input_airport_types_name"),document.getElementById("input_airport_types_sort_order"),document.getElementById("input_airport_types_enabled"),document.getElementById("input_airport_types_date_created"),document.getElementById("input_airport_types_created_by"),document.getElementById("input_airport_types_date_modified"),document.getElementById("input_airport_types_modified_by"),document.getElementById("input_airport_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.sort_order=t.sort_order?t.sort_order:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),AirportTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,AirportTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);AirportTypes.all.set("id",n)})},save:function(e){},init:function(){}}}(),Category=function(){"use strict";const e=document.getElementById("modal_product_category_id"),t=document.getElementById("modal_product_city"),a=document.getElementById("modal_product_name"),n=document.getElementById("modal_product_sku"),o=document.getElementById("modal_product_rating_types_id"),i=document.getElementById("modal_product_currency_id"),l=document.getElementById("modal_product_pricing_strategies_types_id"),r=document.getElementById("modal_product_id");let d=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(e).on("change",function(){s($(this).val())});const s=function(d){console.groupCollapsed("Category.handleProductChange"),$("[data-categoryid]").hide();let s=isNaN(parseInt(d))?null:parseInt(d),c=Types.category.get(parseInt(s)),u=c&&c.attribute_id?c.attribute_id:null;if(s){if(Product.attr1=u||null,Product.attr2=null,Product.attr3=null,Product.resetNewProductDetails(),Product.enableNewFormDetails(),Product.updateProductSKU(),s&&!isNaN(s))switch(Product.clearModalForm(),e.value=s,Product.initAutoComplete(s),$(`[data-categoryid='${s}']`).show(),s){case 1:l.value="",o.value="",t.disabled=!1,o.disabled=!1,a.disabled=!1,i.disabled=!1,l.disabled=!1;break;case 2:l.value=2,o.value="",t.disabled=!1,o.disabled=!0,a.disabled=!1,i.disabled=!1,l.disabled=!0,n.disabled=!0,Airport.departFromKeywords=$("#modal_product_depart_from_keywords_airport").BuildKeyword([]),Airport.arriveToKeywords=$("#modal_product_arrive_to_keywords_airport").BuildKeyword([]);break;case 3:l.value=3,o.value="",t.disabled=!1,o.disabled=!0,a.disabled=!1,i.disabled=!1,l.disabled=!0,n.disabled=!0,Country.initAutocomplete();break;case 4:l.value=2,o.value="",t.disabled=!1,o.disabled=!0,a.disabled=!1,i.disabled=!1,l.disabled=!0,n.disabled=!0,Station.departFromKeywords=$("#modal_product_depart_from_keywords_station").BuildKeyword([]),Station.arriveToKeywords=$("#modal_product_arrive_to_keywords_station").BuildKeyword([]);break;case 5:l.value="",o.value="",t.disabled=!1,o.disabled=!1,a.disabled=!1,i.disabled=!1,l.disabled=!1,n.disabled=!0;break;case 6:l.value="2",o.value="",t.disabled=!1,o.disabled=!0,a.disabled=!1,i.disabled=!1,l.disabled=!1,n.disabled=!0;break;case 7:l.value="",o.value="",t.disabled=!1,o.disabled=!1,a.disabled=!1,i.disabled=!1,l.disabled=!1,n.disabled=!0,r.disabled=!0;break;case 8:l.value="",o.value="",t.disabled=!1,o.disabled=!0,a.disabled=!1,i.disabled=!1,l.disabled=!0,n.disabled=!0;break;case 9:l.value="",o.value="",t.disabled=!1,o.disabled=!1,a.disabled=!1,i.disabled=!1,l.disabled=!1,n.disabled=!0;break;default:o.value="",l.value="",o.disabled=!0,a.disabled=!0,i.disabled=!0,l.disabled=!0,n.disabled=!0,t.disabled=!0}else Product.disableNewFormDetails();console.groupEnd()}},c=function(e){console.groupCollapsed("Category.set");let t=function(){console.groupCollapsed("Category.defaultDetail");let e={category_id:1,name:null,last_update:null,id:null,pricing_strategy_types_id:null,color_scheme_id:null,icon:null,view_product_index:1,view_product_index_filter:1,view_product_index_search:1,view_product_edit:1,view_product_package_edit:1,view_product_package_index:1,all_day:1,overlap:1,editable:1,duration_editable:1,start_editable:1,display:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:d,date_modified:formatDateMySQL(),modified_by:d,note:null};return console.groupEnd(),e}();return e&&(t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.last_update=e.last_update?e.last_update:null,t.id=e.id?e.id:null,t.pricing_strategy_types_id=e.pricing_strategy_types_id?e.pricing_strategy_types_id:null,t.color_scheme_id=e.color_scheme_id?e.color_scheme_id:null,t.name=e.name?e.name:null,t.icon=e.icon?e.icon:null,t.view_product_index=e.view_product_index?e.view_product_index:1,t.view_product_index_filter=e.view_product_index_filter?e.view_product_index_filter:1,t.view_product_index_search=e.view_product_index_search?e.view_product_index_search:1,t.view_product_edit=e.view_product_edit?e.view_product_edit:1,t.view_product_package_edit=e.view_product_package_edit?e.view_product_package_edit:1,t.view_product_package_index=e.view_product_package_index?e.view_product_package_index:1,t.all_day=e.all_day?e.all_day:1,t.overlap=e.overlap?e.overlap:1,t.editable=e.editable?e.editable:1,t.duration_editable=e.duration_editable?e.duration_editable:1,t.start_editable=e.start_editable?e.start_editable:1,t.display=e.display?e.display:null,t.sort_order=e.sort_order?e.sort_order:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:created_by,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:modified_by,t.note=e.note?e.note:null,t.seasons=e.seasons?e.seasons:[]),Category.detail=t,console.groupEnd(),t},u=function(e){console.groupCollapsed("Category.loadAll"),Category.all=new Map,e&&($.each(e,function(e,t){let a=c(t);Category.all.set(a.id,a)}),console.groupEnd())};return{validator:null,detail:{},all:new Map,get:function(e){console.groupCollapsed("Category.get"),console.groupEnd()},load_all:function(e){u(e)},save:function(e){console.groupCollapsed("Category.save"),console.groupEnd()},init:function(e){!function(e){console.groupCollapsed("Category.init");let t=[];e&&e.categories&&(t=e.categories),u(t),console.groupEnd()}(e)},initProductModal:function(e){console.groupCollapsed("Category.initProductModal"),console.groupEnd()}}}(),ContactTypes=function(){"use strict";document.getElementById("input_contact_types_id"),document.getElementById("input_contact_types_name"),document.getElementById("input_contact_types_sort_order"),document.getElementById("input_contact_types_enabled"),document.getElementById("input_contact_types_date_created"),document.getElementById("input_contact_types_created_by"),document.getElementById("input_contact_types_date_modified"),document.getElementById("input_contact_types_modified_by"),document.getElementById("input_contact_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.sort_order=t.sort_order?t.sort_order:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),ContactTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,ContactTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);ContactTypes.all.set("id",n)})},save:function(e){},init:function(){}}}(),Company=function(){"use strict";document.getElementById("product_edit_page");const e=document.getElementById("button_save_provider"),t=document.getElementById("form_edit_company"),a=(document.getElementById("company_enabled"),document.getElementById("company_name")),n=document.getElementById("company_phone_1"),o=document.getElementById("company_phone_2"),i=document.getElementById("company_fax"),l=document.getElementById("company_email"),r=document.getElementById("company_website"),d=document.getElementById("button_submit_form_edit_company"),s=document.getElementById("company_cover_image"),c=document.getElementById("address_company_id"),u=document.getElementById("company_id"),p=document.getElementById("contact_company_id"),_=document.getElementById("form_edit_company_block"),m=document.getElementById("button_edit_company_name"),g=document.getElementById("button_cancel_edit_company_name"),h=document.getElementById("button_close_edit_company_form"),f=document.getElementById("form_edit_vendor"),v=document.getElementById("form_edit_provider"),y=document.getElementById("vendor_name"),b=document.getElementsByClassName("vendor_company_id"),I=document.getElementById("provider_name"),E=document.getElementById("provider_company_id"),w=document.getElementById("company_keywords"),C=(document.getElementById("company_logo"),document.getElementById("company_description_long")),k=document.getElementById("company_description_short"),S=document.getElementById("button_clear_form_edit_company"),N=document.getElementById("company_images"),B=(document.getElementById("modal_product_category_id"),{rules:{company_name:{required:!0},company_phone_1:{},company_phone_2:{},company_fax:{},company_email:{email:!0},company_website:{url:!0}},messages:{company_name:{required:"Field Required1"},company_email:{email:"Field Invalid"},company_website:{url:"Field Invalid"}}});let x,L,M={},P=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,D=!1,F={};$('a[data-toggle="tab"]').on("hide.bs.tab",function(e){V()}),$(g).on("click",function(){let e=W(F);A(e),V()}),$(m).on("click",function(){F=q(),Q()}),$(S).on("click",function(){U()}),$(h).on("click",function(){V()}),$(d).on("click",function(){let e=Company.build();e&&confirmDialog("Would you like to update?",t=>{t&&z(e,function(e){if(e&&e[0]){let t=e[0],a=W(t);M=a,A(a),T(),V()}})})}),$(u).on("change",function(){c.value=u.value}),$(t).on("change",function(){j()});const T=function(){$(a).on("change",function(){setTimeout(function(){let e=a.value;!1===D&&(""===e?(a.value="",u.value="",D=!1):O(e))},200)}).on("search",function(){Company.resetForm(!0),v&&Provider.resetForm(),f&&Vendor.resetForm()}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/companies",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;D=!0,A(t),I?$(I).val(t.name).trigger("change"):$(y).val(t.name),E&&$(E).val(t.id),Address.get_by_company_id(t.id),Contact.getByCompanyId(t.id)}})},R=function(e,t,a){e||(e="There was an Error"),t||(t="Company"),a||(a="error"),toastr[a](`${e}`,t)},A=function(e){$("#company_logo").dropify();let t=e.keywords?e.keywords:"";$(u).val(e.id?e.id:"").trigger("change"),a.value=e.name?e.name:"",n.value=e.phone_1?e.phone_1:"",o.value=e.phone_2?e.phone_2:"",i.value=e.fax?e.fax:"",l.value=e.email?e.email:"",r.value=e.website?e.website:"",C.value=e.description_long?e.description_long:"",k.value=e.description_short?e.description_short:"",x=$(w).BuildKeyword(t),I&&$(I).val(e.name?e.name:"").trigger("change"),y&&(y.value=e.name?e.name:null),E&&(E.value=e.id?e.id:null),b&&(b.value=e.id?e.id:null),p&&(p.value=e.id?e.id:null),c&&(c.value=e.id?e.id:null)},q=function(){return remove_nulls({email:$(l).val(),enabled:1,fax:$(i).val(),id:isNaN(u.value)?null:parseInt(u.value),modified_by:P,cover_image:"/public/img/placeholder.jpg",description_short:k.value,description_long:C.value,keywords:x.build(),name:$(a).val(),note:null,phone_1:$(n).val(),phone_2:$(o).val(),status_id:10,website:$(r).val()})},O=function(e){if(e&&""!==e){Y({name:e},function(t){let n=null;t&&t[0]&&t[0]&&(n=t[0]),n?(U(!0),A(n),Address.get_by_company_id(n.id),Contact.getByCompanyId(n.id)):confirmDialog(`The company: ${e} does not exist exists. Would you like to create it?`,e=>{e&&z({name:a.value,status_id:10,enabled:1},function(e){e&&e[0]&&(n=e[0],F=n,U(!0),A(n),Q())})})})}},Y=function(e,t){if(e)try{sendGetRequest("/api/v1.0/companies/validate",e,function(e,a,n){if(e)return t(e);R("Oops: 1")})}catch(e){R("Error Validating Company")}else R("Error Loading Company- Missing Data")},U=function(e){n.value="",o.value="",i.value="",l.value="",r.value="",e&&!0===e&&(I&&$(I).val("").trigger("change"),y&&$(y).val("").trigger("change"),$(u).val("").trigger("change"),a.value="",Address.clearTable(),Contact.clearTable())},W=function(e){let t={created_by:P,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),email:null,cover_image:"/public/img/placeholder.jpg",enabled:1,fax:null,id:null,modified_by:P,name:null,note:null,phone_1:null,phone_2:null,status_id:10,website:null,description_short:null,description_long:null,keywords:null,logo:null,images:[]};return e&&(t.created_by=e.created_by?e.created_by:P,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.email=e.email?e.email:null,t.cover_image=e.cover_image?e.cover_image:null,t.enabled=e.enabled?e.enabled:1,t.fax=e.fax?e.fax:null,t.id=e.id?e.id:null,t.modified_by=e.modified_by?e.modified_by:P,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.phone_1=e.phone_1?e.phone_1:null,t.phone_2=e.phone_2?e.phone_2:null,t.status_id=e.status_id?e.status_id:10,t.website=e.website?e.website:null,t.logo=e.logo?e.logo:"",t.keywords=e.keywords?e.keywords:"",t.description_long=e.description_long?e.description_long:"",t.description_short=e.description_short?e.description_short:"",t.images=e.images?e.images:[]),Company.detail=t,t},Q=function(){M=Company.build(),_&&($(_).show(),$(g).show(),$(m).hide(),$(a).attr("readonly",!0)),e&&($(e).attr("readonly",!0),e.disabled=!0)},V=function(){if(_){W(M);$(a).attr("readonly",!1),$(_).hide(),$(g).hide(),$(m).show(),T()}e&&($(e).attr("readonly",!1),e.disabled=!1)},j=function(){isNaN(parseInt(u.value))?(m.disabled=!0,$(s).attr("readonly",!0),$(n).attr("readonly",!0),$(o).attr("readonly",!0),$(i).attr("readonly",!0),$(l).attr("readonly",!0)):($(n).attr("readonly",!1),$(o).attr("readonly",!1),$(i).attr("readonly",!1),$(l).attr("readonly",!1),$(s).attr("readonly",!1),m.disabled=!1)},z=function(e,t){e&&sendPostRequest("/api/v1.0/companies/update",e,function(e,a,n){if(e)return t(e);R("Oops: 1")})};return{detail:{created_by:P,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),email:null,enabled:1,fax:null,id:null,modified_by:P,name:null,note:null,phone_1:null,phone_2:null,status_id:10,website:null},all:new Map,validator:null,fileManager:null,build:function(){if($(t).valid())return q()},setDetail:function(e){return W(e)},add:function(e,t){return z(e,t)},company_exists:function(e){return O(e)},populate_form:function(e){A(e)},resetForm:function(e){U(e)},init:function(e){!function(e){let a=[];if(e){let n=W(e);a=e.images?e.images:[],N&&(Company.fileManager=$("#company_images").fileManager({height:400,source:"company",sourceId:n.id,images:a})),t&&(A(n),validator_init(B),L=$(t).validate(),T(),_&&V())}}(e)}}}(),Contact=function(){"use strict";const e=document.getElementById("clear_contact_table"),t=document.getElementById("button_add_contact_table"),a=document.getElementById("button_clear_form_edit_contact"),n=document.getElementById("button_close_edit_contact_form"),o=document.getElementById("button_submit_form_edit_contact"),i=document.getElementById("company_id"),l=document.getElementById("contact_company_id"),r=document.getElementById("contact_id"),d=document.getElementById("contact_name_first"),s=document.getElementById("contact_name_last"),c=document.getElementById("contact_phone"),u=document.getElementById("contact_email"),p=document.getElementById("contact_enabled"),_=document.getElementById("contact_types_id"),m=document.getElementById("card_edit_contact_form"),g=document.getElementById("form_edit_contact"),h=document.getElementById("table_contact");document.getElementById("contact_date_created"),document.getElementById("contact_created_by"),document.getElementById("contact_date_modified"),document.getElementById("contact_modified_by"),document.getElementById("contact_note");let f,v=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,y=$(h),b={rules:{contact_name_first:{required:!0},contact_name_last:{required:!0},contact_phone:{required:!0},contact_email:{required:!0},contact_types_id:{required:!0}},messages:{contact_name_first:{required:"Field Required"},contact_name_last:{required:"Field Required"},contact_phone:{required:"Field Required"},contact_email:{required:"Field Required"},contact_types_id:{required:"Field Required"}}};$(o).on("click",function(){I()&&confirmDialog("Would you like to update?",e=>{e&&E()})}),$(t).on("click",function(){y.clearSelectedRows(),k(),S()}),$(a).on("click",function(){y.clearSelectedRows(),k()}),$(n).on("click",function(){y.clearSelectedRows(),k(),N()}),$(e).on("click",function(){Contact.clearTable()});const I=function(){return $(g).valid()},E=function(){let e=function(){let e={name_first:d.value,name_last:s.value,email:u.value,phone:c.value,contact_types_id:toNumbers(getListOfIds($(_).val())),enabled:!0===p.checked?1:0,company_id:isNaN(l.value)?null:parseInt(l.value),id:isNaN(r.value)?null:parseInt(r.value)};return remove_nulls(e)}();e&&w(e,function(e){if(e&&e[0]){let t=e[0],a=B(t);Contact.all.get(a.id)?y.updateRow(a):y.insertRow(a),Contact.all.set(a.id,a),toastr.success("Contact Updated")}})},w=function(e,t){e&&sendPostRequest("/api/v1.0/contacts/update",e,function(e,a,n){return e?t(e):C("Oops: 1")})},C=function(e){toastr.error(e)},k=function(){m&&(r.value="",d.value="",s.value="",c.value="",u.value="",p.checked=!0,$(_).val([]))},S=function(){m&&$(m).show()},N=function(){m&&$(m).hide()},B=function(e){let t={id:null,company_id:null,name_first:null,name_last:null,formatted_types:"",formatted_names:"",phone:null,email:null,enabled:1,date_created:formatDateMySQL(),created_by:v,date_modified:formatDateMySQL(),modified_by:v,note:null};return e&&(t.id=e.id?e.id:null,t.company_id=e.company_id?e.company_id:null,t.name_first=e.name_first?e.name_first:null,t.name_last=e.name_last?e.name_last:null,t.formatted_types=e.formatted_types?e.formatted_types:"",t.formatted_names=e.formatted_names?e.formatted_names:"",t.contact_types_id=getListOfIds(e.contact_types_id),t.phone=e.phone?e.phone:null,t.email=e.email?e.email:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:created_by,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:modified_by,t.note=e.note?e.note:null),Contact.detail=t,t},x=function(e){Contact.all=new Map,e&&($.each(e,function(e,t){let a=B(t);Contact.all.set(a.id,a),y.insertRow(a)}),e[0]&&y.loadRow(e[0]))},L=function(e){e&&function(e){k(),l.value=i.value,e&&(r.value=validInt(e.id),d.value=e.name_first?e.name_first:null,s.value=e.name_last?e.name_last:null,c.value=e.phone?e.phone:null,u.value=e.email?e.email:null,p.checked=!e.enabled||1===e.enabled,$(_).val(e.contact_types_id?e.contact_types_id:[])),S()}(e)},M=function(e){h&&h&&($.fn.DataTable.isDataTable(h)||(y=$(h).table({table_type:"display_list",data:Contact.all,columnDefs:[{title:"ID",targets:0,data:"id",render:function(e,t,a,n){return e}},{title:"Name",targets:1,data:"formatted_names",render:function(e,t,a,n){return e}},{title:"Types",targets:2,data:"formatted_types",render:function(e,t,a,n){return e}}],rowClick:Contact.navigate}))),e&&x(e),g&&(validator_init(b),f=$(g).validate()),N()},P=function(){let e=Array.from(Contact.all.values());$.each(e,function(e,t){y.deleteRow(t)}),Contact.all=new Map},D=function(e){e&&function(e,t){if(!e)return C("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/contacts",e,function(e,a,n){return e?t(e):C("Oops: 1")})}catch(e){return C("Error Validating Company")}}({company_id:e},function(e){if(e){let t=e;P(),function(e){if(h){let t;Contact.all=new Map;let a=0;$.each(e,function(e,n){0===a&&(t=n),n.contact_types_id=getListOfIds(n.contact_types_id),Contact.all.set(n.id,n),y.insertRow(n),a++}),h&&(t&&y.loadRow(t),y.clearSelectedRows())}}(t)}})};return{validator:null,detail:{},all:new Map,getByCompanyId:function(e){D(e)},clearTable:function(){P()},navigate:function(e){L(e)},load_all:function(e){x(e)},save:function(e){E(e)},init:function(e){M(e)}}}(),Currency=function(){"use strict";document.getElementById("input_currency_id"),document.getElementById("input_currency_sort_order"),document.getElementById("input_currency_name"),document.getElementById("input_currency_iso"),document.getElementById("input_currency_minor_unit"),document.getElementById("input_currency_symbol"),document.getElementById("input_currency_enabled"),document.getElementById("input_currency_date_created"),document.getElementById("input_currency_created_by"),document.getElementById("input_currency_date_modified"),document.getElementById("input_currency_modified_by"),document.getElementById("input_currency_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,sort_order:null,name:null,iso:null,minor_unit:null,symbol:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.sort_order=t.sort_order?t.sort_order:null,a.name=t.name?t.name:null,a.iso=t.iso?t.iso:null,a.minor_unit=t.minor_unit?t.minor_unit:null,a.symbol=t.symbol?t.symbol:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),Currency.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,Currency.all=new Map,a&&$.each(a,function(e,a){let n=t(a);Currency.all.set("id",n)})},save:function(e){},init:function(){}}}();Currency.init();const Vendor=function(){"use strict";const e=document.getElementById("panel_tab_contact"),t=document.getElementById("button_add_vendor_page_heading"),a=document.getElementById("vendor_index_table_add_button"),n=document.getElementById("vendor_company_id"),o=document.getElementById("form_edit_vendor"),i=document.getElementById("vendor_name"),l=document.getElementById("vendor_id"),r=document.getElementById("vendor_show_online"),d=document.getElementById("vendor_show_sales"),s=document.getElementById("vendor_show_ops"),c=document.getElementById("vendor_is_provider"),u=document.getElementById("vendor_sku"),p=document.getElementById("vendor_enabled"),_=document.getElementById("provider_edit"),m=(document.getElementById("provider_name"),document.getElementById("provider_company_id"),document.getElementById("company_id")),g=document.getElementById("button_submit_form_edit_vendor"),h=document.getElementById("table_vendor_index"),f=document.getElementById("form_vendor_add"),v=document.getElementById("modal_button_submit_add_vendor"),y=document.getElementById("modal_button_cancel_add_vendor"),b=document.getElementById("modal_new_vendor"),I=document.getElementById("vendor_modal_vendor_name"),E=document.getElementById("button_save_vendor"),w=document.getElementById("company_name"),C=document.getElementById("form_product_add"),k=document.getElementById("modal_product_vendor_id"),S=document.getElementById("modal_product_vendor_name"),N=document.getElementById("modal_product_provider_vendor_match"),B=document.getElementById("modal_product_provider_company_id"),x=document.getElementById("modal_product_vendor_company_id"),L=document.getElementById("product_edit_details_section_vendor_form_filter"),M=document.getElementById("product_edit_details_section_vendor_form_vendor_id");let P,D,F=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,T=!1,R={rules:{vendor_name:{required:!0}},messages:{vendor_name:{required:"Field Required"}}},A={rules:{vendor_modal_vendor_name:{required:!0}},messages:{vendor_modal_vendor_name:{required:"Field Required"}}},q=$(h);$(E).on("click",function(){Company.build();Z()}),$(t).on("click",function(){U()}),$(a).on("click",function(){U()}),$(y).on("click",function(){Y()}),$(v).on("click",function(){if(W()){let e={name:I.value};confirmDialog(`Vendor: ${name} will be added`,t=>{t&&Q(e)})}}),$(I).on("change",function(){setTimeout(function(){let e=I.value;!1===T&&(""===e?(I.value="",T=!1):O(e))},200)}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;confirmDialog(`Vendor ${t.name} ALREADY exists. Would you like to load this record to edit?`,e=>{e?window.location.replace("/vendors/"+t.id):j()})}}),$(S).on("change",function(){setTimeout(function(){let e=S.value;T=!1,""===e?(k.value="",S.value="",x.value="",Product.attr3=null,Product.updateProductSKU(),T=!1):O(e)},200)}).on("search",function(){k.value="",S.value="",x.value="",N.checked=!1,Product.attr3=null,Product.updateProductSKU(),T=!1}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;e.data;if(C){let t=isNaN(parseInt(B.value))?null:parseInt(B.value);k.value=e.data.id,S.value=e.data.name,x.value=e.data.company_id,Product.attr3=e.data.sku,Product.updateProductSKU(),N.checked=parseInt(e.data.company_id)===t}T=!0}}),$(m).on("change",function(){$(n).val(m.value)}),$(g).on("click",function(){Z()});const O=function(e){if(e&&""!==e){H({name:e},function(e){let t;if(e&&e.length>0)t=e,e.length>0&&e[0]&&(t=e[0]);else{k.value="",x.value="",Product.attr3=null,Product.updateProductSKU();let e=S.value;""!==e&&confirmDialog(`Vendor ${e} does not exists. Would you like to create this`,e=>{if(e){let e={name:S.value};Q(e)}else S.value=""})}t&&(I&&confirmDialog(`Vendor ${t.name} ALREADY exists. Would you like to load this record to edit?`,e=>{e&&window.location.replace("/vendors/"+t.id)}),C&&(k.value=t.id?t.id:"",x.value=t.company_id?t.company_id:"",Product.attr3=t.sku?t.sku:null,Product.updateProductSKU()))})}},Y=function(){$(b).modal("hide")},U=function(){$(I).val(""),$(b).modal("show")},W=function(){return!!f&&$(f).valid()},Q=function(e){e&&V(e,function(e){if(e&&e[0]){let t=e[0];t.id&&(C&&(x.value=t.company_id?t.company_id:"",k.value=t.id?t.id:"",N.checked=x.value===B.value,Product.attr3=t.sku?t.sku:null,Product.updateProductSKU()),f&&window.location.replace("/vendors/"+t.id))}})},V=function(e,t){if(e)try{sendPostRequest("/api/v1.0/vendors/add",e,function(e,a,n){return e?t(e):z("Oops: 1")})}catch(e){}},j=function(){I.value=""},z=function(e){toastr.error(e)},H=function(e,t){if(!e)return z("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/vendors/validate",e,function(e,a,n){return e?t(e):z("Oops: 1")})}catch(e){return z("Error Validating Company")}},K=function(){return{id:null,name:null,company_id:null,status_id:1,show_online:1,show_sales:1,show_ops:1,is_provider:1,sku:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null,company:{},addresses:[],contacts:[]}},G=function(e){let t,a=K(),n={},o=[];return e&&(a.id=e.id?e.id:null,a.name=e.name?e.name:null,a.status_id=e.status_id?e.status_id:null,a.show_online=e.show_online,a.show_sales=e.show_sales,a.show_ops=e.show_ops,a.is_provider=e.is_provider,a.sku=e.sku?e.sku:null,a.enabled=e.enabled,a.date_created=e.date_created?e.date_created:formatDateMySQL(),a.created_by=e.created_by?e.created_by:created_by,a.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),a.modified_by=e.modified_by?e.modified_by:modified_by,a.note=e.note?e.note:null,e.company&&(n=e.company,a.company_id=n.id,e.company.addresses&&(t=e.addresses),e.company.contacts&&(o=e.contacts))),a.addresses=t,a.contacts=o,a.company=n,Vendor.detail=a,a},J=function(e,t){if(e)try{sendPostRequest("/api/v1.0/vendors/update",e,function(e,a,n){return e?t(e):z("Oops: 1")})}catch(e){}},Z=function(){let e=Vendor.build();e.company_detail=Company.build(),e&&confirmDialog("Would you like to update?",t=>{t&&J(e,function(e){if(e&&e[0]){let t=e[0];if(t.id)if(""===l.value||isNaN(parseInt(l.value)))window.location.replace("/vendors/"+t.id);else{let e=w.value;toastr.success(`Vendor ${e} has been updated.`)}}})})},X=function(e){e&&J(e,function(e){if(e&&e[0]){let t=e[0];if(t.id)if(""===l.value||isNaN(parseInt(l.value)))window.location.replace("/vendors/"+t.id);else{let e=w.value;toastr.success(`Vendor ${e} has been updated.`)}}})},ee=function(e){Vendor.all=new Map,e&&$.each(e,function(e,t){let a=G(t);q.insertRow(a),Vendor.all.set(a.id,a)})},te=function(e){let t={};if(e&&(e.company&&(t=e.company),e.vendor_detail)){let t=G(e.vendor_detail);a=t,L.value=a.company.name,M.value=a.id,Product.attr3=a.sku?a.sku:null}var a;o&&(i&&(i.value=e.name?e.name:"",i&&$(i).on("change",function(){setTimeout(function(){let e=i.value;T=!1,""===e?(i.value="",n.value=""):O(e)},200)}).on("click",function(){$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){e.data}})),l&&(l.value=e.id?e.id:""),n&&(n.value=t.id?t.id:""),u&&(u.value=e.sku?e.sku:""),p&&(p.checked=!e.enabled||1===e.enabled),c&&(c.checked=1===e.is_provider),r&&(r.checked=1===e.show_online),s&&(s.checked=1===e.show_ops),d&&(d.checked=1===e.show_sales),validator_init(R),D=$(o).validate())},ae=function(e){f&&(validator_init(A),P=$(f).validate()),q=$(h).table({table_type:"display_list",data:Vendor.all,columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:2,data:"sku",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Vendor.navigate}),e&&e.vendors&&ee(e.vendors)},ne=function(){i&&($(c).attr("readonly",!0),c.disabled=!0,$(i).attr("readonly",!0),$(l).attr("readonly",!0),$(u).attr("readonly",!0),$(c).attr("readonly",!0))};return{validator:null,detail:{},all:new Map,newVendor:function(e,t){return V(e,t)},index:function(e){ae(e)},setProvider:function(){_&&(c.checked=!0,$(c).attr("readonly","true"),c.disabled=!0,$(i).attr("readonly","true"),$(l).attr("readonly","true"),$(u).attr("readonly","true"),$(c).attr("readonly","true"))},get:function(e){},load_all:function(e){ee(e)},reset_form:function(){i.value="",l.value="",n.value="",r.checked=!0,d.checked=!0,s.checked=!0,c.checked=!0,u.value="",p.checked=!0},save:function(e){X(e)},init:function(e){te(e)},build:function(){if($(o).valid())return remove_nulls({id:isNaN(parseInt(l.value))?null:parseInt(l.value),company_id:isNaN(parseInt(n.value))?null:parseInt(n.value),name:""!==i.value?i.value:null,status_id:10,enabled:p.checked?1:0,show_online:!0===r.checked?1:0,show_sales:!0===d.checked?1:0,show_ops:!0===s.checked?1:0,is_provider:!0===c.checked?1:0,sku:u.value})},navigate:function(e){!function(e){e&&e.id&&window.location.replace("/vendors/"+e.id)}(e)},edit:function(t){!function(t){let a=[],n=[],o={},i={};t&&t.vendor_detail&&(i=G(t.vendor_detail),a=t.address_detail?t.address_detail:[],n=t.contact_detail?t.contact_detail:[],o=t.company_detail?t.company_detail:{}),$(e).removeClass("disabled"),Vendor.init(i),Address.init(a),Contact.init(n),Company.init(o),ne()}(t)},setVendor:function(){ne()}}}(),Tour=function(){"use strict";const e=document.getElementById("tour_route");return{all:new Map,route:null,detail:{},init:function(t){!function(t){console.log("Tour.init(options)",t),e&&$(e).routeManager({stops:[{id:1,location_id:1,time:"01:00"},{id:2,location_id:2,time:"01:00"},{id:3,location_id:3,time:"01:00"},{id:4,location_id:4,time:"01:00"},{id:5,location_id:5,time:"01:00"},{id:6,location_id:6,time:"01:00"}]})}(t)}}}(),MessageTypes=function(){"use strict";document.getElementById("input_message_types_id"),document.getElementById("input_message_types_name"),document.getElementById("input_message_types_icon"),document.getElementById("input_message_types_sort_order"),document.getElementById("input_message_types_enabled"),document.getElementById("input_message_types_date_created"),document.getElementById("input_message_types_created_by"),document.getElementById("input_message_types_date_modified"),document.getElementById("input_message_types_modified_by"),document.getElementById("input_message_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,icon:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.icon=t.icon?t.icon:null,a.sort_order=t.sort_order?t.sort_order:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),MessageTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,MessageTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);MessageTypes.all.set("id",n)})},save:function(e){},init:function(){}}}(),Pricing=function(){"use strict";const e=document.getElementById("pricing_strategy_unit_id"),t=document.getElementById("pricing_strategy_season_id"),a=document.getElementById("pricing_strategy_types_id"),n=document.getElementById("calendar_filter_profile_id");let o=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(a).on("change",function(){PricingWorksheet.pricingWorksheet()});const i=function(e){console.groupCollapsed("Pricing.loadAll"),Pricing.all=new Map,e||(e=[]),$.each(e,function(e,t){let a=t.pricing_code,n=d(t);Pricing.all.set(a,n)}),console.groupEnd()},l=function(){console.groupCollapsed("Pricing.loadProfileDropdown");let e=InventoryProfile&&InventoryProfile.all?Array.from(InventoryProfile.all.values()):[],t="<option value='' disabled readonly selected>-- Profiles --</option>";$.each(e,function(e,a){let n=a.name,o=a.id;t+=`<option value="${o}">${n}</option>`}),$(n).empty(),$(n).html(t),console.groupEnd()},r=function(){console.groupCollapsed("Pricing.loadUnitDropdown"),function(){console.groupCollapsed("Pricing.loadSeasonDropdown");let e=Season&&Season.all?Array.from(Season.all.values()):[],a="";$.each(e,function(e,t){let n=t.name,o=t.id;a+=`<option value="${o}">${n}</option>`}),$(t).empty(),$(t).html(a),console.groupEnd()}(),function(){console.groupCollapsed("Pricing.loadUnitDropdown");let t=Unit&&Unit.all?Array.from(Unit.all.values()):[],a="";console.log("units",t),$.each(t,function(e,t){let n=t.name,o=t.id;a+=`<option value="${o}">${n}</option>`}),$(e).empty(),$(e).html(a),console.groupEnd()}(),l(),console.groupEnd()},d=function(e){console.groupCollapsed("Pricing.set");let t=function(){console.groupCollapsed("Pricing.loadUnitDropdown");let e={pricing_code:null,matrix_code:null,code:null,id:null,product_id:null,season_id:null,unit_id:null,matrix_id:null,variant_id:0,name:null,mon:null,tue:null,wed:null,thu:null,fri:null,sat:null,sun:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null,count:1,enabled:1,date_created:formatDateMySQL(),created_by:o,date_modified:formatDateMySQL(),modified_by:o,note:null};return console.groupEnd(),e}();return e&&(console.log("pricing",e),t.pricing_code=e.pricing_code?e.pricing_code:null,t.matrix_code=e.matrix_code?e.matrix_code:null,t.code=e.code?e.code:null,t.id=e.id?e.id:null,t.product_id=e.product_id?e.id:null,t.season_id=e.season_id?e.id:null,t.unit_id=e.unit_id?e.id:null,t.matrix_id=e.matrix_id?e.matrix_id:null,t.variant_id=e.variant_id?e.variant_id:null,t.name=e.name?e.name:null,t.mon=e.mon?e.mon:null,t.tue=e.tue?e.tue:null,t.wed=e.wed?e.wed:null,t.thu=e.thu?e.thu:null,t.fri=e.fri?e.fri:null,t.sat=e.sat?e.sat:null,t.sun=e.sun?e.sun:null,t.monMargin=e.monMargin?e.monMargin:null,t.tueMargin=e.tueMargin?e.tueMargin:null,t.wedMargin=e.wedMargin?e.wedMargin:null,t.thuMargin=e.thuMargin?e.thuMargin:null,t.friMargin=e.friMargin?e.friMargin:null,t.satMargin=e.satMargin?e.satMargin:null,t.sunMargin=e.sunMargin?e.sunMargin:null,t.count=e.count?e.count:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:o,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:o,t.note=e.note?e.note:null),console.groupEnd(),Pricing.detail=t,t};return{all:new Map,init:function(e){!function(e){console.groupCollapsed("Pricing.init"),r();let t,n=[];e&&(t=e,e.pricings&&(n=e.pricings)),t.pricing_strategy_types_id&&(a.value=t.pricing_strategy_types_id,PricingWorksheet.pricingStrategyId=parseInt(t.pricing_strategy_types_id)),i(n),a.disabled=!0,$(a).addClass("disabled"),console.groupEnd()}(e)},set:function(e){return d(e)},resetForm:function(){r()},loadProfileDropdown:function(){l()}}}(),Matrix=function(){"use strict";let e,t,a,n=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const o=function(e){let t={been_saved:0,cost:0,created_by:n,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,has_pricing:0,id:null,margin:0,code:null,modified_by:n,note:null,price:0,pricings:new Map,product_id:null,season_id:null,unit_id:null};return e&&(t.been_saved=e.been_saved?e.been_saved:0,t.cost=e.cost?e.cost:null,t.created_by=e.created_by?e.created_by:n,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.enabled=e.enabled?e.enabled:1,t.has_pricing=e.has_pricing?e.has_pricing:null,t.id=e.id?e.id:null,t.margin=e.margin?e.margin:null,t.code=e.code?e.code:null,t.modified_by=e.modified_by?e.modified_by:n,t.note=e.note?e.note:null,t.price=e.price?e.price:null,t.product_id=e.product_id?e.product_id:null,t.season_id=e.season_id?e.season_id:null,t.unit_id=e.unit_id?e.unit_id:null),Matrix.detail=t,t},i=function(e){let t=[];e&&e.matrices&&(t=e.matrices),function(e){Matrix.all=new Map,e||(e=[]),$.each(e,function(e,t){let a=o(t),n=t.code;Matrix.all.set(n,a)})}(t),l()},l=function(){e=document.getElementsByName("matrix_cost"),a=document.getElementsByName("matrix_price"),t=document.getElementsByName("matrix_margin"),e.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid})),a.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid})),t.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid}))};return{detail:{},all:new Map,set:function(e){return o(e)},init:function(e){i(e)},buildMatrixForm:function(){l()},loadPerUnitForm:function(){},loadPerPersonForm:function(){},loadPerDayForm:function(){}}}(),PricingStrategyTypes=function(){"use strict";document.getElementById("input_pricing_strategy_types_id"),document.getElementById("input_pricing_strategy_types_name"),document.getElementById("input_pricing_strategy_types_enabled"),document.getElementById("input_pricing_strategy_types_date_created"),document.getElementById("input_pricing_strategy_types_created_by"),document.getElementById("input_pricing_strategy_types_date_modified"),document.getElementById("input_pricing_strategy_types_modified_by"),document.getElementById("input_pricing_strategy_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),PricingStrategyTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,PricingStrategyTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);PricingStrategyTypes.all.set("id",n)})},save:function(e){},init:function(){}}}();PricingStrategyTypes.init();const RatingTypes=function(){"use strict";document.getElementById("input_rating_types_id"),document.getElementById("input_rating_types_name"),document.getElementById("input_rating_types_enabled"),document.getElementById("input_rating_types_date_created"),document.getElementById("input_rating_types_created_by"),document.getElementById("input_rating_types_date_modified"),document.getElementById("input_rating_types_modified_by"),document.getElementById("input_rating_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),RatingTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,RatingTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);RatingTypes.all.set("id",n)})},save:function(e){},init:function(){}}}(),SalesTypes=function(){"use strict";document.getElementById("input_sales_types_id"),document.getElementById("input_sales_types_name"),document.getElementById("input_sales_types_class"),document.getElementById("input_sales_types_sort_order"),document.getElementById("input_sales_types_enabled"),document.getElementById("input_sales_types_date_created"),document.getElementById("input_sales_types_created_by"),document.getElementById("input_sales_types_date_modified"),document.getElementById("input_sales_types_modified_by"),document.getElementById("input_sales_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let a={id:null,name:null,class:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.class=t.class?t.class:null,a.sort_order=t.sort_order?t.sort_order:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null),SalesTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var a;a=e,SalesTypes.all=new Map,a&&$.each(a,function(e,a){let n=t(a);SalesTypes.all.set("id",n)})},save:function(e){},init:function(){}}}(),StatusTypes=function(){"use strict";document.getElementById("input_status_types_id"),document.getElementById("input_status_types_name"),document.getElementById("input_status_types_enabled"),document.getElementById("input_status_types_date_created"),document.getElementById("input_status_types_created_by"),document.getElementById("input_status_types_date_modified"),document.getElementById("input_status_types_modified_by"),document.getElementById("input_status_types_note"),document.getElementById("input_status_types_sort_order");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(e){StatusTypes.all=new Map,e&&$.each(e,function(e,t){let a=n(t);a.id&&StatusTypes.all.set(a.id,a)})},a=function(e){let t="";e&&(t=e);Array.from(StatusTypes.all.values())},n=function(t){let a={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null,sort_order:null};return t&&(a.id=t.id?t.id:null,a.name=t.name?t.name:null,a.enabled=t.enabled?t.enabled:1,a.date_created=t.date_created?t.date_created:formatDateMySQL(),a.created_by=t.created_by?t.created_by:created_by,a.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),a.modified_by=t.modified_by?t.modified_by:modified_by,a.note=t.note?t.note:null,a.sort_order=t.sort_order?t.sort_order:null),StatusTypes.detail=a,a};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){t(e)},save:function(e){},init:function(e){!function(e){e&&e.status_types&&(t(e.status_types),a())}(e)}}}(),Types=function(){"use strict";document.getElementById("user_id")&&(isNaN(parseInt(document.getElementById("user_id").value))||parseInt(document.getElementById("user_id").value));const e=function(e,t){console.groupCollapsed("Types.setType"),$.each(e,function(e,a){Types[t].set(a.id,a)}),console.groupEnd()};return{allot_by:new Map,address_types:new Map,season_types:new Map,airport_types:new Map,categories_ratings_types:new Map,category:new Map,color_scheme:new Map,contact_types:new Map,currency:new Map,location_types:new Map,message_types:new Map,pricing_strategy_types:new Map,rating_types:new Map,sales_types:new Map,status_types:new Map,init:function(t){!function(t){console.groupCollapsed("Types.init"),console.log("settings",t),Types.address_types=new Map,Types.allot_by=new Map,Types.airport_types=new Map,Types.categories_ratings_types=new Map,Types.category=new Map,Types.color_scheme=new Map,Types.contact_types=new Map,Types.currency=new Map,Types.location_types=new Map,Types.message_types=new Map,Types.pricing_strategy_types=new Map,Types.rating_types=new Map,Types.sales_types=new Map,Types.status_types=new Map,Country.all=new Map,Province.all=new Map,City.all=new Map,t.address_types&&e(t.address_types,"address_types"),t.season_types&&(e(t.season_types,"season_types"),Season.init({seasons:t.season_types})),t.airport_types&&e(t.airport_types,"airport_types"),t.category&&(e(t.category,"category"),Category.init({categories:t.category})),t.color_scheme&&e(t.color_scheme,"color_scheme"),t.contact_types&&e(t.contact_types,"contact_types"),t.currency&&e(t.currency,"currency"),t.location_types&&e(t.location_types,"location_types"),t.message_types&&e(t.message_types,"message_types"),t.pricing_strategy_types&&e(t.pricing_strategy_types,"pricing_strategy_types"),t.rating_types&&e(t.rating_types,"rating_types"),t.sales_types&&e(t.sales_types,"sales_types"),t.status_types&&(e(t.status_types,"status_types"),StatusTypes.init({status_types:t.status_types})),t.allot_by&&e(t.allot_by,"allot_by"),t.countries&&Country.load_all(t.countries),t.provinces&&Province.loadAll(t.provinces),t.countries&&City.loadAll(t.cities),console.groupEnd()}(t)}}}(),Login=function(){"use strict";document.getElementById("dataToSend");const e=document.getElementById("email"),t=document.getElementById("password"),a=document.getElementById("button_login_submit"),n=document.getElementById("button_login_register"),o=document.getElementById("form_login"),i=document.getElementById("register_form_submit_button"),l=document.getElementById("register_page_form"),r=document.getElementById("register_page"),d=function(e,t){return Login.validator=validator_init(t),$(e).valid()},s=function(i){let l={rules:{email:{required:!0,email:!0},password:{required:!0}},messages:{email:{required:"Field Required",email:"Field invalid"},password:{required:"Field Required"}}};Login.validator=validator_init(l),$(n).on("click",function(){}),$(a).on("click",function(){s()});const r=function(e){toastr.error(e)},s=function(){if(d(o,l)){let a={email:e.value,password:t.value};!function(e){if(!e)return r("Error: 3");try{sendPostRequest("/api/v1.0/users/login",e,function(e,t,a){if(!e||!e.id)return r("Error Logging In: 1");e.id&&window.location.replace("/")})}catch(e){return r("Error: 2")}}(remove_nulls(a))}}};return{detail:{},all:new Map,validator:null,init:function(e){!function(e){o&&Login.login(e),r&&Login.register(e)}(e)},login:function(e){s()},register:function(e){!function(e){let t={rules:{user_name_first:{required:!0},user_name_last:{required:!0},user_email:{required:!0,email:!0},user_password:{required:!0,minlength:5},user_password_confirm:{required:!0,minlength:5,equalTo:"#user_password"}},messages:{user_name_first:{required:"Field Required"},user_name_last:{required:"Field Required"},user_email:{required:"Field Required",email:"Field invalid"},user_password:{required:"Field Required"}}};const a=document.getElementById("user_name_first"),n=document.getElementById("user_name_last"),o=document.getElementById("user_email"),r=document.getElementById("user_password");Login.validator=validator_init(t),$(i).on("click",function(){s()});const s=function(){if(d(l,t)){let e={name_first:a.value,name_last:n.value,email:o.value,password:r.value};c(remove_nulls(e))}},c=function(e){if(!e)return handle_login_error("Error: 3");try{sendPostRequest("/api/v1.0/users/register",e,function(e,t,a){if(!e||!e.id)return handle_login_error("Error Logging In: 1");e.id&&window.location.replace("/")})}catch(e){return handle_login_error("Error: 2")}}}()}}}();Login.init();const Provider=function(){"use strict";const t=document.getElementById("modal_product_category_id"),a=document.getElementById("button_add_provider_page_heading"),n=document.getElementById("button_edit_provider_name"),o=document.getElementById("button_save_provider"),i=document.getElementById("panel_tab_contact"),l=document.getElementById("panel_tab_vendor"),r=document.getElementById("panel_tab_address"),d=document.getElementById("panel_tab_provider"),s=document.getElementById("table_provider_index"),c=document.getElementById("location_id"),u=document.getElementById("company_name"),p=document.getElementById("provider_id"),_=document.getElementById("provider_name"),m=document.getElementById("provider_company_id"),g=document.getElementById("provider_enabled"),h=document.getElementById("provider_code_direct_id"),f=document.getElementById("vendor_name"),v=document.getElementById("vendor_company_id"),y=document.getElementById("company_id"),b=document.getElementById("location_name_filter_id"),I=document.getElementById("form_edit_provider"),E=document.getElementById("form_product_add"),w=document.getElementById("modal_product_provider_name"),C=document.getElementById("modal_product_provider_id"),k=document.getElementById("modal_product_vendor_id"),S=document.getElementById("modal_product_vendor_name"),N=document.getElementById("modal_product_vendor_company_id"),B=document.getElementById("modal_product_provider_company_id"),x=document.getElementById("modal_product_provider_vendor_match"),L=document.getElementById("modal_product_provider_location_id"),M=(document.getElementById("modal_product_location_id"),document.getElementById("product_edit_details_section_provider_form"),document.getElementById("product_edit_details_section_provider_form_filter")),P=document.getElementById("product_edit_details_section_provider_form_provider_id"),D=document.getElementById("product_edit_details_section_provider_form_submit_button"),F=document.getElementById("product_edit_details_section_provider_form_provider_company_id"),T=document.getElementById("product_edit_details_section_provider_form_details"),R=document.getElementById("product_edit_details_section_provider_form_provider_name"),A=document.getElementById("product_edit_details_section_provider_form_provider_phone_1"),q=document.getElementById("product_edit_details_section_provider_form_provider_phone_2"),O=document.getElementById("product_edit_details_section_provider_form_provider_fax"),Y=document.getElementById("product_edit_details_section_provider_form_provider_website"),U=document.getElementById("product_edit_details_section_provider_form_provider_email"),W=document.getElementById("product_edit_details_section_provider_form_provider_cover_image"),Q=document.getElementById("product_edit_details_section_provider_form_provider_enabled"),V=(document.getElementById("product_edit_details_section_provider_form_provider_note"),document.getElementById("product_edit_details_section_provider_form_provider_keywords"),document.getElementById("product_edit_details_section_provider_form_provider_description_long")),j=document.getElementById("product_edit_details_section_provider_form_provider_description_short"),z=document.getElementById("product_edit_details_section_provider_form_provider_logo"),H=document.getElementById("product_edit_details_section_provider_form_cancel_button"),K=document.getElementById("provider_keywords"),G=document.getElementById("product_edit_details_section_provider_form_reset_button"),J=document.getElementById("product_edit_provider_panel_link_product"),Z=document.getElementById("display_provider_name"),X=document.getElementById("display_provider_code_direct"),ee=document.getElementById("product_edit_details_section_provider_form_edit_button");let te,ae,ne,oe,ie=!1,le=$(s),re=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,de={rules:{provider_name:{required:!0},provider_company_id:{required:!0}},messages:{provider_company_id:{required:"Field Required"},provider_name:{required:"Field Required"}}};$(ee).on("click",function(){pe()}),$(G).on("click",function(){let e=ve();ue(e)}),$(D).on("click",function(){}),$(J).on("click",function(){pe()}),$(H).on("click",function(){ce(ae),_e()}),$(o).on("click",function(){let e=$("#provider_edit_tabs > li.nav-item > a.nav-link"),t=$("div.tab-pane"),a=Company.build(),n=Provider.build(),o=Location.build(),i=Vendor.build(),l=Array.from(Address.all.values()),r=Array.from(Contact.all.values());a&&n&&o&&i&&l&&r?(n.location_id=o.id?o.id:null,i.is_provider=I?1:0,confirmDialog("Would you like to update?",e=>{e&&fe({company_detail:a,provider_detail:n,location_detail:o,vendor_detail:i,addresses:l,contacts:r})})):$.each(t,function(a,n){if($(this).find(".is-invalid").length>0){let a=$("body").find("[aria-controls='"+$(this).attr("id")+"']");return e.removeClass("active"),t.removeClass("active"),$(this).addClass("active"),a.addClass("active"),!1}})}),$("#provider_edit").on("change",function(){Ee()}),$(m).on("change",function(){$(v).val($(this).val())}),$(a).on("click",function(){}),$(n).on("click",function(){ye()}),$(y).on("change",function(){$(m).val(y.value)});const se=/[^A-Za-z0-9]/g,ce=function(e){let t=ve(e),a=t.keywords?t.keywords:[],n=t.company.cover_image?t.company.cover_image:"/public/img/placeholder.jpg",o=t.company.logo?t.company.logo:"/public/img/placeholder.jpg",i=t.company.name?t.company.name:null,l=e.code_direct_id?e.code_direct_id:null;o=o.replace(se,""),n=n.replace(se,""),M.value=e.company.name?e.company.name:null,P.value=e.id?e.id:null,F.value=e.company_id?e.company_id:null,R.value=e.company.name?e.company.name:null,A.value=e.company.phone_1?e.company.phone_1:null,q.value=e.company.phone_2?e.company.phone_2:null,O.value=e.company.fax?e.company.fax:null,Y.value=e.company.website?e.company.website:null,U.value=e.company.email?e.company.email:null,V.value=e.description_long?e.description_long:null,j.value=e.description_short?e.description_short:null,Q.checked=e.enabled&&1===e.enabled,W.value=n.toString(),z.value=o.toString(),te=$(K).BuildKeyword(a),Z.innerText=i,X.innerText=l,Product.attr2=l},ue=function(){M.value="",P.value="",F.value="",R.value="",A.value="",q.value="",O.value="",Y.value="",U.value="",V.value="",j.value="",Q.checked=!0,W.value="/public/img/placeholder.jpg"},pe=function(){$(T).show(),$(ee).addClass("d-none"),$(G).removeClass("d-none"),$(D).removeClass("d-none"),$(H).removeClass("d-none")},_e=function(){$(T).hide(),$(ee).addClass("d-none"),$(G).addClass("d-none"),$(D).addClass("d-none"),$(H).addClass("d-none")},me=function(){le=$(s).table({table_type:"display_list",data:Provider.all,columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Code Direct ID",targets:1,data:"code_direct_id",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:2,data:"vendor",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e.sku+"</span>"}},{title:"Location",targets:3,data:"location",render:function(e,t,a,n){let o="";return"<span style='white-space: nowrap;'>"+(o=e.display_medium)+"</span>"}}],rowClick:Provider.navigate})},ge=function(e,t){if(e)try{sendPostRequest("/api/v1.0/providers/update",e,function(e,a,n){if(e)return t(e);$e("Oops: 1","Provider","error")})}catch(e){}},he=function(e){Provider.all=new Map,e&&$.each(e,function(e,t){let a=ve(t);le.insertRow(a),Provider.all.set(a.id,a)})},fe=function(e){e&&ge(e,function(e){if(e&&e[0]){let t=e[0];if(t.id)if(""===p.value||isNaN(parseInt(p.value)))window.location.replace("/providers/"+t.id);else{let e=u.value;toastr.success(`Provider ${e} has been updated.`)}}})},ve=function(e){let t={addresses:[],contacts:[],location:{},company:{},vendor:{},id:null,description_long:null,description_short:null,keywords:null,company_id:null,name:null,code_direct_id:null,provider_vendor:1,enabled:1,date_created:formatDateMySQL(),created_by:re,date_modified:formatDateMySQL(),modified_by:re,note:null};return e&&(t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.location_id=e.location_id?e.location_id:null,t.code_direct_id=e.code_direct_id?e.code_direct_id:null,t.description_long=e.description_long?e.description_long:null,t.description_short=e.description_short?e.description_short:null,t.keywords=e.keywords?e.keywords:null,t.provider_vendor=e.provider_vendor?e.provider_vendor:1,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.company_id=e.company_id?e.company_id:null,t.created_by=e.created_by?e.created_by:re,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:re,t.note=e.note?e.note:null,t.vendor=e.vendor?e.vendor:{},t.addresses=e.addresses?e.addresses:[],t.contacts=e.contacts?e.contacts:[],t.location=e.location?e.location:{},t.company=e.company?e.company:{}),Provider.detail=t,t},ye=function(){""!==p.value&&m.value},be=function(){$(_).attr("readonly",!0),I&&(ie||$(u).attr("readonly",!0))},Ie=function(e){e&&(p.value=e.id?e.id:null,$(_).val(e.name?e.name:null),$(u).val($(_).val()),m.value=e.company_id?e.company_id:null,h.value=e.code_direct_id?e.code_direct_id:null,g.checked=!e.enabled||1===e.enabled)},Ee=function(){isNaN(p.value)||p.value;let e=isNaN(m.value)?null:m.value;null===e||""===e?($(i).addClass("disabled"),$(r).addClass("disabled"),$(d).addClass("disabled"),$(l).addClass("disabled")):($(i).removeClass("disabled"),$(r).removeClass("disabled"),$(d).removeClass("disabled"),$(l).removeClass("disabled")),o.disabled=!(""!==y.value&&""!==b.value)},$e=function(e,t,a){t||(t="Product"),a||(a="error"),toastr[a](`${e}`,t)},we=function(e){if(e&&""!==e){let a={name:e};!function(e,t){if(e)try{sendGetRequest("/api/v1.0/providers/validate",e,function(e,a,n){if(e)return t(e);$e("Oops: 1")})}catch(e){$e("Error Validating Company")}else $e("Error Loading Company- Missing Data")}(a,function(e){let n;e&&0!==e.length?(n=e[0]?e[0]:e,E&&Se(n)):confirmDialog("This provider does not exist. Would you like to create it?",e=>{if(e){let e=a&&a.name?a.name:null;if(e){let a={name:e,status_id:10,enabled:1};Company.add(a,function(e){let a;if(!e)return $e("No Data","Error","error");{let n=(a=e[0]?e[0]:e)&&!isNaN(parseInt(a.id))?parseInt(a.id):null,o=a&&a.name?a.name:null;if(null===n||null===o)return $e("No Data","Error","error");B.value=n,N.value=n,w.value=o,S.value=o,x.checked=!0,function(e){if(e){let a={name:w.value,status_id:1,show_online:1,show_sales:1,show_ops:1,is_provider:1,enabled:1};Vendor.newVendor(a,function(a){let n,o={},i=t&&!isNaN(parseInt(t.value))?parseInt(t.value):null;a&&(n=a,a[0]&&(n=a[0]),e.location_id=e.location_id?e.location_id:1,e.vendor_id=n.id,ge(o={provider_detail:e},function(e){if(e){let t=e.length>0?e[0]:e;if(t){let e=ve(t),a=e.vendor?e.vendor:{},n=e.company?e.company:{},o=Types.category.get(i),l=o&&o.attribute_id?o.attribute_id:null,r=n&&n.name?n.name:null,d=e&&e.code_direct_id?e.code_direct_id:null,s=a&&a.sku?a.sku:null,c=n&&n.id&&!isNaN(parseInt(n.id))?parseInt(n.id):null,u=t&&t.id&&!isNaN(parseInt(t.id))?parseInt(t.id):null,p=a&&a.id&&!isNaN(parseInt(a.id))?parseInt(a.id):null;w.value=r,C.value=u,B.value=c,S.value=r,k.value=p,N.value=c,Ce(),Product.attr1=l,Product.attr2=d,Product.attr3=s,Product.updateProductSKU(),Product.enableNewFormDetails()}}}))})}}(remove_nulls({location_id:null,company_id:n,code_direct_id:null,id:null,provider_vendor:1,enabled:1}))}})}}else k.value="",C.value="",S.value="",w.value="",oe=!1}),I&&(e&&e.length>0&&(n=e[0],confirmDialog("This provider exists. Would you like to edit it?",e=>{e?window.location.href="/providers/"+n.id:(Company.reset_form(),Provider.resetForm(),Vendor.reset_form())})),$(f).val($(_).val()).trigger("change"))})}},Ce=function(){_&&$(_).on("change",function(){}).on("search",function(){Provider.resetForm(),Vendor.reset_form()}).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data,a=t.company?t.company:{},n=(t.addresses&&t.addresses,t.contacts&&t.contacts,t.location?t.location:{}),o=(t.vendor&&t.vendor,t.id),i=t.company.name,l=t.company.id;I&&($(m).val(l),$(p).val(o),confirmDialog("This provider exists. Would you like to edit it?",e=>{e?(window.location.replace("/providers/"+o),Ie(t),Company.populate_form(a),Location.populate_form(n),$(v).val(l),$(f).val(i).trigger("change")):(Provider.resetForm(),Vendor.reset_form())}))}}),M&&$(M).on("change",function(){setTimeout(function(){let e=M.value;!1===oe&&(""===e?(M.value="",F.value="",P.value="",oe=!1,$(F).val("").trigger("change"),$(P).val("").trigger("change")):we(e))},200)}).on("search",function(){}).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;ae=t;t.company&&t.company,t.addresses&&t.addresses,t.contacts&&t.contacts,t.location&&t.location,t.vendor&&t.vendor,t.id,t.company.name,t.company.id;ce(t)}}),w&&$(w).on("change",function(){setTimeout(function(){let e=w.value;!1===oe&&(""===e?ke():we(e))},200)}).on("search",function(){oe=!1,ke()}).on("keyup",function(){oe=!1}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){e.data&&(oe=!0,Se(e.data))}})},ke=function(){L.value="",C.value="",B.value="",k.value="",N.value="",S.value="",x.checked=!1,$(E).trigger("change")},Se=function(e){let a=t&&!isNaN(parseInt(t.value))?parseInt(t.value):null,n=Types.category.get(a),o=e&&e.company?e.company:{},i=(e&&e.addresses&&e.addresses,e&&e.contacts&&e.contacts,e&&e.location&&e.location,e&&e.vendor?e.vendor:{}),l=o&&o.id&&!isNaN(parseInt(o.id))?parseInt(o.id):null,r=o&&o.name?o.name:null,d=i&&i.id&&!isNaN(parseInt(i.id))?parseInt(i.id):null,s=e&&e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,c=e&&e.code_direct_id?e.code_direct_id:null,u=i&&i.sku?i.sku:null,p=e&&e.location_id&&!isNaN(parseInt(e.location_id))?parseInt(e.location_id):null,_=n&&n.attribute_id?n.attribute_id:null;ke(),L.value=p,w.value=r,C.value=s,B.value=l,k.value=d,N.value=l,S.value=r,x.checked=!0,Product.attr1=_,Product.attr2=c,Product.attr3=u,$(E).trigger("change"),Product.updateProductSKU()};return{validator:null,detail:{},all:new Map,navigate:function(e){!function(e){e&&e.id&&window.location.replace("/providers/"+e.id)}(e)},get:function(e){get(e)},build:function(){if($(I).valid())return remove_nulls({location_id:isNaN(parseInt(c.value))?null:parseInt(c.value),company_id:isNaN(parseInt(m.value))?null:parseInt(m.value),code_direct_id:""===h.value?null:h.value,id:isNaN(parseInt(p.value))?null:parseInt(p.value),provider_vendor:I?1:0,enabled:1})},load_all:function(e){he(e)},save:function(e){fe(e)},init:function(e){!function(e){let t;e&&e.provider_detail&&(t=ve(e.provider_detail))&&(ae=t,t.company&&Company.init(t.company)),M&&_e(),Ce()}(e)},resetForm:function(){p.value="",$(_).val("").trigger("change"),m.value="",h.value="",g.checked=!0},providerExists:function(e){we(e)},enable_form_fields:function(){ye()},disable_form_fields:function(){be()},index:function(e){var t;t=e,me(),t&&t.providers&&he(t.providers)},edit:function(e){!function(e){let t={},a=[],n=[],i={},s={},c={};I&&(Ce(),validator_init(de),ne=$(I).validate()),e&&(e.is_new&&(ie=e.is_new,o.disabled=!0,$(d).addClass("disabled"),$(l).addClass("disabled"),$(r).addClass("disabled")),e.provider_detail&&(a=(t=ve(e.provider_detail)).addresses?t.addresses:[],n=t.contacts?t.contacts:[],i=t.location?t.location:{},s=t.company?t.company:{},c=t.vendor?t.vendor:{})),Ie(t),Vendor.init(c),Location.init(i),Address.init(a),Contact.init(n),Company.init(s),Vendor.setProvider(),be(),Ee()}(e)}}}(),Profile=function(){"use strict";const e=document.getElementById("table_profile_product_edit");document.getElementById("product_edit_profile_form_profile_name_filter"),document.getElementById("product_edit_profile_form");let t=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(e);const a=function(e){let a={advanced_booking_date:null,advanced_booking_max:null,advanced_booking_min:null,allot_by_details:{created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},allot_by_id:null,checkin_dow:"",checkout_dow:"",created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),days_out:null,departure_dow:"",enabled:1,equal_duration:null,expires:null,id:null,inc_days_dow:"",max_duration:null,min_duration:1,min_length_days:1,modified_by:t,name:null,note:null,product_profile_details:{created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,modified_by:t,note:null,product_id:null,profile_id:null},quantity:null,release_amt:null,return_dow:"",sales_types_details:{class:null,created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},sales_types_id:null,transfer_sales_types_details:{class:null,created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},transfer_sales_types_id:null,weekday_dow:""};return e&&(a.advanced_booking_date=e.advanced_booking_date?e.advanced_booking_date:null,a.advanced_booking_max=e.advanced_booking_max?e.advanced_booking_max:null,a.advanced_booking_min=e.advanced_booking_min?e.advanced_booking_min:null,a.allot_by_details.created_by=e.created_by?e.created_by:null,a.allot_by_details.date_created=e.date_created?e.date_created:formatDateMySQL(),a.allot_by_details.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),a.allot_by_details.enabled=e.enabled?e.enabled:1,a.allot_by_details.id=e.id?e.id:null,a.allot_by_details.modified_by=e.modified_by?e.modified_by:t,a.allot_by_details.name=e.name?e.name:null,a.allot_by_details.note=e.note?e.note:null,a.allot_by_details.sort_order=e.sort_order?e.sort_order:999),a},n=function(e){let t=[];e&&e.profiles&&(t=e.profiles),function(e){Profile.all=new Map,e||(e=[]),$.each(e,function(e,t){a(t)})}(t)};return{all:new Map,init:function(e){n(e)},edit:function(e){}}}();function FileManager(e,t){if(console.groupCollapsed("FileManager"),!(t&&t.source&&e))return console.log("Missing options."),console.log("options",t),console.log("options.source",t.source),void console.log("options.sourceId",t.sourceId);let a=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,n=t.source,o=t.sourceId,i="file_manager_"+n,l={defaultFile:"",maxFileSize:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,showRemove:!0,showLoader:!0,showErrors:!0,errorTimeout:3e3,errorsPosition:"overlay",imgFileExtensions:["png","jpg","jpeg","gif","bmp","webp"],maxFileSizePreview:"5M",allowedFormats:["portrait","square","landscape"],allowedFileExtensions:["*"],urls:{remove:"/",update:"/",get:"get",upload:"/"},messages:{default:"Drag and drop a file here or click",replace:"Drag and drop or click to replace",remove:"Remove",error:"Ooops, something wrong happended."},error:{fileSize:"The file size is too big ({{ value }} max).",minWidth:"The image width is too small ({{ value }}}px min).",maxWidth:"The image width is too big ({{ value }}}px max).",minHeight:"The image height is too small ({{ value }}}px min).",maxHeight:"The image height is too big ({{ value }}px max).",imageFormat:"The image format is not allowed ({{ value }} only).",fileExtension:"The file is not allowed ({{ value }} only)."},tpl:{gallery:{wrap:""},preview:{wrapper:`<section id="${i}_preview" class="mb-4 p-0 filemanager-preview-wrapper d-flex align-items-center justify-content-center" />`,error:`<img id="${i}_image" src="/public/img/placeholder.jpg" alt="Preview Placeholder" class="img-fluid" />`,container:'<div class="filemanager-preview "/>',loader:"<div class='filemanager-loader'></div>",message:'<div class="filemanager-message w-100 text-center d-flex flex-column"><i class="fas fa-upload w-100 fa-4x mb-2"></i><p class="w-100 mt-4">Drag and drop a file here or click</p></div>',errorsContainer:'<div class="filemanager-errors-container"><ul></ul></div>',errorLine:'<p class="filemanager-error"></p>',clearButton:'<button type="button" class="filemanager-clear">remove</button>'},filename:'<p class="fileManager-filename"><span class="fileManager-filename-inner"></span></p>'}};this.userId=a,this.element=e,this.source=n,this.sourceId=o,this.baseId=i,this.isInit=!1,this.errorsEvent=$.Event("filemanager.errors"),this.errorsEvent.errors=[],this.isDisabled=!1,this.all=new Map,this.images=t.images?t.images:[],this.inputs={labels:{},buttons:{},fields:{},displays:{},errors:{}},this.detail={alt:null,caption:null,created_by:a,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),dimensions:null,enabled:1,extension:null,height:null,id:null,is_cover:0,is_shown:1,modified_by:a,name:null,note:null,path:null,size:null,thumbs_path:null,title:null,width:null},this.file={object:null,name:null,size:null,width:null,height:null,type:null},this.settings=$.extend(!0,l,t),Array.isArray(this.settings.allowedFormats)||(this.settings.allowedFormats=this.settings.allowedFormats.split(" ")),Array.isArray(this.settings.allowedFileExtensions)||(this.settings.allowedFileExtensions=this.settings.allowedFileExtensions.split(" ")),this.uploadProgress=this.uploadProgress.bind(this),this.uploadComplete=this.uploadComplete.bind(this),this.uploadFailed=this.uploadFailed.bind(this),this.uploadCanceled=this.uploadCanceled.bind(this),this.validate=this.validate.bind(this),this.isShown=this.isShown.bind(this),this.isCover=this.isCover.bind(this),this.clearElement=this.clearElement.bind(this),this.formHide=this.formHide.bind(this),this.formShow=this.formShow.bind(this),this.formRemove=this.formRemove.bind(this),this.formCancel=this.formCancel.bind(this),this.onChange=this.onChange.bind(this),this.formClear=this.formClear.bind(this),this.fileSelected=this.fileSelected.bind(this),this.formReset=this.formReset.bind(this),this.open=this.open.bind(this),this.load=this.load.bind(this),this.onFileReady=this.onFileReady.bind(this),this.displaySet=this.displaySet.bind(this),this.buildImageThumbnails=this.buildImageThumbnails.bind(this),this.formUpload=this.formUpload.bind(this),this.sendUpdateRequest=this.sendUpdateRequest.bind(this),this.init(t),this.createElements(),this.assignEvents(),this.loadAll(),this.formReset(),console.groupEnd()}FileManager.prototype.createPreviewElements=function(){let e;console.groupCollapsed("FileManager.createPreviewElements"),this.previewWrapper=$(this.settings.tpl.preview.wrapper),this.previewLoader=$(this.settings.tpl.preview.loader),this.previewContainer=$(this.settings.tpl.preview.container),this.previewMessage=$(this.settings.tpl.preview.message),this.previewWrapper.append(this.previewContainer),e=$(this.settings.tpl.preview.message).insertBefore(this.previewContainer),$(this.settings.tpl.preview.errorLine).appendTo(e),!0===this.settings.showLoader&&(this.loader=$(this.settings.tpl.preview.loader),this.previewWrapper.append(this.loader),this.hideLoader()),!0===this.settings.showErrors&&(this.previewErrorsContainer=$(this.settings.tpl.preview.errorsContainer),"outside"===this.settings.errorsPosition?this.previewErrorsContainer.insertAfter(this.previewWrapper):this.previewWrapper.append(this.previewErrorsContainer)),!1===this.isDisabled&&!0===this.settings.showRemove&&(this.clearButton=$(this.settings.tpl.preview.clearButton),this.previewWrapper.append(this.clearButton),this.clearButton.on("click",this.clearElement));let t=this.settings.defaultFile||"";""!==t.trim()&&(this.file.name=this.cleanFilename(t),this.setPreview(this.isImage(),t)),this.preview=this.previewWrapper,console.groupEnd()},FileManager.prototype.setPreview=function(e,t){console.groupCollapsed("FileManager.setPreview");let a=this.previewContainer;if(this.hideLoader(),this.preview.removeClass("has-error").addClass("has-preview"),!0===e){let e=$("<img alt='File Preview' class='img-fluid' src='"+t+"'/>");this.settings.height&&e.css("max-height",this.settings.height),this.previewContainer.empty(),e.appendTo(a)}else $("<i />").attr("class","filemanager-font-file").appendTo(a),$('<span class="filemanager-extension" />').html(this.getFileType()).appendTo(a);this.formShow(),console.groupEnd()},FileManager.prototype.resetPreview=function(){console.groupCollapsed("FileManager.resetPreview");let e=this.previewContainer;this.preview.removeClass("has-error"),this.preview.removeClass("has-preview"),e.find(".filemanager-extension").remove(),e.find("i").remove(),e.find("img").remove(),this.hideLoader(),console.groupEnd()},FileManager.prototype.clearElement=function(){if(console.groupCollapsed("FileManager.clearElement"),0===this.errorsEvent.errors.length){let e=$.Event("filemanager.beforeClear");this.inputs.fields.imageFile.trigger(e,[this]),!1!==e.result&&(this.resetFile(),this.inputs.fields.imageFile.val(""),this.resetPreview(),this.inputs.fields.imageFile.trigger($.Event("filemanager.afterClear"),[this])),this.formClear(),this.displayClear(),this.formHide()}console.groupEnd()},FileManager.prototype.hideLoader=function(e){console.groupCollapsed("FileManager.hideLoader"),$(this.loader).hide(),console.groupEnd()},FileManager.prototype.showLoader=function(e){console.groupCollapsed("FileManager.showLoader"),$(this.loader).show(),console.groupEnd()},FileManager.prototype.clearErrors=function(){console.groupCollapsed("FileManager.clearErrors"),this.preview.removeClass("has-errors"),void 0!==this.previewErrorsContainer&&this.previewErrorsContainer.children("ul").html(""),console.groupEnd()},FileManager.prototype.pushError=function(e){console.groupCollapsed("FileManager.pushError");let t=$.Event("filemanager.error."+e);this.errorsEvent.errors.push(t),this.inputs.fields.imageFile.trigger(t,[this]),console.groupEnd()},FileManager.prototype.showError=function(e){console.groupCollapsed("FileManager.showError"),void 0!==this.previewErrorsContainer&&this.previewErrorsContainer.children("ul").append("<li>"+this.getError(e)+"</li>"),console.groupEnd()},FileManager.prototype.getError=function(e){console.groupCollapsed("FileManager.getError");let t=this.settings.error[e],a="";return"fileSize"===e?a=this.settings.maxFileSize:"minWidth"===e?a=this.settings.minWidth:"maxWidth"===e?a=this.settings.maxWidth:"minHeight"===e?a=this.settings.minHeight:"maxHeight"===e?a=this.settings.maxHeight:"imageFormat"===e?a=this.settings.allowedFormats.join(", "):"fileExtension"===e&&(a=this.settings.allowedFileExtensions.join(", ")),""!==a?t.replace("{{ value }}",a):(console.groupEnd(),t)},FileManager.prototype.createElements=function(){console.groupCollapsed("FileManager.createElements"),this.isInit=!0,this.inputs.buttons.close=$(`<a href="javascript:void(0);" id="${this.baseId+"_form_button_close"}" class="panel-button-close fas fa-times"/>`),this.inputs.buttons.upload=$(`<button type="button" id="${this.baseId+"_form_button_upload"}" name="submit" class="btn btn-primary btn-sm waves-effect waves-light" >upload</button>`),this.inputs.buttons.clear=$(`<button type="button" id="${this.baseId+"_form_button_clear"}" name="clear" class="btn btn-flat primary-text text-center p-1 mx-0 mb-0 waves-effect waves-light" >clear</button>`),this.inputs.buttons.cancel=$(`<button type="button" id="${this.baseId+"_form_button_cancel"}" name="cancel" class="btn btn-danger btn-sm waves-effect waves-light" >cancel</button>`),this.inputs.buttons.remove=$(`<button type="button" id="${this.baseId+"_form_button_remove"}" name="remove" class="btn btn-outline-danger btn-sm waves-effect waves-ligh" >remove</button>`),this.inputs.fields.imageFile=$(`<input type="file" id="${this.baseId+"_form_file_upload"}" name="${this.baseId+"_form_file_upload"}" />`),this.inputs.fields.imageId=$(`<input type="text" id="${this.baseId+"_form_id"}" name="${this.baseId+"_form_id"}" value="" placeholder="" class="form-control" readonly="readonly"/>`),this.inputs.fields.imageName=$(`<input type="text" id="${this.baseId+"_form_name"}" name="${this.baseId+"_form_name"}" value="" placeholder="" class="form-control" readonly="readonly"/>`),this.inputs.fields.imageEnabled=$(`<input type="checkbox" id="${this.baseId+"_form_enabled"}" name="${this.baseId+"_form_enabled"}" value="1" class="custom-control-input" />`),this.inputs.fields.imageIsShown=$(`<input type="checkbox" id="${this.baseId+"_form_is_shown"}" name="${this.baseId+"_form_is_shown"}" value="1" class="custom-control-input" />`),this.inputs.fields.imageIsCover=$(`<input type="checkbox" id="${this.baseId+"_form_is_cover"}" name="${this.baseId+"_form_is_cover"}" value="1" class="custom-control-input" />`),this.inputs.fields.imageCaption=$(`<textarea id="${this.baseId+"_form_caption"}" name="${this.baseId+"_form_caption"}" class="md-textarea short-description form-control" rows="4" maxlength="200"/>`),this.inputs.fields.imageAlt=$(`<input type="text" id="${this.baseId+"_form_alt"}" name="${this.baseId+"_form_alt"}" class="form-control"/>`),this.inputs.fields.imageTitle=$(`<input type="text" id="${this.baseId+"_form_title"}" name="${this.baseId+"_form_title"}" class="form-control"/>`),this.input=this.inputs.fields.imageFile,this.inputs.errors.imageFile=$(`<div id="${this.baseId+"_form_enabled"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageId=$(`<div id="${this.baseId+"_form_id"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageName=$(`<div id="${this.baseId+"_form_name"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageEnabled=$(`<div id="${this.baseId+"_form_enabled"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageIsShown=$(`<div id="${this.baseId+"_form_is_shown"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageIsCover=$(`<div id="${this.baseId+"_form_is_cover"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageCaption=$(`<div id="${this.baseId+"_form_caption"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageAlt=$(`<div id="${this.baseId+"_form_alt"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageTitle=$(`<div id="${this.baseId+"_form_title"}-error" class="error w-100 text-center"/>`),this.inputs.labels.imageEnabled=$(`<label for="${this.baseId+"_form_enabled"}" class="custom-control-label p-0">Enabled</label>`),this.inputs.labels.imageIsShown=$(`<label for="${this.baseId+"_form_is_shown"}" class="custom-control-label p-0">Shown</label>`),this.inputs.labels.imageIsCover=$(`<label for="${this.baseId+"_form_is_cover"}" class="custom-control-label p-0">Cover</label>`),this.inputs.labels.imageId=$(`<label for="${this.baseId+"_form_enabled"}" >Id:</label>`),this.inputs.labels.imageTitle=$(`<label for="${this.baseId+"_form_title"}" >Title:</label>`),this.inputs.labels.imageAlt=$(`<label for="${this.baseId+"_form_alt"}" >Alt:</label>`),this.inputs.labels.imageCaption=$(`<label for="${this.baseId+"_form_caption"}" >Caption:</label>`),this.inputs.labels.imageNameField=$(`<label for="${this.baseId+"_form_name"}" >Name:</label>`),this.inputs.labels.imageNameDetail=$('<span class="font-weight-bolder" >Name:</span>'),this.inputs.labels.imageRatio=$('<span class="font-weight-bolder" >Ratio:</span>'),this.inputs.labels.imageSize=$('<span class="font-weight-bolder" >Size:</span>'),this.inputs.labels.imageExtension=$('<span class="font-weight-bolder" >Extension:</span>'),this.inputs.labels.imageDimensions=$('<span class="font-weight-bolder" >Dimensions:</span>'),this.inputs.labels.imageType=$('<span class="font-weight-bolder" >Type:</span>'),this.inputs.labels.imageHeight=$('<span class="font-weight-bolder" >Height:</span>'),this.inputs.labels.imageWidth=$('<span class="font-weight-bolder" >Width:</span>'),this.inputs.displays.imageRatio=$(`<span id="${this.baseId+"_form_ratio"}" />`),this.inputs.displays.imageHeight=$(`<span id="${this.baseId+"_form_height"}" />`),this.inputs.displays.imageWidth=$(`<span id="${this.baseId+"_form_width"}" />`),this.inputs.displays.imageSize=$(`<span id="${this.baseId+"_form_size"}" />`),this.inputs.displays.imageExtension=$(`<span id="${this.baseId+"_form_extension"}"/>`),this.inputs.displays.imageName=$(`<span id="${this.baseId+"_form_name"}" />`),this.inputs.displays.imageDimensions=$(`<span id="${this.baseId+"_form_dimensions"}" />`),this.inputs.displays.imageType=$(`<span id="${this.baseId+"_form_type"}" />`),this.createPreviewElements(),this.detailSection=$(`<section id="${this.baseId+"_detail"}" class="card card-body grey lighten-3 p-3 mb-2"/>`),this.render(),console.groupEnd()},FileManager.prototype.fileGallery=function(){console.groupCollapsed("FileManager.fileGallery");let e,t,a,n,o,i,l,r,d,s,c,u=this.source?this.source.ucwords()+" Images:":"Files";return d=$("<i/>",{class:"fas fa-sliders-h"}),t=$("<span/>",{text:u}),this.inputs.buttons.toggle=$("<a/>",{id:this.baseId+"_gallery_toggle"}).append(d),o=$('<hr class="ml-3 mr-3 mt-1 mb-3 color-dark"/>'),(a=$("<h5/>",{class:"card-title label",id:this.baseId+"_gallery_heading"})).append(t),e=$("<div/>",{class:"d-flex justify-content-between"}).append(a,this.inputs.buttons.toggle),this.galleryContainer=$("<div/>",{id:this.baseId+"_gallery_container",class:"row"}),r=$("<span/>",{text:"Choose File",id:this.baseId+"_gallery_file_upload_label"}),this.inputs.fields.imageFileButton=$("<div/>",{class:"btn btn-secondary btn-sm waves-effect waves-light"}).append(r,this.inputs.fields.imageFile),l=$("<div/>",{class:"d-flex justify-content-end mb-2"}).append(this.inputs.fields.imageFileButton),i=$("<div/>",{class:"file-field"}).append(l),s=$("<div/>",{class:"col-12"}).append(i),c=$("<div/>",{class:"row"}).append(s),n=$("<section/>",{class:"card card-body z-depth-0 mb-2",id:this.baseId+"_gallery"}).append(e,o,this.galleryContainer,c),console.groupEnd(),n},FileManager.prototype.fileFormFields=function(){let e,t,a,n,o,i,l,r,d,s,c,u,p,_,m,g,h,f,v,y,b,I,E,w,C,k,S,N,B,x,L;return console.groupCollapsed("FileManager.fileFormFields"),y=$("<div class='form-element'/>"),b=$("<div class='form-element'/>"),I=$("<div class='form-element'/>"),E=$("<div class='form-element'/>"),w=$("<div class='form-element'/>"),S=$("<div class='form-element mb-4'/>"),k=$("<div class='form-element'/>"),C=$("<div class='form-element'/>"),r=$("<div/>",{class:"custom-control custom-switch"}).append(this.inputs.fields.imageEnabled,this.inputs.labels.imageEnabled),d=$("<div/>",{class:"custom-control custom-switch"}).append(this.inputs.fields.imageIsShown,this.inputs.labels.imageIsShown),s=$("<div/>",{class:"custom-control custom-switch"}).append(this.inputs.fields.imageIsCover,this.inputs.labels.imageIsCover),y.append(this.inputs.labels.imageId,this.inputs.fields.imageId,this.inputs.errors.imageId),b.append(this.inputs.labels.imageNameField,this.inputs.fields.imageName,this.inputs.errors.imageName),I.append(r,this.inputs.errors.imageEnabled),w.append(s,this.inputs.errors.imageIsCover),E.append(d,this.inputs.errors.imageIsShown),C.append(this.inputs.labels.imageTitle,this.inputs.fields.imageTitle,this.inputs.errors.imageTitle),k.append(this.inputs.labels.imageAlt,this.inputs.fields.imageAlt,this.inputs.errors.imageAlt),S.append(this.inputs.labels.imageCaption,this.inputs.fields.imageCaption,this.inputs.errors.imageCaption),this.inputs.fields.progress=$(`<div id="${this.baseId+"_progress"}" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"/>`),L=$("<div class='progress'/>").append(this.inputs.fields.progress),c=$("<div/>",{class:"col-12 col-md-6"}).append(y),u=$("<div/>",{class:"col-12 col-md-6"}).append(b),p=$("<div/>",{class:"col-12 col-md-4 d-flex align-self-end justify-content-center pb-2 mb-2 mt-4"}).append(I),_=$("<div/>",{class:"col-12 col-md-4 d-flex align-self-end justify-content-center pb-2 mb-2 mt-4"}).append(E),m=$("<div/>",{class:"col-12 col-md-4 d-flex align-self-end justify-content-center pb-2 mb-2 mt-4"}).append(w),g=$("<div/>",{class:"col-12"}).append(C),h=$("<div/>",{class:"col-12"}).append(k),f=$("<div/>",{class:"col-12"}).append(S),v=$("<div/>",{class:"col-12"}).append(L),B=$("<div/>",{class:"col-12 col-md-6 text-left"}).append(this.inputs.buttons.cancel,this.inputs.buttons.remove),x=$("<div/>",{class:"col-12 col-md-6 text-right"}).append(this.inputs.buttons.clear,this.inputs.buttons.upload),t=$("<div/>",{class:"row"}).append(c,u),a=$("<div/>",{class:"row"}).append(p,_,m),n=$("<div/>",{class:"row"}).append(g),o=$("<div/>",{class:"row"}).append(h),i=$("<div/>",{class:"row"}).append(f),l=$("<div/>",{class:"row mt-2"}).append(v),N=$("<div/>",{class:"row mt-2"}).append(B,x),e=$("<section/>",{id:this.baseId+"_form_data"}).append(t,a,n,o,i,l,N),console.groupEnd(),e},FileManager.prototype.fileForm=function(){let e,t,a,n;console.groupCollapsed("FileManager.fileForm");return this.form=$(`<form id="${this.baseId}_form" class="card card-body z-depth-0 mb-2" novalidate="novalidate"/>`),t=$("<span/>",{text:"Image"}),a=$("<h5/>",{class:"card-title",id:this.baseId+"_form_heading"}),e=$("<h6/>",{id:this.baseId+"_form_subheading"}),n=$('<hr class="ml-3 mr-3 mt-1 mb-3 color-dark"/>'),a.append(t,this.inputs.buttons.close),this.form.append(a,e,n,this.preview,this.fileDetail(this),this.fileFormFields(this)),console.groupEnd(),this.form},FileManager.prototype.fileDetail=function(){let e,t,a,n,o,i,l,r,d,s,c,u,p,_,m,g,h,f,v,y;return console.groupCollapsed("FileManager.fileDetail"),o=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageNameDetail),i=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageName),l=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageSize),r=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageSize),d=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageDimensions),s=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageDimensions),c=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageRatio),u=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageRatio),p=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageHeight),_=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageHeight),m=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageWidth),g=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageWidth),h=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageType),f=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageType),v=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageExtension),y=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageExtension),e=$("<div/>",{class:"row"}).append(o,i,l,r),t=$("<div/>",{class:"row"}).append(d,s,c,u),a=$("<div/>",{class:"row"}).append(p,_,m,g),n=$("<div/>",{class:"row"}).append(h,f,v,y),this.detailSection.append(e,t,a,n),console.groupEnd(),this.detailSection},FileManager.prototype.formShow=function(){console.groupCollapsed("FileManager.formShow");let e=document.getElementById(this.inputs.fields.imageFile.attr("id")),t=document.getElementById(this.inputs.buttons.toggle.attr("id"));this.form.show(),t.disabled=!0,e.disabled=!0,console.groupEnd()},FileManager.prototype.formHide=function(){console.groupCollapsed("FileManager.formHide");let e=document.getElementById(this.inputs.fields.imageFile.attr("id")),t=document.getElementById(this.inputs.buttons.toggle.attr("id"));this.form.hide(),this.inputs.buttons.upload.html("upload"),t.disabled=!1,e.disabled=!1,console.groupEnd()},FileManager.prototype.formClear=function(){console.groupCollapsed("FileManager.formClear");let e=document.getElementById(this.inputs.fields.progress.attr("id"));$(this.inputs.fields.imageId).val(""),$(this.inputs.fields.imageName).val(""),$(this.inputs.fields.imageAlt).val(""),$(this.inputs.fields.imageTitle).val(""),$(this.inputs.fields.imageCaption).val(""),$(this.inputs.fields.imageIsCover).attr("checked",!1),$(this.inputs.fields.imageEnabled).attr("checked",!0),$(this.inputs.fields.imageIsShown).attr("checked",!0),$("img.selected").removeClass("selected"),$(e).css({width:"0%","background-color":"#007bff",color:"#fff"}),clearValidation(this.form),console.groupEnd()},FileManager.prototype.formReset=function(){console.groupCollapsed("FileManager.formReset"),this.formClear(),this.displayClear(),this.resetPreview(),this.clearSelected(),console.groupEnd()},FileManager.prototype.formCancel=function(){console.groupCollapsed("FileManager.formCancel"),this.formReset(),this.formHide(),console.groupEnd()},FileManager.prototype.formRemove=function(){console.groupCollapsed("FileManager.formRemove");const e=this.inputs.fields.imageId[0];let t=this;if(e){let a=isNaN(parseInt(e.value))?null:parseInt(e.value);if(null!==a){console.log("imageId",a);let e=t.all.get(a);if(e){console.log("image",e);let n=document.getElementById("image_"+a);n&&confirmDialog("Would you like to delete this image?",e=>{e&&this.sendRemoveRequest({image_id:a,source:t.source,source_id:t.sourceId},function(e){e&&e.deleted&&(!0!==e.deleted&&"true"!==e.deleted||(t.all.delete(a),$(n).parent("div").remove(),t.formReset(),t.formHide(),toastr.success("File Removed","File Manager")))})})}}}console.groupEnd()},FileManager.prototype.formLoad=function(e){if(console.groupCollapsed("FileManager.formLoad"),e){let t=isNaN(parseInt(e.id))?null:parseInt(e.id),a=e.name?e.name:null,n=e.title?e.title:null,o=e.alt?e.alt:null,i=e.caption?e.caption:null,l=e.enabled&&1===e.enabled,r=!(!e.is_shown||1!==e.is_shown),d=!(!e.is_cover||1!==e.is_cover),s=e.path?e.path:null,c=e.name?e.name:null,u=e.extension?e.extension:null;console.log("imageId",t),console.log("imageName",a),console.log("imageTitle",n),console.log("imageAlt",o),console.log("imageCaption",i),console.log("imageEnabled",l),console.log("imageIsShown",r),console.log("imageIsCover",d),$(this.inputs.fields.imageId).val(t),$(this.inputs.fields.imageName).val(a),$(this.inputs.fields.imageAlt).val(o),$(this.inputs.fields.imageTitle).val(n),$(this.inputs.fields.imageCaption).val(i),$(this.inputs.fields.imageIsCover).attr("checked",d),$(this.inputs.fields.imageEnabled).attr("checked",l),$(this.inputs.fields.imageIsShown).attr("checked",r);let p=is_null(s)||is_null(c)||is_null(u)?this.settings.defaultFile?this.settings.defaultFile:null:`${s}/${c}.${u}`;console.log("path",p),this.setPreview(this.isImage(),p),this.displaySet(),this.form.show()}console.groupEnd()},FileManager.prototype.displayReset=function(){console.groupCollapsed("FileManager.displayReset"),this.displayClear(),console.groupEnd()},FileManager.prototype.displayClear=function(){console.groupCollapsed("FileManager.displayClear"),$(this.inputs.displays.imageName).html("&nbsp;"),$(this.inputs.displays.imageType).html("&nbsp;"),$(this.inputs.displays.imageRatio).html("&nbsp;"),$(this.inputs.displays.imageExtension).html("&nbsp;"),$(this.inputs.displays.imageDimensions).html("&nbsp;"),$(this.inputs.displays.imageSize).html("&nbsp;"),$(this.inputs.displays.imageHeight).html("&nbsp;"),$(this.inputs.displays.imageWidth).html("&nbsp;"),console.groupEnd()},FileManager.prototype.displaySet=function(){let e,t,a,n,o,i,l,r;console.groupCollapsed("FileManager.displaySet"),this.displayReset(),e=this.detail.name?this.detail.name:"&nbsp;",t=this.detail.type?this.detail.type:"&nbsp;",a=this.detail.ratio?this.detail.ratio:"&nbsp;",n=this.detail.extension?this.detail.extension:"&nbsp;",o=this.detail.dimensions?this.detail.dimensions:"&nbsp;",i=this.detail.size?this.detail.size:"&nbsp;",l=isNaN(parseInt(this.detail.height))?"&nbsp;":this.detail.height+"px",r=isNaN(parseInt(this.detail.width))?"&nbsp;":this.detail.width+"px",$(this.inputs.displays.imageName).html(e),$(this.inputs.displays.imageType).html(t),$(this.inputs.displays.imageRatio).html(a),$(this.inputs.displays.imageExtension).html(n),$(this.inputs.displays.imageDimensions).html(o),$(this.inputs.displays.imageSize).html(i),$(this.inputs.displays.imageHeight).html(l),$(this.inputs.displays.imageWidth).html(r),console.groupEnd()},FileManager.prototype.handleError=function(e,t,a){console.groupCollapsed("FileManager.handleError"),a||(a="error"),t||(t="File Manager"),toastr[a](e,t),console.groupEnd()},FileManager.prototype.defaultDetail=function(){console.groupCollapsed("FileManager.defaultDetail"),this.detail={alt:null,caption:null,created_by:this.userId,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),dimensions:null,enabled:1,extension:null,height:null,id:null,is_cover:0,is_shown:1,modified_by:this.userId,name:null,note:null,path:null,size:null,thumbs_path:null,title:null,width:null},console.groupEnd()},FileManager.prototype.setDetail=function(e){return console.groupCollapsed("FileManager.setDetail"),this.defaultDetail(),e&&(this.detail.alt=e.alt?e.alt:null,this.detail.caption=e.caption?e.caption:null,this.detail.created_by=isNaN(parseInt(this.created_by))?this.userId:parseInt(this.created_by),this.detail.date_created=e.date_created?e.date_created:formatDateMySQL(),this.detail.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),this.detail.dimensions=e.dimensions?e.dimensions:null,this.detail.enabled=e.enabled&&1===e.enabled?1:0,this.detail.extension=e.extension?e.extension:null,this.detail.height=isNaN(parseInt(e.height))?null:parseInt(e.height),this.detail.id=isNaN(parseInt(e.id))?null:parseInt(e.id),this.detail.is_cover=e.is_cover&&1===e.is_cover?1:0,this.detail.is_shown=e.is_shown&&1===e.is_shown?1:0,this.detail.modified_by=isNaN(parseInt(this.modified_by))?this.userId:parseInt(this.modified_by),this.detail.name=e.name?e.name:null,this.detail.note=e.note?e.note:null,this.detail.path=e.path?e.path:null,this.detail.size=e.size?e.size:null,this.detail.thumbs_path=e.thumbs_path?e.thumbs_path:null,this.detail.title=e.title?e.title:null,this.detail.width=isNaN(parseInt(e.width))?null:parseInt(e.width),this.setFile(e),console.log("this.detail",this.detail),console.log("this.file",this.file)),console.groupEnd(),this.detail},FileManager.prototype.loadAll=function(){console.log("FileManager.loadAll"),this.images||(this.images=[]);let e=new Map,t=this;$.each(this.images,function(a,n){t.setDetail(n),e.set(n.id,n),t.galleryContainer.append(t.buildImageThumbnails(n))}),this.all=e,console.groupEnd()},FileManager.prototype.buildImageThumbnails=function(e){console.log("FileManager.buildImageThumbnails");let t="",a="";if(e){let n=this,o=(e.path&&e.path,e.alt?e.alt:null),i=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,l=!(!e.is_cover||1!==e.is_cover),r=!(!e.is_shown||1!==e.is_shown),d=e.thumbs_path?e.thumbs_path:null,s=e.path?e.path:null,c=e.name?e.name:null,u=e.extension?e.extension:null;if(l&&(t="is-cover-image"),r&&(a="is-shown"),null!==d&&null!==s&&null!==c&&null!==u){let l=$(`<img id="image_${i}" data-id="${i}" class="img-thumbnail ${t} ${a}" alt="${o}" src="${d}/${c}.${u}" />`);return l.on("click",function(){n.edit(e.id)}),$("<div/>",{class:"col-12 col-md-4 mb-2"}).append(l)}}console.groupEnd()},FileManager.prototype.clearSelected=function(){console.log("FileManager.clearSelected"),$("img.selected").removeClass("selected"),console.groupEnd()},FileManager.prototype.translateMessages=function(){console.groupCollapsed("FileManager.translateMessages");for(let e in this.settings.tpl){console.log("name",e);for(let t in this.settings.messages)console.log("|__ key",t),this.settings.tpl[e]?this.settings.tpl[e]=this.settings.tpl[e].replace("{{ "+t+" }}",this.settings.messages[t]):this.settings.tpl.preview[e]&&(this.settings.tpl.preview[e]=this.settings.tpl.preview[e].replace("{{ "+t+" }}",this.settings.messages[t]))}console.groupEnd()},FileManager.prototype.cleanFilename=function(e){console.groupCollapsed("FileManager.cleanFilename");let t=e.split("\\").pop();return t===e&&(t=e.split("/").pop()),console.groupEnd(),""!==e?t:""},FileManager.prototype.validateImage=function(){console.groupCollapsed("FileManager.validateImage"),0!==this.settings.minWidth&&this.settings.minWidth>=this.file.width&&this.pushError("minWidth"),0!==this.settings.maxWidth&&this.settings.maxWidth<=this.file.width&&this.pushError("maxWidth"),0!==this.settings.minHeight&&this.settings.minHeight>=this.file.height&&this.pushError("minHeight"),0!==this.settings.maxHeight&&this.settings.maxHeight<=this.file.height&&this.pushError("maxHeight"),"-1"===this.settings.allowedFormats.indexOf(this.getImageFormat())&&this.pushError("imageFormat"),console.groupEnd()},FileManager.prototype.checkFileSize=function(){console.groupCollapsed("FileManager.checkFileSize"),0!==this.sizeToByte(this.settings.maxFileSize)&&this.file.size>this.sizeToByte(this.settings.maxFileSize)&&this.pushError("fileSize"),console.groupEnd()},FileManager.prototype.isFileExtensionAllowed=function(){return console.groupCollapsed("FileManager.isFileExtensionAllowed"),"-1"!==this.settings.allowedFileExtensions.indexOf("*")||"-1"!==this.settings.allowedFileExtensions.indexOf(this.getFileType())||(this.pushError("fileExtension"),console.groupEnd(),!1)},FileManager.prototype.isImage=function(e){console.groupCollapsed("FileManager.isImage");let t=this.settings.imgFileExtensions,a=this.getFileType(),n=t.indexOf(a);return console.groupEnd(),n>=0},FileManager.prototype.getFileType=function(){return console.groupCollapsed("FileManager.getFileType"),console.groupEnd(),this.file.name.split(".").pop().toLowerCase()},FileManager.prototype.getImageFormat=function(){let e;return console.groupCollapsed("FileManager.getImageFormat"),this.file.width===this.file.height&&(e="square"),this.file.width<this.file.height&&(e="portrait"),this.file.width>this.file.height&&(e="landscape"),console.groupEnd(),e},FileManager.prototype.setFileName=function(e){console.groupCollapsed("FileManager.setFileName");let t,a=null,n=[];if(e&&e.name){let o=e.name.split(".");if(o.length){a=o[o.length-1];for(let e=0;e<o.length-1;e++)n.push(o[e]);t=n.join(".")}}this.detail.name=t,this.detail.extension=a,console.groupEnd()},FileManager.prototype.setFileDetail=function(e){console.groupCollapsed("FileManager.setFileDetail"),this.detail.path=`/public/img/${this.source}/${this.sourceId}`,this.detail.thumbs_path=`/public/img/${this.source}/${this.sourceId}`,this.detail.id=null,this.detail.title=null,this.detail.alt=null,this.detail.title=null,this.detail.caption=null,this.detail.enabled=1,this.detail.is_shown=1,this.detail.is_cover=0,this.detail.date_created=formatDateMySQL(),this.detail.date_modified=formatDateMySQL(),this.detail.created_by=this.userId,this.detail.modified_by=this.userId,this.detail.note=null,console.groupEnd()},FileManager.prototype.setFileDimensions=function(e,t){console.groupCollapsed("FileManager.setFileDimensions"),this.file.width=null,this.file.height=null,this.detail.dimensions=null,this.detail.width=null,this.detail.height=null,e&&t&&(this.file.width=e,this.file.height=t,this.detail.dimensions=`${e} x ${t}`,this.detail.width=e,this.detail.height=t),console.groupEnd()},FileManager.prototype.setFileSize=function(e){console.groupCollapsed("FileManager.setFileSize");let t=null;t=e.size>1048576?(Math.round(100*e.size/1048576)/100).toString()+"MB":(Math.round(100*e.size/1024)/100).toString()+"KB",this.detail.size=t,console.groupEnd()},FileManager.prototype.setFileInformation=function(e){console.groupCollapsed("FileManager.setFileInformation"),this.file.object=e,this.file.name=e.name,this.file.size=e.size,this.file.type=e.type,this.file.width=null,this.file.height=null,this.detail.type=e.type,console.groupEnd()},FileManager.prototype.sizeToByte=function(e){console.groupCollapsed("FileManager.sizeToByte");let t=0;if(0!==e){let a=e.slice(-1).toUpperCase(),n=1024,o=1024*n,i=1024*o;"K"===a?t=parseFloat(e)*n:"M"===a?t=parseFloat(e)*o:"G"===a&&(t=parseFloat(e)*i)}return console.groupEnd(),t},FileManager.prototype.findClosest=function(e,t){console.groupCollapsed("FileManager.findClosest");let a=e[0],n=Math.abs(e[0]-t);for(let o=1;o<e.length;o++){let i=Math.abs(e[o]-t);if(!(i<n))return a;n=i,a=e[o]}return console.groupEnd(),e[e.length-1]},FileManager.prototype.estimateAspectRatio=function(e,t){console.groupCollapsed("FileManager.estimateAspectRatio");let a=Math.max(e,t)/Math.min(e,t);if(a in LOOKUP)return void(this.detail.ratio=LOOKUP[a]);let n=this.findClosest(RATIOS,a);Math.abs(n-a)<=ERROR_ALLOWED?this.detail.ratio=LOOKUP[n]:(this.detail.ratio=Math.round(100*a)/100+":1",console.groupEnd())},FileManager.prototype.resetFile=function(){console.groupCollapsed("FileManager.resetFile"),this.file.object=null,this.file.name=null,this.file.size=null,this.file.type=null,this.file.width=null,this.file.height=null,console.groupEnd()},FileManager.prototype.setFile=function(e){if(console.groupCollapsed("FileManager.setFile"),this.resetFile(),e){let t=e.name&&e.extension?e.name+"."+e.extension:null,a=e.extension?FILE_TYPES[e.extension]:null,n=e.size&&!isNaN(parseInt(formatSize(e.size)))?parseInt(formatSize(e.size)):null,o=e.size?e.size:null,i=e.width&&!isNaN(parseInt(e.width))?parseInt(e.width):null,l=e.height&&!isNaN(parseInt(e.height))?parseInt(e.height):null;this.file.object=e.object?e.object:null,this.file.size=n,this.file.name=t,this.file.sizeFormatted=o,this.file.type=a,this.file.width=i,this.file.height=l,this.detail.type=a,this.detail.width=i,this.detail.height=l,this.setFileDimensions(this.file.width,this.file.height),this.estimateAspectRatio(this.file.width,this.file.height)}console.groupEnd()},FileManager.prototype.fileSelected=function(e){console.groupCollapsed("FileManager.fileSelected"),this.readFile(this.inputs.fields.imageFile[0]),console.groupEnd()},FileManager.prototype.readFile=function(e){console.groupCollapsed("FileManager.readFile"),e&&e.files[0]||this.handleError("Missing fields","File Manager","error");const t=new FileReader,a=new Image;let n=e.files[0],o=null,i=this,l=$.Event("filemanager.fileReady"),r=document.getElementById($(this.inputs.buttons.remove).attr("id"));this.errorsEvent.errors=[],this.showLoader(),this.setFileInformation(n),this.setFileDetail(n),this.checkFileSize(),this.isFileExtensionAllowed(),this.isImage()&&this.file.size<this.sizeToByte(this.settings.maxFileSizePreview)?(this.inputs.fields.imageFile.on("filemanager.fileReady",this.onFileReady),t.readAsDataURL(n),t.onload=function(e){o=e.target.result,a.src=e.target.result,a.onload=function(){i.setFileDimensions(this.width,this.height),i.estimateAspectRatio(this.width,this.height),i.setFileSize(n),i.setFileName(n),i.validateImage(),$(i.input).trigger(l,[!0,o]),console.log("file",i.file),console.log("detail",i.detail),i.displaySet(),r.disabled=!0}}.bind(this)):this.onFileReady(!1),console.groupEnd()},FileManager.prototype.onFileReady=function(e,t,a){if(console.groupCollapsed("FileManager.onFileReady"),$(this.inputs.fields.imageFile).off("fileManager.fileReady",this.onFileReady),console.log("this.errorsEvent.errors",this.errorsEvent.errors),0===this.errorsEvent.errors.length)this.setPreview(t,a);else{this.inputs.fields.imageFile.trigger(this.errorsEvent,[this]);for(let e=this.errorsEvent.errors.length-1;e>=0;e--){let t=this.errorsEvent.errors[e].namespace.split(".").pop();this.showError(t)}if(void 0!==this.previewErrorsContainer){this.previewErrorsContainer.addClass("visible");let e=this.previewErrorsContainer,t=this.preview;setTimeout(function(){e.removeClass("visible"),t.removeClass("has-error")},this.settings.errorTimeout)}this.resetPreview()}console.groupEnd()},FileManager.prototype.onChange=function(e){console.groupCollapsed("FileManager.onChange"),""!==$(this.inputs.fields.imageFile).val()?(this.formReset(),this.fileSelected(e)):this.formReset(e),console.groupEnd()},FileManager.prototype.isShown=function(){console.groupCollapsed("FileManager.isShown");const e=document.getElementById($(this.inputs.fields.imageIsShown).attr("id")),t=document.getElementById($(this.inputs.fields.imageId).attr("id"));if(console.log("_is_shown",e),console.log("_image_id",t),e&&t){let a=isNaN(parseInt(t.value))?null:parseInt(t.value);if(a){let t=document.getElementById("image_"+a);t&&(!0===e.checked?$(t).addClass("is-shown"):$(t).removeClass("is-shown"))}}console.groupEnd()},FileManager.prototype.isCover=function(){console.groupCollapsed("FileManager.isCover");const e=document.getElementById($(this.inputs.fields.imageIsCover).attr("id")),t=document.getElementById($(this.inputs.fields.imageId).attr("id"));if(console.log("_is_cover",e),console.log("_image_id",t),e&&t){let a=isNaN(parseInt(t.value))?null:parseInt(t.value);if(a){let t=document.getElementById("image_"+a);t&&(!0===e.checked?($("img.is-cover-image").removeClass("is-cover-image"),$(t).addClass("is-cover-image")):$(t).removeClass("is-cover-image"))}}console.groupEnd()},FileManager.prototype.formUpload=function(){console.groupCollapsed("FileManager.formUpload");const e=document.getElementById($(this.inputs.fields.imageId).attr("id")),t=document.getElementById($(this.inputs.fields.imageAlt).attr("id")),a=document.getElementById($(this.inputs.fields.imageTitle).attr("id")),n=document.getElementById($(this.inputs.fields.imageCaption).attr("id")),o=document.getElementById($(this.inputs.fields.imageIsShown).attr("id")),i=document.getElementById($(this.inputs.fields.imageEnabled).attr("id")),l=document.getElementById($(this.inputs.fields.imageIsCover).attr("id")),r=document.getElementById($(this.inputs.displays.imageHeight).attr("id")),d=document.getElementById($(this.inputs.displays.imageWidth).attr("id")),s=document.getElementById($(this.inputs.displays.imageExtension).attr("id")),c=document.getElementById($(this.inputs.displays.imageDimensions).attr("id")),u=document.getElementById($(this.inputs.displays.imageSize).attr("id")),p=document.getElementById($(this.inputs.displays.imageRatio).attr("id")),_=document.getElementById($(this.inputs.fields.imageFile).attr("id")),m=document.getElementById($(this.inputs.displays.imageType).attr("id"));let g,h,f,v,y,b,I,E,w,C,k,S,N,B,x,L,M,P,D,F,T=null,R=new FormData,A=new XMLHttpRequest,q=this;F=(F=r?r.innerHTML:null).replace("px",""),F=parseInt(F),T=(T=d?d.innerHTML:null).replace("px",""),T=parseInt(T),P=e&&!isNaN(parseInt(e.value))?parseInt(e.value):null,B=n&&""!==n.value?n.value:null,S=a&&""!==a.value?a.value:null,I=m&&""!==m.innerHTML?m.innerHTML:null,N=t&&""!==t.value?t.value:null,x=o&&!0===o.checked?1:0,M=i&&!0===i.checked?1:0,L=l&&!0===l.checked?1:0,b=document.getElementById($(this.inputs.displays.imageName).attr("id"))?document.getElementById($(this.inputs.displays.imageName).attr("id")).innerText:null,y=s?s.innerText:null,v=u?u.innerText:null,w=c?c.innerText:null,f=T?isNaN(parseInt(T))?null:parseInt(T):null,h=F?isNaN(parseInt(F))?null:parseInt(F):null,E=p?p.innerText:null,C=q.source,k=q.sourceId;let O={alt:N,caption:B,dimensions:w,directory:C,directory_id:k,enabled:M,extension:y,height:h,id:P,is_cover:L,is_shown:x,name:b,path:g=`/public/img/${C}/${k}`,ratio:E,size:v,thumbs_path:D=`/public/thumbs/${C}/${k}`,type:I,title:S,width:f};if(this.validate()){null!==(isNaN(parseInt(e.value))?null:parseInt(e.value))?confirmDialog("Would you like to update this image?",e=>{e&&this.sendUpdateRequest(removeNulls(O),function(e){if(e){console.log("data",e);let t=q.setDetail(e[0]?e[0]:e);if(t.id&&t.name){console.log("detail",t);let e=q.all.get(t.id);console.log("image",e),q.all.set(t.id,t),q.formReset(),q.formHide(),toastr.success(`${t.name} - has been updated`,"File Manager")}else console.log("data",e),toastr.error(`${t.name} - has not been updated`,"File Manager")}})}):confirmDialog("Would you like to add this image?",e=>{if(e){let e=_.files[0];if(e)switch(O.file=e,R.append("dimensions",w),R.append("extension",y),R.append("file",_.files[0],`${b}.${y}`),R.append("height",h),R.append("name",b),R.append("path",g),R.append("thumbs_path",D),R.append("ratio",E),R.append("size",v),R.append("type",I),R.append("width",f),R.append("directory",C),R.append("directory_id",k),R.append("title",S),R.append("enabled",M),R.append("is_shown",x),R.append("is_cover",L),R.append("alt",N),R.append("caption",B),A.upload.addEventListener("progress",this.uploadProgress,!1),A.addEventListener("load",this.uploadComplete,!1),A.addEventListener("error",this.uploadFailed,!1),A.addEventListener("abort",this.uploadCanceled,!1),C.toLowerCase()){case"product":A.open("POST","/api/v1.0/upload/product"),A.send(R);break;case"unit":A.open("POST","/api/v1.0/upload/unit"),A.send(R);break;case"company":A.open("POST","/api/v1.0/upload/company"),A.send(R);break;case"user":A.open("POST","/api/v1.0/upload/user"),A.send(R);break;default:return}}})}console.groupEnd()},FileManager.prototype.uploadComplete=function(e){console.groupCollapsed("FileManager.uploadComplete");let t=null;if(e&&e.target&&e.target.responseText){const a=JSON.parse(e.target.responseText);if(console.log("image",a),a)if(a.status&&"success"===a.status&&void 0!==a.result)t=a.result[0]?a.result[0]:a.result,this.formReset(),this.formHide(),this.all.set(t.id,t),this.galleryContainer.append(this.buildImageThumbnails(t)),toastr.success(`Image ${t.name} was added.`,"File Manager");else if(a.status&&"error"===a.status&&void 0!==a.error){t=a.error;let e=1,n=t.length;$.each(t,function(t,a){console.log(`Error(${e} of ${n}): `,a),e++}),this.formReset(),this.formHide(),toastr.warning("Image was added with issues.","File Manager")}}console.groupEnd()},FileManager.prototype.uploadProgress=function(e){console.groupCollapsed("FileManager.uploadProgress");let t=document.getElementById(this.inputs.fields.progress.attr("id"));if(e.lengthComputable){let a=Math.round(100*e.loaded/e.total);t.innerHTML=a.toString()+"%",$(t).css({width:`${a}%`,"background-color":"#007bff",color:"#fff"})}else t.innerHTML="unable to compute",$(t).css({width:"100%","background-color":"#c58e34",color:"#06030a"});console.groupEnd()},FileManager.prototype.uploadFailed=function(e){console.groupCollapsed("FileManager.uploadFailed"),console.groupEnd()},FileManager.prototype.uploadCanceled=function(e){console.groupCollapsed("FileManager.uploadFailed"),console.groupEnd()},FileManager.prototype.sendRemoveRequest=function(e,t){if(console.groupCollapsed("FileManager.sendRemoveRequest"),e){let a="/api/v1.0/images/remove";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){return console.log("error",e),this.handleError("Error Removing Image.","Image Manager","error")}}console.groupEnd()},FileManager.prototype.sendUpdateRequest=function(e,t){console.groupCollapsed("FileManager.sendUpdateRequest");let a=this,n=this.source?this.source:null,o=isNaN(parseInt(this.sourceId))?null:parseInt(this.sourceId);if(e&&null!==n&&null!==o){let n="/api/v1.0/images/update";console.groupCollapsed("sendUpdateRequest");try{sendPostRequest(n,e,function(e,a,n){if(e)return t(e)})}catch(e){return console.log("error",e),a.handleError("Error Retrieving Images.","Image Manager","error")}console.groupEnd()}console.groupEnd()},FileManager.prototype.validate=function(){console.groupCollapsed("FileManager.validate");let e=this.form[0];return console.groupEnd(),$(e).valid()},FileManager.prototype.formRules=function(){console.groupCollapsed("FileManager.formRules");let e={},t={};return e[`file_manager_${this.source}_form_title`]={required:!0},e[`file_manager_${this.source}_form_alt`]={required:!0},e[`file_manager_${this.source}_form_caption`]={required:!0},t[`file_manager_${this.source}_form_title`]={required:"Field is required."},t[`file_manager_${this.source}_form_alt`]={required:"Field is required."},t[`file_manager_${this.source}_form_caption`]={required:"Field is required."},console.groupEnd(),{rules:e,messages:t}},FileManager.prototype.assignEvents=function(){console.groupCollapsed("FileManager.assignEvents");let e=this.form[0],t=this.formRules();initializeValidator(t),this.inputs.buttons.toggle.on("click",this.open),this.inputs.buttons.close.on("click",this.formHide),this.inputs.buttons.cancel.on("click",this.formCancel),this.inputs.buttons.remove.on("click",this.formRemove),this.inputs.buttons.clear.on("click",this.formClear),this.inputs.buttons.upload.on("click",this.formUpload),this.inputs.fields.imageFile.on("change",this.onChange),this.inputs.fields.imageIsShown.on("change",this.isShown),this.inputs.fields.imageIsCover.on("change",this.isCover),this.validator=$(e).validate(),console.groupEnd()},FileManager.prototype.edit=function(e){console.groupCollapsed("FileManager.edit");let t=document.getElementById($(this.inputs.buttons.remove).attr("id"));if(this.formReset(),this.inputs.buttons.upload.html("Update"),e){let a=this.all.get(e),n=e?"image_"+e.toString():null,o=document.getElementById(n);a&&o&&($(o).addClass("selected"),this.setDetail(a),this.formLoad(a),t.disabled=!1)}console.groupEnd()},FileManager.prototype.open=function(){console.groupCollapsed("FileManager.open"),$(this.inputs.fields.imageFile).trigger("click"),console.groupEnd()},FileManager.prototype.render=function(){console.groupCollapsed("FileManager.render"),this.form=this.fileForm(),this.gallery=this.fileGallery(),$(this.element).append(this.form,this.gallery),this.input=$(this.inputs.fields.imageFile)[0];document.getElementById($(this.form).attr("id"));initializeValidator(),this.formHide(),console.groupEnd()},FileManager.prototype.load=function(e){console.groupCollapsed("FileManager.load"),e&&e.source&&e.sourceId&&(this.all=new Map,this.source=e.source?e.source:null,this.images=e.images?e.images:[],this.sourceId=isNaN(parseInt(e.sourceId))?null:parseInt(e.sourceId),this.formReset(),this.formHide(),this.galleryContainer.empty(),this.loadAll()),console.groupEnd()},FileManager.prototype.init=function(e){console.groupCollapsed("FileManager.init"),this.inputs.displays.imageId=null,this.inputs.displays.imageName=null,this.inputs.displays.imageAlt=null,this.inputs.displays.imageTitle=null,this.inputs.displays.imageIsCover=null,this.inputs.displays.imagePath=null,this.inputs.displays.imageExtension=null,this.inputs.displays.imageDimensions=null,this.inputs.displays.imageSize=null,this.inputs.displays.imageHeight=null,this.inputs.displays.imageWidth=null,this.inputs.displays.imageEnabled=null,this.inputs.displays.imageDateCreated=null,this.inputs.displays.imageCreatedBy=null,this.inputs.displays.imageDateModified=null,this.inputs.displays.imageModifiedBy=null,this.inputs.displays.imageNote=null,this.inputs.displays.imageFile=null,this.inputs.displays.imageType=null,this.inputs.displays.imageRatio=null,this.inputs.errors.imageId=null,this.inputs.errors.imageName=null,this.inputs.errors.imageAlt=null,this.inputs.errors.imageTitle=null,this.inputs.errors.imageIsCover=null,this.inputs.errors.imageEnabled=null,this.inputs.errors.imageIsShown=null,this.inputs.errors.imageFile=null,this.inputs.labels.imageId=null,this.inputs.labels.imageNameField=null,this.inputs.labels.imageNameDetail=null,this.inputs.labels.imageAlt=null,this.inputs.labels.imageTitle=null,this.inputs.labels.imageIsCover=null,this.inputs.labels.imageEnabled=null,this.inputs.labels.imageIsShown=null,this.inputs.fields.imageId=null,this.inputs.fields.imageName=null,this.inputs.fields.imageAlt=null,this.inputs.fields.imageTitle=null,this.inputs.fields.imageIsCover=null,this.inputs.fields.imageEnabled=null,this.inputs.fields.imageIsShown=null,this.inputs.fields.progress=null,this.inputs.buttons.toggle=null,this.inputs.buttons.close=null,this.inputs.buttons.cancel=null,this.inputs.buttons.remove=null,this.inputs.buttons.clear=null,this.inputs.buttons.upload=null,this.inputs.fields.imageFileButton=null,this.loader=null,this.input=null,this.file.sizeFormatted=null,this.form=null,this.gallery=null,this.preview=null,this.detailSection=null,this.galleryContainer=null,this.settings.urls={get:`/api/v1.0/images/${this.source}/${this.sourceId}`,update:"/api/v1.0/images/update",remove:"/api/v1.0/images/remove"},console.groupEnd()},$.fn.fileManager=function(e){"use strict";return new FileManager(document.getElementById($(this).attr("id")),e)};const Product=function(){"use strict";const e=document.getElementById("product_edit_meta_description_long_update_button"),t=document.getElementById("product_edit_meta_description_short_update_button"),a=document.getElementById("product_edit_meta_product_amenities_update_button"),n=document.getElementById("product_edit_meta_product_keywords_update_button"),o=document.getElementById("product_edit_details_section_publish"),i=document.getElementById("product_edit_details_section_save_draft"),l=document.getElementById("form_product_add"),r=document.getElementById("modal_product_depart_from_time"),d=document.getElementById("modal_product_depart_from_date"),s=document.getElementById("modal_product_arrive_to_time"),c=document.getElementById("modal_product_arrive_to_date"),u=document.getElementById("modal_product_depart_from_station"),p=document.getElementById("modal_product_arrive_to_station"),_=document.getElementById("modal_product_depart_from_station_id"),m=document.getElementById("modal_product_arrive_to_station_id"),g=document.getElementById("modal_product_depart_from_airport_id"),h=document.getElementById("modal_product_arrive_to_airport_id"),f=document.getElementById("modal_button_cancel_add_product"),v=document.getElementById("modal_button_submit_add_product"),y=document.getElementById("modal_product_provider_name"),b=document.getElementById("modal_product_vendor_name"),I=document.getElementById("modal_product_provider_id"),E=document.getElementById("modal_product_vendor_id"),w=document.getElementById("modal_new_product"),C=document.getElementById("modal_product_name"),k=document.getElementById("modal_product_category_id"),S=document.getElementById("modal_product_sku"),N=document.getElementById("modal_product_rating_types_id"),B=document.getElementById("modal_product_currency_id"),x=document.getElementById("modal_product_pricing_strategies_types_id"),L=document.getElementById("modal_product_provider_company_id"),M=document.getElementById("modal_product_vendor_company_id"),P=document.getElementById("modal_product_provider_vendor_match"),D=document.getElementById("modal_product_provider_location_id"),F=document.getElementById("modal_product_location_id"),T=document.getElementById("modal_product_street_1"),R=document.getElementById("modal_product_street_2"),A=document.getElementById("modal_product_postal_code"),q=document.getElementById("modal_product_city_id"),O=document.getElementById("modal_product_province_id"),Y=document.getElementById("modal_product_country_id"),U=document.getElementById("modal_product_city"),W=document.getElementById("modal_product_day_span"),Q=document.getElementById("modal_button_clear_add_product"),V=document.getElementById("modal_product_depart_from_station_date"),j=document.getElementById("modal_product_arrive_to_station_date"),z=document.getElementById("modal_product_depart_from_station_time"),H=document.getElementById("modal_product_arrive_to_station_time"),K=document.getElementById("product_edit_page"),G=document.getElementById("product_panel_link_overview"),J=document.getElementById("panel_tab_product_o"),Z=document.getElementById("product_panel_link_product"),X=document.getElementById("panel_tab_product"),ee=document.getElementById("product_panel_link_season"),te=document.getElementById("panel_tab_season"),ae=document.getElementById("product_panel_link_unit"),ne=document.getElementById("panel_tab_unit"),oe=document.getElementById("product_panel_link_variant"),ie=document.getElementById("panel_tab_variant"),le=document.getElementById("product_panel_link_inventory"),re=document.getElementById("panel_tab_inventory"),de=document.getElementById("product_panel_link_pricing"),se=document.getElementById("panel_tab_pricing"),ce=document.getElementById("panel_tab_location"),ue=document.getElementById("panel_tab_meta"),pe=document.getElementById("product_panel_link_meta"),_e=document.getElementById("product_panel_link_location"),me=document.getElementById("product_edit_details_currency_id"),ge=document.getElementById("product_edit_details_rating_types_id"),he=document.getElementById("product_keywords"),fe=document.getElementById("product_edit_meta_description_long"),ve=document.getElementById("product_edit_meta_description_short"),ye=document.getElementById("product_index_page"),be=document.getElementById("product_index_table"),Ie=document.getElementById("product_amenities"),Ee=document.getElementById("product_id"),$e=document.getElementById("product_edit_details_name"),we=document.getElementById("product_edit_details_enabled"),Ce=document.getElementById("product_edit_details_sku"),ke=document.getElementById("pricing_strategy_types_id"),Se=document.getElementById("product_edit_location_city_id"),Ne=document.getElementById("product_edit_location_id"),Be=document.getElementById("provider_id"),xe=document.getElementById("vendor_id"),Le=document.getElementById("display_product_name"),Me=document.getElementById("button_save_product"),Pe=document.getElementById("button_add_product_page_heading"),De=document.getElementById("category_id"),Fe=document.getElementById("product_location_departing_station_city_id"),Te=document.getElementById("product_location_arriving_station_city_id"),Re=document.getElementById("product_location_departing_station_id"),Ae=document.getElementById("product_location_arriving_station_id"),qe=document.getElementById("product_location"),Oe=document.getElementById("product_edit_details_submit_button"),Ye=document.getElementById("product_description_long"),Ue=document.getElementById("product_edit_details_section_seasons"),We=document.getElementById("product_edit_details_section_units"),Qe=document.getElementById("product_edit_details_section_variants"),Ve=document.getElementById("product_edit_details_section_status"),je=document.getElementById("product_description_short"),ze=document.getElementById("product_edit_details_section_profiles"),He=document.getElementById("user_id"),Ke=document.getElementById("modal_product_id"),Ge=document.getElementById("modal_product_description_short"),Je=document.getElementById("modal_product_description_long"),Ze=document.getElementById("modal_product_keywords"),Xe=document.getElementById("modal_product_depart_from_fields"),et=document.getElementById("modal_product_arrive_to_fields"),tt=document.getElementById("modal_product_hotel_fields"),at=document.getElementById("modal_product_flight_fields"),nt=document.getElementById("modal_product_cars_fields"),ot=document.getElementById("modal_product_rail_fields"),it=document.getElementById("modal_product_transport_fields"),lt=document.getElementById("modal_product_tours_fields"),rt=document.getElementById("modal_product_cruises_fields");let dt,st,ct,ut,pt,_t,mt=document.querySelectorAll('input[type=radio][name="location_to_use"]'),gt=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,ht={groups:{},rules:{modal_product_sku:{required:!0},modal_day_span:{required:!0},modal_product_rating_types_id:{required:function(e){let t=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null;if(t&&(1===t||3===t||5===t||6===t||7===t))return!0}},modal_product_currency_id:{required:!0},modal_product_pricing_strategies_types_id:{required:!0},modal_product_name:{required:!0},modal_product_category_id:{required:!0},modal_product_country_id:{required:!0},modal_product_province_id:{required:function(e){let t=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null;if(t&&(1===t||2===t))return!0}},modal_product_city_id:{required:function(e){let t=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null;if(t&&(1===t||2===t))return!0}},modal_product_city:{required:function(e){let t=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null;if(t&&1===t)return!0}},modal_product_country_cars:{required:function(e){let t=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null;if(t&&3===t)return!0}},modal_product_city_transports:{required:function(e){let t=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null;if(t&&5===t)return!0}},modal_product_city_tours:{required:function(e){let t=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null;if(t&&6===t)return!0}},modal_product_provider_name:{required:!0},modal_product_provider_id:{required:!0},modal_product_provider_company_id:{required:!0},modal_product_vendor_name:{required:!0},modal_product_vendor_id:{required:!0},modal_product_vendor_company_id:{required:!0},modal_product_depart_from_airport:{required:function(e){if(k){if(2===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}},modal_product_depart_from_airport_id:{required:function(e){if(k){if(2===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}},modal_product_arrive_to_airport:{required:function(e){if(k){if(2===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}},modal_product_arrive_to_airport_id:{required:function(e){if(k){if(2===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}},modal_product_depart_from_station:{required:function(e){if(k){if(4===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}},modal_product_depart_from_station_id:{required:function(e){if(k){if(4===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}},modal_product_arrive_to_station:{required:function(e){if(k){if(4===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}},modal_product_arrive_to_station_id:{required:function(e){if(k){if(4===(isNaN(parseInt(k.value))?null:parseInt(k.value)))return!0}}}},messages:{modal_product_sku:{required:"Field Required"},modal_day_span:{required:"Field Required"},modal_product_rating_types_id:{required:"Field Required"},modal_product_currency_id:{required:"Field Required"},modal_product_pricing_strategies_types_id:{required:"Field Required"},modal_product_name:{required:"Field Required"},modal_product_category_id:{required:"Field Required"},modal_product_city:{required:"Field Required"},modal_product_country_id:{required:"Field Required"},modal_product_province_id:{required:"Field Required"},modal_product_city_id:{required:"Field Required"},modal_product_country_cars:{required:"Field Required"},modal_product_city_transports:{required:"Field Required"},modal_product_city_tours:{required:"Field Required"},modal_product_provider_name:{required:"Field Required"},modal_product_provider_id:{required:"Field Required"},modal_product_provider_company_id:{required:"Field Required"},modal_product_vendor_name:{required:"Field Required"},modal_product_vendor_id:{required:"Field Required"},modal_product_vendor_company_id:{required:"Field Required"},modal_product_depart_from_airport:{required:"Field Required"},modal_product_depart_from_airport_id:{required:"Field Required"},modal_product_arrive_to_airport:{required:"Field Required"},modal_product_arrive_to_airport_id:{required:"Field Required"},modal_product_depart_from_station:{required:"Field Required"},modal_product_depart_from_station_id:{required:"Field Required"},modal_product_arrive_to_station:{required:"Field Required"},modal_product_arrive_to_station_id:{required:"Field Required"}}};$("#modal_product_day_span_station").on("change",function(){let e=isNaN(parseInt($(this).val()))?1:parseInt($(this).val());e<=0&&(e=1),$(this).val(e),W.value=e}),$("#modal_product_day_span_airport").on("change",function(){let e=isNaN(parseInt($(this).val()))?1:parseInt($(this).val());e<=0&&(e=1),$(this).val(e),W.value=e}),$("#button_view_calendar").on("click",function(){$("#seasonCalendarModal").modal("show")}),$(e).on("click",function(){console.groupCollapsed("Product.product_edit_meta_description_long_update_button.click()"),Ct()}),$(t).on("click",function(){console.groupCollapsed("Product.product_edit_meta_description_short_update_button.click()"),Ct()}),$(a).on("click",function(){console.groupCollapsed("Product.product_edit_meta_product_amenities_update_button.click()"),Ct()}),$(n).on("click",function(){console.groupCollapsed("Product.product_edit_meta_product_keywords_update_button.click()"),Ct()}),$(o).on("click",function(){console.groupCollapsed("Product.product_edit_details_section_publish.click()")}),$(i).on("click",function(){console.groupCollapsed("Product.product_edit_details_section_save_draft.click()")}),$($e).on("change",function(){Le.innerText=$e.value}),$(Oe).on("click",function(){Ft()}),$(ge).on("change",function(){Product.detail.rating_types_id=isNaN(parseInt(ge.value))?1:parseInt(ge.value),Pt()}),$(Me).on("click",function(){Nt()}),$(Pe).on("click",function(){ft()}),$(f).on("click",function(){vt(),Station.resetStationForm("depart_from"),Station.resetStationForm("arrive_to"),Station.resetStationForm("depart_from"),Station.resetStationForm("arrive_to"),clearValidation(l),$(w).modal("hide")}),$(v).on("click",function(){console.groupCollapsed("Product.modal_button_submit_add_product:click()"),bt()&&confirmDialog("Would you like to update?",e=>{e&&It()})}),$(P).on("change",function(){null!==(isNaN(parseInt(L.value))?null:parseInt(L.value))&&(P.checked?(M.value=L.value,null!==Provider.detail?(M.value=Provider.detail.vendor.company_id,E.value=Provider.detail.vendor.id,b.value=Provider.detail.vendor.name):(M.value="",E.value="",b.value="")):(M.value="",E.value="",b.value=""))}),$(Q).on("click",function(){vt()}),$(ve).on("change",function(){Product.detail.description_short=$(this).val(),Pt()}),$(fe).on("change",function(){Product.detail.description_long=$(this).val(),Pt()}),$(l).on("change",function(){Product.enableNewFormDetails()});const ft=function(){console.groupCollapsed("Product.setNewProductModal"),vt(),$(w).modal("show"),console.groupEnd()},vt=function(){console.groupCollapsed("Product.clearModalForm"),w&&(yt(),p.value="",m.value="",U.value="",q.value="",W.value=1,u.value="",u.value="",Ke.value="",C.value="",A.value="",T.value="",R.value="",p.value="",_.value="",m.value="",_.value="",k.value="",S.value="",Y.value="",O.value="",Y.value="",N.value="",B.value="",L.value="",M.value="",E.value="",x.value="",D.value="",F.value="",Ge.value="",Je.value="",Product.product_keywords&&Product.product_keywords.clear(),$(y).val("").trigger("change"),$(E).val("").trigger("change"),Product.depart_from_date.value(""),Product.arrive_to_date.value(""),Product.attr1=null,Product.attr2=null,Product.attr3=null,Product.updateProductSKU(),Product.disableNewFormDetails(),$("[data-categoryid]").hide()),console.groupEnd()},yt=function(){if(console.groupCollapsed("Product.clearNewProductValidation"),Product.validator){$(l).validate().resetForm()}clearAllValidation(),console.groupEnd()},bt=function(){if(console.groupCollapsed("Product.validateNewProduct"),!l)return console.log("Missing _form_product_add"),!1;let e=!1;k&&!isNaN(parseInt(k.value))&&parseInt(k.value);if($(l).valid())e=!0;else{let t=$(l).validate();console.log("validator",t),console.log("isValid",e)}return console.groupEnd(),e},It=function(){console.groupCollapsed("Product.saveNewProduct()");let e,t=wt();Et(t,function(t){if(console.groupCollapsed("Product.saveNewProduct - newProduct"),t&&(e=t,1===t.length&&(e=t[0]),e.id)){let t=Bt(e);Ke.value=isNaN(parseInt(e.id))?"":parseInt(e.id),_t.insertRow(t),_t.loadRow(t),_t.jumpToRow(t),_t.clearSelectedRows(),toastr.success(`Product - ${e.id} was created, would you like to edit?`,"Product Created"),window.location.replace("/products/"+e.id)}console.groupEnd()}),console.groupEnd()},Et=function(e,t){console.groupCollapsed("Product.newProduct(dataToSend)",e);if(e)try{sendPostRequest("/api/v1.0/products/add",e,function(e,a,n){return e?t(e):Lt("Oops: 1")})}catch(e){Lt("Oops: 1")}console.groupEnd()},$t=function(){console.groupCollapsed("Product.disableNewFormDetails"),Product.product_keywords&&Product.product_keywords.readOnly(!0),C.disabled=!0,y.readOnly=!0,b.readOnly=!0,P.disabled=!0,N.disabled=!0,B.disabled=!0,x.disabled=!0,Je.disabled=!0,Ge.disabled=!0,v.disabled=!0,tt.disabled=!0,at.disabled=!0,Xe.disabled=!0,et.disabled=!0,S.disabled=!0,Ke.disabled=!0,console.groupEnd()},wt=function(){console.groupCollapsed("Product.buildInsertData()");let e,t,a,n,o,i,l,r,d,s,c,u,p,f,v,y,b,$,w,P,D,F,U,Q,V=Ke&&!isNaN(parseInt(Ke.value))?parseInt(Ke.value):null,j=isNaN(parseInt(k.value))?null:parseInt(k.value),z="12:00",H=moment(new Date).format("YYYY-MM-DD"),K=moment(H,"YYYY-MM-DD").add(3,"months").format("YYYY-MM-DD"),G=moment(K,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD"),J={name:null,street_1:null,street_2:null,zipcode:null,country_id:null,province_id:null,city_id:null},Z=Product.product_keywords.build();return d=Ge&&""!==Ge.value?Ge.value:null,s=Je&&""!==Je.value?Je.value:null,r=W&&!isNaN(parseInt(W.value))?parseInt(W.value):1,b=Y&&!isNaN(parseInt(Y.value))?parseInt(Y.value):null,y=O&&!isNaN(parseInt(O.value))?parseInt(O.value):null,$=q&&!isNaN(parseInt(q.value))?parseInt(q.value):null,p=T&&""!==T.value?T.value:null,f=R&&""!==R.value?R.value:null,v=A&&""!==A.value?A.value:null,e=C&&""!==C.value?C.value:null,t=S&&""!==S.value?S.value:null,a=B&&!isNaN(parseInt(B.value))?parseInt(B.value):null,i=I&&!isNaN(parseInt(I.value))?parseInt(I.value):null,l=E&&!isNaN(parseInt(E.value))?parseInt(E.value):null,o=N&&!isNaN(parseInt(N.value))?parseInt(N.value):null,n=x&&!isNaN(parseInt(x.value))?parseInt(x.value):null,U="12:00",z="12:00",1===j?(c=null,u=null,w=null,P=null,D=null,F=null,J={name:e,location_types_id:2,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):2===j?(c=isNaN(parseInt(g.value))?null:parseInt(g.value),u=isNaN(parseInt(h.value))?null:parseInt(h.value),w=Product.depart_from_date&&""!==Product.depart_from_date.value()&&null!==Product.depart_from_date.value()?Product.depart_from_date.value():K,P=Product.depart_from_time&&""!==Product.depart_from_time.value()&&null!==Product.depart_from_time.value()?Product.depart_from_time.value():"12:00",D=Product.arrive_to_date&&""!==Product.arrive_to_date.value()&&null!==Product.arrive_to_date.value()?Product.arrive_to_date.value():G,F=Product.arrive_to_time&&""!==Product.arrive_to_time.value()&&null!==Product.arrive_to_time.value()?Product.arrive_to_time.value():"12:00",J={name:e,location_types_id:3,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):3===j?(c=null,u=null,w=null,P=null,D=null,F=null,J={name:e,location_types_id:18,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):4===j?(c=isNaN(parseInt(_.value))?null:parseInt(_.value),u=isNaN(parseInt(m.value))?null:parseInt(m.value),w=Product.depart_from_date&&""!==Product.depart_from_date.value()&&null!==Product.depart_from_date.value()?Product.depart_from_date.value():K,P=Product.depart_from_time&&""!==Product.depart_from_time.value()&&null!==Product.depart_from_time.value()?Product.depart_from_time.value():"12:00",D=Product.arrive_to_date&&""!==Product.arrive_to_date.value()&&null!==Product.arrive_to_date.value()?Product.arrive_to_date.value():G,F=Product.arrive_to_time&&""!==Product.arrive_to_time.value()&&null!==Product.arrive_to_time.value()?Product.arrive_to_time.value():"12:00",J={name:e,location_types_id:4,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):5===j?(c=null,u=null,w=null,P=null,D=null,F=null,J={name:e,location_types_id:7,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):6===j?(c=null,u=null,w=null,P=null,D=null,F=null,J={name:e,location_types_id:17,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):7===j?(c=null,u=null,w=null,P=null,D=null,F=null,J={name:e,location_types_id:19,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):8===j?(c=null,u=null,w=null,P=null,D=null,F=null,J={name:e,location_types_id:19,street_1:p,street_2:f,zipcode:v,country_id:b,province_id:y,city_id:$}):(c=null,u=null),Q={id:V,category_id:j,depart_from:c,depart_date:w,depart_time:P,arrive_to:u,arrive_date:D,arrive_time:F,street_1:p,street_2:f,country_id:b,province_id:y,city_id:$,postal_code:v,pricing_strategy_types_id:n,status_types_id:1,currency_id:a,day_span:r,description_short:d,description_long:s,keywords:Z,rating_types_id:o,provider_id:i,vendor_id:l,provider_vendor_match:(isNaN(parseInt(L.value))?null:parseInt(L.value))===(isNaN(parseInt(M.value))?null:parseInt(M.value))?1:0,name:e,sku:t,use_provider_location_id:0,location:J},console.groupEnd(),remove_nulls(Q)},Ct=function(){console.groupCollapsed("Product.updateMeta");isNaN(parseInt(Ee.value))||parseInt(Ee.value),isNaN(parseInt(De.value))||parseInt(De.value),isNaN(parseInt(He.value))||parseInt(He.value);let e=function(){console.groupCollapsed("Product.buildMetaObject");let e=isNaN(parseInt(Ee.value))?null:parseInt(Ee.value),t=ut.build(),a=pt.build(),n=""!==ve.value?ve.value:null,o=""!==fe.value?fe.value:null;return console.groupEnd(),removeNulls({amenities:a,keywords:t,id:e,description_long:o,description_short:n})}();confirmDialog("Would you like to update?",t=>{t&&kt(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);Bt(t);K&&Mt(),Lt(`Product ${t.name} was updated.`,"Product","success")}})}),console.groupEnd()},kt=function(e,t){if(console.groupCollapsed("Product.sendRequestUpdateProductMeta"),e){let a="/api/v1.0/products/update_meta";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){return Lt("Error")}}console.groupEnd()},St=function(){console.groupCollapsed("Product.buildProductRecord"),console.groupCollapsed("Product.validateProductRecord"),console.groupEnd();{let e,t,a=isNaN(parseInt(De.value))?null:parseInt(De.value);2===a?(e=isNaN(parseInt(Ae.value))?null:parseInt(Ae.value),t=isNaN(parseInt(Re.value))?null:parseInt(Re.value)):4===a?(e=isNaN(parseInt(Te.value))?null:parseInt(Te.value),t=isNaN(parseInt(Fe.value))?null:parseInt(Fe.value)):(e=null,t=null);let n={id:isNaN(parseInt(Ee.value))?null:parseInt(Ee.value),category_id:isNaN(parseInt(De.value))?null:parseInt(De.value),description_short:ve&&""!==ve.value?ve.value:null,description_long:fe&&""!==fe.value?fe.value:null,amenities:pt.build(),keywords:ut.build(),rating_types_id:isNaN(parseInt(ge.value))?null:parseInt(ge.value),currency_id:isNaN(parseInt(me.value))?null:parseInt(me.value),name:""!==$e.value?$e.value:null,pricing_strategy_types_id:isNaN(parseInt(ke.value))?null:parseInt(ke.value),city_id:isNaN(parseInt(Se.value))?null:parseInt(Se.value),location_id:Ne&&!isNaN(parseInt(Ne.value))?parseInt(Ne.value):null,provider_id:isNaN(parseInt(Be.value))?null:parseInt(Be.value),vendor_id:isNaN(parseInt(xe.value))?null:parseInt(xe.value),use_provider_location_id:0,provider_vendor_match:1,status_types_id:2,enabled:we.checked?1:0,sku:""!==Ce.value?Ce.value:null,arrive_to:e,depart_from:t};return removeNulls(n)}},Nt=function(){console.groupCollapsed("Product.save");let e=St();e&&confirmDialog("Would you like to update?",t=>{t&&function(e,t){console.groupCollapsed("Product.sendUpdateRequest");if(e)try{sendPostRequest("/api/v1.0/products/update",e,function(e,a,n){if(e)return t(e);Lt("Oops: 1")})}catch(e){Lt("Oops: 1")}console.groupEnd()}(e,function(e){let t;if(e&&(t=e,e[0]&&(t=e[0])),t.id){let e=Bt(t),a=e.name?e.name:null;toastr.success(`Product ${a} has been updated`,"Product Updated")}})}),console.groupEnd()},Bt=function(e){console.groupCollapsed("Product.set");let t=function(){console.groupCollapsed("Product.defaultDetail");let e={id:null,category_id:null,pricing_strategy_types_id:null,status_types_id:null,product_status_types_id:null,currency_id:null,location_id:null,city_id:null,vendor_id:null,provider_id:null,name:null,provider_vendor_match:1,description_short:null,description_long:null,rating:null,sku:null,phone:null,infant:null,child:null,teen:null,depart_from:null,arrive_to:null,depart_time:null,arrive_time:null,day_span:null,cover_image:null,api_id:null,from_api:1,hotel_code:null,enabled:1,date_created:formatDateMySQL(),created_by:gt,date_modified:formatDateMySQL(),modified_by:gt,note:null,amenities:"",keywords:"",seasons:[],units:[],use_provider_location:0,variants:[],category:{},location:{},vendor:{},profiles:[],provider:{}};return console.groupEnd(),e}();return e&&(t.id=e.id?e.id:null,t.category_id=e.category_id?e.category_id:null,t.pricing_strategy_types_id=e.pricing_strategy_types_id?e.pricing_strategy_types_id:null,t.status_types_id=e.status_types_id?e.status_types_id:null,t.product_status_types_id=e.product_status_types_id?e.product_status_types_id:null,t.currency_id=e.currency_id?e.currency_id:null,t.location_id=e.location_id?e.location_id:null,t.city_id=e.city_id?e.city_id:null,t.vendor_id=e.vendor_id?e.vendor_id:null,t.provider_id=e.provider_id?e.provider_id:null,t.name=e.name?e.name:null,t.provider_vendor_match=e.provider_vendor_match?e.provider_vendor_match:1,t.description_short=e.description_short?e.description_short:null,t.description_long=e.description_long?e.description_long:null,t.rating=e.rating?e.rating:null,t.sku=e.sku?e.sku:null,t.phone=e.phone?e.phone:null,t.infant=e.infant?e.infant:null,t.child=e.child?e.child:null,t.teen=e.teen?e.teen:null,t.depart_from=e.depart_from?e.depart_from:null,t.arrive_to=e.arrive_to?e.arrive_to:null,t.depart_time=e.depart_time?e.depart_time:null,t.arrive_time=e.arrive_time?e.arrive_time:null,t.day_span=e.day_span?e.day_span:null,t.cover_image=e.cover_image?e.cover_image:null,t.api_id=e.api_id?e.api_id:null,t.from_api=e.from_api?e.from_api:1,t.hotel_code=e.hotel_code?e.hotel_code:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:gt,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:gt,t.note=e.note?e.note:null,t.category=e.category?e.category:{},t.keywords=e.keywords?e.keywords:"",t.amenities=e.amenities?e.amenities:"",t.seasons=e.seasons?e.seasons:[],t.units=e.units?e.units:[],t.use_provider_location=e.use_provider_location?e.use_provider_location:0,t.variants=e.variants?e.variants:[],t.location=e.location?e.location:{},t.vendor=e.vendor?e.vendor:{},t.provider=e.provider?e.provider:{}),Product.detail=t,console.groupEnd(),t},xt=function(e){console.groupCollapsed("Product.loadAll"),Product.all=new Map,e&&($.each(e,function(e,t){let a=Bt(t);_t.insertRow(a),Product.all.set("id",a)}),console.groupEnd())},Lt=function(e,t,a){console.groupCollapsed("Product.handleProductError"),t||(t="Product"),a||(a="error"),toastr[a](`${e}`,t),console.groupEnd()},Mt=function(){if(console.groupCollapsed("Product.updateProgress"),K){let e=Array.from(Variant.all.values()),t=Array.from(InventoryProfile.all.values()),a=Array.from(Unit.all.values()),n=Array.from(Season.all.values()),i=document.querySelectorAll("button[data-target='#seasonCalendarModal']");if(0===e.length||0===a.length||0===n.length||0===t.length)$(o).addClass("disabled"),0===e.length||0===a.length||0===n.length?(i.forEach(e=>{e.disabled=!0}),$("#button_view_calendar").addClass("disabled"),$(se).addClass("disabled"),$(re).addClass("disabled")):$(re).removeClass("disabled"),0===t.length&&($("#button_view_calendar").addClass("disabled"),$(se).addClass("disabled")),$(Me).addClass("disabled"),$("#panel_tab_pricing").html('\n\t\t\t\t\t\t\t<span id="tab_span_pricing">Pricing</span>\n\t\t\t\t\t\t\t<span class="badge rounded-pill badge-notification bg-danger tab-badge" style="color:#fff!important">!</span>\n\t\t\t\t\t\t');else{$("#button_view_calendar").removeClass("disabled"),$(se).removeClass("disabled"),$(re).removeClass("disabled"),"incomplete"===PricingWorksheet.status()?($(o).addClass("disabled"),$(Me).addClass("disabled"),$("#panel_tab_pricing").html("<span id='tab_span_pricing'>Pricing</span> <span class='badge rounded-pill badge-notification bg-danger tab-badge' style='color:#fff!important'>!</span>")):($(o).removeClass("disabled"),$(Me).removeClass("disabled"),$("#panel_tab_pricing").html("<span id='tab_span_pricing'>Pricing</span>"))}Pt()}console.groupEnd()},Pt=function(){if(console.groupCollapsed("Product.updateDisplay"),K){let e,t,a="Product Location",n="fas fa-archway";Product.detail.location&&(e=Product.detail.location),e&&(t=e.type?e.type:null,a=e.display_medium?e.display_medium:"Product Location"),t&&(n=t.icon?t.icon:"fas fa-archway"),qe&&$(qe).empty().html(`\n\t\t\t\t\t\t<i class="${n} mr-2"></i> <span class="">${a}</span>\n\t\t\t\t\t`);let o=isNaN(parseInt(ge.value))?1:parseInt(ge.value),i="";for(let e=0;e<5;e++)i+=e<o?'\n\t\t\t\t\t\t<li class="list-inline-item mr-0">\n                            <i class="fas fa-star"></i>\n                        </li>\n\t\t\t\t\t':'\n\t\t\t\t\t\t<li class="list-inline-item mr-0">\n                            <i class="far fa-star"></i>\n                        </li>\n\t\t\t\t\t';$("ul.rating").empty().html(i);let l="";if(Ve){let e=isNaN(parseInt(Product.detail.status_types_id))?null:parseInt(Product.detail.status_types_id);if(e){let t=StatusTypes.all.get(e);if(t){let e=t.name?t.name:"";l=`\n\t\t\t\t\t\t\t<span class="">Status</span>\n\t\t\t\t\t\t\t<span id="product_edit_details_section_status_text" class="badge badge-${e.replace(/\s+/g,"-").toLowerCase()} badge-pill badge-status">${e}</span>\n\t\t\t\t\t\t`}}}Ve&&$(Ve).empty().html(l);let r=Array.from(Season.all.values()).length,d="badge badge-success badge-pill";0===r&&(d="badge badge-danger badge-pill");let s=Array.from(Unit.all.values()).length,c="badge badge-success badge-pill";0===s&&(c="badge badge-danger badge-pill");let u=Array.from(Variant.all.values()).length,p="badge badge-success badge-pill";0===u&&(p="badge badge-danger badge-pill");let _=Array.from(InventoryProfile.all.values()).length,m="badge badge-success badge-pill";0===_&&(m="badge badge-danger badge-pill"),Ue.classList=d,Ue.innerText=r,We.classList=c,We.innerText=s,Qe.classList=p,Qe.innerText=u,ze.classList=m,ze.innerText=_,$(je).empty().html(Product.detail.description_short),$(Ye).empty().html(Product.detail.description_long),Dt()}console.groupEnd()},Dt=function(){console.groupCollapsed("Product.updateProductSKU");let e=Product.attr1,t=Product.attr2,a=Product.attr3,n="";return is_null(e)||is_null(t)||is_null(a)?(S&&(S.value=""),is_null(e),is_null(t),is_null(a)):(n=e.replace(/-/g,"")+"-"+t.replace(/-/g,"")+"-"+a.replace(/-/g,""),S&&(S.value=n),Ce&&(Ce.value=n)),console.groupEnd(),n},Ft=function(){console.groupCollapsed("Product.updateProductDetails");isNaN(parseInt(Ee.value))||parseInt(Ee.value),isNaN(parseInt(De.value))||parseInt(De.value),isNaN(parseInt(He.value))||parseInt(He.value);let e=function(){console.groupCollapsed("Product.buildProductDetailRecord");let e=Dt(),t=we&&!0===we.checked?1:0,a=isNaN(parseInt(ge.value))?null:parseInt(ge.value),n=isNaN(parseInt(me.value))?null:parseInt(me.value),o=$e&&""!==$e.value?$e.value:null,i=isNaN(parseInt(Ee.value))?null:parseInt(Ee.value);isNaN(parseInt(De.value))||parseInt(De.value),isNaN(parseInt(He.value))||parseInt(He.value);return console.groupEnd(),removeNulls({id:i||null,rating_types_id:a||null,currency_id:n||null,name:o||null,sku:e||null,enabled:t})}();confirmDialog("Would you like to update?",t=>{t&&function(e,t){if(console.groupCollapsed("Product.sendRequestUpdateProductDetail"),e){let a="/api/v1.0/products/update_detail";try{sendPostRequest(a,e,function(e,a,n){if(e)return t(e)})}catch(e){return Lt("Error")}}console.groupEnd()}(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);Bt(t);K&&Mt(),Lt(`Product ${t.name} was updated.`,"Product","success")}})}),console.groupEnd()},Tt=function(e){console.groupCollapsed("Product.initEditForm");let t=function(){console.groupCollapsed("Product.setDefaultProductDetails");return console.groupEnd(),{location:{},provider:{},vendor:{},seasons:[],units:[],variants:[],profiles:[],matrix:[]}}();e&&(t=e),Array.prototype.forEach.call(mt,function(e){}),function(e){console.groupCollapsed("Product.setEditFormValues");let t,a=Bt(e),n=isNaN(parseInt(e.id))?null:parseInt(e.id),o=e.sku?e.sku:"",i=e.name?e.name:"",l=(e.day_span&&e.day_span,e.rating_types_id?e.rating_types_id:""),r=e.enabled&&1===e.enabled,d=e.currency_id?e.currency_id:"",s=e.description_long?e.description_long:"",c=e.description_short?e.description_short:"",u=e.keywords?e.keywords:[],p=e.amenities?e.amenities:[],_=e.images?e.images:[];a.category&&(t=a.category),Product.fileManager=$("#product_images").fileManager({height:400,source:"product",sourceId:n,images:_}),ut=$(he).BuildKeyword(u),pt=$(Ie).BuildKeyword(p),$e.value=i,Ce.value=o,we.checked=r,ve.value=c,fe.value=s,me.value=d,ge.value=l,Product.attr1=t.attribute_id?t.attribute_id:null,$("#page").on("change",function(){Mt()}),console.groupEnd()}(t),console.groupEnd()},Rt=function(e){let t,a,n,o;console.groupCollapsed("Product.index"),be&&(console.groupCollapsed("Product.buildIndexTable"),_t=$(be).table({table_type:"display_list",data:[],columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:1,data:"sku",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Provider",targets:2,data:"provider",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e.name+"</span>"}},{title:"Vendor",targets:3,data:"vendor",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e.name+"</span>"}},{title:"Location",targets:4,data:"location",render:function(e,t,a,n){let o="";return"<span style='white-space: nowrap;'>"+(o=e.display_medium)+"</span>"}},{title:"Category",targets:5,data:"category",render:function(e,t,a,n){return"<span style='white-space: nowrap;'>"+e.name+"</span>"}}],rowClick:Product.navigate}),console.groupEnd()),e&&(a=e.products?e.products:[],n=e.stations?e.stations:[],o=e.airports?e.airports:[],t=e.category?e.category:[]),xt(a),w&&(validator_init(ht),Product.validator=$(l).validate(),Product.attr1=null,Product.attr2=null,Product.attr3=null,$(document).ready(function(){Category.initProductModal(t),Provider.init(),Airport.init({airports:o}),Station.init({stations:n}),Ze&&(Product.product_keywords=$(Ze).BuildKeyword([])),d&&(Product.depart_from_date=$(d).dateSelect({onStart:function(){}})),r&&(Product.depart_from_time=$(r).timeSelect({onStart:function(){}})),c&&(Product.arrive_to_date=$(c).dateSelect({onStart:function(){}})),s&&(Product.arrive_to_time=$(s).timeSelect({onStart:function(){}})),j&&(Product.depart_from_station_date=$(j).dateSelect({onStart:function(){}})),V&&(Product.depart_from_station_date=$(V).dateSelect({onStart:function(){}})),H&&(Product.arrive_to_station_time=$(H).timeSelect({onStart:function(){}})),z&&(Product.depart_from_station_time=$(z).timeSelect({onStart:function(){}})),$t()})),console.groupEnd()},At=function(e){console.groupCollapsed("Product.initAutoComplete");let t=e&&!isNaN(parseInt(e))?parseInt(e):isNaN(parseInt(k.value))?null:parseInt(k.value);null!==t&&$(C).on("change",function(){}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/products",minChars:2,params:{category_id:t},cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;e.data}}),console.groupEnd()};return{validator:null,depart_from_date:null,depart_from_time:null,calendars:null,product_keywords:null,product_initial_location:null,provider_initial_location:null,arrive_to_station_time:null,depart_from_station_time:null,arrive_to_station_date:null,depart_from_station_date:null,detail:{},all:new Map,attr1:null,attr2:null,attr3:null,newProduct_validator:null,enableNewFormDetails:function(){!function(){console.groupCollapsed("Product.enableNewFormDetails"),$t();let e=k&&!isNaN(parseInt(k.value))?parseInt(k.value):null,t=C&&""!==C.value?C.value:null,a=y&&""!==y.value?y.value:null,n=b&&""!==b.value?b.value:null;e&&(C.disabled=!1,t&&(y.readOnly=!1,b.readOnly=!1,P.disabled=!1,a&&n&&(N.disabled=!1,B.disabled=!1,x.disabled=!1,Je.disabled=!1,Ge.disabled=!1,v.disabled=!1,Product.product_keywords.readOnly(!1),1===e&&(tt.disabled=!1,x.disabled=!1),2===e&&(x.value=2,x.disabled=!0,N.disabled=!0,at.disabled=!1,Xe.disabled=!1,et.disabled=!1),3===e&&(x.value=3,x.disabled=!0,nt.disabled=!1),4===e&&(x.value=2,ot.disabled=!1),5===e&&(x.value=2,it.disabled=!1),6===e&&(x.value=2,lt.disabled=!1,x.disabled=!1),7===e&&(x.value=2,rt.disabled=!1)))),console.groupEnd()}()},disableNewFormDetails:function(){$t()},updateDisplay:function(){Pt()},updateProgress:function(){Mt(),$("html").css({overflow:"auto"})},updateProductSKU:function(){Dt()},setNewFormDetails:function(e){console.groupCollapsed("Product.setNewFormDetails"),console.groupEnd()},get:function(e){console.groupCollapsed("Product.get"),console.groupEnd()},loadAll:function(e){xt(e)},save:function(e){Nt(e)},init:function(e){!function(e){let t,a,n,o,i,l,r,d,s,c,u,p,_;console.groupCollapsed("Product.init"),console.log("settings",e),K&&$(document).ready(function(){if(dt=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,st=document.getElementById("category_id")?isNaN(parseInt(document.getElementById("category_id").value))?null:parseInt(document.getElementById("category_id").value):null,ct=document.getElementById("product_id")?isNaN(parseInt(document.getElementById("product_id").value))?null:parseInt(document.getElementById("product_id").value):null,e&&e.product_details){(t=e.product_details).images&&(_=t.images),t.provider&&(l=t.provider),t.vendor&&(r=t.vendor),t.variants&&(a=t.variants),t.seasons&&(n=t.seasons),t.matrices&&(d=t.matrices),t.profiles&&(i=t.profiles),t.units&&(o=t.units),t.pricings&&(s=t.pricings),t.location&&(c=t.location),t.arriving_location&&(u=t.arriving_location),t.departing_location&&(p=t.departing_location);let m={pricing_strategy_types_id:isNaN(parseInt(t.pricing_strategy_types_id))?null:parseInt(t.pricing_strategy_types_id)};switch(Provider.init({provider_detail:l}),Vendor.init({vendor_detail:r}),Variant.init(a),Season.init(n),Season.loadAll(n),Unit.init({units:o}),Matrix.init({matrices:d}),Pricing.init({pricings:s}),InventoryProfile.init({profiles:i}),PricingWorksheet.init({pricing_strategy:m,pricings:s}),Product.calendar=$("#calendar").YearCalendar({displayEventTime:!1,calendarType:"season",events:[]}),st){case 1:ProductLocation.init({product_location:c,product:t});break;case 2:ProductLocation.init({product_location:c,departing_location:p,arriving_location:u,product:t});break;case 3:ProductLocation.init({product_location:c,product:t});break;case 4:ProductLocation.init({product_location:c,departing_location:p,arriving_location:u,product:t});break;case 5:ProductLocation.init({product_location:c,product:t});break;case 6:ProductLocation.init({product_location:c,product:t}),Tour.init({route:[]});break;case 7:case 8:case 9:ProductLocation.init({product_location:c,product:t})}$(G).on("click",function(){$(J).tab("show")}),$(_e).on("click",function(){$(ce).tab("show")}),$(Z).on("click",function(){$(X).tab("show")}),$(ee).on("click",function(){$(te).tab("show")}),$(ae).on("click",function(){$(ne).tab("show")}),$(oe).on("click",function(){$(ie).tab("show")}),$(le).on("click",function(){$(re).tab("show")}),$(de).on("click",function(){$(se).tab("show")}),$(pe).on("click",function(){$(ue).tab("show")}),At(),Tt(t),Mt()}}),ye&&Product.index(e),console.groupEnd()}(e)},index:function(e){Rt(e)},navigate:function(e){!function(e){console.groupCollapsed("Product.navigate"),e&&e.id&&window.location.replace("/products/"+e.id),console.groupEnd()}(e)},clearModalForm:function(){vt()},resetNewProductDetails:function(){console.groupCollapsed("Product.resetNewProductDetails"),yt(),Product.depart_from_date.value(""),Product.arrive_to_date.value(""),Station.resetStationForm("depart_from"),Station.resetStationForm("arrive_to"),Station.resetStationForm("depart_from"),Station.resetStationForm("arrive_to"),r.value="",s.value="",u.value="",p.value="",I.value="",E.value="",y.value="",b.value="",U.value="",C.value="",S.value="",q.value="",N.value="",B.value="",x.value="",C.disabled=!0,S.disabled=!0,Ke.disabled=!0,N.disabled=!0,B.disabled=!0,clearAllValidation(),console.groupEnd()},initAutoComplete:function(){At()}}}();$(function(){const e=document.getElementById("profile_card"),t=document.getElementById("profile_card_cover_image"),a=document.getElementById("profile_edit_name");$(a).on("click",function(){});const n=function(){parseInt($(e).outerHeight());let a,n=parseInt($(e).outerWidth()),o=0;a=n/2+"px",o=n+"px",$(t).css({width:"100%",height:"100%","max-height":a+"px"})};window.addEventListener("resize",debounce(function(t){e&&n()})),n()}),$(document).ready(function(){window.addEventListener("load",function(){const e=document.getElementsByTagName("input");mdbPreloader&&$(mdbPreloader).delay(500).fadeOut(300);for(let t=0;t<e.length;t++)"text"===e[t].type&&(e[t].classList.contains("date-format"),e[t].classList.contains("time-format"))},!1),window.addEventListener("resize",debounce(function(e){resize_elements()})),(new WOW).init(),$(this).scrollTop(0),$("body").scrollTop(),$.fn.dataTableExt.afnFiltering.push(function(e,t,a){if("dates_table"===e.nTable.id){let e=document.getElementById("min").value,a=document.getElementById("max").value,n=1,o=1;e=e.substring(6,10)+e.substring(3,5)+e.substring(0,2),a=a.substring(6,10)+a.substring(3,5)+a.substring(0,2);let i=t[n].substring(6,10)+t[n].substring(3,5)+t[n].substring(0,2),l=t[o].substring(6,10)+t[o].substring(3,5)+t[o].substring(0,2);return""===e&&""===a||(e<=i&&""===a||(a>=l&&""===e||e<=i&&a>=l))}return e.nTable.id,!0}),"scrollRestoration"in history&&(history.scrollRestoration="manual"),$(".button-collapse").sideNav(sideNavOptions),window.scrollTo(0,0),resize_elements(),$(function(){$('[data-toggle="tooltip"]').tooltip()}),document.querySelectorAll(".panel-code").forEach(e=>{let t=$(e).html(),a="",n="";$(e).empty(),"json"===e.dataset.datatype?(a=jsonPrettify(t),n="json"):"jsonp"===e.dataset.datatype?(a=jsonPrettify(t),n="jsonp"):"json5"===e.dataset.datatype&&(a=jsonPrettify(t),n="json5");let o=document.createElement("pre"),i=document.createElement("code");i.classList=[`language-${n}`],i.innerHTML=a,o.appendChild(i),e.appendChild(o),Prism.highlightElement(i)}),$("button.pre_display_button").show(),$("div.pre_display_el").hide(),$(function(){$("textarea.short-description").maxlength({alwaysShow:!0,threshold:10,warningClass:"badge badge-warning",limitReachedClass:"badge badge-danger"})}),$(function(){toastr.options={closeButton:!0,debug:!0,newestOnTop:!0,progressBar:!1,positionClass:"md-toast-bottom-right",preventDuplicates:!0,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}})});