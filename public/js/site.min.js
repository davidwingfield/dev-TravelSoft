const mySQLDate="",defaultLocationDisplayFormat="medium",sideNavOptions={edge:"left",closeOnClick:!1,breakpoint:1199,menuWidth:240,timeDurationOpen:500,timeDurationClose:500,timeDurationOverlayOpen:200,timeDurationOverlayClose:200,easingOpen:"easeInOutQuad",easingClose:"easeInOutQuad",showOverlay:!0,showCloseButton:!1,slim:!1,onOpen:null,onClose:null,mode:"over"},toastrOptions={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"md-toast-bottom-right",preventDuplicates:!0,onclick:null,showDuration:3e8,hideDuration:1e9,timeOut:5e6,extendedTimeOut:1e6,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},dow_short=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],days=[{name:"Sunday",short:"Sun"},{name:"Monday",short:"Mon"},{name:"Tuesday",short:"Tue"},{name:"Wednesday",short:"Wed"},{name:"Thursday",short:"Thu"},{name:"Friday",short:"Fri"},{name:"Saturday",short:"Sat"}],dowStart=1,short_dexcription_max=250,colorScheme=new Map,toggleAJAXResponse=!1,debugMode=!0;colorScheme.set(1,{name:"Color - 1",backGround:"#bdbdbd",borderColor:"#686868",textColor:"#000"}),colorScheme.set(2,{name:"Color - 2",backGround:"#54cbe3",borderColor:"#357f8e",textColor:"#000"}),colorScheme.set(3,{name:"Color - 3",backGround:"#49de94",borderColor:"#2d895b",textColor:"#000"}),colorScheme.set(4,{name:"Color - 4",backGround:"#ab8c82",borderColor:"#564641",textColor:"#000"}),colorScheme.set(5,{name:"Color - 5",backGround:"#ffcd17",borderColor:"#aa890f",textColor:"#000"}),colorScheme.set(6,{name:"Color - 6",backGround:"#96a3fa",borderColor:"#636ca5",textColor:"#000"}),colorScheme.set(7,{name:"Color - 7",backGround:"#fa983c",borderColor:"#a56428",textColor:"#000"}),colorScheme.set(8,{name:"Color - 8",backGround:"#17b3a3",borderColor:"#0c5e56",textColor:"#000"}),colorScheme.set(9,{name:"Color - 9",backGround:"#76838f",borderColor:"#30353a",textColor:"#fff"}),colorScheme.set(10,{name:"Color - 10",backGround:"#910112",borderColor:"#3c0007",textColor:"#fff"}),colorScheme.set(11,{name:"Color - 11",backGround:"#ff666b",borderColor:"#aa4447",textColor:"#000"}),colorScheme.set(12,{name:"Color - 12",backGround:"#3e8ef7",borderColor:"#295da2",textColor:"#000"}),colorScheme.set(13,{name:"Color - 13",backGround:"#f74584",borderColor:"#a22d57",textColor:"#000"}),colorScheme.set(14,{name:"Color - 14",backGround:"#5a9101",borderColor:"#253c00",textColor:"#fff"}),colorScheme.set(15,{name:"Color - 15",backGround:"#9463f7",borderColor:"#6141a2",textColor:"#fff"});const tableCellMaxChars=10,defaultAddressView="medium",DEBUGMODE=!0,inactivityTimeout=36e5,initialCalenderViewCount=12,FILE_TYPES={aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",mid:"audio/midi audio/x-midi",midi:"audio/midi audio/x-midi",mjs:"text/javascript",mp3:"audio/mpeg",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"text/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","7z":"application/x-7z-compressed"},STANDARD_ASPECT_RATIOS=[[1,"1:1"],[4/3,"4:3"],[5/4,"5:4"],[1.5,"3:2"],[1.6,"16:10"],[16/9,"16:9"],[21/9,"21:9"],[32/9,"32:9"]];let ERROR_ALLOWED=.05,RATIOS=STANDARD_ASPECT_RATIOS.map(function(e){return e[0]}).sort(),LOOKUP=Object();for(let e=0;e<STANDARD_ASPECT_RATIOS.length;e++)LOOKUP[STANDARD_ASPECT_RATIOS[e][0]]=STANDARD_ASPECT_RATIOS[e][1];let mdbPreloader=document.getElementById("mdb-preloader");$.fn.BuildDropDown=function(e){if(!e||!e.text_field||!e.id_field)return;let t=document.getElementById($(this).attr("id")),n=e.data?e.data:[],a=(e.class_list&&e.class_list,e.id_field?e.id_field:""),i=e.text_field?e.text_field:"",o=e.title?e.title:"Select Option",l=!!e.first_selectable&&e.firstSelectable,d=!!e.select2&&e.select2,r=e.type?e.type:"";if($(t).empty(),"multiple"===r&&t.setAttribute("multiple","multiple"),!1===l){let e=$(document.createElement("option")).prop({value:"",text:"-- "+o.charAt(0).toUpperCase()+o.slice(1)+" --",disabled:!0}).attr("readonly","readonly");$(t).append(e)}$.each(n,function(e,n){let o=n[a],l=n[i];$(t).append($(document.createElement("option")).prop({value:o,text:l.charAt(0).toUpperCase()+l.slice(1)}))}),$(t).val(""),d&&$(t).select2()};const calculateWidth=(e,t,n)=>{let a=e.value/t.value;return parseFloat((n*a).toFixed(2))},calculateHeight=(e,t,n)=>{return parseFloat((n/(e/t)).toFixed(2))},gcd=function(e,t){return 0===t?e:gcd(t,e%t)},shadeColor=function(e,t){var n=parseInt(e.substring(1,3),16),a=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);return n=parseInt(n*(100+t)/100),a=(a=parseInt(a*(100+t)/100))<255?a:255,i=(i=parseInt(i*(100+t)/100))<255?i:255,"#"+(1===(n=n<255?n:255).toString(16).length?"0"+n.toString(16):n.toString(16))+(1===a.toString(16).length?"0"+a.toString(16):a.toString(16))+(1===i.toString(16).length?"0"+i.toString(16):i.toString(16))},clearAllValidation=function(){$("div.error").html("&nbsp;").hide(),$(".is-invalid").removeClass("is-invalid")};$.fn.showError=function(e){let t=this.parents("div.form-element").find("div.error");return this.addClass("is-invalid"),t.html(e).show(),this},$.fn.hideError=function(){let e=this.parents("div.form-element").find("div.error");return this.removeClass("is-invalid"),e.html("&nbsp;").hide(),this};const hexToRgb=e=>e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,a)=>"#"+t+t+n+n+a+a).substring(1).match(/.{2}/g).map(e=>parseInt(e,16));jQuery.fn.dataTable.Api.register("page.jumpToData()",function(e,t){var n=this.column(t,{order:"current"}).data().indexOf(e);if(n>=0){var a=Math.floor(n/this.page.info().length);this.page(a).draw(!1)}return this});const isOdd=function(e){return e%2},clearValidation=function(e){$(".autocomplete-suggestions").hide();let t=$(e).validate();$("[name]",e).each(function(){t&&(t.successList&&t.successList.push(this),t.showErrors())}),$(".is-invalid").each(function(){t&&(t.successList&&t.successList.push(this),t.showErrors())}),t&&(t.resetForm(),t.reset())},get_errors=function(e){},validator_init=function(e){let t={},n={},a={};return e&&(e.rules&&(t=e.rules),e.messages&&(n=e.messages),e.groups&&(a=e.groups)),jQuery.validator.setDefaults({rules:t,messages:n,groups:a,ignore:"",success:"valid",invalidHandler:function(e,t){t.numberOfInvalids();let n=t.findLastActive()||t.errorList.length&&t.errorList[0].element;n&&$(n).closest(".accordion-body").collapse("show")},errorElement:"span",highlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");a.attr("data-ref")?$("#"+a.attr("data-ref")).addClass("is-invalid"):(n.parent().find("span.select2").addClass("is-invalid"),n.addClass("is-invalid")),a&&a.css({display:"block"})},unhighlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");n.parents("div.form-element").find("span.select2").removeClass("is-invalid"),n.removeClass("is-invalid"),a&&a.css({display:"none"})},errorPlacement:function(e,t){let n=t.attr("id");$("#"+n+"-error").html(e)},submitHandler:function(e){return!0}}),jQuery.validator.addMethod("postalCode",function(e){return/^((\d{5}-\d{4})|(\d{5})|([A-Z]\d[A-Z]\s\d[A-Z]\d))$/.test(e)},"Please enter a valid postal code."),jQuery.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("phoneIT",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator},initializeValidator=function(e){let t={},n={},a={};return e&&(e.rules&&(t=e.rules),e.messages&&(n=e.messages),e.groups&&(a=e.groups)),jQuery.validator.setDefaults({rules:t,messages:n,groups:a,ignore:"",success:"valid",invalidHandler:function(e,t){t.numberOfInvalids();let n=t.findLastActive()||t.errorList.length&&t.errorList[0].element;n&&$(n).closest(".accordion-body").collapse("show")},errorElement:"span",highlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");a.attr("data-ref")?$("#"+a.attr("data-ref")).addClass("is-invalid"):(n.parent().find("span.select2").addClass("is-invalid"),n.addClass("is-invalid")),a&&a.css({display:"block"})},unhighlight:function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");n.parents("div.form-element").find("span.select2").removeClass("is-invalid"),n.removeClass("is-invalid"),a&&a.css({display:"none"})},errorPlacement:function(e,t){let n=t.attr("id");$("#"+n+"-error").html(e)},submitHandler:function(e){return!0}}),jQuery.validator.addMethod("postalCode",function(e){return/^((\d{5}-\d{4})|(\d{5})|([A-Z]\d[A-Z]\s\d[A-Z]\d))$/.test(e)},"Please enter a valid postal code."),jQuery.validator.addMethod("phoneUS",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("phoneIT",function(e,t){return e=e.replace(/\s+/g,""),this.optional(t)||e.length>9&&e.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator},jsonPrettify=e=>{if("object"==typeof e&&null!==e)return JSON.stringify(e,void 0,"\t");try{const t=JSON.parse(e);return jsonPrettify(t)}catch(t){return e}},setError=function(e,t){let n=$(e).attr("id"),a=$("#"+n),i=$("#"+n+"-error");i.attr("data-ref")?$("#"+i.attr("data-ref")).addClass("is-invalid"):(a.parent().find("span.select2").addClass("is-invalid"),a.addClass("is-invalid")),i&&i.css({display:"block"}),$(i).append(`<span id="#${n}-error" class="invalid">${t}</span>`)},clearError=function(e){let t=$(e).attr("id"),n=$("#"+t),a=$("#"+t+"-error");a.attr("data-ref")?$("#"+a.attr("data-ref")).removeClass("is-invalid"):(n.parent().find("span.select2").removeClass("is-invalid"),n.removeClass("is-invalid")),a&&($(a).empty(),a.css({display:"none"}))},toNumbers=e=>e.map(Number),remove_nulls=function(e){let t={};return $.each(e,function(e,n){null===n||(t[e]=n)}),t},removeNulls=function(e){let t={};return $.each(e,function(e,n){null===n||(t[e]=n)}),t},buildMap=function(e,t){let n=new Map;return $.each(e,function(e,a){n.set(a[t],a)}),n},getListOfIds=function(e){if(e){if("string"==typeof e){let t=e.replace(/\s/g,"");return Array.from(t.split(","),Number)}if("object"==typeof e)return e}return[]},formatListOfIds=function(e){let t="";return e&&"object"==typeof e&&(t=e.join(",")),t},sendGetRequest=function(e,t,n){let a=[];if(!e||!t){let n=[];return e||n.push("url"),t||n.push("data_to_send"),handleError("Missing Data: "+n.join(", "))}$.getJSONRequest(e,t,function(e,t,i){return"success"===t&&void 0!==e.result?(a=e.result,n(a)):"failed"===t&&void 0===e.error?handleError(e):"success"===t&&void 0!==e.error?handleError(e.error):void 0})},sendPostRequest=function(e,t,n){let a=[];if(!e||!t)return e||(void 0).push("url"),t||(void 0).push("data_to_send"),handleError("Missing Data: "+(void 0).join(", "));$.postJSON(e,t,function(e,t,i){return"success"===t&&void 0!==e.result?e.result?(a=e.result,n(a)):handleError("Error Posting Data 1"):"failed"===t&&void 0===e.result?e.error?handleError(e.error):handleError("Error Posting Data"):handleError("Error Posting Data 2")})},getAjaxError=function(e,t,n){let a="",i={message:"",status:"",uri:n};return 404===e.status&&(a="Requested page( "+n+" ) not found. [404]"),i.message=a,i.status=e.status,i.uri=n,i.jqXHR=e,i},_display_ajax_error=function(e,t,n){let a="",i={message:"",status:"",uri:n};return a=0===e.status?"Not connected, verify Network.":404===e.status?"Requested page( "+n+" ) not found. [404]":500===e.status?e.responseJSON?e.responseJSON:"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error."+e.responseText,i.message=a,i.status=e.status,i.uri=n,i.jqXHR=e,i},handleError=function(e){e||(e="3Error processing request"),toastr.error(" -- "+e)},validInt=function(e){return e&&!isNaN(parseInt(e))?parseInt(e):null},formatDateMySQL=function(e){if(!e){new Date}return moment(e).format("YYYY-MM-DD HH:mm:ss")},resize_elements=function(){const e=document.getElementById("page"),t=document.getElementById("main"),n=document.getElementsByClassName("double-nav"),a=document.getElementById("screen_width"),i=document.getElementById("screen_height"),o=document.getElementsByClassName("page-footer"),l=document.getElementById("slide-out"),d=document.getElementById("page_header");let r=0,s=0,c=0,u=0,m=0,_=0;r=window.innerHeight,s=window.innerWidth,$.each(n,function(e,t){let n=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());c+=n}),$.each(o,function(e,t){let n=isNaN(parseInt($(t).outerHeight()))?0:parseInt($(t).outerHeight());_+=n});let p=r-_-c-1+"px";l&&(m=isNaN(parseInt($(l).outerHeight()))?0:parseInt($(l).outerHeight()),u=isNaN(parseInt($(l).width()))?0:parseInt($(l).width())),e&&i&&a&&(t&&$(t).css({"padding-left":u+"px","min-height":r-_-c+"px!important"}),e&&e.setAttribute("style","min-height:"+p+"!important"),d&&d.setAttribute("style","margin-top:"+c+"px;"),i.innerText=r+"",a.innerText=s+"")},debounce=function(e){var t;return function(n){t&&clearTimeout(t),t=setTimeout(e,100,n)}},populateMultiSelect=function(e,t){for(var n,a=0,i=t.options.length;a<i;a++)n=t.options[a],-1!==e.indexOf(n.value)&&(n.selected=!0)},findObjectByKey=function(e,t,n){let a=[];for(var i=0;i<e.length;i++)e[i][t]===n&&a.push(e[i]);return a},addTinyMCE=function(e){tinymce.init({selector:"#"+e,menubar:!1,height:"400",plugins:"print visualblocks visualchars charmap hr pagebreak advlist lists",content_css:["https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","/assets/css/bootstrap.min.css","/assets/css/style.css"],body_class:"p-2",font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Open Sans=Open Sans; Roboto=Roboto;Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",toolbar1:"undo redo | styleselect | fontselect fontsizeselect | removeformat | numlist bullist checklist | outdent indent ",toolbar2:"cut copy | bold italic underline strikethrough | forecolor | alignleft aligncenter alignright alignjustify | backcolor",content_style:'body { font-family:"Roboto",sans-serif", sans-serif; font-size:14px; font-weight: 400 }',style_formats:[{title:"Headers",items:[{title:"h1",block:"h1"},{title:"h2",block:"h2"},{title:"h3",block:"h3"},{title:"h4",block:"h4"},{title:"h5",block:"h5"},{title:"h6",block:"h6"}]},{title:"Blocks",items:[{title:"p",block:"p"},{title:"div",block:"div"},{title:"pre",block:"pre"}]},{title:"Containers",items:[{title:"section",block:"section",wrapper:!0,merge_siblings:!1},{title:"article",block:"article",wrapper:!0,merge_siblings:!1},{title:"blockquote",block:"blockquote",wrapper:!0},{title:"hgroup",block:"hgroup",wrapper:!0},{title:"aside",block:"aside",wrapper:!0},{title:"figure",block:"figure",wrapper:!0}]}],branding:!1,resize:!1,setup:function(e){e.on("change",function(){e.save()})}})},htmlDecode=function(e){return $("<textarea/>").html(e).text()},is_null=function(e){return null==e};function decodeHtml(e){e||(e="");var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g,function(e){return t[e]})}function escapeHtml(e){e||(e="");var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}const setInt=function(e){let t=null;return e&&(isNaN(parseInt(e))||(t=e)),t},inactivityTime=function(){let e;function t(){location.href="/logout"}function n(){clearTimeout(e),e=setTimeout(t,inactivityTimeout)}window.onload=n,document.onmousemove=n,document.onkeydown=n},htmlEncode=function(e){return $("<textarea/>").text(e).html()},paddy=function(e,t,n){var a=void 0!==n?n:"0",i=new Array(1+11).join(a);return(i+e).slice(-i.length)},generateCodeDirectId=function(e){return e?"D"+(t=14,a=void 0!==n?n:"0",((i=new Array(1+11).join(a))+t).slice(-i.length)):"";var t,n,a,i},getDate=function(e){if(e.pickadate("picker"))return e.pickadate("picker").get()};jQuery.extend({postJSON:function(e,t,n){let a=$.ajax({url:e,type:"POST",data:t,dataType:"json"});return a.done(function(e){if($.isFunction(n))return n(e,"success"),!0}),a.fail(function(e,t,a){return $.isFunction(n)&&(e.responseJSON,n(e,"failed")),!1}),a},getJSONRequest:function(e,t,n){let a=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!0});a.done(function(e){$.isFunction(n)&&n(e,"success")}),a.fail(function(t,a,i){let o=getAjaxError(t,0,e);if(void 0!==a){_display_ajax_error(t,a,e)}else{_display_ajax_error(t,a,e)}$.isFunction(n)&&(i=o.message,n(i,"failed"))})},getJSON:function(e,t,n){let a=$.ajax({url:e,type:"GET",data:t,dataType:"json",async:!1});a.done(function(e){$.isFunction(n)&&n(e,"success")}),a.fail(function(e,t,a){$.isFunction(n)&&n(a,"failed")})}});const infoDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-info" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">${e}</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-info fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-info btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-info waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body");const n=document.getElementById("modalConfirm");if(n){const e=$(n);e.modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){t(!0),e.modal("hide")}),$(".btn-no").click(function(){t(!1),e.modal("hide")}),e.on("hidden.bs.modal",function(){e.remove()})}},confirmDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n            <div class="modal-dialog modal-sm modal-notify modal-info" role="document">\n                \x3c!--Content--\x3e\n                <div class="modal-content text-center">\n                    \x3c!--Header--\x3e\n                    <div class="modal-header d-flex justify-content-center">\n                        <p class="heading">${e}</p>\n                    </div>\n                    \x3c!--/.Header--\x3e\n                    \n                    \x3c!--Body--\x3e\n                    <div class="modal-body">\n                        <i class="fas fa-check fa-4x mb-3 animated rotateIn"></i>\n                    </div>\n                    \x3c!--/.Body--\x3e\n                   \n        \n                    \x3c!--Footer--\x3e\n                    <div class="modal-footer flex-center">\n                        <a type="button" class="btn btn-outline-info btn-sm waves-effect btn-no">no</a>\n                        <a class="btn btn-info btn-sm btn-yes">yes</a>\n                    </div>\n                    \x3c!--/.Footer--\x3e\n                    \n                </div>\n                \n                \x3c!--/.Content--\x3e\n\t        </div>\n        </div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body");const n=document.getElementById("modalConfirm");if(n){const e=$(n);e.modal({backdrop:"static",keyboard:!1}),$(".btn-yes").on("click",function(){t(!0),e.modal("hide")}),$(".btn-no").click(function(){t(!1),$("#modalConfirm").modal("hide")}).on("click",function(){t(!1),e.modal("hide")}),e.on("hidden.bs.modal",function(){$("#modalConfirm").remove()})}},deleteDialog=function(e,t){$(`\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-danger" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">${e}</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-times fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-danger btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-danger waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    `).appendTo("body"),$("#modalConfirm").modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){t(!0),$("#modalConfirm").modal("hide")}),$(".btn-no").click(function(){t(!1),$("#modalConfirm").modal("hide")}),$("#modalConfirm").on("hidden.bs.modal",function(){$("#modalConfirm").remove()})},formatURL=function(e){return encodeURIComponent(e.trim())},buildMapsURL=function(e){let t,n,a,i,o,l,d;t=e.name?e.name:null,n=null!==(n=e.street_1?e.street_1:null)?n:null,a=null!==(a=e.street_2?e.street_2:null)?a:null,i=null!==(i=e.zipcode?e.zipcode:null)?i:null,o=null!==(o=e.city.name?e.city.name:null)?o:null,l=null!==(l=e.province.iso2?e.province.iso2:e.province.iso3?e.province.iso3:e.province.name?e.province.name:null)?l:null,d=null!==(d=e.province.name?e.country.name:e.country.iso2?e.country.iso2:e.country.iso3?e.country.iso3:null)?d:null;let r=[];is_null(t=null!==t?t:null)||r.push(t),is_null(n)||r.push(n),is_null(a)||r.push(a),is_null(o);let s="";is_null(o)||is_null(l)||is_null(i)?!is_null(o)||is_null(l)||is_null(i)?is_null(o)&&is_null(l)&&!is_null(i)?s=i:is_null(o)||!is_null(l)||is_null(i)?is_null(o)||is_null(l)||!is_null(i)||(s=o+" "+l):s=i+" "+o:s=i+" "+l:s=i+" "+o+" "+l,""!==s&&r.push(s),is_null(d)||r.push(d);let c=r.join(", ");return`https://maps.google.com/maps?q=${c=encodeURIComponent(c.trim())}&t=&z=7&ie=UTF8&iwloc=&output=embed`},weatherUpdate=function(e){const t=new XMLHttpRequest;let n=e;t.open("GET",`https://api.openweathermap.org/data/2.5/weather?q=${n}&appid=2ad550b2d7e352b38c3ca9da8396aade`),t.send(),t.onload=(()=>{if(404===t.status);else{let e=JSON.parse(t.response);e.name,Math.round(e.main.temp-273.15),e.weather[0].main,e.weather[0].description,e.weather[0].icon}})},ucwords=function(e){return(e=e.toLowerCase()).replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};String.prototype.ucwords=function(){return str=this.toLowerCase(),str.replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,function(e){return e.toUpperCase()})};const trimTrailingChars=function(e,t){return e.replace(new RegExp(t+"+$"),"")},formatSize=function(e,t=2){const n=t<0?0:t;let a,i;var o;if(i=e.toUpperCase(),o="S",(i=(i=(i=(i=i.replace(new RegExp(o+"+$"),"")).replace(/BYTE/g,"BYTES")).replace(/MEGABYTE/g,"MB")).replace(/KILOBYTE/g,"KB")).includes("BYTES")){let e="BYTES";return isNaN(parseInt(i.replace(`/${e}/g`,"")))?null:parseInt(i.replace(`/${e}/g`,""))}if(i.includes("KB")){let e="KB";if(null!==(a=isNaN(parseInt(1024*parseFloat(i.replace(`/${e}/g`,"")).toFixed(n)))?null:parseInt(1024*parseFloat(i.replace(`/${e}/g`,"")).toFixed(n))))return a}else if(i.includes("MB")){let e="MB";if(null!==(a=isNaN(parseInt(2097152*parseFloat(i.replace(`/${e}/g`,"")).toFixed(n)))?null:parseInt(2097152*parseFloat(i.replace(`/${e}/g`,"")).toFixed(n))))return a}};$(function(){$(".debug").on("click",function(){showElements=!0,$(this).attr("data-shown")||($(this).attr("data-shown","true"),showElements=!0),"false"===$(this).attr("data-shown")?($(this).attr("data-shown","true"),showElements=!0):(showElements=!1,$(this).attr("data-shown","false"));let e=document.getElementsByClassName("dev-element");for(let t=0;t<e.length;t++){let n=e[t],a=n.tagName;"input"===a.toLowerCase()?!1===showElements?(n.hidden=!1,n.type="text"):(n.hidden=!0,n.type="hidden"):"label"===a.toLowerCase()&&(!1===showElements?$(n).removeClass("d-none"):$(n).addClass("d-none"))}}),$(".debug_demo").on("click",function(){showElements=!0,$(this).attr("data-shown")||($(this).attr("data-shown","true"),showElements=!0),"false"===$(this).attr("data-shown")?($(this).attr("data-shown","true"),showElements=!0):(showElements=!1,$(this).attr("data-shown","false"));let e=document.getElementsByClassName("dev-element");for(let t=0;t<e.length;t++){let n=e[t],a=n.tagName;"input"===a.toLowerCase()?!1===showElements?(n.hidden=!1,n.type="text"):(n.hidden=!0,n.type="hidden"):"label"===a.toLowerCase()&&(!1===showElements?$(n).removeClass("d-none"):$(n).addClass("d-none"))}})});const Console={error:function(){},log:function(){let e,t,n;arguments.length>0&&(1===arguments.length&&(e="Log Object",n=arguments[0]),2===arguments.length&&("string"==typeof arguments[0]?e=arguments[0]:(e="Log Object",n=arguments[0]),"object"==typeof arguments[1]?(t=" [object] ",n=arguments[1]):"boolean"==typeof arguments[1]?(t=" [boolean] ",n=arguments[1]):"number"==typeof arguments[1]?(t=" [number] ",n=arguments[1]):"bigint"==typeof arguments[1]?(t=" [bigint] ",n=arguments[1]):"string"==typeof arguments[1]?(t=" [string] ",n=arguments[1]):"symbol"==typeof arguments[1]?(t=" [symbol] ",n=arguments[1]):"function"==typeof arguments[1]?(t=" [function] ",n=arguments[1]):(t=" [other] ",n=arguments[1])))}},Icon=function(){const e=function(e){e&&e.icons&&(e.icons,Icon.all=new Map)};return{all:new Map,init:function(t){return e(t)}}}(),ProductLocation=function(){"use strict";document.getElementById("product_location_transport_city_search");const e=document.getElementById("product_edit_location_id"),t=document.getElementById("product_location_search"),n=document.getElementById("product_edit_location_city_id"),a=document.getElementById("product_edit_location_city"),i=document.getElementById("product_edit_location_street_1"),o=document.getElementById("product_edit_location_street_2"),l=document.getElementById("product_edit_location_zipcode"),d=document.getElementById("product_edit_location_location_types_id"),r=document.getElementById("product_edit_location_name"),s=document.getElementById("button_submit_form_product_edit_location"),c=document.getElementById("button_clear_form_product_edit_location"),u=(document.getElementById("product_edit_location_city_edit"),document.getElementById("location_country_id")),m=document.getElementById("location_province_id"),_=document.getElementById("location_city_id"),p=document.getElementById("product_edit_location_form"),g=(document.getElementById("product_location"),document.getElementById("product_id")),f=document.getElementById("category_id");let y={group:{product_edit_location_city:"edit_location_country_id location_province_id location_city_id"},rules:{product_edit_location_city:{required:!0},product_edit_location_name:{required:!0},product_edit_location_location_types_id:{required:!0}},messages:{product_edit_location_city:{required:"Field Required"},product_edit_location_name:{required:"Field Required"},product_edit_location_location_types_id:{required:"Field Required"}}},v=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(s).on("click",function(){M()}),$(c).on("click",function(){I()}),$(l).on("change",function(){ProductLocation.detail.zipcode=""!==l.value?l.value:null,w()}),$(r).on("click",function(){ProductLocation.detail.name=""!==r.value?r.value:null,w()}),$(u).on("change",function(){let e=isNaN(parseInt(u.value))?null:parseInt(u.value);if(null!==e){let t=Country.all.get(e);ProductLocation.detail.country_id=e,ProductLocation.detail.country=t}}),$(m).on("change",function(){let e=isNaN(parseInt(m.value))?null:parseInt(m.value);if(null!==e){let t=Province.all.get(e);ProductLocation.detail.province_id=e,ProductLocation.detail.province=t}}),$(_).on("change",function(){let e=isNaN(parseInt(_.value))?null:parseInt(_.value);if(null!==e){let t=City.all.get(e);ProductLocation.detail.city_id=e,ProductLocation.detail.city=t,w()}}),$(r).on("change",function(){ProductLocation.detail.name=""!==r.value?r.value:null,w()}),$(i).on("change",function(){ProductLocation.detail.street_1=""!==i.value?i.value:null,w()}),$(o).on("change",function(){ProductLocation.detail.street_2=""!==o.value?o.value:null,w()}),$(_).on("change",function(){let e="",t=isNaN(parseInt(u.value))?null:parseInt(u.value),i=isNaN(parseInt(m.value))?null:parseInt(m.value),o=isNaN(parseInt(_.value))?null:parseInt(_.value),l=Country.all.get(t),d=Province.all.get(i),r=City.all.get(o);if(ProductLocation.detail.country=l,ProductLocation.detail.country_id=t,ProductLocation.detail.province=d,ProductLocation.detail.province_id=i,ProductLocation.detail.city=r,ProductLocation.detail.city_id=o,l&&d&&r){let t=r.name,a=d.name,i=l.name;n.value=r.id,e=`${t} (${a}, ${i})`}else e="",n.value="";a.value=e});const h=function(){$(a).on("change",function(){setTimeout(function(){""===a.value&&b()},200)}).on("search",function(){b()}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let n,a,d,s,c=null,m=e.data;E(m);m.country&&(n=m.country,Country.set_detail(n),Country.id=n.id?n.id.toString():null),m.province&&(a=m.province,Province.set_detail(a),c=a.name,Province.id=a.id?a.id.toString():null),m.city&&(s=(d=m.city).name,City.set_detail(d),City.id=d.id?d.id.toString():null),$(u).val(m.city.country_id?m.city.country_id:"").trigger("change"),t.value=`City Center (${s}, ${c})`;let _=r&&""!==r.value?r.value:null,p=l&&""!==l.value?l.value:null,g=i&&""!==i.value?i.value:null,f=o&&""!==o.value?o.value:null;m.name=_,m.street_1=g,m.street_2=f,m.zipcode=p}})},b=function(){l.value="",n.value="",$(u).val("").trigger("change")},I=function(){i.value="",o.value="",l.value="",a.value="",r.value="",d.value="",b()},w=function(){let e,t=buildMapsURL(ProductLocation.detail),n=null,a=document.getElementById("locationMap");a&&($(a).empty().append($("<iframe/>",{id:"locationMapContainer",allowfullscreen:"allowfullscreen",frameborder:"0",src:t})),(e=isNaN(parseInt($(a).actual("width")))?null:parseInt($(a).actual("width")))&&(n=e/2,$("#locationMapContainer").css({height:n+"px",width:e+"px"})))},E=function(e){},B=function(t){if(p&&(I(),t)){let n,s,c={};ProductLocation.detail=t,ProductLocation.display_long=t.display_long,ProductLocation.display_medium=t.display_medium,ProductLocation.display_short=t.display_short;let m="",_=t.name?t.name:null,p=isNaN(parseInt(t.id))?null:parseInt(t.id),g=t.postal_code?t.postal_code:"",f=t.street_1?t.street_1:"",y=t.street_2?t.street_2:"";e.value=p,i.value=f,o.value=y,l.value=g,a.value="",r.value=_,$(d).val(t.type.id.toString()),t.country&&(n=t.country,Country.set_detail(n),Country.id=n.id?n.id.toString():null),t.province&&(s=t.province,Province.set_detail(s),Province.id=s.id?s.id.toString():null),t.city&&(c=t.city,City.set_detail(c),City.id=c.id?c.id.toString():null),ProductLocation.detail.name=t.name?t.name:null,m=c.name+" ("+s.name+", "+n.name+")",a.value=m,$(u).val(n.id?n.id:"").trigger("change"),w()}},k=function(){if($(p).valid()){let t,n,a,s,c,u,m;s=""!==r.value?r.value:null,c=""!==i.value?i.value:null,u=""!==o.value?o.value:null,n=isNaN(parseInt(_.value))?null:parseInt(_.value),m=""!==l.value?l.value:null,t=isNaN(parseInt(e.value))?null:parseInt(e.value),a=isNaN(parseInt(d.value))?null:parseInt(d.value);let p={product_id:isNaN(parseInt(g.value))?null:parseInt(g.value),category_id:isNaN(parseInt(f.value))?null:parseInt(f.value),id:t,city_id:n,location_types_id:a,name:s,street_1:c,street_2:u,zipcode:m,enabled:1,note:null};return removeNulls(p)}},N=function(e){},M=function(){let e=k();e&&confirmDialog("Would you like to update?",t=>{t&&function(e,t){try{sendPostRequest("/api/v1.0/locations/update",e,function(e,n,a){if(e)return t(e)})}catch(e){N("Error Updating Location")}}(e,function(e){let t;e&&(t=e,e[0]&&(t=e[0])),t&&(Product.detail.location=t,Product.updateDisplay(),toastr.success(`Location ${t.id} has been updated`,"Location Updated"))})})};return{validator:null,detail:{id:null,city_id:null,location_types_id:null,name:null,street_1:null,street_2:null,zipcode:null,enabled:1,date_created:formatDateMySQL(),created_by:v,date_modified:formatDateMySQL(),modified_by:v,note:null,display_long:null,display_medium:null,display_short:null,country:[],province:[],city:[],type:[]},display_long:null,display_medium:null,display_short:null,init:function(e){$(document).ready(function(){!function(e){$(document).ready(function(){let t,a=f&&!isNaN(parseInt(f.value))?parseInt(f.value):null;if(e){if(n.value=e.product.city_id?e.product.city_id:null,1===a&&p&&(n.value=e.product.city_id?e.product.city_id:null,(t=e.product_location?e.product_location:null)&&(validator_init(y),ProductLocation.validator=$(p).validate(),$(u).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(m).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(_).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),h(),B(t))),2===a){let t=e.product.city_id?e.product.city_id:null;n.value=t,e.arriving_location&&e.departing_location&&Airport.init(e)}3===a&&(e.product.city_id&&e.product.city_id,n.value=e.product.city_id?e.product.city_id:null,Car.init(e)),6===a&&p&&(n.value=e.product.city_id?e.product.city_id:null,(t=e.product_location?e.product_location:null)&&(validator_init(y),ProductLocation.validator=$(p).validate(),$(u).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(m).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(_).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),h(),B(t)))}})}(e)})}}}();let today=new Date,today_year=today.getFullYear(),today_month=today.getMonth(),today_date=today.getDate();$.fn.productSearch=function(e){};const ProductSearch=function(e){"use strict";const t=document.getElementById("form_product_search"),n=document.getElementById("formProductSearchCitySubmit"),a=document.getElementById("formProductSearchNameSubmit"),i=document.getElementById("formProductSearchGuestSubmit"),o=document.getElementById("formProductSearchName"),l=document.getElementById("product_search_name_display"),d=document.getElementById("form_product_search_hotel_product_name"),r=document.getElementById("buttonProductSearchName"),s=document.getElementById("product_search_room_quantity"),c=document.getElementById("product_search_adult_quantity"),u=document.getElementById("product_search_clild_quantity"),m=document.getElementById("form_product_search_hotel_product_number_of_rooms"),_=document.getElementById("form_product_search_hotel_product_number_of_adults"),p=document.getElementById("form_product_search_hotel_product_number_of_children"),g=document.getElementById("buttonProductSearchGuest"),f=document.getElementById("product_search_room_quantity_display"),y=document.getElementById("product_search_adult_quantity_display"),v=document.getElementById("product_search_children_quantity_display"),h=document.getElementById("buttonProductSearchCity"),b=document.getElementById("formProductSearchCity"),I=document.getElementById("product_search_city_display"),w=document.getElementById("form_product_search_hotel_product_city_id"),E=document.getElementById("formProductSearchCityId"),B=document.getElementById("buttonProductSearchCheckOut"),k=document.getElementById("buttonProductSearchCheckIn"),N=document.getElementById("form_product_search_hotel_product_arrive_date"),M=document.getElementById("form_product_search_hotel_product_depart_date"),x=document.getElementById("product_search_category_display"),C=document.getElementById("product_search_name_icon_display"),S=document.getElementById("formProductSearchIcon"),P=document.getElementById("formProductSearchGuestClose"),D=document.getElementById("formProductSearchCityClose"),L=document.getElementById("formProductSearchNameClose"),F=document.getElementById("form_product_search_hotel_product_category_id"),T=document.getElementById("buttonProductSearchCategory"),R=document.getElementById("formProductSearchNameId"),q=document.getElementById("product_search_subtitle"),A=document.getElementById("button_product_search_panel_hotels_clear"),O=document.getElementById("product_search_check_in_display"),Q=document.getElementById("product_search_check_out_display"),Y=document.getElementById("form_product_search_hotel_product_product_id"),U=document.getElementById("button_product_search_panel_hotels_submit");document.getElementById("product_search_results");let W,j,z,V,H,G,K,J,Z=[];$(t).on("change",function(){}),$(U).on("click",function(){te()}),$(A).on("click",function(){ne()}),$(F).on("change",function(){if(F.dataset.categoryid){le();let e=parseInt(F.dataset.categoryid),t=F.dataset.categoryname,n=F.dataset.categoryicon;switch(F.value=e,C.classList=n+" btn-guest-picker-icon",x.innerText=t,e){case 1:ae();break;case 2:ie()}}}),$(T).on("click",function(){me(),ce(),ue()}),$(k).on("click",function(){me(),ce(),ue()}).datepicker({startDate:"-1d",autoclose:!0,title:function(){return"<div class='popover-header'><span class='cPZwQ'>Select a date to continue</span></div>"},todayHighlight:!1,format:"yyyy-mm-dd",orientation:"bottom auto",showOnFocus:"false",beforeShowDay:function(e){}}).on("changeDate",function(e){const t=document.getElementById("buttonProductSearchCheckIn"),n=document.getElementById("buttonProductSearchCheckIn");let a=$(t).datepicker("getFormattedDate");Z=[X($(t).datepicker("getFormattedDate"))],N.value=a,n&&$(n).find("span#product_search_check_in_display").text(""===a?" — / — / — ":a),$(B).val("").datepicker("setStartDate",""!==a?a:null).datepicker("update").trigger("changeDate").datepicker("update")}),$(B).on("click",function(){me(),ce(),ue()}).datepicker({startDate:"-1d",autoclose:!0,todayBtn:"linked",numberOfMonths:2,title:function(){return"<div class='popover-header'><span class='cPZwQ'>Select a date to continue</span></div>"},clearBtn:!0,todayHighlight:!1,maxViewMode:2,format:"yyyy-mm-dd",orientation:"bottom auto",showOnFocus:"false",toggleActive:!0,autoSize:!0,defaultViewDate:{year:today_year,month:today_month,day:today_date},beforeShowDay:function(e){},beforeShowMonth:function(e){}}).on("changeDate",function(e){const t=document.getElementById("buttonProductSearchCheckOut");let n=$(B).datepicker("getFormattedDate");M.value=n,t&&$(t).find("span#product_search_check_out_display").text(""===n?" — / — / — ":n)}),$(L).on("click",function(){ce()}),$(D).on("click",function(){ue()}),$(P).on("click",function(){me()}),$(n).on("click",function(){se(),me()}),$(a).on("click",function(){de(),ce()}),$(i).on("click",function(){re(),me()}),$(h).on("show.bs.popover",function(){ve()}).on("shown.bs.popover",function(){}).on("hidden.bs.popover",function(){window.removeEventListener("click",_e)}),$(g).on("show.bs.popover",function(){ye()}).on("shown.bs.popover",function(){}).on("hidden.bs.popover",function(){window.removeEventListener("click",pe)}),$(r).on("show.bs.popover",function(){fe()}).on("shown.bs.popover",function(){}).on("hidden.bs.popover",function(){window.removeEventListener("click",_e)});const X=function(e){if(!isNaN(Date.parse(e))){let t=new Date(e+" 00:00"),n=t.getFullYear().toString(),a=(t.getMonth()+1).toString(),i=t.getDate().toString();return 1===a.length&&(a="0"+a),1===i.length&&(i="0"+i),moment(n+"-"+a+"-"+i+" 00:00","YYYY-MM-DD H:mm").valueOf()}},ee=function(e){!function(e,t){if(e)try{sendGetRequest("/api/v1.0/search/hotels",e,function(e,n,a){if(e)return t(e)})}catch(e){}}(e,function(e){})},te=function(){let e=isNaN(parseInt(F.value))?null:parseInt(F.value);if(!e)return;let t={};switch(e){case 1:let n=isNaN(parseInt(_.value))?1:parseInt(_.value),a=isNaN(parseInt(p.value))?0:parseInt(p.value),i=isNaN(parseInt(w.value))?null:parseInt(w.value),o=n+a,l=""!==N.value?N.value:null,d=""!==M.value?M.value:null;i&&l&&d&&(t.category_id=e,t.city_id=i,t.from_date=l,t.to_date=d,t.pax=o,ee(t));break;default:return}},ne=function(){$("div[data-hotel='true'").hide(),$("div[data-flight='true'").hide(),me(),ce(),ue(),re(),de(),se(),x.innerText="** Select **",l.innerText="any",I.innerText="city name",O.innerText="— / — / —",Q.innerText="— / — / —",s.value=1,c.value=1,u.value=0;let e=isNaN(parseInt(s.value))?1:parseInt(s.value),t=isNaN(parseInt(c.value))?1:parseInt(c.value),n=isNaN(parseInt(u.value))?0:parseInt(u.value);f.innerText=e>1?e+" rooms, ":e+" room, ",y.innerText=t>1?t+" adults, ":t+" adult, ",v.innerText=n>1?n+" children":n+" child",C.classList="fas fa-pencil-alt btn-guest-picker-icon",w.value="",F.value="",Y.value="",d.value="",N.value="",p.value="0",_.value="1",m.value="1",M.value="",oe()},ae=function(){r.disabled=!1,h.disabled=!1,k.disabled=!1,B.disabled=!1,g.disabled=!1,$("div[data-hotel='true'").show()},ie=function(){r.disabled=!1,h.disabled=!1,k.disabled=!1,B.disabled=!1,g.disabled=!1,$("div[data-flight='true'").show()},oe=function(){r.disabled=!0,h.disabled=!0,k.disabled=!0,B.disabled=!0,g.disabled=!0},le=function(){ne()},de=function(){if(o){let e=""!==o.value?o.value:"any";l.innerText=e,d.value=e,r&&$(r).popover("hide")}},re=function(){if(s&&c&&u&&m&&_&&p&&f&&y&&v){let e=isNaN(parseInt(s.value))?1:parseInt(s.value),t=isNaN(parseInt(c.value))?1:parseInt(c.value),n=isNaN(parseInt(u.value))?0:parseInt(u.value);f.innerText=e>1?e+" rooms, ":e+" room, ",y.innerText=t>1?t+" adults, ":t+" adult, ",v.innerText=n>1?n+" children":n+" child",m.value=e>1?e:1,_.value=t>1?t:1,p.value=n>0?n:0,g&&$(g).popover("hide")}},se=function(){b&&(I.innerText=""!==b.value?b.value:"city name",w.value=E.value,$(w).trigger("change"))},ce=function(){r&&$(r).popover("hide"),window.removeEventListener("click",_e)},ue=function(){h&&$(h).popover("hide"),window.removeEventListener("click",ge)},me=function(){g&&$(g).popover("hide"),window.removeEventListener("click",pe)},_e=e=>{$(e.target).parents("div.popover")[0]||e.target.className.includes("name-search")||(de(),ce())},pe=e=>{$(e.target).parents("div.popover")[0]||e.target.className.includes("btn-guest-picker")||(re(),me())},ge=e=>{$(e.target).parents("div.popover")[0]||e.target.className.includes("btn-city-picker")||(se(),ue())},fe=function(){window.addEventListener("click",_e)},ye=function(){window.addEventListener("click",pe)},ve=function(){window.addEventListener("click",ge)},he=function(e){$(function(){t&&((J=document.querySelectorAll(".category-dropdown-item")).forEach(e=>e.addEventListener("click",t=>{S.classList=" "+e.dataset.categoryicon+" mr-3 ",C.classList=" "+e.dataset.categoryicon+" btn-guest-picker-icon",x.innerText=e.dataset.categoryname,function(e){$(b).on("search",function(){b.value="",E.value="",se()}).on("click",function(e){$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;E.value=t.id}}),$(o).on("search",function(){o.value="",R.value="",se()}).on("click",function(e){$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/products",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,params:{category_id:e},paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;Y.value=t.id,R.value=t.id}})}(K=parseInt(e.dataset.categoryid)),F.value=K,F.dataset.categoryid=K,F.dataset.categoryname=e.dataset.categoryname,F.dataset.categoryicon=e.dataset.categoryicon,q.innerText=e.dataset.categoryname,$(F).trigger("change"),$(T).trigger("change")})),r&&(z=$("#popoverNameForm .popover-head h5"),V=$("#popoverNameForm .popover-body form"),$(r).popover({placement:"bottom",title:()=>z,html:!0,container:"body",content:()=>V})),h&&(H=$("#popoverCityForm .popover-head h5"),G=$("#popoverCityForm .popover-body form"),$(h).popover({placement:"bottom",title:()=>H,html:!0,container:"body",content:()=>G})),g&&(W=$("#popoverGuestForm .popover-head h5"),j=$("#popoverGuestForm .popover-body form"),$(g).popover({placement:"bottom",title:()=>W,html:!0,container:"body",content:()=>j})),ne())})};return he(),{init:function(e){he()},updateProductCitySearch:function(){se()},updateProductNameSearch:function(){de()},closeProductGuestSearch:function(){me()}}};$(function(){}),$.fn.formFields=function(e){"use strict";let t=$(this).attr("id"),n=document.getElementById(t),a=n.elements,i=document.createElement("pre"),o=document.createElement("code"),l="",d="";o.id="constantFields",o.classList=["language-javascript"],i.appendChild(o),n.appendChild(i);for(var r=0;r<a.length;r++){let e=a[r];if(e.id){let t=e.id;l+=`const _${t} = document.getElementById('${t}')\n`,d+=`_${t}.value = ""\n`}}$(o).attr("data-prismjs-copy","Copy the JavaScript snipp"),o.innerHTML=l+"\n"+d,Prism.highlightElement(o)},jQuery(e=>{e.fn.dateSelect=function(t){let n,a,i,o,l,d,r,s,c,u,m=e(this),_=m.attr("id");m.attr("id","date-selector-"+_);let p={monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],showMonthsShort:void 0,showWeekdaysFull:void 0,today:"Today",clear:"Clear",close:"Close",labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",format:"yyyy-mm-dd",formatSubmit:"yyyy-mm-dd",hiddenPrefix:void 0,hiddenSuffix:"_submit",hiddenName:void 0,editable:void 0,selectYears:void 0,selectMonths:void 0,firstDay:void 0,min:void 0,max:void 0,disable:void 0,container:void 0,containerHidden:void 0,closeOnSelect:!0,closeOnClear:!0,onStart:void 0,onRender:void 0,onOpen:void 0,onClose:void 0,onSet:void 0,onStop:void 0},g={label:"Date",placeholder:"Select Date"};const f=function(t){e(t).parents("div.form-element").find("div.error").html("").hide()},y=function(t,n){let a=t.value;16===n&&(isShift=!0),/(((19|20)\d\d)\-(0[1-9]|1[0-2])\-((0|1)[0-9]|2[0-9]|3[0-1]))$/.test(a)||0===a.length?(f(t),b.picker.set("select",a,{format:"yyyy-mm-dd"}),b.picker.render()):function(t){e(t).parents("div.form-element").find("div.error").html("Invalid Date. Only YYYY-MM-DD format allowed.").show()}(t)},v=function(t,u){n=t,a=e("<div>").addClass("form-element"),i=e("<div>").addClass("input-group"),o=e("<div>").addClass("input-group-append"),l=e("<button type='button'>").attr("id","button-"+_).attr("type","button").addClass("btn btn-md btn-secondary m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-calendar-alt"></i>').on("click",function(e){e.preventDefault()}),c=e("<button type='button'>").attr("id","button-clear-"+_).addClass("btn btn-md btn-outline-danger m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-ban"></i>').on("click",function(){b.clear(),d.val("").trigger("change"),f(d[0])}),d=e("<input>").addClass("form-control date-format").attr("id",_).attr("type","text").attr("placeholder",g.placeholder).attr("maxlength","10").on("keydown",function(e){return t=this,n=e.keyCode,isNaN(parseInt(n))||(n=parseInt(n)),16===n&&(isShift=!0),(n>=48&&n<=57||n>=96&&n<=105||8===n||46===n)&&16!==n&&(4!==t.value.length&&7!==t.value.length||8===n||(t.value+="-"),!0);var t,n}).on("keyup",function(e){y(this,e.keyCode),h()}).on("change",function(){h()}),r=e("<label>").attr("for",_).html(g.label),s=e("<div>").addClass("error w-100 text-center")},h=function(){if(""!==d.val()){c.show();let e=d.attr("id");clearError(document.getElementById(e))}else c.hide()},b={picker:null,val:null,fooListener:function(e){},registerNewListener:function(e){this.fooListener=e},set:function(){var e;e||(e={}),b.picker.set(e,{muted:!0})},value:function(e){return e||(e=null),(t=e)?(b.picker.set("select",t,{format:"yyyy-mm-dd"}),b.picker.render(),null):""===d.val()?null:d.val();var t},clear:function(){b.picker.clear()&&(b.picker.clear(),b.picker.set("select",moment().format("YYYY-MM-DD"),{format:"yyyy-mm-dd"}),b.picker.render(),f(d[0]))},init:function(e,t){I(e,t)}},I=function(t,m){var _;(_=m)&&e.each(_,function(e,t){p[e]=t}),g.label=e(t).attr("data-label")?e(t).attr("data-label"):"Date",g.placeholder=e(t).attr("data-placeholder")?e(t).attr("data-placeholder"):"Select Date",function(e,t){v(e),o.append(c,l),i.append(d,o),a.append(r,i,s),n.append(a),u=l.pickadate("picker")}(t),l.pickadate(p).on("change",function(){""===e(this).val()?d.val(""):d.val(e(this).val()),d.trigger("change")}),u=l.pickadate("picker"),h(),b.picker=l.pickadate("picker")};return I(m,t),b}}),jQuery(e=>{e.fn.timeSelect=function(t){let n,a,i,o,l,d,r,s,c,u,m,_=e(this),p=_.attr("id");_.attr("id","time-selector-"+p);let g={clear:"Clear",format:"h:i A",formatLabel:void 0,formatSubmit:void 0,hiddenPrefix:void 0,hiddenSuffix:"_submit",editable:void 0,interval:30,min:void 0,max:void 0,container:void 0,containerHidden:void 0,closeOnSelect:!0,closeOnClear:!0,onStart:void 0,onRender:void 0,onOpen:void 0,onClose:void 0,onSet:void 0,onStop:void 0},f={label:"Time",placeholder:"Select Time"};const y=function(t){e(t).parents("div.form-element").find("div.error").html("").hide()};function v(t){var n=!0,a=t.split(":");if(2!==a.length)n=!1;else if((isNaN(a[0])||isNaN(a[1]))&&(n=!1),a[0]<24&&a[1]<60){if(!a[0]||!a[1]||isNaN(parseInt(a[0]))||isNaN(parseInt(a[1])))return!1;parseInt(a[0])<=9&&(a[0]="0"+a[0]),parseInt(a[1])<=9&&(a[0]="0"+a[0]),e(u).val(a[0]+":"+a[1])}else n=!1;return n}const h=function(t,n){v(t.value)?y(t):function(t){e(t).parents("div.form-element").find("div.error").html("Invalid Time. Only HH-MM format allowed.").show()}(t)},b=function(t,u){n=t,a=e("<div>").addClass("form-element"),i=e("<div>").addClass("input-group"),o=e("<div>").addClass("input-group-append"),l=e("<button type='button'>").attr("id","button-"+p).attr("type","button").addClass("btn btn-md btn-secondary m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-calendar-alt"></i>').on("click",function(e){e.preventDefault()}),c=e("<button type='button'>").attr("id","button-clear-"+p).addClass("btn btn-md btn-outline-danger m-0 px-3 py-2 z-depth-0 waves-effect waves-light").html('<i class="fas fa-ban"></i>').on("click",function(){$.clear(),d.val("").trigger("change"),y(d[0])}),d=e("<input>").addClass("form-control time-format").attr("id",p).attr("type","text").attr("placeholder",f.placeholder).attr("maxlength","5").on("keydown",function(e){return t=this,n=e.keyCode,isNaN(parseInt(n))||(n=parseInt(n)),16===n&&(isShift=!0),(n>=48&&n<=57||n>=96&&n<=105||8===n||46===n)&&16!==n&&(2===t.value.length&&8!==n&&(t.value+=":"),!0);var t,n}).on("keyup",function(e){h(this,e.keyCode),I()}).on("change",function(){I()}),r=e("<label>").attr("for",p).html(f.label),s=e("<div>").addClass("error w-100 text-center")},I=function(){if(""!==d.val()){c.show();let e=d.attr("id");clearError(document.getElementById(e))}else c.hide()},$={picker:null,val:null,fooListener:function(e){},registerNewListener:function(e){this.fooListener=e},set:function(){var e;e||(e={}),$.picker.set(e,{muted:!0})},value:function(e){return e||(e=null),(t=e)?($.picker.set("select",t,{format:"HH-i"}),$.picker.render(),null):""===d.val()?null:d.val();var t},clear:function(){$.picker.clear()&&($.picker.clear(),$.picker.set("select",moment().format("YYYY-MM-DD"),{format:"HH-i"}),$.picker.render(),y(d[0]))},init:function(e,t){w(e,t)}},w=function(t,u){var _;(_=u)&&e.each(_,function(e,t){g[e]=t}),f.label=e(t).attr("data-label")?e(t).attr("data-label"):"Date",f.placeholder=e(t).attr("data-placeholder")?e(t).attr("data-placeholder"):"Select Date",function(e,t){b(e),o.append(c,l),i.append(d,o),a.append(r,i,s),n.append(a),m=l.pickatime("picker")}(t),l.pickatime(g).on("change",function(){""===e(this).val()?d.val(""):d.val(e(this).val()),d.trigger("change")}),m=l.pickatime("picker"),I(),$.picker=l.pickatime("picker")};return w(_,t),$}});const tinyEditor=function(){"use strict";let e;const t=function(e){tinymce.init({selector:"#"+e,menubar:!1,height:"400",plugins:"print visualblocks visualchars charmap hr pagebreak advlist lists",content_css:["https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap","/public/css/bootstrap.min.css","/public/css/style.css","/public/css/variant.min.css"],body_class:"p-2",font_formats:"Andale Mono=andale mono,times; Arial=arial,helvetica,sans-serif; Arial Black=arial black,avant garde; Book Antiqua=book antiqua,palatino; Comic Sans MS=comic sans ms,sans-serif; Courier New=courier new,courier; Georgia=georgia,palatino; Helvetica=helvetica; Impact=impact,chicago; Open Sans=Open Sans;Symbol=symbol; Tahoma=tahoma,arial,helvetica,sans-serif; Terminal=terminal,monaco; Times New Roman=times new roman,times; Trebuchet MS=trebuchet ms,geneva; Verdana=verdana,geneva; Webdings=webdings; Wingdings=wingdings,zapf dingbats",toolbar1:"undo redo | styleselect | fontselect fontsizeselect | removeformat | numlist bullist checklist | outdent indent ",toolbar2:"cut copy | bold italic underline strikethrough | forecolor | alignleft aligncenter alignright alignjustify | backcolor",content_style:'body { font-family:"Open Sans", sans-serif; font-size:14px; font-weight: 400 }',style_formats:[{title:"Headers",items:[{title:"h1",block:"h1"},{title:"h2",block:"h2"},{title:"h3",block:"h3"},{title:"h4",block:"h4"},{title:"h5",block:"h5"},{title:"h6",block:"h6"}]},{title:"Blocks",items:[{title:"p",block:"p"},{title:"div",block:"div"},{title:"pre",block:"pre"}]},{title:"Containers",items:[{title:"section",block:"section",wrapper:!0,merge_siblings:!1},{title:"article",block:"article",wrapper:!0,merge_siblings:!1},{title:"blockquote",block:"blockquote",wrapper:!0},{title:"hgroup",block:"hgroup",wrapper:!0},{title:"aside",block:"aside",wrapper:!0},{title:"figure",block:"figure",wrapper:!0}]}],branding:!1,resize:!1,setup:function(e){e.on("change",function(){e.save()})}})};return{addTinyMCE:function(e){t(e)},init:function(){(e=document.querySelectorAll(".but_toggle")).forEach(e=>e.addEventListener("click",n=>{if(e.dataset.texted){let n=e.dataset.texted,a=$("#"+n),i=a.parents("div.card");tinyMCE.get(n)?(a.val(htmlEncode(a.val())),tinymce.remove("#"+n),i.removeClass("is-fullscreen")):(a.val(decodeHtml(a.val())),i.addClass("is-fullscreen"),t(n))}}))}}}();$(document).ready(function(){$(function(){tinyEditor.init()})});const ContextMenu=function(){"use strict";let e;return{init:function(t){e=$.contextMenu({selector:".selected-day",callback:function(e,t){e.toLowerCase()},items:{edit:{name:"Assign Season To Days",icon:"edit"},cut:{name:"Cut",icon:"cut"},copy:{name:"Copy",icon:"copy"},paste:{name:"Paste",icon:"paste"},delete:{name:"Delete",icon:"delete"},sep1:"---------",quit:{name:"Quit",icon:function(){return"context-menu-icon context-menu-icon-quit"}}}}),$(".selected-day").on("click",function(e){})}}}(),Season=function(){"use strict";const e=document.getElementById("product_edit_season_display"),t=document.getElementById("edit_product_season"),n=document.getElementById("product_edit_season_form_edit_season_link"),a=(document.getElementById("product_season"),document.getElementById("product_edit_season_form_season_name_filter")),i=document.getElementById("category_id"),o=document.getElementById("product_edit_season_form_season_color_scheme_id"),l=document.getElementById("product_edit_season_form_season_id"),d=document.getElementById("product_edit_season_form_season_name"),r=document.getElementById("product_edit_season_id_name_display"),s=document.getElementById("product_edit_season_form_season_enabled"),c=document.getElementById("edit_season_button"),u=document.getElementById("table_season_product_edit"),m=document.getElementById("button_clear_form_edit_season"),_=document.getElementById("display_product_season_name"),p=document.getElementById("button_submit_form_edit_season"),g=document.getElementById("product_id"),f=document.getElementById("panel_tab_season"),y=document.getElementById("button_remove_season_from_product"),v=document.getElementById("calendar_loader"),h=document.getElementById("table_season_product_edit_add_new_button");document.getElementById("product_edit_season_section");let b,I,w=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,E=new Map,B=!1;$(h).on("click",function(){U(),d.disabled=!1,d.readonly=!1,ColorScheme.enable()}),$(y).on("click",function(){let e={product_id:parseInt(g.value),season_id:parseInt(l.value)};confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&x(e)})}),$(n).on("click",function(){Q()}),$(c).on("click",function(){ColorScheme.enable()}),$(m).on("click",function(){a.value="",O(),Y(),b.clearSelectedRows()}),$(p).on("click",function(){let e=S();confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&N(e)})}),$(f).on("hide.bs.tab",function(){a.value="",O(),Y(),b&&b.clearSelectedRows()});const k=function(){0===Array.from(Season.all.values()).length?$(f).html('<span id="tab_span_season">Season</span> <span id="seasonNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>'):$(f).html('<span id="tab_span_season">Season</span>'),Product.updateProgress()},N=function(e){e&&$(v).fadeIn("fast",function(){M(e,function(e){if(e){let t=e[0]?e[0]:e;A(t),F(t)}else YearCalendar.endLoading()})})},M=function(e,t){if(e)try{sendPostRequest("/api/v1.0/seasons/update",e,function(e,n,a){if(e)return t(e);C("Oops: 1")})}catch(e){}},x=function(e){e&&$(v).fadeIn("fast",function(){!function(e,t){if(e)try{sendPostRequest("/api/v1.0/seasons/remove",e,function(e,n,a){return e?t(e):C("Oops: 1")})}catch(e){return C(e)}}(e,function(t){t?q(e.season_id):YearCalendar.endLoading()})})},C=function(e){toastr.error(`${e}`,"Season")},S=function(){return remove_nulls({product_id:isNaN(parseInt(g.value))?null:parseInt(g.value),season_id:isNaN(parseInt(l.value))?null:parseInt(l.value),disabled_dow:formatListOfIds(I.disabled_dows)})},P=function(){return{id:null,color_scheme_id:null,name:null,view_product_index:1,view_product_index_filter:1,view_product_index_search:1,view_product_edit:1,view_product_package_edit:1,view_product_package_index:1,enabled:1,date_created:formatDateMySQL(),created_by:w,date_modified:formatDateMySQL(),modified_by:w,note:null,category_id:null,color_scheme:{id:null,name:null,background_color:null,border_color:null,text_color:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:w,date_modified:formatDateMySQL(),modified_by:w,note:null},product_season_detail:{created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),disabled_dow:null,enabled:1,id:null,modified_by:w,note:null,product_id:null,season_id:null,seasons_background:null,seasons_border:null,seasons_text:null}}},D=function(e){E=new Map,e&&$.each(e,function(e,t){Season.types.set(t.id,function(e){let t=P(),n=isNaN(parseInt(e.category_id))?null:parseInt(e.category_id);t.id=isNaN(parseInt(e.id))?null:parseInt(e.id),t.color_scheme_id=isNaN(parseInt(e.color_scheme_id))?null:parseInt(e.color_scheme_id),t.name=e.name?e.name:null,t.view_product_index=e.view_product_index?e.view_product_index:1,t.view_product_index_filter=e.view_product_index_filter?e.view_product_index_filter:1,t.view_product_index_search=e.view_product_index_search?e.view_product_index_search:1,t.view_product_edit=e.view_product_edit?e.view_product_edit:1,t.view_product_package_edit=e.view_product_package_edit?e.view_product_package_edit:1,t.view_product_package_index=e.view_product_package_index?e.view_product_package_index:1,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=isNaN(parseInt(e.created_by))?w:parseInt(e.created_by),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=isNaN(parseInt(e.modified_by))?w:parseInt(e.modified_by),t.note=e.note?e.note:null,t.category_id=isNaN(parseInt(e.category_id))?null:parseInt(e.category_id),t.color_scheme.id=isNaN(parseInt(e.color_scheme.id))?null:parseInt(e.color_scheme.id),t.color_scheme.name=e.color_scheme.name,t.color_scheme.background_color=e.color_scheme.background_color,t.color_scheme.border_color=e.color_scheme.border_color,t.color_scheme.text_color=e.color_scheme.text_color,t.color_scheme.sort_order=isNaN(parseInt(e.color_scheme.sort_order))?999:parseInt(e.color_scheme.sort_order),t.color_scheme.enabled=e.color_scheme.enabled,t.color_scheme.date_created=e.color_scheme.date_created?e.color_scheme.date_created:formatDateMySQL(),t.color_scheme.created_by=isNaN(parseInt(e.color_scheme.created_by))?w:parseInt(e.color_scheme.created_by),t.color_scheme.date_modified=e.color_scheme.date_modified?e.color_scheme.date_modified:formatDateMySQL(),t.color_scheme.modified_by=isNaN(parseInt(e.color_scheme.modified_by))?w:parseInt(e.color_scheme.modified_by),t.color_scheme.note=e.color_scheme.note,E.get(n)||E.set(n,{seasons:[]});let a=E.get(n);a.seasons&&a.seasons;return t}(t))})},L=function(e){let t,n;if(!e||!e.color_scheme||!e.product_season_detail)return;t=e.color_scheme,n=e.product_season_detail;e.color_scheme&&e.color_scheme.background_color&&e.color_scheme.background_color,e.color_scheme&&e.color_scheme.text_color&&e.color_scheme.text_color,e.color_scheme&&e.color_scheme.border_color&&e.color_scheme.border_color,e.product_season_detail&&getListOfIds(e.product_season_detail.disabled_dow),e.name&&e.name;let a=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null;a&&$(`#disabledDOWDisplay${a}`).remove()},F=function(t){let n,a;if(!t||!t.color_scheme||!t.product_season_detail)return;n=t.color_scheme,a=t.product_season_detail;let i=t.color_scheme&&t.color_scheme.background_color?t.color_scheme.background_color:"#fff",o=t.color_scheme&&t.color_scheme.text_color?t.color_scheme.text_color:"#0a070d",l=t.color_scheme&&t.color_scheme.border_color?t.color_scheme.border_color:"#0a070d",d=t.product_season_detail?getListOfIds(t.product_season_detail.disabled_dow):[],r=[],s="",c=t.name?t.name:null,u=t.id&&!isNaN(parseInt(t.id))?parseInt(t.id):null;for(let e=0;e<d.length;e++){let t=days[e];t.short&&r.push(t.short.toUpperCase())}s=r.join(", "),i=shadeColor(i,30),l=shadeColor(l,-30),Season.all.get(u)&&L(Season.all.get(u)),$(e).append(`\n            <div class="col-12 col-sm-12 col-md-4 px-1" id="disabledDOWDisplay${u}">\n        \n                <div class="card card-body mb-2" style="background:${i};color:${o};border-color:${l};">\n                \n                    <h5 class="card-title" style="color:${o};">${c}</h5>\n                    <h6 class="card-subtitle">\n                        <p class="m-0 mb-1" style="font-size:.85rem;font-weight:400;color:#0a070d;">Disabled Days:</p>\n                        <p class="m-0 mb-1" style="font-size:.75rem;color:${l};">${s}</p>\n                    </h6>\n                \n                </div>\n            </div>\n        `)},T=function(e){let t=P();return e&&(t=e),t},R=function(){b=$(u).table({table_type:"display_list",data:Season.all,columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Color Scheme",targets:2,data:"color_scheme",render:function(e,t,n,a){return`\n                            <div style="font-size:14px; line-height:1.25;padding-left:.5rem;background:${e.background_color};color:${e.text_color}; border:solid 1px ${e.border_color}">${e.name}</div>\n                        `}},{title:"Disabled DOW",targets:3,data:"product_season_detail",render:function(e,t,n,a){let i=e.disabled_dow?getListOfIds(e.disabled_dow):[],o=[];for(let e=0;e<i.length;e++)o.push(dow_short[i[e]]);return`\n                            <span>${e=o.join(", ")}</span>\n                        `}}],rowClick:Season.edit})},q=function(e){if(e){let t=Season.all.get(e);t&&(Season.all.delete(e),b.deleteRow(t),b.clearSelectedRows(),a.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),k(),O(),Y(),L(t),toastr.warning(`Season: ${t.name} - has been deleted`,"Season"),YearCalendar.endLoading())}},A=function(e){if(e){let t=T(e);Season.all.get(t.id)?b.updateRow(t):b.insertRow(t),Season.all.set(t.id,t),b.loadRow(t),b.jumpToRow(t),b.clearSelectedRows(),a.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),k(),O(),Y(),toastr.success(`Season: ${t.name} - has been updated`),YearCalendar.endLoading()}},O=function(){l.value="",d.value="",r.value="",s.checked=!0,k(),ColorScheme.load()},Q=function(){},Y=function(){I.init([]),W()},U=function(e){let n=[],i="Details";if(e){let t=e.color_scheme?e.color_scheme:{};i=e.name?e.name:"Detail",e.product_season_detail&&e.product_season_detail.disabled_dow&&(n=getListOfIds(e.product_season_detail.disabled_dow)),ColorScheme.load(t),ColorScheme.disable(),l.value=e.id,d.value=e.name,o.value=e.color_scheme_id,s.checked=1===e.enabled,s.disabled=!0,a.disabled=!0}a.disabled=!0,_.innerText=i,I.init(n),$(t).show()},W=function(){a.disabled=!1,d.disabled=!0,$(t).hide()},j=function(e){let t=isNaN(parseInt(i.value))?null:parseInt(i.value);if(e&&""!==e&&t){let n={name:e,category_id:t};!function(e,t){if(e)try{sendGetRequest("/api/v1.0/seasons/validate",e,function(e,n,a){if(e)return t(e);C("Oops: 1")})}catch(e){C("Error Validating Airport")}else C("Error Loading Airport - Missing Data")}(n,function(t){let i=null;if(t&&(i=t,t[0]&&(i=t[0])),i&&i.id){B=!0;let e=i.color_scheme?i.color_scheme:{},t=Season.all.get(i.id);b.clearSelectedRows(),l.value=i.id,d.value=i.name,o.value=i.color_scheme_id,s.checked=1===i.enabled,s.disabled=!0,ColorScheme.load(e),ColorScheme.disable(),t?(U(t),b.loadRow(t)):U(i)}else confirmDialog(`The season: ${e} does not exist exists. Would you like to create it?`,e=>{e?function(e,t){if(!e)return C("Error Loading Airport - Missing Data");try{sendPostRequest("/api/v1.0/seasons/add",e,function(e,n,a){if(e)return t(e);C("Oops: 1")})}catch(e){return C("Error Validating Airport")}}(n,function(e){let t=null;if(e&&(t=e,e[0]&&(t=e[0])),t&&t.id){let e=t.color_scheme?t.color_scheme:{},n=Season.all.get(t.id);b.clearSelectedRows(),l.value=t.id,d.value=t.name,o.value=t.color_scheme_id,s.checked=1===t.enabled,s.disabled=!0,ColorScheme.load(e),ColorScheme.disable(),n?(U(n),b.loadRow(n)):U(t)}}):(b.clearSelectedRows(),O(),a.value="")})})}},z=function(n){let r=[];n&&(r=n,n.seasons&&(r=n.seasons)),D(r),a&&($(e).empty(),function(){let e=isNaN(parseInt(i.value))?null:parseInt(i.value);$(a).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){b.clearSelectedRows(),O()}).on("change",function(){setTimeout(function(){""===a.value?(b.clearSelectedRows(),O()):j(a.value)},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/seasons",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:e},onSelect:function(e){if(!e.data)return;let t=e.data,n=t.color_scheme?t.color_scheme:{},a=Season.all.get(t.id);b.clearSelectedRows(),l.value=t.id,d.value=t.name,o.value=t.color_scheme_id,s.checked=1===t.enabled,s.disabled=!0,ColorScheme.load(n),ColorScheme.disable(),a?(U(a),b.loadRow(a)):U(t)}})}(),O()),document.getElementById("season_disabled_dow")&&(I=$("#season_disabled_dow").DisabledDOW({name:"season_disabled_dow",label:"Disabled DOW"})),t&&W()};return{types:new Map,all:new Map,edit:function(e){!function(e){e&&e.id&&(e.id,l&&(isNaN(parseInt(l.value))||parseInt(l.value)));Y(),U(e)}(e)},loadTypes:function(e){D(e)},init:function(e){z(e)},loadAll:function(e){!function(e){Season.all=new Map,u&&R(),e||(e=[]),$.each(e,function(e,t){let n=T(t);isNaN(parseInt(n.id))||(b.insertRow(n),Season.all.set(parseInt(n.id),n),F(n))}),k()}(e)}}}(),Page=function(){"use strict";const e=document.getElementById("modal_new_page"),t=document.getElementById("button_add_page_heading"),n=document.getElementById("table_pages_index"),a=document.getElementById("page_index_section"),i=document.getElementById("modal_new_page_id"),o=document.getElementById("modal_new_page_menu_id"),l=document.getElementById("modal_new_page_path"),d=document.getElementById("modal_new_page_title"),r=document.getElementById("modal_new_page_sub_title"),s=document.getElementById("modal_new_page_heading"),c=document.getElementById("modal_new_page_sub_heading"),u=document.getElementById("modal_new_page_description"),m=document.getElementById("modal_new_page_keywords"),_=document.getElementById("modal_new_page_enabled"),p=document.getElementById("modal_new_page_form"),g=document.getElementById("modal_new_page_save_button"),f=document.getElementById("modal_new_page_cancel_button"),y=document.getElementById("modal_new_page_clear_button"),v={rules:{modal_new_page_path:{required:!0}},messages:{modal_new_page_path:{required:"Fields Required"}}};let h,b,I=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,w=null;$(t).on("click",function(){C(),M()}),$(g).on("click",function(){D()}),$(f).on("click",function(){C(),x()}),$(y).on("click",function(){C()});const E=function(e,t){t||(t="Error"),toastr.error(e,t)},B=function(e){let t=k();return e&&(Page.detail.id=isNaN(parseInt(e.id))?null:parseInt(e.id),Page.detail.menu_id=isNaN(parseInt(e.menu_id))?null:parseInt(e.menu_id),Page.detail.path=e.path?e.path:null,Page.detail.title=e.title?e.title:null,Page.detail.sub_title=e.sub_title?e.sub_title:null,Page.detail.heading=e.heading?e.heading:null,Page.detail.sub_heading=e.sub_heading?e.sub_heading:null,Page.detail.description=e.description?e.description:null,Page.detail.keywords=e.keywords&&""!==e.keywords?e.keywords.toString().replace(/,\s/g,",").trim().split(","):[],Page.detail.enabled=e.enabled&&1===e.enabled?1:0,Page.detail.date_created=e.date_created?e.date_created:formatDateMySQL(),Page.detail.created_by=e.created_by?e.created_by:I,Page.detail.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),Page.detail.modified_by=e.modified_by?e.modified_by:I,Page.detail.note=e.note?e.note:null,t.id=Page.detail.id,t.menu_id=Page.detail.menu_id,t.path=Page.detail.path,t.title=Page.detail.title,t.sub_title=Page.detail.sub_title,t.heading=Page.detail.heading,t.sub_heading=Page.detail.sub_heading,t.description=Page.detail.description,t.keywords=Page.detail.keywords,t.enabled=Page.detail.enabled,t.date_created=Page.detail.date_created,t.created_by=Page.detail.created_by,t.date_modified=Page.detail.date_modified,t.modified_by=Page.detail.modified_by,t.note=Page.detail.note),t},k=function(){return Page.detail.id=null,Page.detail.menu_id=null,Page.detail.path=null,Page.detail.title=null,Page.detail.sub_title=null,Page.detail.heading=null,Page.detail.sub_heading=null,Page.detail.description=null,Page.detail.keywords=[],Page.detail.enabled=1,Page.detail.date_created=formatDateMySQL(),Page.detail.created_by=I,Page.detail.date_modified=formatDateMySQL(),Page.detail.modified_by=I,Page.detail.note=null,{id:null,menu_id:null,path:null,title:null,sub_title:null,heading:null,sub_heading:null,description:null,keywords:[],enabled:1,date_created:formatDateMySQL(),created_by:I,date_modified:formatDateMySQL(),modified_by:I,note:null}},N=function(e){if(o){let t='<option value="" disabled selected>-- Menu --</option>';$(o).empty(),$.each(e,function(e,n){let a=isNaN(parseInt(n.id))?null:parseInt(n.id),i=n.label?n.label:null,o=n.sub_menus;t+=`<option  value="${a}">${i}</option>`,$.each(o,function(e,n){let a=isNaN(parseInt(n.id))?null:parseInt(n.id),i=n.label?n.label:null;t+=`<option value="${a}">${i}</option>`})}),$(o).html(t)}},M=function(){e&&$(e).modal("show")},x=function(){e&&$(e).modal("hide")},C=function(){i.value="",o.value="",l.value="",d.value="",r.value="",s.value="",c.value="",u.value="",b.clear(),_.checked=!0},S=function(e){if(e){let t=B(e);C(),function(e){e&&(Page.menus.get(Page.detail.menu_id)&&Page.menus.get(Page.detail.menu_id),o.value=Page.detail.menu_id,i.value=Page.detail.id,l.value=Page.detail.path,d.value=Page.detail.title,r.value=Page.detail.sub_title,s.value=Page.detail.heading,c.value=Page.detail.sub_heading,u.value=Page.detail.description,b.set(Page.detail.keywords),_.checked=Page.detail.enabled&&1===Page.detail.enabled)}(t),M()}},P=function(e){if(Page.all=new Map,e&&e.length){let t=0;w=null,$.each(e,function(e,n){let a=B(n);0===t&&(w=a),a.id&&(Page.all.set(a.id,a),function(e){h.insertRow(e)}(a)),t++})}else w=null;null!==w&&(h.clearSelectedRows(),h.jumpToRow(w))},D=function(){if($(p).valid()){let e=removeNulls({id:isNaN(parseInt(i.value))?null:parseInt(i.value),menu_id:isNaN(parseInt(o.value))?null:parseInt(o.value),path:l&&""!==l.value?l.value:null,title:d&&""!==d.value?d.value:null,sub_title:r&&""!==r.value?r.value:null,heading:s&&""!==s.value?s.value:null,sub_heading:c&&""!==c.value?c.value:null,description:u&&""!==u.value?u.value:null,keywords:b.build(),enabled:_&&!0===_.checked?1:0});e&&confirmDialog(`Page: ${e.title} does not exist. Would you like to create it?`,t=>{t&&function(e,t){if(!e)return E("Error Loading Page - Missing Data","Save Error");try{sendPostRequest("/api/v1.0/pages/save",e,function(e,n,a){return e?t(e):E("Oops: 1","Save Error")})}catch(e){return E("Error Validating Page","Save Error")}}(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);B(t)}})})}},L=function(e){var t;a&&(n&&(h=$(n).table({table_type:"display_list",data:Array.from(Page.all.values()),columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Title",targets:1,data:"title",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Path",targets:2,data:"path",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Page.edit})),e&&(e.pages&&P(e.pages),e.menus&&(t=e.menus,Page.menus=new Map,Page.sub_menus=new Map,t&&t.length&&$.each(t,function(e,t){let n=t.sub_menus?t.sub_menus:[];$.each(n,function(e,t){Page.menus.set(t.id,t)}),Page.menus.set(t.id,t)}),N(e.menus)),b=$(m).BuildKeyword([]),initializeValidator(v),Page.validator=$(p).validate()))};return{menus:new Map,sub_menus:new Map,detail:{id:null,menu_id:null,path:null,title:null,sub_title:null,heading:null,sub_heading:null,description:null,keywords:null,enabled:1,date_created:formatDateMySQL(),created_by:I,date_modified:formatDateMySQL(),modified_by:I,note:null},all:new Map,buildMenuDropDown:function(){N()},edit:function(e){!function(e){e&&S(e)}(e)},init:function(e){L(e)}}}(),PricingStrategy=function(){"use strict";document.getElementById("product_id");const e=document.getElementById("pricing_strategy_types_id"),t=document.getElementById("pricing_strategy_unit_id"),n=document.getElementById("pricing_strategy_season_id"),a=(document.getElementById("pricing_container"),document.getElementById("panel_tab_pricing"));document.getElementById("user_id")&&(isNaN(parseInt(document.getElementById("user_id").value))||parseInt(document.getElementById("user_id").value));$(e).on("change",function(){}),$(n).on("change",function(){}),$(t).on("change",function(){});return{all:new Map,unitSeasons:new Map,updateStatus:function(){$(a).find("span").remove()},init:function(e){},updatePrice:function(e){!function(e){let t=document.getElementById(e);document.getElementById(e.replace("cost","margin"));document.getElementById(e.replace("cost","price")).value=parseInt((isNaN(parseInt(t.value))?0:parseInt(t.value))+!isNaN(parseInt(t.value))?parseInt(t.value):0)}(e)},clearUnitSelection:function(){$(t).val([]).trigger("change")},clearSeasonSelection:function(){$(n).val([]).trigger("change")},buildUnitSeasonValues:function(){PricingStrategy.unitSeasons=new Map,$.each(Array.from(Unit.all.values()),function(e,t){PricingStrategy.unitSeasons.set(t.id,{id:t.id,name:t.name,seasons:Season.all})})}}}();document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("div.panel").forEach(e=>{const t=$(e),n=t.find("div.panel-heading").find("div.panel-actions.panel-actions-keep").find("a.panel-action");$.each(n,function(e,n){let a=$(n).attr("data-toggle");if(a)switch(a){case"panel-refresh":break;case"panel-hide":n.addEventListener("click",function(){let e=$(n).attr("data-loadonhide");$(e).show(),$(n).parents("div.pre_display").find("div.pre_display_el").hide()});break;case"panel-collapse":break;case"panel-fullscreen":n.addEventListener("click",function(){$(n).hasClass("fa-expand")?($(n).removeClass("fa-expand"),$(n).addClass("fa-compress"),t.addClass("is-fullscreen")):$(n).hasClass("fa-compress")&&($(n).removeClass("fa-compress"),$(n).addClass("fa-expand"),t.removeClass("is-fullscreen"))})}})})}),$.fn.table=function(e){"use strict";let t,n,a=[],i="display_list",o=$(this).attr("id");const l=document.getElementById(o);if($.fn.DataTable.isDataTable("#"+o))return;e&&(e.columnDefs&&(t=e.columnDefs),e.table_type&&(i=e.table_type),e.data&&(a=e.data));const d=function(){let e=$("#"+o+"_wrapper .dataTables_filter"),t=$("#"+o+"_wrapper .dataTables_length"),n=$("#"+o+"_wrapper .dataTables_info"),a=$("#"+o+"_wrapper .dataTables_paginate"),l=$("#"+o+"_wrapper"),d=$("#"+o+"_wrapper select");$("#"+o).parent("div").removeClass("col-sm-12").addClass("p-0 m-0 w-100 h-100"),l.find("label").each(function(){$(this).parent().append($(this).children())}),l.find("div.row").removeClass("row").addClass("d-flex justify-content-between"),e.find("input").each(function(){const e=$(this);e.attr("placeholder","Search"),e.removeClass("form-control-sm")}),e.find("label").remove(),e.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),n.parent("div").removeClass("col-sm-12 col-md-5").addClass("w-50 d-flex align-content-center flex-wrap px-0"),n.addClass("py-0"),a.parent("div").removeClass("col-sm-12 col-md-7").addClass("w-50 px-0"),a.addClass("py-0"),a.find("ul.pagination").addClass("mb-0"),t.parent("div").removeClass("col-sm-12 col-md-6").addClass("w-50"),t.find("label").each(function(){$(this).addClass("mb-0 pb-0 mr-3 d-inline-block")}),d.removeClass("custom-select custom-select-sm form-control form-control-sm"),d.addClass("form-control d-inline-block"),"display_list"===i&&$("#"+o+">tbody>tr").css({cursor:"pointer"})},r=function(e){if(e)try{$("#"+o+"_tr_"+e.id).addClass("selected"),n.page.jumpToData(e.id,0)}catch(e){}},s=function(){try{let e=$("#"+o+"> tbody  > tr");$.each(e,function(e,t){$(t).removeClass("selected")})}catch(e){}};if(l)try{n=$(this).DataTable({pageLength:5,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],data:a,columnDefs:t}),e.rowClick&&n.on("click","tr",function(t){if($(this).find("td").hasClass("dataTables_empty"));else if(s(),"TH"===t.target.nodeName);else{$(this).addClass("selected");let t=n.row(this).data();e.rowClick(t)}}),d()}catch(e){}return{insertRow:function(e){!function(e){if(e)try{n.row.add(e).node().id=o+"_tr_"+e.id,n.draw(!1),n.page.jumpToData(e.id,0),d()}catch(e){}}(e)},clearSelectedRows:function(){s()},deleteRow:function(e){!function(e){if(e)try{let t="#"+o+"_tr_"+e.id;n.row(t).remove().draw()}catch(e){}}(e)},loadRow:function(e){r(e)},updateRow(e){!function(e){if(e)try{let t="#"+o+"_tr_"+e.id;n.row(t).data(e).draw(),r(e.id)}catch(e){}d()}(e)},jumpToRow:function(e){!function(e){if(console.log("table:jumpToRow(row_data)",e),e)try{n.page.jumpToData(e.id,0)}catch(e){console.log("error",e)}}(e)}}},$.fn.BuildKeyword=function(e){let t,n,a,i,o,l,d,r,s=0,c=null,u=new Map;if(!$(this).hasClass("keyword")||!$(this).attr("id"))return;if(t=(a=$(this).attr("id"))+"_search",n=a+"_container",i=document.getElementById(a),o=document.getElementById(t),!(l=document.getElementById(n))||!o||!i)return;d=$(o),r=$(l),e||(e=[]),"string"==typeof e&&(e=e.split(",").map(function(e){return e.trim()})),jQuery.event.special.destroyed={remove:function(e){e.handler&&e.handler()}},d.on("keydown",function(e){9===e.keyCode&&e.preventDefault(),13!==e.which&&9!==e.keyCode||(f(),c=null)});const m=function(e){if(e){let t=e,n=t.text();u.get(n)&&(t.remove(),u.delete(n))}},_=function(e){},p=function(e){let t=u.get(e);if(t)toastr.error(`A tag for ${e} already exists`),u.set(e,t);else{let t=function(e){if(s+=1,e){let t=$("<div>"),n=$("<i>");return n.addClass("close fas fa-times").on("click",function(e){e.stopPropagation();let t=$(this).parents("div.chip");var n;n=(e=>{e&&($id=t.attr("id"),m(t))}),$('\n        \x3c!--Modal: modalConfirm--\x3e\n        <div class="modal fade" id="modalConfirm" tabindex="-1" role="dialog" aria-labelledby="modalConfirmationLabel" aria-hidden="true">\n\t<div class="modal-dialog modal-sm modal-notify modal-danger" role="document">\n\t\t\x3c!--Content--\x3e\n\t\t<div class="modal-content text-center">\n\t\t\t\x3c!--Header--\x3e\n\t\t\t<div class="modal-header d-flex justify-content-center">\n\t\t\t\t<p class="heading">Would you like to delete?</p>\n\t\t\t</div>\n\n\t\t\t\x3c!--Body--\x3e\n\t\t\t<div class="modal-body">\n\t\t\t\t<i class="fas fa-times fa-4x animated rotateIn"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!--Footer--\x3e\n\t\t\t<div class="modal-footer flex-center">\n\t\t\t\t<a class="btn btn-outline-danger btn-yes">yes</a>\n\t\t\t\t<a type="button" class="btn btn-danger waves-effect btn-no">no</a>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!--/.Content--\x3e\n\t</div>\n</div>\n        \x3c!--Modal: modalConfirm--\x3e\n    ').appendTo("body"),$("#modalConfirm").modal({backdrop:"static",keyboard:!1}),$(".btn-yes").click(function(){n(!0),$("#modalConfirm").modal("hide")}),$(".btn-no").click(function(){n(!1),$("#modalConfirm").modal("hide")}),$("#modalConfirm").on("hidden.bs.modal",function(){$("#modalConfirm").remove()})}),t.addClass("chip blue lighten-4 waves-effect").text(e).append(n).attr("id",a+"_"+s).on("click",function(e){let t=$(this);c=u.get(t.text());let n=t.attr("id");_(n)}),t}}(e);t&&(u.set(e,t),r&&r.append(t))}},g=function(e){$.each(e,function(e,t){t&&f(t)})},f=function(e){e||(e=d.val()),""!==e&&(p(e),d.val(""))};return g(e),{clear:function(){u=new Map,d.val(""),r.empty()},add:function(e){p(e)},delete:function(e){m(e)},build:function(){let e=[],t=Array.from(u.values());for(let n=0;n<t.length;n++){let a=t[n].text();e.push(a)}return e.join(",")},set:function(e){!function(e){let t;t="string"==typeof e?""!==e?e.toString().replace(/,\s/g,",").trim().split(","):[]:"object"==typeof e?e:[],r&&r.empty(),$.each(t,function(e,t){f(t)})}(e)},init:function(){g()}}};const InventoryProfile=function(){"use strict";const e=document.getElementById("panel_tab_inventory"),t=document.getElementById("table_profile_product_edit_add_new_button"),n=document.getElementById("product_edit_profile_form_profile_transfer_sales_types_id_block"),a=document.getElementById("product_edit_profile_form_profile_allot_by_id_block"),i=document.getElementById("table_profile_product_edit"),o=document.getElementById("product_edit_profile_form_profile_days_out_block"),l=document.getElementById("product_edit_profile_form_profile_expires_block"),d=document.getElementById("product_edit_profile_form_profile_quantity_block"),r=document.getElementById("product_edit_profile_form_profile_release_amt_block"),s=document.getElementById("product_edit_profile_form"),c=document.getElementById("product_edit_profile_form_profile_id"),u=document.getElementById("product_edit_profile_form_profile_name"),m=document.getElementById("product_edit_profile_form_profile_enabled"),_=document.getElementById("product_edit_profile_form_profile_sales_types_id"),p=document.getElementById("product_edit_profile_form_profile_allot_by_id"),g=document.getElementById("product_edit_profile_form_profile_transfer_sales_types_id"),f=document.getElementById("product_edit_profile_form_profile_days_out"),y=document.getElementById("product_edit_profile_form_profile_quantity"),v=document.getElementById("product_edit_profile_form_profile_release_amt"),h=document.getElementById("product_edit_profile_form_profile_min_length_days"),b=document.getElementById("product_edit_profile_form_profile_min_duration"),I=document.getElementById("product_edit_profile_form_profile_max_duration"),w=document.getElementById("product_edit_profile_form_profile_equal_duration"),E=document.getElementById("product_edit_profile_form_profile_advanced_booking_min"),B=document.getElementById("product_edit_profile_form_profile_advanced_booking_max"),k=document.getElementById("product_edit_profile_form_profile_checkin_dow"),N=document.getElementById("product_edit_profile_form_profile_checkout_dow"),M=document.getElementById("product_edit_profile_form_profile_departure_dow"),x=document.getElementById("product_edit_profile_form_profile_return_dow"),C=document.getElementById("product_edit_profile_form_profile_inc_days_dow"),S=document.getElementById("product_edit_profile_form_profile_weekday_dow"),P=document.getElementById("product_edit_profile_form_close_button"),D=document.getElementById("button_add_product_profile"),L=document.getElementById("product_edit_profile_form_clear_button"),F=document.getElementById("product_edit_profile_form_submit_button"),T=document.getElementById("product_id"),R=document.getElementById("button_remove_profile_from_product");let q,A,O,Q,Y,U,W=$(i),j=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,z={rules:{product_edit_profile_form_profile_sales_types_id:{required:!0},product_edit_profile_form_profile_allot_by_id:{required:function(e){return""!==$(_).val()&&1===$(_).val()||"1"===$(_).val()}},profile_expires:{required:function(e){return""!==$(p).val()&&1===$(p).val()||"1"===$(p).val()}},product_edit_profile_form_profile_days_out:{required:function(e){return""!==$(p).val()&&2===$(p).val()||"2"===$(p).val()},number:!0,min:1},product_edit_profile_form_profile_name:{required:!0}},messages:{product_edit_profile_form_profile_sales_types_id:{required:"Field Required"},product_edit_profile_form_profile_allot_by_id:{required:"Field Required"},profile_expires:{required:"Field Required"},product_edit_profile_form_profile_days_out:{required:"Field Required"},product_edit_profile_form_profile_name:{required:"Field Required"}}};$(D).on("click",function(){le()}),$(t).on("click",function(){W.clearSelectedRows(),le()}),$(L).on("click",function(){W.clearSelectedRows(),ae(),ee()}),$(F).on("click",function(){re()}),$(P).on("click",function(){W.clearSelectedRows(),ae(),J(),ee()}),$(_).on("change",function(){J(),InventoryProfile.expiration_date.value(""),f.value="",p.value=""}),$(p).on("change",function(){J(),InventoryProfile.expiration_date.value(""),f.value=""}),$(g).on("change",function(){}),$(R).on("click",function(){H()}),$(e).on("hide.bs.tab",function(){W.clearSelectedRows(),ae(),J(),ee()});const V=function(){0===Array.from(InventoryProfile.all.values()).length?$(e).html('Inventory <span id="profileNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>'):$(e).html("Inventory"),Product.updateProgress()},H=function(){let e={product_id:parseInt(T.value),profile_id:parseInt(c.value)};e&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&function(e,t){if(e){let n="/api/v1.0/profiles/remove";try{sendPostRequest(n,e,function(e,n,a){return e?t(e):se("Oops: 1")})}catch(e){}}}(e,function(t){if(t){let t=de(InventoryProfile.all.get(e.profile_id));InventoryProfile.all.delete(t.id),W.deleteRow(t),W.clearSelectedRows(),PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.resetForm(),PricingWorksheet.status(),V(),le(),ee(),toastr.success(`InventoryProfile: ${t.name} - has been removed`),YearCalendar.endLoading()}})})},G=function(){W=$(i).table({table_type:"display_list",data:[],columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Sales Types",targets:1,data:"sales_types_details",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+(e.name?e.name:"N/A")+"</span>"}},{title:"Allot By",targets:2,data:"allot_by_id",render:function(e,t,n,a){let i="N/A";return"<span style='white-space: nowrap;'>"+(i=null===e?"N/A":(i=Types.allot_by.get(e))?i.name:"N/A")+"</span>"}},{title:"Expires",targets:3,data:"expires",render:function(e,t,n,a){let i;if(null===e)i="N/A";else{let t=e.replace(/-|\s/g,"");i=moment(t).format("YYYY-MM-DD")}return"<span style='white-space: nowrap;'>"+i+"</span>"}},{title:"Release",targets:4,data:"release_amt",render:function(e,t,n,a){let i="N/A";return e&&(i=e),"<span style='white-space: nowrap;'>"+i+"</span>"}}],rowClick:InventoryProfile.edit})},K=function(e){InventoryProfile.all=new Map,e||(e=[]),$.each(e,function(e,t){let n=de(t);isNaN(parseInt(n.id))||(i&&W.insertRow(n),InventoryProfile.all.set(parseInt(n.id),n))}),Pricing.loadProfileDropdown(),V()},J=function(){let e=isNaN(parseInt(_.value))?null:parseInt(_.value);if(X(),e)switch(e){case 1:Z()}},Z=function(){let e=isNaN(parseInt(p.value))?null:parseInt(p.value);if(e)switch(e){case 1:$(o).hide(),$(l).show();break;case 2:$(o).show(),$(l).hide();break;case 3:default:$(o).hide(),$(l).hide()}$(n).show(),$(d).show(),$(r).show(),$(a).show()},X=function(){$(o).hide(),$(l).hide(),$(a).hide(),$(n).hide(),$(d).hide(),$(r).hide(),$("#accordionEx").collapse("hide")},ee=function(){s&&(X(),$(s).hide(),$("#accordionEx").collapse("hide"),V())},te=function(){s&&$(s).show()},ne=function(){ae(),oe()},ae=function(){oe(),c.value="",u.value="",m.checked=!0,_.value="",p.value="",g.value="",f.value="",y.value="",v.value="",h.value="",b.value="",I.value="",w.value="",E.value="",B.value="",InventoryProfile.checkin_dow.init([0,1,2,3,4,5,6]),InventoryProfile.checkout_dow.init([0,1,2,3,4,5,6]),InventoryProfile.departure_dow.init([0,1,2,3,4,5,6]),InventoryProfile.return_dow.init([0,1,2,3,4,5,6]),InventoryProfile.weekday_dow.init([0,1,2,3,4,5,6]),InventoryProfile.inc_days_dow.init([0,1,2,3,4,5,6]),InventoryProfile.expiration_date.value(""),InventoryProfile.advanced_booking_date.value(""),J()},ie=function(){let e=$(s).valid();if(e){if(1===(isNaN(parseInt(p.value))?3:parseInt(p.value))){let t=InventoryProfile.expiration_date.value();null===t||""===t?(setError(document.getElementById("profile_expires"),"Field Required"),e=!1):clearError(document.getElementById("profile_expires"))}}return e},oe=function(){u.disabled=!1},le=function(e){ae(),e&&(c.value=e.id?e.id:"",u.value=e.name?e.name:"",m.checked=0!==e.enabled,_.value=e.sales_types_id?e.sales_types_id:"",p.value=e.allot_by_id?e.allot_by_id:"",g.value=e.transfer_sales_types_id?e.transfer_sales_types_id:"",f.value=e.days_out?e.days_out:"",y.value=e.quantity?e.quantity:"",v.value=e.release_amt?e.release_amt:"",h.value=e.min_length_days?e.min_length_days:"",b.value=e.min_duration?e.min_duration:"",I.value=e.max_duration?e.max_duration:"",w.value=e.equal_duration?e.equal_duration:"",E.value=e.advanced_booking_min?e.advanced_booking_min:"",B.value=e.advanced_booking_max?e.advanced_booking_max:"",InventoryProfile.checkin_dow.init(e.checkin_dow?e.checkin_dow:[0,1,2,3,4,5,6]),InventoryProfile.checkout_dow.init(e.checkout_dow?e.checkout_dow:[0,1,2,3,4,5,6]),InventoryProfile.departure_dow.init(e.departure_dow?e.departure_dow:[0,1,2,3,4,5,6]),InventoryProfile.return_dow.init(e.return_dow?e.return_dow:[0,1,2,3,4,5,6]),InventoryProfile.weekday_dow.init(e.weekday_dow?e.weekday_dow:[0,1,2,3,4,5,6]),InventoryProfile.inc_days_dow.init(e.inc_days_dow?e.inc_days_dow:[0,1,2,3,4,5,6]),InventoryProfile.expiration_date.value(e.expires?e.expires:""),InventoryProfile.advanced_booking_date.value(e.advanced_booking_date?e.advanced_booking_date:"")),J(),te()},de=function(e){let t,n,a,i={id:null,allot_by_id:null,sales_types_id:null,name:null,quantity:null,expires:null,transfer_sales_types_id:null,release_amt:null,min_length_days:null,checkin_dow:[0,1,2,3,4,5,6],checkout_dow:[0,1,2,3,4,5,6],departure_dow:[0,1,2,3,4,5,6],return_dow:[0,1,2,3,4,5,6],inc_days_dow:[0,1,2,3,4,5,6],weekday_dow:[0,1,2,3,4,5,6],min_duration:null,max_duration:null,equal_duration:null,advanced_booking_min:null,advanced_booking_max:null,advanced_booking_date:null,days_out:null,enabled:1,date_created:formatDateMySQL(),created_by:j,date_modified:formatDateMySQL(),modified_by:j,note:null,sales_types_details:{},allot_by_details:{},tranfer_sales_type_details:{}};if(e){let o=getListOfIds(e.checkin_dow),l=getListOfIds(e.checkout_dow),d=getListOfIds(e.departure_dow),r=getListOfIds(e.return_dow),s=getListOfIds(e.inc_days_dow),c=getListOfIds(e.weekday_dow);t=Types.sales_types.get(isNaN(parseInt(e.sales_types_id))?null:parseInt(e.sales_types_id)),n=Types.allot_by.get(isNaN(parseInt(e.allot_by_id))?null:parseInt(e.allot_by_id)),a=Types.sales_types.get(isNaN(parseInt(e.transfer_sales_types_id))?null:parseInt(e.transfer_sales_types_id)),i.id=isNaN(parseInt(e.id))?null:parseInt(e.id),i.allot_by_id=isNaN(parseInt(e.allot_by_id))?null:parseInt(e.allot_by_id),i.sales_types_id=isNaN(parseInt(e.sales_types_id))?null:parseInt(e.sales_types_id),i.name=e.name?e.name:null,i.quantity=isNaN(parseInt(e.quantity))?null:parseInt(e.quantity),i.expires=e.expires?e.expires:null,i.transfer_sales_types_id=isNaN(parseInt(e.transfer_sales_types_id))?null:parseInt(e.transfer_sales_types_id),i.release_amt=e.release_amt?e.release_amt:null,i.min_length_days=e.min_length_days?e.min_length_days:null,i.min_duration=e.min_duration?e.min_duration:null,i.max_duration=e.max_duration?e.max_duration:null,i.equal_duration=e.equal_duration?e.equal_duration:null,i.advanced_booking_min=e.advanced_booking_min?e.advanced_booking_min:null,i.advanced_booking_max=e.advanced_booking_max?e.advanced_booking_max:null,i.advanced_booking_date=e.advanced_booking_date?e.advanced_booking_date:null,i.checkin_dow=o,i.checkout_dow=l,i.departure_dow=d,i.return_dow=r,i.inc_days_dow=s,i.weekday_dow=c,i.days_out=e.days_out?e.days_out:null,i.enabled=e.enabled?e.enabled:1,i.date_created=e.date_created?e.date_created:formatDateMySQL(),i.created_by=isNaN(parseInt(e.created_by))?j:parseInt(e.created_by),i.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),i.modified_by=isNaN(parseInt(e.modified_by))?j:parseInt(e.modified_by),i.note=e.note?e.note:null,i.sales_types_details=t,i.allot_by_details=n,i.tranfer_sales_type_details=a}return InventoryProfile.detail=i,i},re=function(){let e=!!ie()&&remove_nulls({id:isNaN(parseInt(c.value))?null:parseInt(c.value),name:""!==u.value?u.value:null,product_id:isNaN(parseInt(T.value))?null:parseInt(T.value),sales_types_id:isNaN(parseInt(_.value))?null:parseInt(_.value),transfer_sales_types_id:isNaN(parseInt(g.value))?null:parseInt(g.value),allot_by_id:isNaN(parseInt(p.value))?3:parseInt(p.value),enabled:!0===m.checked?1:0,expires:InventoryProfile.expiration_date.value(),advanced_booking_date:InventoryProfile.advanced_booking_date.value(),checkin_dow:null===formatListOfIds(InventoryProfile.checkin_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.checkin_dow.disabled_dows),checkout_dow:""===formatListOfIds(InventoryProfile.checkout_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.checkout_dow.disabled_dows),departure_dow:""===formatListOfIds(InventoryProfile.departure_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.departure_dow.disabled_dows),return_dow:""===formatListOfIds(InventoryProfile.return_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.return_dow.disabled_dows),weekday_dow:""===formatListOfIds(InventoryProfile.weekday_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.weekday_dow.disabled_dows),inc_days_dow:""===formatListOfIds(InventoryProfile.inc_days_dow.disabled_dows)?"":formatListOfIds(InventoryProfile.inc_days_dow.disabled_dows),days_out:isNaN(parseInt(f.value))?null:parseInt(f.value),release_amt:isNaN(parseInt(v.value))?null:parseInt(v.value),min_length_days:isNaN(parseInt(h.value))?"":parseInt(h.value),min_duration:isNaN(parseInt(b.value))?null:parseInt(b.value),max_duration:isNaN(parseInt(I.value))?null:parseInt(I.value),equal_duration:isNaN(parseInt(w.value))?null:parseInt(w.value),advanced_booking_min:isNaN(parseInt(E.value))?null:parseInt(E.value),advanced_booking_max:isNaN(parseInt(B.value))?null:parseInt(B.value)});e&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",t=>{t&&ce(e,function(e){if(e){let t=de(e[0]?e[0]:e);InventoryProfile.all.get(t.id)?W.updateRow(t):W.insertRow(t),InventoryProfile.all.set(t.id,t),W.loadRow(t),W.jumpToRow(t),W.clearSelectedRows(),PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),V(),le(),ee(),toastr.success(`InventoryProfile: ${t.name} - has been updated`),YearCalendar.endLoading()}})})},se=function(e){toastr.error(e)},ce=function(e,t){if(e){let n="/api/v1.0/profiles/update";try{sendPostRequest(n,e,function(e,n,a){return e?t(e):se("Oops: 1")})}catch(e){}}};return{validator:null,all:new Map,detail:{},expiration_date:null,advanced_booking_date:null,checkin_dow:null,checkout_dow:null,departure_dow:null,return_dow:null,weekday_dow:null,inc_days_dow:null,initProductEdit:function(e){!function(e){let t=[];e&&e.profiles&&(t=e.profiles),q=$(k).DisabledDOW({name:"checkin_dow",label:"Checkin DOW"}),A=$(N).DisabledDOW({name:"checkout_dow",label:"Checkout DOW"}),O=$(M).DisabledDOW({name:"departure_dow",label:"Departure DOW"}),Q=$(x).DisabledDOW({name:"return_dow",label:"Return DOW"}),U=$(C).DisabledDOW({name:"inc_days_dow",label:"Included Days"}),Y=$(S).DisabledDOW({name:"weekday_dow",label:"Weekdays"}),InventoryProfile.checkin_dow=q,InventoryProfile.checkout_dow=A,InventoryProfile.departure_dow=O,InventoryProfile.return_dow=Q,InventoryProfile.weekday_dow=Y,InventoryProfile.inc_days_dow=U,InventoryProfile.advanced_booking_date=$("#profile_advanced_booking_date").dateSelect({onStart:function(){}}),InventoryProfile.expiration_date=$("#profile_expires").dateSelect({onStart:function(){}}),i&&G(),s&&(validator_init(z),InventoryProfile.validator=$(s).validate(),ne(),ee()),K(t)}(e)},init:function(e){!function(e){let t=[];e&&e.profiles&&(t=e.profiles),q=$(k).DisabledDOW({name:"checkin_dow",label:"Checkin DOW"}),A=$(N).DisabledDOW({name:"checkout_dow",label:"Checkout DOW"}),O=$(M).DisabledDOW({name:"departure_dow",label:"Departure DOW"}),Q=$(x).DisabledDOW({name:"return_dow",label:"Return DOW"}),U=$(C).DisabledDOW({name:"inc_days_dow",label:"Included Days"}),Y=$(S).DisabledDOW({name:"weekday_dow",label:"Weekdays"}),InventoryProfile.checkin_dow=q,InventoryProfile.checkout_dow=A,InventoryProfile.departure_dow=O,InventoryProfile.return_dow=Q,InventoryProfile.weekday_dow=Y,InventoryProfile.inc_days_dow=U,InventoryProfile.advanced_booking_date=$("#profile_advanced_booking_date").dateSelect({onStart:function(){}}),InventoryProfile.expiration_date=$("#profile_expires").dateSelect({onStart:function(){}}),$(document).ready(function(){i&&G(),s&&(validator_init(z),InventoryProfile.validator=$(s).validate(),ne(),ee()),K(t)})}(e)},initAutoComplete:function(){isNaN(parseInt(T.value))||parseInt(T.value)},edit:function(e){!function(e){if(e){W.clearSelectedRows();let t=de(e);te(),W.loadRow(t),le(t)}}(e)}}}(),PricingWorksheet=function(){"use strict";const e=document.getElementById("product_edit_matrix_form"),t=["sun","mon","tue","wed","thu","fri","sat"],n=document.getElementById("product_edit_pricing_section_reset_filters"),a=document.getElementById("pricing_strategy_types_id"),i=document.getElementById("product_id"),o=document.getElementById("pricing_strategy_unit_id"),l=document.getElementById("pricing_strategy_season_id"),d=document.getElementById("button_collapse_seasons"),r=document.getElementById("button_collapse_units"),s=document.getElementById("button_toggle_completed_pricings"),c=document.getElementById("button_toggle_completed_matrices"),u=document.getElementById("product_edit_pricing_section_reload_worksheet");let m,_,p,g,f,y=!1,v='<span class="badge badge-pill badge-success">Completed</span>',h='<span class="badge badge-pill badge-danger">Incomplete</span>',b=[],I=[],w=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(u).on("click",function(){$(a).val(PricingWorksheet.pricingStrategyId).trigger("change")}),$(n).on("click",function(){C()}),$(a).on("change",function(){}),$(o).on("change",function(){S()}),$(l).on("change",function(){P()}),$(n).on("click",function(){C()}),$(s).on("click",function(){N()}),$(c).on("click",function(){k()}),$(d).on("click",function(){x()}),$(r).on("click",function(){M()});const E=function(){let e=!1,t="complete",n=Array.from(PricingWorksheet.incompletePricings.values()),a=Array.from(PricingWorksheet.incompleteMatrices.values());return(n.length>0||a.length>0)&&(e=!0),$("<span>",{class:"badge rounded-pill badge-notification bg-danger tab-badge",alt:"Notification",css:{color:"rgb(255, 255, 255) !important"},text:"!"}),!0===e?(t="incomplete",$("#panel_tab_pricing").html("Pricing<span class='badge rounded-pill badge-notification bg-danger tab-badge' style='color:#fff!important'>!</span>")):(t="complete",$("#panel_tab_pricing").html("Pricing")),t},B=function(e,n){let a,i,o=-1,l=[],d={};return n&&e&&(a=Season.all.get(n))&&(d=a.product_season_detail?a.product_season_detail:{},l=getListOfIds(d.disabled_dow.trim()),i=t.indexOf(e),o=l.indexOf(i)),o>=0},k=function(e){let t=!0;e&&(t=e),$(c).attr("data-shown")||$(c).attr("data-shown",!0===t?"true":"false"),"false"===$(c).attr("data-shown")?($(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices"),t=!0):($(c).attr("data-shown","false"),$(c).text("Show Completed Matrices"),t=!1),t?($("[data-matrixcomplete='true']").show(),_=!1):(_=!0,$("[data-matrixcomplete='true']").hide())},N=function(){let e=!0;$(s).attr("data-shown")||$(s).attr("data-shown",!0===e?"true":"false"),"false"===$(s).attr("data-shown")?($(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings"),e=!0):($(s).attr("data-shown","false"),$(s).text("Show Completed Pricings"),e=!1),e?($("[data-pricingcomplete='true']").show(),m=!1):($("[data-pricingcomplete='true']").hide(),m=!0)},M=function(){let e,t=document.querySelectorAll("[data-type='unit']");$(r).attr("data-shown")||($(r).attr("data-shown","true"),e=!0),"false"===$(r).attr("data-shown")?($(r).attr("data-shown","true"),$(r).text("Collapse Units"),e=!0):($(r).attr("data-shown","false"),$(r).text("Expand Units"),e=!1);for(let n=0;n<t.length;n++){let a=t[n],i=$(a).attr("id");$("#"+i).collapse(!0===e?"show":"hide"),p=!0===e}},x=function(){let e=document.querySelectorAll("[data-type='season']"),t=!0;$(d).attr("data-shown")||$(d).attr("data-shown","true"),"false"===$(d).attr("data-shown")?($(d).attr("data-shown","true"),$(d).text("Collapse Seasons"),t=!0):($(d).attr("data-shown","false"),$(d).text("Expand Seasons"),t=!1);for(let n=0;n<e.length;n++){let a=e[n],i=$(a).attr("id");$("#"+i).collapse(!0===t?"show":"hide"),y=!0===t}},C=function(){var e;$(n).html("<span class='spinner-border spinner-border-sm' role='status' aria-hidden='true'></span> Loading..."),e=function(e){e&&$(n).html("Reset Filters")},$("[data-matrixcomplete='true']").show(),$(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices"),$("[data-pricingcomplete='true']").show(),$(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings"),$(l).val([]).trigger("change"),$(o).val([]).trigger("change"),$(r).attr("data-shown","false"),$(r).text("Expand Units"),M(),$(d).attr("data-shown","false"),$(d).text("Expand Seasons"),x(),e(1)},S=function(){!function(){let e=Array.from(Unit.all.values());$.each(e,function(e,t){let n="unit-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).hide()})})}();let e=getListOfIds($(o).val());e.length?$.each(e,function(e,t){let n="unit-"+t,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})}):function(){let e=Array.from(Unit.all.values());$.each(e,function(e,t){let n="unit-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})})}()},P=function(){!function(){let e=Array.from(Season.all.values());$.each(e,function(e,t){let n="season-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).hide()})})}();let e=getListOfIds($(l).val());e.length?$.each(e,function(e,t){let n="season-"+t,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})}):function(){let e=Array.from(Season.all.values());$.each(e,function(e,t){let n="season-"+t.id,a=document.querySelectorAll(`[data-sectiontype='${n}']`);$.each(a,function(e,t){$(t).show()})})}()},D=function(e){let t,n,a,i,o=null,l=[],d={monCost:null,tueCost:null,wedCost:null,thuCost:null,friCost:null,satCost:null,sunCost:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null};if("true"!==$(e).attr("data-dowrow"))return i=$(e).attr("data-matrixid")?isNaN(parseInt($(e).attr("data-matrixid")))?null:parseInt($(e).attr("data-matrixid")):null,t=$(e).attr("data-pricingid")?isNaN(parseInt($(e).attr("data-pricingid")))?null:parseInt($(e).attr("data-pricingid")):null,n=$(e).attr("data-variantid")?isNaN(parseInt($(e).attr("data-variantid")))?null:parseInt($(e).attr("data-variantid")):null,a=$(e).attr("data-pricingcode")?$(e).attr("data-pricingcode"):null,o=$(e).attr("data-pricingcount")?isNaN(parseInt($(e).attr("data-pricingcount")))?null:parseInt($(e).attr("data-pricingcount")):null,l=e.getElementsByTagName("input"),$.each(l,function(e,t){let n=t.name?t.name:null,a=!!t.disabled&&t.disabled,i=t.value?t.value:null;is_null(n)||is_null(a)||a||(d[n]=isNaN(parseInt(i))?null:parseInt(i))}),remove_nulls({id:t,matrix_id:i,variant_id:n,code:a,count:o,mon:d.monCost,tue:d.tueCost,wed:d.wedCost,thu:d.thuCost,fri:d.friCost,sat:d.satCost,sun:d.sunCost,monMargin:d.monMargin,tueMargin:d.tueMargin,wedMargin:d.wedMargin,thuMargin:d.thuMargin,friMargin:d.friMargin,satMargin:d.satMargin,sunMargin:d.sunMargin,enabled:1,note:null})},L=function(e){if(!e)return;let t=e.id,n=document.getElementById(t+"-table"),a=$(n).attr("data-productid"),i=$(n).attr("data-seasonid"),o=$(n).attr("data-unitid"),l=($(n).attr("data-matrixid"),{id:null,code:""!==e.elements.baseMatrixCode.value?e.elements.baseMatrixCode.value:"",product_id:isNaN(parseInt(a))?null:parseInt(a),season_id:isNaN(parseInt(i))?null:parseInt(i),unit_id:isNaN(parseInt(o))?null:parseInt(o),name:""!==e.elements.baseMatrixName.value?e.elements.baseMatrixName.value:"",cost:""!==e.elements.baseCost.value?parseInt(e.elements.baseCost.value):null,margin:""!==e.elements.baseMargin.value?parseInt(e.elements.baseMargin.value):null,has_pricing:1,been_saved:1,enabled:1,pricings:[],price:null});return l.id=$(n).attr("data-matrixid")?parseInt($(n).attr("data-matrixid")):null,l.pricings=function(e,t){let n=[];$(e).attr("data-productid"),$(e).attr("data-seasonid"),$(e).attr("data-unitid"),$(e).attr("data-matrixid");for(let a of e.rows){D(a);let e,i,o,l=null,d=[],r={monCost:null,tueCost:null,wedCost:null,thuCost:null,friCost:null,satCost:null,sunCost:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null};"true"!==$(a).attr("data-dowrow")&&(e=$(a).attr("data-pricingid")?isNaN(parseInt($(a).attr("data-pricingid")))?null:parseInt($(a).attr("data-pricingid")):null,i=$(a).attr("data-variantid")?isNaN(parseInt($(a).attr("data-variantid")))?null:parseInt($(a).attr("data-variantid")):null,o=$(a).attr("data-pricingcode")?$(a).attr("data-pricingcode"):null,l=$(a).attr("data-pricingcount")?isNaN(parseInt($(a).attr("data-pricingcount")))?null:parseInt($(a).attr("data-pricingcount")):null,d=a.getElementsByTagName("input"),$.each(d,function(e,t){let n=t.name?t.name:null,a=!!t.disabled&&t.disabled,i=t.value?t.value:null;is_null(n)||is_null(a)||a||(r[n]=isNaN(parseInt(i))?null:parseInt(i))}),n.push(remove_nulls({id:e,matrix_id:t.id,variant_id:i,code:o,count:l,mon:r.monCost,tue:r.tueCost,wed:r.wedCost,thu:r.thuCost,fri:r.friCost,sat:r.satCost,sun:r.sunCost,monMargin:r.monMargin,tueMargin:r.tueMargin,wedMargin:r.wedMargin,thuMargin:r.thuMargin,friMargin:r.friMargin,satMargin:r.satMargin,sunMargin:r.sunMargin,enabled:1,note:null})))}return n}(n,l),remove_nulls(l)},F=function(e){toastr.error(e)},T=function(e,t){if(e)try{sendPostRequest("/api/v1.0/matrices/update",e,function(e,n,a){return e?t(e):F("Oops: 1")})}catch(e){}},R=function(e,t){if(e)try{sendPostRequest("/api/v1.0/pricings/update",e,function(e,n,a){return e?t(e):F("Oops: 1")})}catch(e){}},q=function(e){let t=L(document.getElementById($(e).attr("data-targetform")));confirmDialog("Would you like to update?",e=>{e&&function(e){e&&T(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);let n=t.pricings?t.pricings:[];new Map,Matrix.all.set(t.code,t),$.each(n,function(e,t){Pricing.all.set(t.code,t)}),PricingWorksheet.pricingWorksheet(),Product.updateProgress(),toastr.success(`Matrix: ${t.name} - has been updated`,"Pricing Worksheet")}})}(t)})},A=function(e,t){let n=D(t);confirmDialog("Would you like to update?",e=>{e&&function(e){e&&R(e,function(e){let t;e&&(t=e,e[0]&&(t=e[0]),Pricing.all.set(t.code,t),PricingWorksheet.pricingWorksheet(),y&&($(d).attr("data-shown","false"),$(d).text("Expand Seasons"),x()),p&&($(r).attr("data-shown","false"),$(r).text("Expand Units"),M()),_&&($("[data-matrixcomplete='true']").show(),$(c).attr("data-shown","true"),$(c).text("Hide Completed Matrices")),m&&($("[data-pricingcomplete='true']").show(),$(s).attr("data-shown","true"),$(s).text("Hide Completed Pricings")),toastr.success(`Pricing: ${t.name} - has been updated`))})}(n)})},O=function(e){let n=isNaN(parseInt(i.value))?null:parseInt(i.value),o=e.matrix_code,l=$("<form/>",{id:"pricingMatrixForm-"+o,class:"card card-body border border-dark rounded-lg mb-2 mt-2 p-0 ",attr:{novalidate:"novalidate"}});e&&e.been_saved&&1===e.been_saved?(l.attr("data-matrixcomplete","true"),PricingWorksheet.incompleteMatrices.get(o)&&PricingWorksheet.incompleteMatrices.delete(o)):(PricingWorksheet.incompleteMatrices.set(o,e),l.attr("data-matrixcomplete","false"));let d=$("<div/>",{class:"pl-1 pr-1"}),r=$("<div/>",{class:"row"}),s=$("<div/>",{class:"col-12"}),c=function(e){let t=$("<div/>",{class:"p-2"}),n=$("<div/>",{class:"row"});if(e){let a,i=e.matrix_code,o=Matrix.all.get(i),l="",d=e.name?e.name:"",r=!1,s=null;o&&(l=o.id?o.id:null,s=o.margin?o.margin:null,a=o.cost?o.cost:null,r=1===e.been_saved);let c=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),u=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),m=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),_=$("<div/>",{class:"col-12 col-md-3 mb-2 px-4"}),p=$("<label/>",{class:"",for:"base_cost_"+i,text:"Cost"}),g=$("<label/>",{class:"",for:"base_margin_"+i,text:"Margin"}),f=$("<label/>",{class:"dev-element d-none",for:"base_matrix_id_"+i,text:"Matrix Id:"}),y=$("<div/>",{class:"form-element"}),v=$("<label/>",{class:"dev-element d-none",for:"base_matrix_name_"+i,text:"Matrix Name:"}),h=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixName",readonly:"readonly",disabled:"disabled",id:"base_matrix_name_"+i}).val(d),b=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixId",readonly:"readonly",disabled:"disabled",id:"base_matrix_id_"+i}).val(l),I=$("<input/>",{class:"form-control",id:"base_cost_"+i,name:"baseCost",attr:{"data-targetform":"pricingMatrixForm-"+i}}).on("keyup",function(){let e=document.getElementById($(this).attr("data-targetform"));this.value,e.querySelectorAll(".cost").forEach(e=>{e.disabled||($(e).val(this.value),""!==this.value?$(e).parent("div").find("label").addClass("active"):$(e).parent("div").find("label").removeClass("active"))})}).on("click",function(){$(this).select()}).val(a),w=$("<input/>",{class:"form-control",id:"base_margin_"+i,name:"baseMargin",attr:{"data-targetform":"pricingMatrixForm-"+i}}).on("keyup",function(){document.getElementById($(this).attr("data-targetform")).querySelectorAll(".margin").forEach(e=>{e.disabled||($(e).val(this.value),""!==this.value?$(e).parent("div").find("label").addClass("active"):$(e).parent("div").find("label").removeClass("active"))})}).on("click",function(){$(this).select()}).val(s),E=$("<div/>",{class:"form-element"}),B=$("<div/>",{class:"form-element"}),k=$("<div/>",{class:"form-element"}),N=$("<label/>",{class:"dev-element d-none",for:"base_matrix_code_"+i,text:"Matrix Code:"}),M=$("<input/>",{class:"form-control dev-element",type:"hidden",name:"baseMatrixCode",readonly:"readonly",disabled:"disabled",id:"base_matrix_code_"+i}).val(i),x=$("<div/>",{class:"form-element"}),C=$("<div/>",{class:"error w-100 text-center"}),S=$("<div/>",{class:"error w-100 text-center"});B.append(f,b),E.append(p,I,C),x.append(g,w,S),k.append(N,M),y.append(v,h),c.append(E),u.append(x),m.append(B),_.append(k,y),n.append(c,u,m,_),t.append(n)}return t}(e),u=function(e){let t=e.matrix_code,n=$("<div/>",{class:"row"}),a=$("<div/>",{class:"col-12 col-md-6 mb-2 text-left"}),i=$("<div/>",{class:"col-12 col-md-6 mb-2 text-right"}),o=$("<button/>",{class:"btn btn-primary btn-sm submit-pricing-matrix-form waves-effect waves-light",text:"Update",type:"button",id:"submitPricingMatrixForm-"+t,attr:{"data-targetform":"pricingMatrixForm-"+t}}).on("click",function(){q(this)});return i.append(o),n.append(a,i)}(e),m=$("<table/>",{class:"table table-bordered table-sm",id:"pricingMatrixForm-"+o+"-table",attr:{"data-matrixcode":o,"data-productid":n,"data-unitid":e.unit_id,"data-seasonid":e.season_id,"data-name":e.name}});e.id&&m.attr("data-matrixid",e.id);let _=$("<tbody/>",{}),p=$("<thead/>",{}).append(function(e){let n=$("<tr/>"),a=$("<th/>",{html:"&nbsp;"}),i=$("<th/>",{css:{width:"120px"}});if(n.attr("data-dowrow","true"),n.append(i),e){let i=!1,o=Matrix.all.get(e.pricing_code);o&&(i=!(!o.been_saved||1!==o.been_saved));for(let a=0;a<t.length;a++){let i="",o=ucwords(t[a]);B(a,e.season_id)&&(i="disabled",o=ucwords(t[a])+" (disabled)");let l=$("<th/>",{class:""+i,text:o});n.append(l)}n.append(a)}return n}(e));for(let a=0;a<e.variants.length;a++){let i=e.variants[a],l=h;i.matrix_code=o;let d=$("<tr/>"),r=$("<i/>",{class:"far fa-edit"});d.attr({id:"tr-"+i.code,"data-variantid":i.variant_id?i.variant_id:null,"data-pricingid":i.id?i.id:null,"data-pricingcode":i.code?i.code:null,"data-matrixcode":i.matrix_code?i.matrix_code:null,"data-pricingcount":i.count?i.count:null,"data-productid":n,"data-targetform":"pricingMatrixForm-"+i.matrix_code,"data-seasonid":i.season_id?i.season_id:null,"data-name":i.name?i.name:null}),1===i.been_saved?(d.attr("data-pricingcomplete","true"),l=v):(d.attr("data-pricingcomplete","false"),PricingWorksheet.incompletePricings.set(i.pricing_code,i));let s=$(`\n                        <td style="padding:0;">\n                            <div class="d-flex flex-column">\n                                <div class="p-1">\n                                    ${l}\n                                </div>\n                                <div class="p-1">\n                                    <span class="table-variant-title">${e.name}</span>\n                                </div>\n                               \n                            </div>\n                        </td>\n                    `);d.append(s);let c=$("<button/>",{class:"btn btn-sm editRow btn-sm btn-teal waves-effect waves-light",type:"button",attr:{"data-variantid":i.variant_id?i.variant_id:null,"data-pricingid":i.id?i.id:null,"data-pricingcode":i.code?i.code:null,"data-matrixcode":i.matrix_code?i.matrix_code:null,"data-pricingcount":i.count?i.count:null,"data-productid":n,"data-targetform":"pricingMatrixForm-"+i.matrix_code,"data-seasonid":i.season_id?i.season_id:null,"data-name":i.name?i.name:null}}).append(r);i.matrix_id&&c.attr("data-matrixid",i.matrix_id),c.on("click",function(){let e=document.getElementById("tr-"+i.code);e&&A(0,e)});for(let e=0;e<t.length;e++){let n=$("<td/>");n.append(Y(i,t[e]),Q(i,t[e])),d.append(n)}let u=$("<td/>",{class:"text-center td-editor"}).append(c);d.append(u),_.append(d)}m.append(p,_),d.append(m),s.append(d),r.append(s);let g=function(e){let t,n=$("<h5/>",{class:"card-title d-flex justify-content-between m-2"});e&&((t=Matrix.all.get(e.pricing_code))||(t=Matrix.set()));let i=e.name?e.name:"Pricing";1===parseInt(a.value)?i="Unit Pricing":3===parseInt(a.value)&&(i="Daily Pricing");let o=$("<span/>",{class:"",text:i||"Pricing Variant"});return e&&e.been_saved&&1===e.been_saved?n.append(o,v):n.append(o,h),n}(e),f=$("<hr/>",{class:"ml-3 mr-3 mt-1 mb-3 color-dark"});return l.append(g,f,c,r,u)},Q=function(e,t){let n=e.matrix_code,a=n+"-"+e.variant_id+"-"+e.count,i=Pricing.all.get(a);if(i||((i=Pricing.set()).note="generated form"),i.product_id=e.product_id,i.season_id=e.product_id,i.unit_id=e.product_id,i.variant_id=e.variant_id,i.matrix_code=n,i.pricing_code=a,i.name=e.name,i.code=a,t){B(t,e.season_id);let n=t+"Margin",o=i[n]?i[n]:null,l=$("<input/>",{type:"text",id:"cm-"+a+"-"+t,name:n,class:"form-control margin m-0"}).attr("data-element","margin"),d=$("<div/>",{class:"md-form md-outline form-sm input-with-post-icon mb-2 mt-3"}),r=$("<label/>",{text:"Margin",for:"cm-"+a+"-"+t}),s=$("<i/>",{class:"fas fa-percentage input-prefix"});return B(t,e.season_id)?(l.attr("disabled","disabled"),l.val(""),r.removeClass("active"),d.addClass("disabled")):(d.removeClass("disabled"),o>0&&(l.val(o),r.addClass("active"))),d.append(s,l,r),d}},Y=function(e,t){let n=e.matrix_code,a=n+"-"+e.variant_id+"-"+e.count,i=Pricing.all.get(a);if(i||((i=Pricing.set()).note="generated form"),i.product_id=e.product_id,i.season_id=e.product_id,i.unit_id=e.product_id,i.variant_id=e.variant_id,i.matrix_code=n,i.pricing_code=a,i.name=e.name,i.code=a,t){let n=t+"Cost",o=i[t]?i[t]:0,l=$("<input/>",{type:"text",name:n,id:"ce-"+a+"-"+t,class:"form-control cost m-0"}).attr("data-element","cost"),d=$("<div/>",{class:"md-form md-outline form-sm input-with-pre-icon mt-2 mb-3"}),r=$("<label/>",{text:"Cost",for:"ce-"+a+"-"+t}),s=$("<i/>",{class:"fas fa-dollar-sign input-prefix"});return B(t,e.season_id)?(l.attr("disabled","disabled"),l.val(""),r.removeClass("active"),d.addClass("disabled")):(d.removeClass("disabled"),o>0&&(l.val(o),r.addClass("active"))),d.append(s,l,r),d}},U=function(e){let t=$("<div/>",{});if(e&&e.units){let n=0;$.each(e.units,function(e,a){let o=a.seasons,l=function(e,t){let n=e.id+"-"+t;return $("<div/>",{class:"accordion md-accordion card card-body p-1 mb-2",id:"accordionUnit-"+n,role:"tablist","aria-multiselectable":"true"}).attr("data-sectiontype","unit-"+e.id)}(a,n),d=function(e,t){let n=e.id+"-"+t,a=e.name?e.name:null,i=isNaN(parseInt(e.id))?null:parseInt(e.id);if(Unit.all.get(i)){let e=$("<div/>",{class:"card-header p-0",role:"tab",id:"unitHeading-"+n}),t=$("<i/>",{class:"fas fa-angle-down rotate-icon"}),i=$("<a/>",{href:"#unitCollapse-"+n,"aria-controls":"unitCollapse-"+n,"data-toggle":"collapse","aria-expanded":"true"}),o=$("<span/>",{text:a}),l=$("<h5/>",{class:"mb-0 w-100 d-flex align-items-center justify-content-between p-1"});return e.append(i.append(l.append(o,t))),e}}(a,n),r=$("<div/>",{class:"card border border-0"}),s=$("<div/>",{class:"collapse show",role:"tabpanel","data-parent":"#accordionUnit-"+a.id+"-"+n,id:"unitCollapse-"+a.id+"-"+n,"aria-labelledby":"unitHeading-"+a.id+"-"+n}).attr("data-type","unit"),c=$("<div/>",{class:"card-body px-1"}),u=0;$.each(o,function(e,t){let n,o,l,d=i.value+"-"+a.id+"-"+t.season_id,r=t.pricings,m=t.season_id?t.season_id:null,_=Season.all.get(m),p=function(e,t,n){return $("<div/>",{class:"accordion md-accordion",id:"accordionEx"+t+"-"+n,role:"tablist","aria-multiselectable":"true"}).attr("data-sectiontype","season-"+e.season_id)}(t,d,u),g=function(e,t,n){let a,i,o;if(e){let l=e.season_name?e.season_name:null,d=e.season_id?e.season_id:null,r=Season.all.get(d);r&&(a=r.color_scheme.background_color?r.color_scheme.background_color:null,i=r.color_scheme.text_color?r.color_scheme.text_color:null,o=r.color_scheme.border_color?r.color_scheme.border_color:null);let s=$("<div/>",{class:"card-header p-0",role:"tab",id:"seasonHeading"+t+"-"+n}),c=$("<i/>",{class:"fas fa-angle-down rotate-icon"}),u=$("<a/>",{href:"#collapse"+t+"-"+n,"aria-controls":"collapse"+t+"-"+n,"data-toggle":"collapse","aria-expanded":"true"}),m=$("<span/>",{text:l}),_=$("<h5/>",{class:"mb-0 w-100 d-flex align-items-center justify-content-between p-1",css:{"background-color":`${a}`,border:`solid 1px ${o}`,color:`${i}`}});return s.append(u.append(_.append(m,c))),s}}(t,d,u),f=$("<div/>",{class:"card"}),y=$("<div/>",{class:"collapse show",role:"tabpanel","data-parent":"#accordionEx"+d+"-"+u,id:"collapse"+d+"-"+u,"aria-labelledby":"seasonHeading"+d+"-"+u}).attr("data-type","season");_&&(n=hexToRgb(_.color_scheme.background_color),o=_.color_scheme.text_color,l=_.color_scheme.border_color);let v=$("<div/>",{class:"card-body p-1",css:{background:`rgba(${n.join(",")}, .15)`,color:o}});$.each(r,function(e,t){v.append(O(t)),y.append(v)}),f.append(g,y),p.append(f),c.append(p),s.append(c),u+=1}),r.append(d,s),l.append(r),t.append(l),n+=1})}return t},W=function(){let e=[];switch(isNaN(parseInt(a.value))?null:parseInt(a.value)){case 1:e=[36];break;case 2:let t=Array.from(Variant.all.values());for(let n=0;n<t.length;n++)t[n].used_in_pricing&&e.push(t[n].id);break;default:e=[36]}return e},j=function(e){let t="";1===parseInt(a.value)?t="Unit Pricing":3===parseInt(a.value)&&(t="Daily Pricing");let n={category_id:1,code:"VA-00000000036-OTHR",created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:36,max_age:null,min_age:null,modified_by:w,name:t,note:null,used_in_pricing:1},i=Variant.all.get(e);return i&&(n=Variant.set(i)),n},z=function(e,t,n,a){let o=a.trim().split("-").map(Number),l=parseInt(t.id),d=parseInt(e.id),r=isNaN(parseInt(i.value))?null:parseInt(i.value),s=new Map;$.each(o,function(o,c){let u=j(c);if(u){let o=s.get(c);if(o){let a=o.count;a+=1,o.count=a,o.name=a+" "+pluralize(u.name);let s=n.toString()+"-"+c+"-"+a,m=Pricing.all.get(s);m?(m.aaa=1,m.has_pricing=1,m.been_saved=1):m={aaa:"ok here 2",been_saved:0,has_pricing:0,code:n.toString()+"-"+c.toString()+"-"+a.toString(),count:a,created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,fri:null,friMargin:null,id:null,matrix_code:n.toString(),matrix_id:null,modified_by:w,mon:null,monMargin:null,name:u.name+" "+a,note:"generated form",pricing_code:s,product_id:r,sat:null,satMargin:null,season_id:l,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:d,variant_id:c,wed:null,wedMargin:null},o.variants.push({aaa:"ok here",matrix_code:n.toString(),been_saved:5,has_pricing:m.has_pricing?m.has_pricing:0,code:n.toString()+"-"+c.toString()+"-"+a.toString(),count:a,created_by:m.created_by?m.created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:m.enabled?m.enabled:1,fri:m.fri?m.fri:null,friMargin:m.friMargin?m.friMargin:null,id:m.id?m.id:null,matrix_id:m.matrix_id?m.matrix_id:null,modified_by:m.modified_by?m.matrix_id:w,mon:m.mon?m.mon:null,monMargin:m.monMargin?m.monMargin:null,name:u.name+" "+a,note:"generated form",pricing_code:n.toString()+"-"+c.toString()+"-"+a.toString(),product_id:isNaN(parseInt(i.value))?null:parseInt(i.value),sat:m.sat?m.sat:null,satMargin:m.satMargin?m.satMargin:null,season_id:parseInt(t.id),sun:m.sun?m.sun:null,sunMargin:m.sunMargin?m.sunMargin:null,thu:m.thu?m.thu:null,thuMargin:m.thuMargin?m.thuMargin:null,tue:m.tue?m.tue:null,tueMargin:m.tueMargin?m.tueMargin:null,unit_id:e.id,variant_id:c,wed:m.wed?m.wed:null,wedMargin:m.wedMargin?m.wedMargin:null})}else{let t=1,i=n.toString()+"-"+c+"-"+t,s=Pricing.all.get(i);s?(s.aaa="hasPricing",s.been_saved=1,s.has_pricing=1):s={aaa:"ok here 1",has_pricing:0,been_saved:0,code:i,count:t,created_by:w,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,fri:null,friMargin:null,id:null,matrix_code:n,pricing_code:i,matrix_id:null,modified_by:w,mon:null,monMargin:null,name:u.name+" "+t,note:"generated form",product_id:r,sat:null,satMargin:null,season_id:l,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:d,variant_id:u.id,wed:null,wedMargin:null},o={name:t+" "+u.name,variant_combo_id:a.trim(),count:t,variants:[{aaa:s.aaa?s.aaa:"ghg",code:i,has_pricing:s.has_pricing?s.has_pricing:0,variant_id:c,name:u.name+" "+t,count:t,created_by:s.created_by,date_created:s.date_created?s.date_created:formatDateMySQL(),date_modified:s.date_modified?s.date_modified:formatDateMySQL(),enabled:s.enabled?s.enabled:1,fri:null,friMargin:null,id:s.id?s.id:null,matrix_code:n,matrix_id:s.matrix_id?parseInt(s.matrix_id):null,modified_by:s.modified_by?parseInt(s.modified_by):w,mon:s.mon?parseInt(s.mon):null,monMargin:null,note:"fff",pricing_code:n+"-"+c+"-"+t,product_id:null,sat:null,satMargin:null,season_id:null,sun:null,sunMargin:null,thu:null,thuMargin:null,tue:null,tueMargin:null,unit_id:e.id,wed:null,wedMargin:null}]}}s.set(c,o)}else 36===parseInt(c)&&(u={category_id:1,code:"VA-00000000036-OTHR",created_by:4,date_created:"2022-01-18 08:08:22",date_modified:"2022-01-18 12:02:26",enabled:1,id:36,max_age:null,min_age:null,modified_by:4,name:"Other",note:null,used_in_pricing:1})});let c,u,m,_,p=0,g=[],f=[],y=null;$.each(Array.from(s.values()),function(e,t){f.push(t.name),t.variants&&$.each(t.variants,function(e,t){u=n+"-"+t.variant_id+"-"+t.count,m=n;let a=j(t.variant_id),i=Matrix.all.get(m),o=Pricing.all.get(u),s=(Season.all.get(l),null),f=null,v=null,h=null,b=null,I=null,$=null,E=null,B=null,k=null,N=null,M=null,x=null,C=null,S=1,P=null,D=formatDateMySQL(),L=formatDateMySQL(),F=w,T=w;i&&(_=i.id,c=1),o&&(y=o.id,p=1,s=o.sun,f=o.mon,v=o.tue,h=o.wed,b=o.thu,I=o.fri,$=o.sat,E=o.sunMargin,B=o.monMargin,k=o.tueMargin,N=o.wedMargin,M=o.thuMargin,x=o.friMargin,C=o.satMargin,S=o.enabled,P=o.note,D=o.date_created,L=o.date_modified,F=o.created_by,T=o.modified_by);let R={count:t.count,been_saved:p,code:u,pricing_code:u,product_id:r,unit_id:d,season_id:l,variant_id:t.variant_id,matrix_id:_,name:a.name+" "+t.count,id:y,sun:s,mon:f,tue:v,wed:h,thu:b,fri:I,sat:$,sunMargin:E,monMargin:B,tueMargin:k,wedMargin:N,thuMargin:M,friMargin:x,satMargin:C,enable:S,note:P,date_created:D,date_modified:L,created_by:F,modified_by:T,matrix_code:"H"};g.push(R)})}),f=f.join(" - ");let v=0,h=null,b=null,I=Matrix.all.get(n);return I&&(v=1,h=I.cost,b=I.margin),{name:f,cost:h,margin:b,season_id:l,unit_id:d,product_id:r,been_saved:v,matrix_code:n,id:_||null,variants:g}},V=function(e,t,n){for(let a=0;a<n.length;a++)if(1===e){let e=t+n[a],i=e.split("-").map(function(e){return parseInt(e,10)});i=i.sort().join("-"),I.indexOf(e)<0&&I.push(i)}else{n[a];V(e-1,t+n[a]+"-",n)}},H=function(){let e=isNaN(parseInt(i.value))?null:parseInt(i.value),t={id:null,units:[]};b=W(),g=function(){var e=[],t=Array.from(Season.all.values());for(let n=0;n<t.length;n++)e.push(t[n]);return e}(),f=function(){var e=[],t=Array.from(Unit.all.values());for(let n=0;n<t.length;n++)e.push(t[n]);return e}();for(let n=0;n<f.length;n++){I=[];let i=f[n],o=parseInt(i.id),l=i.max_pax?parseInt(i.max_pax):5,d=i.min_pax?parseInt(i.min_pax):1;switch(isNaN(parseInt(a.value))?null:parseInt(a.value)){case 1:d=1,l=1;break;case 2:if(d>l){let e=l;l=d,d=e}break;default:d=1,l=1}for(let e=d;e<=l;e++)V(e,"",W());let r=I,s={id:i.id,name:i.name,seasons:[]};for(let t=0;t<g.length;t++){let n=g[t],a=e+"-"+o+"-"+(isNaN(parseInt(n.id))?null:parseInt(n.id)),l=Matrix.all.get(a);l?l.pricings=[]:l={been_saved:0,code:a,cost:0,created_by:4,date_created:"2022-01-14 09:00:39",date_modified:"2022-01-14 09:00:39",enabled:1,has_pricing:1,id:null,margin:0,modified_by:4,note:null,price:201,pricings:[]};let d={been_saved:l.been_saved,code:l.code,cost:l.cost,created_by:l.created_by,date_created:l.date_created,date_modified:l.date_modified,enabled:l.enabled,has_pricing:l.has_pricing,id:l.id,margin:l.margin,modified_by:l.modified_by,note:l.note,price:l.price,season_id:n.id,season_name:n.name,matrix_code:a,pricings:[]};$.each(r,function(e,t){d.matrix_code=a+"-"+t,d.pricings.push(z(i,n,a+"-"+t,t))}),s.seasons.push(d)}t.units.push(s)}return t},G=function(){C(),PricingWorksheet.incompletePricings=new Map,PricingWorksheet.incompleteMatrices=new Map,$(e).empty(),$(e).html('\n                <div style="top:0;left:0;width:100%;height:500px;background:rgba(0,0,0,.25);" class="flex-center">\n                    <div class="preloader-wrapper active">\n                        <div class="spinner-layer spinner-blue-only">\n                            <div class="circle-clipper left">\n                                <div class="circle"></div>\n                            </div>\n                            <div class="gap-patch">\n                                <div class="circle"></div>\n                            </div>\n                            <div class="circle-clipper right">\n                                <div class="circle"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            '),I=[],$(e).empty().append(U(PricingWorksheet.buildPricingWorksheet())),E()};return{pricingStrategyId:null,incompleteMatrices:new Map,incompletePricings:new Map,init:function(e){!function(e){let t=null;e&&e.pricing_strategy&&e.pricing_strategy.pricing_strategy_types_id&&(t=isNaN(parseInt(e.pricing_strategy.pricing_strategy_types_id))?null:parseInt(e.pricing_strategy.pricing_strategy_types_id)),$(document).ready(function(){PricingWorksheet.pricingStrategyId=t,a&&$(a).val(PricingWorksheet.pricingStrategyId).trigger("change")})}(e)},pricingWorksheet:function(){G()},buildPricingWorksheet:function(){return H()},status:function(){return E()}}}(),Upload=function(e){this.file=e},_image_manager_is_cover=document.getElementById("image_manager_is_cover"),_image_manager_title=document.getElementById("image_manager_title"),_image_manager_caption=document.getElementById("image_manager_caption"),_image_manager_upload=document.getElementById("image_manager_upload"),_image_manager_alt_text=document.getElementById("image_manager_alt_text"),_image_manager_form_data=document.getElementById("image_manager_form_data"),_image_manager_image_id=document.getElementById("image_manager_id"),_provider_edit=document.getElementById("provider_edit"),_vendor_edit=document.getElementById("vendor_edit"),_provider_company_id=document.getElementById("provider_company_id"),_vendor_company_id=document.getElementById("vendor_company_id");Upload.prototype.getType=function(){return this.file.type},Upload.prototype.getSize=function(){return this.file.size},Upload.prototype.getName=function(){return this.file.name},Upload.prototype.doUpload=function(){let e=this,t=new FormData;t.append("file",this.file,this.getName()),t.append("upload_file",!0),t.append("title",""!==_image_manager_title.value?_image_manager_title.value:null),t.append("caption",""!==_image_manager_caption.value?_image_manager_caption.value:null),t.append("is_cover",!0!==_image_manager_is_cover.checked?parseInt(0):parseInt(1)),t.append("alt",""!==_image_manager_alt_text.value?_image_manager_alt_text.value:null),_provider_edit&&(t.append("directory_id",parseInt(_provider_company_id.value)),t.append("directory","company")),_vendor_edit&&(t.append("directory_id",parseInt(_vendor_company_id.value)),t.append("directory","company")),$.ajax({type:"POST",url:"/api/v1.0/images/update",xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",e.progressHandling,!1),t},success:function(e){let t,n=null;if(e&&e.result&&(n=e.result)[0]&&(t=n[0]),t){let e;_provider_edit&&(e=$("#companyImages").imageManager()),_vendor_edit&&(e=$("#companyImages").imageManager()),e.addImage(t),toastr.success("Image Uploaded"),Upload.prototype.resetForm(),$("button.dropify-clear").click()}},error:function(e){toastr.error("Error")},async:!0,data:t,cache:!1,contentType:!1,processData:!1,timeout:6e4})},Upload.prototype.progressHandling=function(e){var t=0,n=e.loaded||e.position,a=e.total;e.lengthComputable&&(t=Math.ceil(n/a*100)),$("#progress-wrp .progress-bar").css("width",+t+"%"),$("#progress-wrp .status").text(t+"%")},Upload.prototype.progressReset=function(){$("#progress-wrp .progress-bar").css("width","0%"),$("#progress-wrp .status").text("0%")},Upload.prototype.resetForm=function(){Upload.prototype.progressReset(),_image_manager_is_cover.checked=!1,_image_manager_image_id.value="",_image_manager_title.value="",_image_manager_upload.value="",_image_manager_caption.value="",_image_manager_alt_text.value="",_image_manager_upload.disabled=!1,$(_image_manager_form_data).hide()},Upload.prototype.populateForm=function(e){Upload.prototype.progressReset();e.path,e.name,e.extension;_image_manager_is_cover.checked=1===e.is_cover,_image_manager_image_id.value=e.id,_image_manager_title.value=e.title,_image_manager_caption.value=e.caption,_image_manager_alt_text.value=e.alt,$("button.dropify-clear").click(),_image_manager_upload.disabled=!0,$(_image_manager_form_data).show()},$("#image_manager_upload").on("change",function(){_image_manager_is_cover.checked=!1,_image_manager_image_id.value="",_image_manager_title.value="",_image_manager_caption.value="",_image_manager_alt_text.value="",$(_image_manager_form_data).show()}),$("#image_manager_clear_button").on("click",function(){Upload.prototype.resetForm()}),$.fn.YearCalendar=function(e){"use strict";document.getElementById("calendar_filter_ranges");const t=document.getElementById("product_id"),n=document.getElementById("calendar_display_select_all_days"),a=document.getElementById("calendar_display_clear_selected_days");let i,o="season",l=null,d=$(this).attr("id"),r=document.getElementById(d),s=[],c=new Map,u=parseInt(t.value);$(n).on("click",function(){m()}),$(a).on("click",function(){f()});const m=function(){f();const e=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),11,31);let n=moment(e).format("YYYY-MM-DD"),a=moment(t).format("YYYY-MM-DD");v(this,n,a)},_=function(e){return e<10?"0"+e.toString():e.toString()},p=function(e){let t=document.createElement("div");return t.classList="row gx-1",t},g=function(e){let t=function(e){let t=document.createElement("div");return t.classList=["card card-block p-1 z-depth-0"],t}(),n=function(e){let t=document.createElement("div");return t.classList="flex-fill col-6 p-1",t}(),a=document.createElement("div"),i="calendar_block_"+e;return a.classList="my_calendar",a.id=i,n.appendChild(t),t.appendChild(a),s.push(a),n},f=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("selected-day"),$(this).attr("data-selected","false")}),YearCalendar.selectedDates=new Map},y=function(e,t){$(e).hasClass("selected-day")?($(e).removeClass("selected-day"),$("td.fc-day-top[data-date='"+moment(t).format("YYYY-MM-DD")+"']").removeClass("selected-day"),YearCalendar.selectedDates.delete(t)):($(e).addClass("selected-day"),$("td.fc-day-top[data-date='"+moment(t).format("YYYY-MM-DD")+"']").addClass("selected-day"),YearCalendar.selectedDates.set(t,t),i=t,l=null)},v=function(e,t,n){let a=new Date(moment(t).format("MM/DD/YYYY")),i=new Date(moment(n).format("MM/DD/YYYY")),o=new Date(a);for($("td.fc-day[data-date='"+moment(n).format("YYYY-MM-DD")+"']").removeClass("selected-day"),$("td.fc-day[data-date='"+moment(t).format("YYYY-MM-DD")+"']").removeClass("selected-day"),$("td.fc-day-top[data-date='"+moment(n).format("YYYY-MM-DD")+"']").removeClass("selected-day");o<=i;){y($("td.fc-day[data-date='"+moment(o).format("YYYY-MM-DD")+"']"),moment(o).format("YYYY-MM-DD"));let e=o.setDate(o.getDate()+1);o=new Date(e)}},h=function(e){YearCalendar.season_events=new Map;let t=new Date;r.appendChild(function(){let e=document.createElement("div"),t=p();e.classList=["calendarContainer container-fluid"],e.id="calendar_block_container";for(let n=0;n<12;n++){let a=n+1;n%2==0&&n>0&&(e.appendChild(t),t=p()),t.appendChild(g(a))}return e.appendChild(t),e}()),YearCalendar.start=e&&e.start?e.start:t.getFullYear(),YearCalendar.events=e&&e.events?e.events:[],YearCalendar.getTitle(),$.each(s,function(e,t){let n=(a=YearCalendar.start,moment(a+"-"+_(0+e+1)+"-"+_(1)).format("YYYY-MM-DD"));var a;let o=$(t).fullCalendar({selectable:!1,showNonCurrentDates:!1,defaultDate:n,initialView:"dayGridMonth",displayEventTime:!1,eventLimit:3,header:{left:"",center:"title",right:""},views:{month:{titleFormat:"MMMM"}},dayRender:function(e,t){let n=moment(e).format("YYYYMMDD"),a=moment(e).format("YYYY-MM-DD"),i="s"+n,o=moment(e).month(),l=moment(e).year(),d=moment(e).day(),r=$(`td.fc-day-top[data-date='${a}']`);$(`td.fc-day-top[data-date='${a}'] > span.fc-day-number`);$(t).hasClass("fc-disabled-day")||($(r).attr("season","true"),$(r).attr("data-date",a),$(r).attr("id",i),$(r).attr("day",n),$(r).attr("month",o),$(r).attr("year",l),$(r).attr("dow",d),$(t).attr("season","true"),$(t).attr("data-date",a),$(t).attr("id",i),$(t).attr("day",n),$(t).attr("month",o),$(t).attr("year",l),$(t).attr("dow",d),$(t).attr("data-selected","false"))},dayClick:function(e,t,n){let a=moment(e).format("YYYY-MM-DD");if(t.originalEvent.shiftKey){if(null!==i){if(l=a,moment(l)<moment(i)){let e=moment(i).format("YYYY-MM-DD"),t=moment(l).format("YYYY-MM-DD"),n=$("td.fc-day[data-date='"+t+"'][season='true']"),a=$("td.fc-day[data-date='"+e+"'][season='true']");$(n).removeClass("is-selected"),a.removeClass("is-selected"),v(this,t,e),i=e,l=t}else v(this,i,l);i=null,l=null}}else if(t.originalEvent.ctrlKey)this.hasClass("selected-day")?(this.removeClass("selected-day"),YearCalendar.selectedDates.delete(a),i=null,l=null):(YearCalendar.selectedDates.set(a,a),i=a,l=null,this.addClass("selected-day"));else{Array.from(YearCalendar.selectedDates.values());f(),y(this,a),i=a,l=a,this.addClass("selected-day")}},eventRender:function(e,t,n){$(t).attr("season","true");let a=moment(e.start).format("YYYY-MM-DD"),i=$("td.fc-day-top[data-date='"+a+"']"),o=$("td.fc-day[data-date='"+a+"'][season='true']"),l=c.get(a),d=e.textColor,r=(e.backgroundColor,e.borderColor,hexToRgb(e.backgroundColor));r.push(.6);let s="rgba("+r.join(", ")+")";if("background"===e.rendering){if($(t).hasClass("fc-disabled-day"))return;YearCalendar.season_events.set(a,"true"),i.addClass("background_event").attr("data",e);let n=document.querySelectorAll(`td.fc-day[season='true'][data-date='${a}']`);l&&($(o).addClass("has-event"),$(o).attr("seasons_types_id",e.id),$(o).data("season","true"),$(o).attr("data-seasonid",e.id)),$(n).addClass("background_event").attr("data",e).css({background:s,color:d}),$(t).attr("data-sid",e.id),$(t).attr("data-date",a),$(t).attr("season","true"),$(t).attr("seasonid",e.id),$(t).addClass("background_event"),$(t).attr("data",e),$(t).css({background:s,color:d})}},eventClick:function(e,t,n){},events:YearCalendar.events});YearCalendar.activeCalendars.push(o);let d=isNaN(parseInt($(document.getElementById("calendar_block_1")).actual("width")))?600:parseInt($(document.getElementById("calendar_block_1")).actual("width"));$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("option","contentHeight",d)})})};return function(e){s=[],e&&e.calendarType&&(o=e.calendarType),function(e,t){if(!e)return t([]);try{sendGetRequest("/api/v1.0/calendars",e,function(e,n,a){return t(e||[])})}catch(e){return t([])}}({product_id:u},function(e){e||(e=[]),YearCalendar.start=(new Date).getFullYear(),YearCalendar.loadSeasonDropdown(),YearCalendar.loadProfileDropdown(),YearCalendar.loadUnitDropdown(),h({events:e,start:YearCalendar.start}),YearCalendar.endLoading()}),$(function(){YearCalendar.init(e)})}(e),{calendars:[]}};const YearCalendar=function(){"use strict";const e=document.getElementById("calendar_display_remove"),t=document.getElementById("calendar_loader"),n=document.getElementById("seasonCalendarModal"),a=document.getElementById("calendar_display_year"),i=document.getElementById("calendar_display_next_year"),o=document.getElementById("calendar_display_prev_year"),l=document.getElementById("calendar_filter_season_id"),d=document.getElementById("product_id"),r=document.getElementById("calendar_filter_profile_id"),s=document.getElementById("calendar_filter_unit_id"),c=(document.getElementById("calendar_filter_profile_id_assign"),document.getElementById("calendar_filter_profile_id_clear")),u=document.getElementById("calendar_filter_unit_id_assign"),m=document.getElementById("calendar_filter_unit_id_clear"),_=document.getElementById("calendar_filter_season_id_assign"),p=document.getElementById("calendar_filter_season_id_clear"),g=document.getElementById("calendar_display_refresh");$(e).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.remove(),h()})}),$(g).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.refresh(),h()})}),$(i).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.start=(parseInt(YearCalendar.start)+1).toString(),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("nextYear")}),S(),YearCalendar.endLoading()})}),$(o).on("click",function(){$(t).fadeIn("slow",function(){YearCalendar.start=(parseInt(YearCalendar.start)-1).toString(),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("prevYear")}),YearCalendar.getTitle(),YearCalendar.endLoading()})}),$(l).on("change",function(){let e,t,n,a=isNaN(parseInt(l.value))?null:parseInt(l.value);is_null(a),is_null(a)?(_.disabled=!0,r.disabled=!1,u.disabled=!0):((t=Season.all.get(a))&&t.product_season_detail&&(e=t.product_season_detail),e.disabled_dow&&(n=getListOfIds(e.disabled_dow)),r.value="",r.disabled=!0,u.disabled=!0,_.disabled=!1,r.value="",$(s).val([])),N(n)}),$(s).on("change",function(){let e=$(s).val();u.disabled=e.length<=0}).on("click",function(){let e=$(s).val();u.disabled=e.length<=0}),$(r).on("change",function(){null!==(isNaN(parseInt(r.value))?null:parseInt(r.value))?(s.disabled=!1,l.disabled=!0):($(s).val([]),s.disabled=!0,l.disabled=!1)}),$(_).on("click",function(){b()}),$(u).on("click",function(){w()}),$(p).on("click",function(){$(l).val("").trigger("change"),h()}),$(m).on("click",function(){$(s).val([]).trigger("change"),h()}),$(c).on("click",function(){$(r).val("").trigger("change"),h()}),$(n).on("shown.bs.modal",function(){h(),$("html").css({overflow:"hidden"})}).on("hidden.bs.modal",function(){k(),$("html").css({overflow:"auto"})}).on("click",function(){YearCalendar.checkProgress()});const f=function(){let e=Season&&Season.all?Array.from(Season.all.values()):[],t="<option value='' disabled readonly selected>-- Seasons --</option>",n="";$.each(e,function(e,a){let i=a.name,o=a.id;t+=`<option value="${o}">${i}</option>`,n+=`<option value="${o}">${i}</option>`}),$(l).empty(),$(l).html(t),$(l).val("").trigger("change")},y=function(){let e=InventoryProfile&&InventoryProfile.all?Array.from(InventoryProfile.all.values()):[],t="<option value='' disabled readonly selected>-- Profiles --</option>";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(r).empty(),$(r).html(t),$(r).val("").trigger("change")},v=function(){let e=Unit&&Unit.all?Array.from(Unit.all.values()):[],t="";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(s).empty(),$(s).html(t),$(s).val([]).trigger("change")},h=function(){M()},b=function(){let e=parseInt(d.value),n=parseInt(l.value),a=Season.all.get(n),i=[],o={season_id:n,product_id:e,days:[]},r=Array.from(YearCalendar.selectedDates.values());a&&a.product_season_detail&&(i=getListOfIds(a.product_season_detail.disabled_dow)),$.each(r,function(e,t){const n=moment(t).day();i.indexOf(n)<0&&o.days.push(t)}),confirmDialog("Would you like to assign? This change may affect your Pricing Worksheets.",e=>{e&&$(t).fadeIn("slow",function(){B(o,function(e){e&&(x(),M(),L(),toastr.success("Dates Assigned.")),C()})})})},I=function(e){toastr.error(e)},w=function(){let e=function(){let e,t=r&&!is_null(parseInt(r.value))?parseInt(r.value):null,n=d&&!isNaN(parseInt(d.value))?parseInt(d.value):null,a=s?$(s).val().map(Number):[],i=[],o=Array.from(YearCalendar.selectedDates.values());if(n&&t&&(e=InventoryProfile.all.get(t))&&$.each(a,function(e,a){let l={product_id:n,profile_id:t,unit_id:a,quantity_released:0,quantity_used:0,days:[]};$.each(o,function(e,t){YearCalendar.season_events.get(t)&&l.days.push(t)}),l.days.length>0&&i.push(l)}),i.length>0)return i}();e?confirmDialog("Would you like to assign? This change may affect your Pricing Worksheets.",n=>{n&&$(t).fadeIn("slow",function(){E(e,function(e){e&&(x(),M(),L(),toastr.success("Dates Assigned.","Inventory Profile")),C()})})}):(toastr.warning("No Profiles to update.","Inventory Profile"),C())},E=function(e,t){if(e)try{sendPostRequest("/api/v1.0/products/assign_profiles",{params:e},function(e,n,a){if(e)return t(e);I("Oops: 1"),C()})}catch(e){I("Oops: 2"),C()}},B=function(e,t){if(e)try{sendPostRequest("/api/v1.0/products/assign_seasons",e,function(e,n,a){return e?t(e):I("Oops: 1")})}catch(e){return I("Oops: 1")}},k=function(){x(),M(),f(),v(),y()},N=function(e){e||(e=[]),M(),$.each(e,function(e,t){let n=t.toString();$(`td[season='true'][dow='${n}']`).each(function(e,t){let n=$(t).attr("data-date");$("td[data-date='"+n+"']").addClass("disabled-dow"),$(t).addClass("disabled-dow")})})},M=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("disabled-dow")})},x=function(){$("td[season='true']").each(function(e,t){$(this).removeClass("selected-day"),$(this).attr("selected","false")}),YearCalendar.selectedDates=new Map},C=function(){h(),$(t).hide()},S=function(){a.innerText=YearCalendar.start},P=function(){YearCalendar.events=[],document.querySelectorAll("td[season='true']").forEach(e=>{$(e).css({background:"initial","background-color":"initial",color:"initial","border-color":"#ddd"})}),$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("removeEvents")}),YearCalendar.endLoading()},D=function(){$(t).fadeIn("slow",function(){let e=isNaN(parseInt(d.value))?null:parseInt(d.value);x(),M(),P(),function(e,t){if(e)try{sendGetRequest("/api/v1.0/calendars",e,function(e,n,a){return t(e||[])})}catch(e){}}({product_id:e},function(e){YearCalendar.events=e,$.each(YearCalendar.activeCalendars,function(e,t){$(t).fullCalendar("removeEvents"),$(t).fullCalendar("addEventSource",YearCalendar.events),$(t).fullCalendar("rerenderEvents")}),YearCalendar.endLoading()})})},L=function(){k(),D()};return{calendarContextMenu:null,calendars:new Map,events:[],start:(new Date).getFullYear(),selectedDates:new Map,activeCalendars:[],season_events:[],refresh:function(){L()},remove:function(){x(),M(),P()},checkProgress:function(){},endLoading:function(){C()},loadSeasonDropdown:function(){f()},loadProfileDropdown:function(){y()},loadUnitDropdown:function(){v()},getTitle:function(){S()},clearSelected:function(){x()},init:function(e){s.disabled=!0,_.disabled=!0,u.disabled=!0,v(),y(),f()},resetForm:function(){k()}}}(),ImageManager=function(){"use strict";const e=document.getElementById("button_product_images_toggle"),t=document.getElementById("imageManagerCancel"),n=document.getElementById("imageManagerFormRemoveButton"),a=document.getElementById("fileDimensions"),i=document.getElementById("fileWidth"),o=document.getElementById("fileHeight"),l=document.getElementById("fileRatio"),d=document.getElementById("imageManagerForm"),r=document.getElementById("imageManagerFormImagesBlock"),s=document.getElementById("imageManagerFormSubmitButton"),c=document.getElementById("imageManagerFormCancelButton"),u=document.getElementById("imageManagerFormClearButton"),m=document.getElementById("imageManagerFormDetails"),_=document.getElementById("fileName"),p=document.getElementById("fileType"),g=document.getElementById("fileExtension"),f=document.getElementById("fileSize"),y=document.getElementById("image_id"),v=document.getElementById("image_name"),h=document.getElementById("image_title"),b=document.getElementById("image_alt"),I=document.getElementById("image_caption"),w=document.getElementById("fileToUpload"),E=document.getElementById("image_enabled"),B=document.getElementById("image_is_cover"),k=document.getElementById("image_is_shown"),N=document.getElementById("imageManagerPreview");let M,x,C=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,S=new Map,P={rules:{image_name:{required:!0},image_title:{required:!0},image_alt:{required:!0},image_caption:{required:!0}},messages:{image_name:{required:"Field Required"},image_title:{required:"Field Required"},image_alt:{required:"Field Required"},image_caption:{required:"Field Required"}}},D=null,L=null,F=null;S.set("png","image/png"),S.set("jpg","image/jpeg"),S.set("gif","image/gif"),S.set("webp","image/webp"),$(w).on("change",function(e){""!==$(this).val()?K(e):V(e)}),$(s).on("click",function(e){A(e)}),$(u).on("click",function(){H()}),$(c).on("click",function(){H(),J()}),$(t).on("click",function(){H(),J()}),$(n).on("click",function(){let e=isNaN(parseInt(y.value))?null:parseInt(y.value);null!==e&&confirmDialog("Would you like to delete this image?",t=>{t&&R(e)})}),$(k).on("change",function(){console.log("ImageManager.image_is_shown:change()",k.checked);let e=isNaN(parseInt(y.value))?null:parseInt(y.value),t=document.getElementById("image_"+e);D=e,k.checked?(F=!1,$(t).addClass("is-shown")):(B.checked&&(L=e,B.checked=!1,$(t).removeClass("is-cover-image")),$(t).removeClass("is-shown"),F=!0)}),$(B).on("change",function(){console.log("ImageManager.is_cover:change()",B.checked);let e=isNaN(parseInt(y.value))?null:parseInt(y.value),t=document.getElementById("image_"+e);L=isNaN(parseInt($(".img-thumbnail.is-cover-image").data("id")))?null:parseInt($(".img-thumbnail.is-cover-image").data("id")),F=k?k.checked:null,B.checked&&(k.checked||(k.checked=!0),$(".img-thumbnail.is-cover-image").removeClass("is-cover-image"),$(t).addClass("is-cover-image is-shown"))}),$("#button_product_images_toggle").on("click",function(){$(w).trigger("click")});const T=function(e,t,n){t||(t="Image"),n||(n="success"),toastr[n](`${e}`,t)},R=function(e){if(console.log("ImageManager.remove(image_id)",e),!e||!ImageManager.source||!ImageManager.sourceId)return;let t={image_id:e,source:ImageManager.source,source_id:ImageManager.sourceId};console.log("|__ dataToSend",t),q({image_id:e,source:ImageManager.source,source_id:ImageManager.sourceId},function(e){e&&console.log("data",e)})},q=function(e,t){if(e){let n="/api/v1.0/images/remove";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){return console.log("error",e),T("Error Removing Image.","Image Manager","error")}}},A=function(e){console.log("ImageManager.submit(event)",e),O()&&confirmDialog("Would you like to update?",t=>{t&&Q(e)})},O=function(){return $(d).valid()},Q=function(e){console.log("ImageManager.uploadFile(event)",e);const t=document.getElementById("fileToUpload");let n,a,i,o,l,d,r,s,c,u,m,_,p,g,f,v,$,w,N=null,M=new FormData,x=new XMLHttpRequest;if(w=y&&!isNaN(parseInt(y.value))?parseInt(y.value):null,g=I&&""!==I.value?I.value:null,_=h&&""!==h.value?h.value:null,p=b&&""!==b.value?b.value:null,f=k&&!0===k.checked?1:0,$=E&&!0===E.checked?1:0,v=B&&!0===B.checked?1:0,null!==w){d=document.getElementById("fileName").innerText,l=document.getElementById("fileExtension")?document.getElementById("fileExtension").innerText:null,o=document.getElementById("fileSize")?document.getElementById("fileSize").innerText:null,c=document.getElementById("fileDimensions")?document.getElementById("fileDimensions").innerText:null,i=document.getElementById("fileWidth")?isNaN(parseInt(document.getElementById("fileWidth").innerText))?null:parseInt(document.getElementById("fileWidth").innerText):null,a=document.getElementById("fileHeight")?isNaN(parseInt(document.getElementById("fileHeight").innerText))?null:parseInt(document.getElementById("fileHeight").innerText):null;let e=removeNulls({id:w,name:d,alt:p,title:_,caption:g,is_cover:v,path:`/public/img/${ImageManager.source}/${ImageManager.sourceId}`,thumbs_path:`/public/thumbs/${ImageManager.source}/${ImageManager.sourceId}`,extension:l,dimensions:c,size:o,height:a,width:i,enabled:$,directory:ImageManager.source,directory_id:ImageManager.sourceId,is_shown:f});console.log("dataToSend",e),function(e,t){if(e){let n="/api/v1.0/images/update";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){return console.log("error",e),T("Error","Image Manager","error")}}}(e,function(e){if(e){let t=z(e[0]?e[0]:e);console.log("|__ detail",t);let n=ImageManager.all.get(t.id);console.log("|__ image",n),ImageManager.all.set(t.id,t),toastr.success(`Image Manager: ${t.name} - has been updated`,"Image Manager")}})}else G(e,function(e){switch(console.log("|__ data",e),u=e.source,m=e.source_id,n=e.path?e.path:null,a=isNaN(parseInt(e.height))?null:parseInt(e.height),i=isNaN(parseInt(e.width))?null:parseInt(e.width),d=e.name?e.name:null,l=e.extension?e.extension:null,o=e.size?e.size:null,s=e.ratio?e.ratio:null,r=e.type?e.type:null,N=e.thumbs_path,c=e.dimensions?e.dimensions:null,M.append("dimensions",c),M.append("extension",l),M.append("file",t.files[0],`${d}.${l}`),M.append("height",a),M.append("name",d),M.append("path",n),M.append("thumbs_path",N),M.append("ratio",s),M.append("size",o),M.append("type",r),M.append("width",i),M.append("directory",u),M.append("directory_id",m),M.append("title",_),M.append("enabled",$),M.append("is_shown",f),M.append("is_cover",v),M.append("alt",p),M.append("caption",g),x.upload.addEventListener("progress",Y,!1),x.addEventListener("load",U,!1),x.addEventListener("error",W,!1),x.addEventListener("abort",j,!1),u.toLowerCase()){case"product":x.open("POST","/api/v1.0/upload/product"),x.send(M);break;case"unit":console.log("|__ |__ unit");break;case"company":console.log("|__ |__ company");break;case"user":console.log("|__ |__ user");break;default:return}})},Y=function(e){if(console.log("ImageManager.uploadProgress(event)",e),e.lengthComputable){let t=Math.round(100*e.loaded/e.total);document.getElementById("progressNumber").innerHTML=t.toString()+"%"}else document.getElementById("progressNumber").innerHTML="unable to compute"},U=function(e){console.log("ImageManager.uploadComplete(event)",e);let t=null;if(e&&e.target&&e.target.responseText){const n=JSON.parse(e.target.responseText);if(n&&n.status&&"success"===n.status&&n.result){t=n.result,1===n.result.length&&(t=n.result[0]);let e=z(t);Array.from(ImageManager.all.values()).length;console.log("|__ image",e),$(r).append(te(e)),ImageManager.all.set(e.id,e),console.log("|__ ImageManager.all",ImageManager.all),console.log("|__ detail",e),H(),J(),toastr.success("Image was added.","Image Manager")}}},W=function(e){console.log("ImageManager.uploadFailed(event)",e),console.log("There was an error attempting to upload this file.")},j=function(e){console.log("ImageManager.uploadCanceled(event)",e),console.log("This upload has been canceled by the user or the browser dropped the connection.")},z=function(e){console.log("ImageManager.set(image)",e);let t={alt:null,caption:null,created_by:C,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),dimensions:null,enabled:1,extension:null,height:null,id:null,is_cover:0,is_shown:1,modified_by:C,name:null,note:null,path:null,size:null,thumbs_path:null,title:null,width:null};return e&&(t.alt=e.alt?e.alt:null,t.caption=e.caption?e.caption:null,t.created_by=e.created_by?e.created_by:C,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.dimensions=e.dimensions?e.dimensions:null,t.enabled=isNaN(parseInt(e.enabled))?1:parseInt(e.enabled),t.extension=e.extension?e.extension:null,t.height=e.height?e.height:null,t.id=isNaN(parseInt(e.id))?null:parseInt(e.id),t.is_cover=e.is_cover?e.is_cover:0,t.is_shown=e.is_shown&&1===e.is_shown?1:0,t.modified_by=e.modified_by?e.modified_by:C,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.path=e.path?e.path:null,t.size=e.size?e.size:null,t.thumbs_path=e.thumbs_path?e.thumbs_path:null,t.title=e.title?e.title:null,t.width=e.width?e.width:null),ImageManager.detail=t,t},V=function(e){console.log("ImageManager.resetFileInput(event)",e);document.getElementById("fileToUpload");let t=document.getElementById("fileName"),n=document.getElementById("fileSize"),a=document.getElementById("fileType"),i=document.getElementById("fileExtension"),o=document.getElementById("imageManagerPreview"),l=document.getElementById("fileToUploadDisplay");$(t).html("&nbsp;"),$(n).html("&nbsp;"),$(a).html("&nbsp;"),$(i).html("&nbsp;"),$(l).html("CHOOSE FILE"),$(o).attr("src","/public/img/placeholder.jpg"),k.checked=!0},H=function(){V(),X(),$("img.img-thumbnail").removeClass("selected")},G=function(e,t){console.log("ImageManager.buildImageObject(event)",e);const n=document.getElementById("fileToUpload"),a=document.getElementById("imageManagerPreview"),i=document.getElementById("imageManagerForm"),o=new FileReader,l=new Image;let d,r,s,c,u,m,_,p,g,f,y,v,h,b,I,w=null;if(e&&i&&i.dataset.source&&(v=i.dataset.source?i.dataset.source:null,h=i.dataset.sourceId&&!isNaN(parseInt(i.dataset.sourceId))?parseInt(i.dataset.sourceId):null,d=`/public/img/${v}/${h}`,b=`/public/thumbs/${v}/${h}`,n)){let i=n.files[0];if(console.log("|__ file",i),$(a).attr("src",e.result),i){let e=function(e){let t,n=null,a=[];if(e&&e.name){let i=e.name.split(".");if(i.length){n=i[i.length-1];for(let e=0;e<i.length-1;e++)a.push(i[e]);t=a.join(".")}}return removeNulls({name:t,extension:n})}(i);console.log("|__ |__ fileNameParts",e),u=e.extension?e.extension:null,m=e.name?e.name:null,c=function(e){let t=null;return t=e.size>1048576?(Math.round(100*e.size/1048576)/100).toString()+"MB":(Math.round(100*e.size/1024)/100).toString()+"KB"}(i),_=function(e){let t=null;return e&&e.type&&(t=e.type),t}(i),I=d+"/"+m+"."+u,w=b+"/"+m+"."+u,o.onload=function(e){l.onload=function(){if(r=this.height?this.height:null,s=this.width?this.width:null,is_null(s)||is_null(r))console.error("Missing Height or Width");else{let e=gcd(s,r);y=`${s} x ${r}`,p=`${f=s/e}:${g=r/e}`}return t({file:i,source:v,source_id:isNaN(parseInt(h))?null:parseInt(h),name:is_null(m)?null:m,height:isNaN(parseInt(r))?null:parseInt(r),width:isNaN(parseInt(s))?null:parseInt(s),path:is_null(d)?null:d,full_path:is_null(I)?null:I,full_thumbs_path:is_null(w)?null:w,thumbs_path:is_null(b)?null:b,size:is_null(c)?null:c,extension:is_null(u)?null:u,type:is_null(_)?null:_,ratio:is_null(p)?null:p,dimensions:is_null(y)?null:y})},l.src=e.target.result},o.readAsDataURL(n.files[0])}}},K=function(e){console.log("ImageManager.fileSelected(event)",e),H();let t=document.getElementById("fileToUpload"),n=document.getElementById("fileName"),d=document.getElementById("fileSize"),r=document.getElementById("fileType"),s=document.getElementById("fileExtension"),c=document.getElementById("imageManagerPreview"),u=document.getElementById("fileToUploadDisplay");G(e,function(e){if(e){console.log("|__ data",e);let m=e.name?e.name:null,_=e.size?e.size:null,p=e.type?e.type:null,g=e.extension?e.extension:null,f=e.ratio?e.ratio:null,h=e.dimensions?e.dimensions:null,b=e.width?e.width:null,I=e.height?e.height:null,w=new FileReader;$(n).html(m),$(d).html(_),$(r).html(p),$(s).html(g),$(u).html(m),$(l).html(f),$(i).html(b),$(o).html(I),$(a).html(h),$(c).attr("src"),$(y).val(""),$(v).val(m),w.onload=function(e){$(c).attr("src",e.target.result)},w.readAsDataURL(t.files[0]),Z()}})},J=function(){console.log("ImageManager.hideImageForm()"),$(w).removeClass("disabled"),$(e).removeClass("disabled"),w.disabled=!1,e.disabled=!1,s.innerText="choose file",$(m).hide()},Z=function(){console.log("ImageManager.renderImageForm()"),$(w).addClass("disabled"),$(e).addClass("disabled"),w.disabled=!0,e.disabled=!0,$("#imageManagerFormDetails").show()},X=function(){console.log("ImageManager.resetImageForm()");if(_.innerHTML="&nbsp;",p.innerHTML="&nbsp;",g.innerHTML="&nbsp;",f.innerHTML="&nbsp;",l.innerHTML="&nbsp;",i.innerHTML="&nbsp;",o.innerHTML="&nbsp;",a.innerHTML="&nbsp;",y.value="",v.value="",h.value="",b.value="",I.value="",E.checked=!0,B.checked=!1,k.checked=!0,$(N).attr("src","/public/img/placeholder.jpg"),null!==D){let e=null!==L&&!0===L?"is-cover-image":"",t=null!==L&&!0===L?"is-shown":"";$(".img-thumbnail.is-cover-image").removeClass("is-cover-image"),$("#image_"+D).addClass(`${e} ${t}`),D=null,L=null,F=null}$("img.img-thumbnail").removeClass("selected")},ee=function(e){if(console.log("ImageManager.edit(image)",e),e){H();let t=isNaN(parseInt(e.id))?null:e.id,n=t?"image_"+t.toString():null,d=document.getElementById(n);d&&($(d).addClass("selected"),function(e){if(console.log("ImageManager.populateImageForm(image)",e),e){console.log(e);let t=e.extension?S.get(e.extension):null,n=e.alt?e.alt:null,d=e.caption?e.caption:null,r=(isNaN(parseInt(e.created_by))||parseInt(e.created_by),e.date_created?e.date_created:formatDateMySQL(),e.date_modified?e.date_modified:formatDateMySQL(),e.dimensions?e.dimensions:null),s=e.enabled&&1===e.enabled,c=e.extension?e.extension:null,u=isNaN(parseInt(e.height))?null:parseInt(e.height),m=isNaN(parseInt(e.id))?null:parseInt(e.id),w=!(!e.is_cover||1!==e.is_cover),M=!(!e.is_shown||1!==e.is_shown),x=(isNaN(parseInt(e.modified_by))||parseInt(e.modified_by),e.name?e.name:null),C=(e.note&&e.note,e.path?e.path:null),P=e.size?e.size:null,D=e.title?e.title:null,L=isNaN(parseInt(e.width))?null:parseInt(e.width),F=gcd(L,u),T=`${L/F}:${u/F}`,R=`${C}/${x}.${c}`;_.innerHTML=x,p.innerHTML=t,g.innerHTML=c,f.innerHTML=P,l.innerHTML=T,a.innerHTML=r,i.innerHTML=L,o.innerHTML=u,y.value=m,v.value=x,h.value=D,b.value=n,I.value=d,E.checked=s,B.checked=w,k.checked=M,$(N).attr("src",R),Z()}}(e),s.innerText="Save")}},te=function(e){console.log("ImageManager.buildImageThumbnail(image)",e);let t="",n="";if(e){e.path&&e.path;let a=e.alt?e.alt:null,i=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,o=!(!e.is_cover||1!==e.is_cover),l=!(!e.is_shown||1!==e.is_shown),d=e.thumbs_path?e.thumbs_path:null,r=e.path?e.path:null,s=e.name?e.name:null,c=e.extension?e.extension:null;if(o&&(t="is-cover-image"),l&&(n="is-shown"),null!==d&&null!==r&&null!==s&&null!==c){let e=$("<img/>",{id:"image_"+i,attr:{"data-id":i},class:`img-thumbnail ${t} ${n}`,alt:a,src:`${d}/${s}.${c}`}).on("click",function(){let e=this.dataset.id&&!isNaN(parseInt(this.dataset.id))?parseInt(this.dataset.id):null;if(e){let t=ImageManager.all.get(e);t?ee(t):console.log("|__ |__ ImageManager.all",ImageManager.all)}else console.log("nope")});return $("<div/>",{class:"col-12 col-md-4 mb-2"}).append(e)}}},ne=function(e){console.log("ImageManager.init(settings)",e),e&&e.source&&(M=e.source?e.source:null,x=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,$(r).empty(),J(),initializeValidator(P),ImageManager.source=M,ImageManager.sourceId=x,ImageManager.validator=$(d).validate(),function(e,t){if(console.log("ImageManager.get()"),e){let n=`/api/v1.0/images/${ImageManager.source}/${ImageManager.sourceId}`;try{sendGetRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){return console.log("error",e),T("Error Retrieving Images.","Image Manager","error")}}}({},function(e){!function(e){console.log("ImageManager.loadAll(images)",e),ImageManager.all=new Map,e&&$.each(e,function(e,t){let n=z(t);ImageManager.all.set(n.id,n),$(r).append(te(n))})}(e)}))};return{source:null,sourceId:null,detail:{},all:new Map,init:function(e){return ne(e)}}}(),LocationTypes=function(){"use strict";document.getElementById("input_location_types_id"),document.getElementById("input_location_types_name"),document.getElementById("input_location_types_icon"),document.getElementById("input_location_types_sort_order"),document.getElementById("input_location_types_enabled"),document.getElementById("input_location_types_date_created"),document.getElementById("input_location_types_created_by"),document.getElementById("input_location_types_date_modified"),document.getElementById("input_location_types_modified_by"),document.getElementById("input_location_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,icon:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.icon=t.icon?t.icon:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),LocationTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,LocationTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);LocationTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),AddressTypes=function(){"use strict";document.getElementById("input_address_types_id"),document.getElementById("input_address_types_name"),document.getElementById("input_address_types_sort_order"),document.getElementById("input_address_types_enabled"),document.getElementById("input_address_types_date_created"),document.getElementById("input_address_types_created_by"),document.getElementById("input_address_types_date_modified"),document.getElementById("input_address_types_modified_by"),document.getElementById("input_address_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),AddressTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,AddressTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);AddressTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),City=function(){"use strict";const e=document.getElementById("product_location_departing_airport_city_search"),t=document.getElementById("product_location_departing_airport_city_id"),n=document.getElementById("product_location_arriving_airport_city_id"),a=document.getElementById("product_edit_location_city_id"),i=document.getElementById("product_location_arriving_airport_city_search"),o=document.getElementById("modal_product_city_id"),l=(document.getElementById("modal_product_provider_name"),document.getElementById("modal_product_vendor_name"),document.getElementById("modal_product_province_id")),d=document.getElementById("modal_product_country_id"),r=document.getElementById("modal_product_arrive_to_airport_city"),s=document.getElementById("modal_product_arrive_to_airport_country_id"),c=document.getElementById("modal_product_arrive_to_airport_province_id"),u=document.getElementById("modal_product_arrive_to_airport_city_id"),m=document.getElementById("modal_product_depart_from_airport_city"),_=document.getElementById("modal_product_depart_from_airport_country_id"),p=document.getElementById("modal_product_depart_from_airport_province_id"),g=document.getElementById("modal_product_depart_from_airport_city_id"),f=(document.getElementById("modal_product_arrive_to_station_city"),document.getElementById("modal_product_arrive_to_station_country_id")),y=document.getElementById("modal_product_arrive_to_station_province_id"),v=document.getElementById("modal_product_arrive_to_station_city_id"),h=(document.getElementById("modal_product_depart_from_station_city"),document.getElementById("modal_product_depart_from_station_country_id")),b=document.getElementById("modal_product_depart_from_station_province_id"),I=document.getElementById("modal_product_depart_from_station_city_id");let w=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$("#product_location_transport_city_search").on("change",function(){setTimeout(function(){},200)}).on("search",function(){a.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;a.value=t.id}}),$("#product_location_cars_city_search").on("change",function(){setTimeout(function(){},200)}).on("search",function(){a.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;a.value=t.id}}),$("#product_location_arriving_airport_city_search").on("change",function(){setTimeout(function(){""===$("#product_location_arriving_airport_city_search").val()&&(n.value="")},200)}).on("search",function(){n.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;i.value=e.value,n.value=t.id}}),$("#product_location_departing_airport_city_search").on("change",function(){setTimeout(function(){""===$("#product_location_departing_airport_city_search").val()&&(a.value="",t.value="")},200)}).on("search",function(){a.value="",t.value=""}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(n){if(!n.data)return;let i=n.data;e.value=n.value,t.value=i.id,a.value=i.id}}),$("#form_product_search_hotel_product_location").on("change",function(){setTimeout(function(){},200)}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){e.data}}),$(o).on("change",function(){o.value}),$("#modal_product_depart_from_airport_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(m).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;o.value=t.id,$(o).val(t.id?t.id:"").trigger("change"),_.value=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),p.value=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),g.value=isNaN(parseInt(t.id))?null:parseInt(t.id)}}),$("#modal_product_arrive_to_airport_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(r).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;s.value=t.country.id?t.country.id:null,c.value=t.province.id?t.province.id:null,u.value=t.id?t.id:null}}),$("#modal_product_depart_from_station_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(o).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;o.value=t.id,$(o).val(t.id?t.id:"").trigger("change"),h.value=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),b.value=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),I.value=isNaN(parseInt(t.id))?null:parseInt(t.id)}}),$("#modal_product_arrive_to_station_city").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(o).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;f.value=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),y.value=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),v.value=isNaN(parseInt(t.id))?null:parseInt(t.id)}}),$("#modal_product_city").on("change",function(){setTimeout(function(){""===$("#modal_product_city").val()&&$(o).val("").trigger("change")},200)}).on("search",function(){o&&$(o).val("").trigger("change"),l&&(l.value=""),d&&(d.value="")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data,n=isNaN(parseInt(t.id))?null:parseInt(t.id),a=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),i=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id);o&&n&&(o.value=n),l&&a&&(l.value=a),d&&i&&(d.value=i)}}),$("#modal_product_city_cars").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(o).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;o.value=t.id,$(o).val(t.id?t.id:"").trigger("change")}}),$("#modal_product_city_transports").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(o).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;o.value=t.id,$(o).val(t.id?t.id:"").trigger("change")}}),$("#modal_product_city_tours").on("change",function(){setTimeout(function(){},200)}).on("search",function(){$(o).val("").trigger("change")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/cities",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;o.value=t.id,$(o).val(t.id?t.id:"").trigger("change")}});const E=function(e){toastr.error(e)},B=e=>{$(e.target).parents("div.form-new-city")[0]||e.target.className.includes("select-add-option")||City.close()},k=function(e){let t={id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:1,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),note:null},n=null;return e&&(n=validInt(e.id),t={id:validInt(e.id),province_id:validInt(e.province_id),created_by:e.created_by?e.created_by:w,modified_by:e.created_by?e.created_by:w,sort_order:e.sort_order?e.sort_order:null,name:e.name?e.name:null,enabled:e.enabled?e.enabled:1,date_created:e.date_created?e.date_created:formatDateMySQL(),date_modified:e.date_modified?e.date_modified:formatDateMySQL(),note:e.note?e.note:null}),City.detail=t,t},N=function(e,t,n){City.all=new Map;let a=null;if(null!==City.id&&(a=City.id),n)return e&&t&&n?void function(e,t){if(!e)return E("Error Loading Province- Missing Data");try{sendGetRequest("/api/v1.0/cities",e,function(e,n,a){return e?t(e):E("Oops: 1")})}catch(e){return E("Error Validating City")}}({country_id:parseInt(e),province_id:parseInt(t)},function(e){e&&(C(e),$(n).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),""!==a&&null!==a&&$(n).val(a).trigger("change"))}):($(n).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),void $(n).val("").trigger("change"))},M=function(e,t,n){e&&function(e,t,n){let a=$(e).attr("id"),i=$(e).parents("div.row"),o="";if(t&&(o=t),!a||!i[0])return;if(document.getElementById("form_new_city"))return;let l=document.createElement("div"),d=document.createElement("h5"),r=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),m=document.createElement("div"),_=document.createElement("div"),p=document.createElement("div"),g=document.createElement("div"),f=document.createElement("div"),y=document.createElement("div"),v=document.createElement("div"),h=document.createElement("div"),b=document.createElement("input"),I=document.createElement("label"),w=document.createElement("button"),E=document.createElement("button");d.classList="card-title",d.innerText="City Details",l.id="form_new_city",l.classList=["card card-body m-3 form-new-city"],b.id="city_name",b.name="city_name",b.type="text",b.classList=["form-control "],I.htmlFor="city_name",I.innerHTML="Name:",h.id="city_name-error",w.classList=["btn btn-primary btn-sm waves-effect waves-light"],w.innerText="save",w.type="button",w.addEventListener("click",t=>{City.save(e,n)}),E.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],E.innerText="cancel",E.type="button",E.addEventListener("click",e=>{City.close()}),r.classList=["row"],s.classList=["row"],c.classList=["col-lg-3 mb-1"],u.classList=["col-lg-3 mb-1"],m.classList=["col-lg-3 mb-1"],_.classList=["col-lg-3 mb-1"],p.classList=["col-12 mb-1 text-right"],g.classList=["form-element"],f.classList=["form-element"],y.classList=["form-element"],v.classList=["form-element"],h.classList=["error w-100 text-center"],g.appendChild(I),g.appendChild(b),g.appendChild(h),c.appendChild(g),r.appendChild(c),r.appendChild(u),r.appendChild(m),r.appendChild(_),p.append(E),p.appendChild(w),s.appendChild(p),l.appendChild(d),l.appendChild(r),l.appendChild(s),i[0].appendChild(l),b.value=o,b.focus({preventScroll:!1}),window.addEventListener("click",B)}(e,t,n)},x=function(e,t){let n={},a=document.getElementById("city_name"),i=document.getElementById(t.replace(/city_id/g,"")+"province_id"),o=document.getElementById(t.replace(/city_id/g,"")+"country_id");if(!isNaN(parseInt(o.value))&&!isNaN(parseInt(i.value))&&o){n.name=a.value,n.country_id=parseInt(o.value),n.province_id=parseInt(i.value),!0===confirm("Are you sure you want to edit this record?")&&function(e,t){if(t)try{sendPostRequest("/api/v1.0/cities/update",t,function(t,n,a){if(!t||!t[0])return E("Error: 1");{let n=t[0];City.all.set(n.id,n);let a=$("select[data-type='city']");City.id=n.id,a.each(function(e,t){var a=new Option(n.name,n.id,!1,!1);$(t).append(a).trigger("change")}),$(e).val(n.id).trigger("change"),City.close(),toastr.success("City: "+n.id+" updated")}})}catch(e){E("Error: Validating City")}else E("Error: Missing Data")}(e,remove_nulls(n))}},C=function(e){City.all=new Map,e&&$.each(e,function(e,t){let n=k(t);City.all.set(n.id,n)})},S=function(e){!function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=document.getElementById(t);n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_city_add_icon")){let a=document.createElement("i");a.classList="select-add-option fas fa-plus filter_city_add",a.id="filter_city_add_icon",a.addEventListener("click",a=>{let i=e.value;$(n).select2("close"),City.add(this,i,t)}),e.after(a)}$(".filter_city_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_city_add").show():$(".filter_city_add").hide()})}}).on("change",function(){$(this).attr("id").replace("city","city")})})}(e)};return{id:null,detail:{id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:null,date_created:null,date_modified:null,note:null},all:[],close:function(){!function(){let e=document.getElementById("form_new_city");e&&(e.parentNode.removeChild(e),window.removeEventListener("click",B))}()},save:function(e,t){x(e,t)},get:function(e,t,n){N(e,t,n)},add:function(e,t,n){M(e,t,n)},set_detail:function(e){k(e)},init:function(e){S(e)}}}(),Station=function(){"use strict";const t=document.getElementById("modal_product_depart_from_station_cancel_button"),n=document.getElementById("modal_product_depart_from_station_submit_button"),a=document.getElementById("modal_product_depart_from_station_iata_code"),i=document.getElementById("modal_product_depart_from_station_country_id"),o=document.getElementById("modal_product_depart_from_station_province_id"),l=document.getElementById("modal_product_depart_from_station_city_id"),d=document.getElementById("modal_product_depart_from_station_city"),r=document.getElementById("modal_product_depart_from_station"),s=document.getElementById("modal_product_depart_from_station_id"),c=document.getElementById("modal_product_depart_from_station_add_block"),u=document.getElementById("modal_product_arrive_to_station_postal_code"),m=document.getElementById("modal_product_arrive_to_station_street_1"),_=document.getElementById("modal_product_arrive_to_station_street_2"),p=document.getElementById("modal_product_depart_from_station_postal_code"),g=document.getElementById("modal_product_depart_from_station_street_1"),f=document.getElementById("modal_product_depart_from_station_street_2"),y=document.getElementById("modal_product_country_id"),v=document.getElementById("modal_product_province_id"),h=document.getElementById("modal_product_city_id"),b=document.getElementById("modal_product_depart_from_station_edit_link"),I=document.getElementById("modal_product_arrive_to_station_edit_link"),w=document.getElementById("modal_product_depart_from_new_station_id"),E=document.getElementById("modal_product_arrive_to_station_cancel_button"),B=document.getElementById("modal_product_arrive_to_new_station_id"),k=document.getElementById("modal_product_arrive_to_station_submit_button"),N=document.getElementById("modal_product_arrive_to_station_iata_code"),M=document.getElementById("modal_product_arrive_to_station_country_id"),x=document.getElementById("modal_product_arrive_to_station_province_id"),C=document.getElementById("modal_product_arrive_to_station_city_id"),S=document.getElementById("modal_product_arrive_to_station_city"),P=document.getElementById("modal_product_arrive_to_station"),D=document.getElementById("modal_product_arrive_to_station_id"),L=document.getElementById("modal_product_arrive_to_station_add_block");let F=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,T=!1,R=!1;$(b).on("click",function(){console.log("Station.modal_product_depart_from_station_edit_link:click()");let e=b.dataset.stationId&&!isNaN(parseInt(b.dataset.stationId))?parseInt(b.dataset.stationId):null,t=Station.all.get(e);t&&(W("depart_from"),U(t,"depart_from"),V("depart_from"))}),$(I).on("click",function(){console.log("Station.modal_product_arrive_to_station_edit_link:click()")}),$(c).on("change",function(){O()}).on("keyup",function(){O()}),$(t).on("click",function(){Y("depart_from")}),$(E).on("click",function(){Y("arrive_to")}),$(n).on("click",function(){q("depart_from")}),$(k).on("click",function(){q("arrive_to")});const q=function(e){if(e){let t=Q(e);t&&confirmDialog("Would you like to update?",n=>{n&&A(t,function(t){let n;if(t&&(n=t,t[0]&&(n=t[0])),n){console.log("|__ station",n);let t=n.country&&!isNaN(parseInt(n.country.id))?parseInt(n.country.id):null,a=n.province&&!isNaN(parseInt(n.province.id))?parseInt(n.province.id):null,i=n.city&&!isNaN(parseInt(n.city.id))?parseInt(n.city.id):null,o=isNaN(parseInt(n.id))?null:parseInt(n.id),l=n.name?n.name:null;"depart_from"===e?(r&&(r.value=l),w&&(w.value=o),s&&(s.value=o),y&&(y.value=t),v&&(v.value=a),h&&(h.value=i),b.dataset.stationId=o,$(b).show()):"arrive_to"===e&&(P&&(P.value=l),B&&(B.value=o),D&&(D.value=o),y&&(y.value=t),v&&(v.value=a),h&&(h.value=i),I.dataset.stationId=o,$(I).show()),j(e),H()}})})}},A=function(e,t){if(e){let n="/api/v1.0/stations/update";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e);J("Oops: 1")})}catch(e){}}},O=function(){let e=!0;return""===a.value?($(a).showError("Field Required"),e=!1):$(a).hideError(),isNaN(parseInt(l.value))?($(d).showError("Field Required"),e=!1):$(d).hideError(),e},Q=function(e){if(c&&L&&e)if("depart_from"===e){if(O()){let e={postal_code:""!==p.value?p.value:null,street_1:""!==g.value?g.value:null,street_2:""!==f.value?f.value:null,city_id:isNaN(parseInt(l.value))?null:parseInt(l.value),name:""!==r.value?r.value:null,iata_code:""!==a.value?a.value:null};return removeNulls(e)}}else if("arrive_to"===e&&function(){let e=!0;return""===N.value?($(N).showError("Field Required"),e=!1):$(N).hideError(),isNaN(parseInt(C.value))?($(S).showError("Field Required"),e=!1):$(S).hideError(),e}()){let e={postal_code:""!==u.value?u.value:null,street_1:""!==m.value?m.value:null,street_2:""!==_.value?_.value:null,city_id:isNaN(parseInt(C.value))?null:parseInt(C.value),name:""!==P.value?P.value:null,iata_code:""!==N.value?N.value:null};return removeNulls(e)}},Y=function(e){c&&L&&(W(e),z(e),e&&("depart_from"===e?r.value="":"arrive_to"===e&&(P.value="")))},U=function(e,t){if(c&&L&&(W(t),e)){console.log("|__ station",e);let n=e.country&&e.country.id&&!isNaN(parseInt(e.country.id))?parseInt(e.country.id):null,r=e.province&&e.province.id&&!isNaN(parseInt(e.province.id))?parseInt(e.province.id):null,c=e.city&&e.city.id&&!isNaN(parseInt(e.city.id))?parseInt(e.city.id):null,u=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,m=(e.name&&e.name,e.iata_code?e.iata_code:null),_=e.street_1?e.street_1:null,b=e.street_2?e.street_2:null,I=e.postal_code?e.postal_code:null;t&&"depart_from"===t&&(w.value=u,a.value=m,d.value="",l.value=c,i.value=n,o.value=r,p.value=I,g.value=_,f.value=b,s.value=u,y.value=n,v.value=r,h.value=c),V(t)}},W=function(e){c&&L&&(e&&("depart_from"===e?(w.value="",a.value="",d.value="",l.value="",i.value="",o.value="",p.value="",g.value="",f.value="",s.value="",y.value="",v.value="",h.value="",r.disabled=!1,b.dataset.stationId="",$(b).hide(),clearAllValidation()):"arrive_to"===e&&(B.value="",N.value="",S.value="",C.value="",M.value="",x.value="",u.value="",m.value="",_.value="",D.value="",P.disabled=!1,I.dataset.stationId="",$(I).hide(),clearAllValidation())),y.value="",v.value="",h.value="")},j=function(e){c&&L&&e&&(P.disabled=!1,r.disabled=!1,W(e),z("depart_from"),z("arrive_to"))},z=function(e){c&&L&&e&&("depart_from"===e?$(c).hide():"arrive_to"===e&&$(L).hide())},V=function(e){c&&L&&e&&("depart_from"===e?(r.disabled=!0,$(c).show(),$(L).hide()):"arrive_to"===e&&(P.disabled=!0,$(L).show(),$(c).hide()))},H=function(){r&&$(r).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){s&&(s.value=""),i&&(i.value=""),o&&(o.value=""),l&&(l.value=""),r&&(r.value=""),b.dataset.stationId="",$(b).hide()}).on("keyup",function(){T=!1}).on("change",function(){setTimeout(function(){let e=r.value;!1===T&&(""===e?(r.value="",s.value="",o.value="",l.value="",b.dataset.stationId="",$(b).hide(),T=!1):G(e,"depart_from"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/stations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;let t=e.data;if(t[0]&&(t=t[0]),T=!0,console.log("|__ station",t),t){let e=t.country&&!isNaN(parseInt(t.country.id))?parseInt(t.country.id):null,n=t.province&&!isNaN(parseInt(t.province.id))?parseInt(t.province.id):null,a=t.city&&!isNaN(parseInt(t.city.id))?parseInt(t.city.id):null,d=isNaN(parseInt(t.id))?null:parseInt(t.id),c=t.name?t.name:null;r&&(r.value=c),s&&(s.value=d),i&&(i.value=e),o&&(o.value=n),l&&(l.value=a),b.dataset.stationId=d,$(b).show()}else b.dataset.stationId="",$(b).hide(),j("depart_from"),V("depart_from")}}),P&&$(P).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keyup",function(){R=!1}).on("search",function(){D&&(D.value=""),P&&(P.value="")}).on("change",function(){setTimeout(function(){let e=P.value;!1===R&&(""===e?(P.value="",D.value="",R=!1):G(e,"arrive_to"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/stations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;R=!0;let t=e.data;t?(P&&(P.value=t.name?t.name:""),D&&(D.value=isNaN(parseInt(t.id))?"":parseInt(t.id)),I.dataset.stationId=isNaN(parseInt(t.id))?"":parseInt(t.id),$(I).show()):(I.dataset.stationId="",$(I).hide(),j("arrive_to"),V("arrive_to"))}})},G=function(e,t){if(e&&""!==e){K({name:e},function(n){let a=null;n&&(a=n,n[0]&&(a=n[0])),a&&a.id?"depart_from"===t?(T=!0,r.value=a.name,s.value=a.id,h.value=a.city.id,b.dataset.stationId=a.id,$(b).show()):(R=!0,P.value=a.name,D.value=a.id,I.dataset.stationId=a.id,$(I).show()):confirmDialog(`The station: ${e} does not exist exists. Would you like to create it?`,n=>{n?("depart_from"===t?T=!1:R=!1,U({name:e},t)):"depart_from"===t?(h&&(h.value=""),s&&(s.value=""),r&&(r.value="")):(D&&(D.value=""),P&&(P.value=""))})})}},K=function(e,t){if(e)try{sendGetRequest("/api/v1.0/stations/validate",e,function(e,n,a){if(e)return t(e);J("Oops: 1")})}catch(e){J("Error Validating Station")}else J("Error Loading Station - Missing Data")},J=function(e){toastr.error(e)},Z=function(e){console.log("Station.setDetail(station)",e);let t=(console.log("Station.defaultDetail()"),{city:{id:null,country_id:null,province_id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},country:{id:null,name:null,sort_order:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},created_by:F,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),display_long:null,display_medium:null,display_short:null,enabled:1,iata_code:null,id:null,keywords:null,modified_by:F,name:null,note:null,postal_code:null,province:{id:null,name:null,sort_order:null,country_id:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},street_1:null,street_2:null});return e&&(t.city=e.city?e.city:{id:null,country_id:null,province_id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},t.country=e.country?e.country:{id:null,name:null,sort_order:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},t.province=e.province?e.province:{id:null,name:null,sort_order:null,country_id:null,iso2:null,iso3:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},t.created_by=e.created_by?e.created_by:F,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null,t.enabled=e.enabled?e.enabled:1,t.iata_code=e.iata_code?e.iata_code:null,t.id=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,t.keywords=e.keywords?e.keywords:[],t.modified_by=e.modified_by?e.modified_by:F,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.postal_code=e.postal_code?e.postal_code:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null),t},X=function(e){var t;console.log("Station.init(settings)",e),(r||P)&&(H(),j("depart_from"),j("arrive_to"),t=e,console.log("Station.loadAll(stations)",t),Station.all=new Map,$.each(t,function(e,t){let n=Z(t),a=n&&!isNaN(parseInt(n.id))?parseInt(n.id):null;Station.all.set(a,n)}))};return{resetStationForm:function(e){j(e)},init:function(e){X(e)}}}(),Province=function(){"use strict";const e="form-new-province",t="form_new_province";let n=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const a=function(e){toastr.error(e)},i=t=>{$(t.target).parents("div."+e)[0]||t.target.className.includes("select-add-option")||Province.close()},o=function(e){let t=l(),a=null;return e&&(a=validInt(e.id),t={id:validInt(e.id),name:e.name?e.name:null,sort_order:e.sort_order?e.sort_order:9999999,country_id:validInt(e.country_id),iso2:e.iso2?e.iso2:null,iso3:e.iso3?e.iso3:null,enabled:e.enabled?e.enabled:1,date_created:e.date_created?e.date_created:formatDateMySQL(),created_by:e.created_by?e.created_by:n,date_modified:e.date_modified?e.date_modified:formatDateMySQL(),modified_by:e.modified_by?e.modified_by:n,note:e.note?e.note:null}),Province.id=a,Province.detail=t,t},l=function(){return{id:null,name:null,sort_order:9999999,iso2:null,iso3:null,enabled:1,note:null,created_by:n,modified_by:n,date_created:formatDateMySQL(),date_modified:formatDateMySQL()}},d=function(){let e=document.getElementById(t);e&&(e.parentNode.removeChild(e),window.removeEventListener("click",i))},r=function(e,t){if(Province.all=new Map,!t)return;let n="";if(null!==Province.id&&(n=Province.id),!e)return $(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),void $(t).val("").trigger("change");!function(e,t){if(!e)return a("Error Loading Province- Missing Data");try{sendGetRequest("/api/v1.0/provinces",e,function(e,n,i){return e?t(e):a("Oops: 1")})}catch(e){return a("Error Validating Province")}}({country_id:e},function(e){e&&(s(e),$(t).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(t).val(n).trigger("change"))})},s=function(e){Province.all=new Map,e&&$.each(e,function(e,t){let n=o(t);Province.all.set(n.id,n)})},c=function(n,a,o){n&&function(n,a,o){let l=$(n).attr("id"),r=$(n).parents("div.row"),s="";if(a&&(s=a),!l||!r[0])return;if(document.getElementById(t))return;let c=document.createElement("div"),u=document.createElement("h5"),m=document.createElement("div"),_=document.createElement("div"),p=document.createElement("div"),g=document.createElement("div"),f=document.createElement("div"),y=document.createElement("div"),v=document.createElement("div"),h=document.createElement("div"),b=document.createElement("div"),I=document.createElement("div"),w=document.createElement("div"),E=document.createElement("div"),B=document.createElement("div"),k=document.createElement("div"),N=document.createElement("input"),M=document.createElement("label"),x=document.createElement("input"),C=document.createElement("label"),S=document.createElement("input"),P=document.createElement("label"),D=document.createElement("button"),L=document.createElement("button");c.id=t,c.classList=["card card-body m-3 "+e],u.classList="card-title",u.innerText="Province Details",N.id="province_name",N.name="province_name",N.type="text",N.classList=["form-control "+e],M.htmlFor="province_name",M.innerHTML="Name:",E.id="province_name-error",x.id="province_iso2",x.name="province_iso2",x.type="text",x.maxLength=2,x.classList=["form-control "+e],C.htmlFor="province_iso2",C.innerHTML="ISO2:",B.id="province_iso2-error",S.id="province_iso3",S.name="province_iso3",S.type="text",S.maxLength=3,S.classList=["form-control "+e],P.htmlFor="province_iso3",P.innerHTML="ISO3:",k.id="province_iso3-error",D.classList=["btn btn-primary btn-sm waves-effect waves-light"],D.innerText="save",D.type="button",D.addEventListener("click",e=>{Province.save(n,o)}),L.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],L.innerText="cancel",L.type="button",L.addEventListener("click",e=>{d()}),m.classList=["row"],_.classList=["row"],p.classList=["col-lg-3 mb-1"],g.classList=["col-lg-3 mb-1"],f.classList=["col-lg-3 mb-1"],y.classList=["col-lg-3 mb-1"],v.classList=["col-12 mb-1 text-right"],h.classList=["form-element"],b.classList=["form-element"],I.classList=["form-element"],w.classList=["form-element"],E.classList=["error w-100 text-center"],B.classList=["error w-100 text-center"],k.classList=["error w-100 text-center"],h.appendChild(M),h.appendChild(N),h.appendChild(E),p.appendChild(h),b.appendChild(C),b.appendChild(x),b.appendChild(B),g.appendChild(b),I.appendChild(P),I.appendChild(S),I.appendChild(k),f.appendChild(I),m.appendChild(p),m.appendChild(g),m.appendChild(f),m.appendChild(y),v.append(L),v.appendChild(D),_.appendChild(v),c.appendChild(u),c.appendChild(m),c.appendChild(_),r[0].appendChild(c),N.value=s,N.focus({preventScroll:!1}),window.addEventListener("click",i)}(n,a,o)},u=function(e,t){let n={},a=document.getElementById("province_name"),i=document.getElementById("province_iso2"),o=document.getElementById("province_iso3"),l=document.getElementById(t.replace(/province_id/g,"")+"country_id");isNaN(parseInt(l.value))||l&&function(){let e=document.getElementById("province_name"),t=document.getElementById("province_iso2"),n=document.getElementById("province_iso3"),a=!0;return e&&t&&n?(""===e.value?($(e).addClass("is-invalid"),$("#province_name-error").text("Required: Field is required").show(),a=!1):($(e).removeClass("is-invalid"),$("#province_name-error").text("").hide()),""===t.value?($(t).addClass("is-invalid"),$("#province_iso2-error").text("Required: Field is required").show(),a=!1):($(t).removeClass("is-invalid"),$("#province_iso2-error").text("").hide()),""===n.value?($(n).addClass("is-invalid"),$("#province_iso3-error").text("Required: Field is required").show(),a=!1):($(n).removeClass("is-invalid"),$("#province_iso3-error").text("").hide()),a):(handle_country_error("Error Processing Data"),!1)}()&&(n.name=a.value,n.iso2=i.value,n.iso3=o.value,n.country_id=parseInt(l.value),confirmDialog("Would you like to update?",t=>{t&&m(e,remove_nulls(n))}))},m=function(e,t){if(t)try{sendPostRequest("/api/v1.0/provinces/update",t,function(t,n,i){if(!t||!t[0])return a("Error: 1");{let n=t[0];Province.all.set(n.id,n);let a=$("select[data-type='province']");Province.id=n.id,City.id=null,a.each(function(e,t){var a=new Option(n.name,n.id,!1,!1);$(t).append(a).trigger("change")}),$(e).val(n.id).trigger("change"),Province.close(),toastr.success("Province: "+n.id+" updated")}})}catch(e){a("Error: Validating Province")}else a("Error: Missing Data")},_=function(e){!function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=Country.id,a=(Province.id,document.getElementById(t));a&&$(a).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let n=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(n[0]){let e=n[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_province_add_icon")){let n=document.createElement("i");n.classList="select-add-option fas fa-plus filter_province_add",n.id="filter_province_add_icon",n.addEventListener("click",n=>{let i=e.value;$(a).select2("close"),Province.add(this,i,t)}),e.after(n)}$(".filter_province_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_province_add").show():$(".filter_province_add").hide()})}}).on("change",function(){let e=$(this).attr("id").replace("province","city"),t=$(this).attr("id").replace("province","country"),a=document.getElementById(e),i=document.getElementById(t);a&&i&&(n=parseInt(i.value),isNaN(parseInt(i.value))?(City.id=null,City.get(null,null,a)):isNaN(parseInt($(this).val()))?(City.id=null,City.get(n,null,a),City.id):City.get(n,parseInt($(this).val()),a)),City.id=null,Province.id=null})})}(e)};return{detail:{},all:new Map,id:null,set_detail:function(e){o(e)},update_select:function(e,t){},close:function(){d()},save:function(e,t){u(e,t)},get:function(e,t){r(e,t)},add:function(e,t,n){c(e,t,n)},init:function(e){_(e)}}}(),Country=function(){"use strict";const e="form_new_country",t=document.getElementById("country_iso3"),n=document.getElementById("country_iso2"),a=document.getElementById("country_name"),i=document.getElementById("form_new_country"),o=document.getElementById("new_country_submit_button"),l=document.getElementById("new_country_cancel_button"),d=document.getElementById("modal_product_country_cars"),r=document.getElementById("modal_product_country_id"),s=document.getElementById("modal_product_province_id"),c=document.getElementById("modal_product_city_id"),u=document.getElementById("modal_product_location_id"),m=document.getElementById("modal_new_product");let _=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,p=!1;$(o).on("click",function(){B(this)}),$(l).on("click",function(){h()});const g=function(){i&&(d&&(d.value=""),h(),v(),$(i).on("change",function(){console.log("Country.form_new_country:change()"),y()})),d&&$(d).on("search",function(){h(),b(),d&&(d.value="")}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keyup",function(){let e=d.value;p=!1,""===e&&I()}).on("change",function(){let e=$(this).val();p=!1,setTimeout(function(){""===e?I():w(e)},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/countries",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=N(e.data),n=t&&!isNaN(parseInt(t.id))?parseInt(t.id):null;Country.all.get(n);p=!0,b(t)}})},f=function(){$(a).hideError(),$(n).hideError(),$(t).hideError()},y=function(){let e=!0,i=a&&""!==a.value?a.value:null,o=t&&""!==t.value?t.value:null,l=n&&""!==n.value?n.value:null;if(is_null(i)?(e=!1,$(a).showError("oops")):$(a).hideError(),is_null(o)?(e=!1,$(t).showError("oops")):$(t).hideError(),is_null(l)?(e=!1,$(n).showError("oops")):$(n).hideError(),e)return{name:i,iso2:l,iso3:o,sort_order:null,enabled:1,currency_id:5}},v=function(){i&&(a&&(a.disabled=!0),n&&(n.disabled=!0),t&&(t.disabled=!0),$(i).hide())},h=function(){r&&(r.value=""),s&&(s.value=""),c&&(c.value=""),t&&(t.value=""),n&&(n.value=""),a&&(a.value=""),p=!1,f()},b=function(e){let i,o,l,m="";e?(m=isNaN(parseInt(e.id))?"":parseInt(e.id),i=e.name?e.name:"",o=e.iso2?e.iso2:"",l=e.iso3?e.iso3:""):d&&(i=d.value,o="",l="",m=""),u&&(u.value=m),r&&(r.value=m),s&&(s.value=""),c&&(c.value=""),t&&(t.value=l),n&&(n.value=o),a&&(a.value=i),d&&(d.value=i)},I=function(){a&&(a.value=""),n&&(n.value=""),t&&(t.value=""),r&&(r.value=""),s&&(s.value=""),c&&(c.value=""),u&&(u.value=""),p=!1,f()},w=function(e){if(!1===p)if(e&&""!==e){!function(e,t){if(!e)return E("Error Loading Country - Missing Data");try{sendGetRequest("/api/v1.0/countries/validate",e,function(e){if(console.log("|__ data",e),e)return t(e);E("Oops: 1")})}catch(e){return console.log("error",e),E("Error Validating Country")}}({name:e},function(a){let o;a&&a.length&&(o=a,a[0]&&(o=a[0])),o&&o.length?(p=!0,h(),b(o)):(p=!1,confirmDialog(`The country: ${e} does not exist exists. Would you like to create it?`,e=>{e?(h(),b(),i&&(n&&(n.disabled=!1),t&&(t.disabled=!1),$(i).show())):(I(),d&&(d.value=""))}))})}else E("here")},E=function(e,t,n){let a=t||"Country";toastr[n||"error"](e,a)},B=function(e){if(a&&i&&n&&t){if(y()){let i={};i.name=a&&""!==a.value?a.value:null,i.iso2=n&&""!==n.value?n.value:null,i.iso3=t&&""!==t.value?t.value:null,i.enabled=1,i.sort_order=null,confirmDialog("Would you like to update?",t=>{t&&k(e,remove_nulls(i))})}}else toastr.error("Error: 2")},k=function(e,t){if(!t)return console.log("Error: Missing Data"),E("Error: Missing Data");try{sendPostRequest("/api/v1.0/countries/update",t,function(t){let n,a,o,l=$("select[data-type='country']");if(!t)return E("Error: 1");(n=N(t[0]?t[0]:t))&&(o=n.name?n.name:null,null!==(a=n.id?n.id:null)&&null!==o&&(Country.all.set(a,n),l.each(function(e,t){let n=new Option(o,a,!1,!1);null!==o&&null!==a&&$(t).append(n).trigger("change")}),$(e).val(a).trigger("change"),m&&i?(g(),b(n),d&&(d.value=o)):Country.close(),E(o+" was updated","Country","success")))})}catch(e){return console.log("error",e),E("Error: Validating Country")}},N=function(e){let t=M(),n=null;return e&&(n=validInt(e.id),t.id=validInt(e.id),t.name=e.name?e.name:null,t.sort_order=e.sort_order?e.sort_order:null,t.iso2=e.iso2?e.iso2:null,t.iso3=e.iso3?e.iso3:null,t.currency_id=validInt(e.currency_id),t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:_,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:_,t.note=e.note?e.note:null,t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null),Country.id=n,Country.detail=t,t},M=function(){return{id:null,name:null,sort_order:null,iso2:null,iso3:null,currency_id:null,enabled:1,note:null,created_by:_,modified_by:_,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),display_long:null,display_medium:null,display_short:null}},x=e=>{$(e.target).parents("div.form-new-country")[0]||e.target.className.includes("select-add-option")||Country.close()},C=function(e){e&&e.dropdowns&&$.each(e.dropdowns,function(e,t){let n=document.getElementById(t);n&&$(n).select2({language:{searching:function(){}},escapeMarkup:function(e){return e}}).on("select2:open",function(e){let a=document.querySelectorAll("[aria-controls='select2-"+t+"-results']");if(a[0]){let e=a[0];if($(e).attr("id",t+"_search"),!document.getElementById("filter_country_add_icon")){let t=document.createElement("i");t.classList="select-add-option fas fa-plus filter_country_add",t.id="filter_country_add_icon",t.addEventListener("click",t=>{let a=e.value;$(n).select2("close"),Country.add(this,a)}),e.after(t)}$(".filter_country_add").hide(),e&&e.addEventListener("keyup",t=>{""!==e.value?$(".filter_country_add").show():$(".filter_country_add").hide()})}}).on("change",function(){isNaN(parseInt($(this).val()))||parseInt($(this).val());let e=$(this).attr("id").replace("country","province"),t=document.getElementById(e),n=$(this).attr("id").replace("country","city");document.getElementById(n);isNaN(parseInt($(this).val()))?Province.get(null,t):t&&Province.get(parseInt($(this).val()),t)})})},S=function(e){!function(e,t){if(!e)return E("Error Loading Country- Missing Data");try{$.ajax({type:"GET",url:"/api/v1.0/countries",data:e,async:!1}).done(function(e){return e?t(e):E("Oops: 1")})}catch(e){return console.log("error",e),E("Error Validating Country")}}({},function(t){t&&(Country.all=t,C(e))})},P=function(t,n){t&&function(t,n){let a=$(t).attr("id"),i=$(t).parents("div.row"),o="";if(n&&(o=n),!a||!i[0])return;if(document.getElementById(e))return;let l=document.createElement("div"),d=document.createElement("h5"),r=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),m=document.createElement("div"),_=document.createElement("div"),p=document.createElement("div"),g=document.createElement("div"),f=document.createElement("div"),y=document.createElement("div"),v=document.createElement("div"),h=document.createElement("div"),b=document.createElement("div"),I=document.createElement("div"),w=document.createElement("input"),E=document.createElement("label"),B=document.createElement("input"),k=document.createElement("label"),N=document.createElement("input"),M=document.createElement("label"),C=document.createElement("button"),S=document.createElement("button");d.classList="card-title",d.innerText="Country Details",l.id=e,l.classList=["card card-body m-3 form-new-country"],w.id="country_name",w.name="country_name",w.type="text",w.classList=["form-control "],E.htmlFor="country_name",E.innerHTML="Name:",h.id="country_name-error",B.id="country_iso2",B.name="country_iso2",B.type="text",B.maxLength=2,B.classList=["form-control "],k.htmlFor="country_iso2",k.innerHTML="ISO2:",b.id="country_iso2-error",N.id="country_iso3",N.name="country_iso3",N.type="text",N.maxLength=3,N.classList=["form-control "],M.htmlFor="country_iso3",M.innerHTML="ISO3:",I.id="country_iso3-error",C.classList=["btn btn-primary btn-sm waves-effect waves-light"],C.innerText="save",C.type="button",C.addEventListener("click",e=>{Country.save(t)}),S.classList=["btn btn-outline-danger btn-sm waves-effect waves-light"],S.innerText="cancel",S.type="button",S.addEventListener("click",e=>{Country.close()}),r.classList=["row"],s.classList=["row"],c.classList=["col-lg-3 mb-1"],u.classList=["col-lg-3 mb-1"],m.classList=["col-lg-3 mb-1"],_.classList=["col-lg-3 mb-1"],p.classList=["col-12 mb-1 text-right"],g.classList=["form-element"],f.classList=["form-element"],y.classList=["form-element"],v.classList=["form-element"],h.classList=["error w-100 text-center"],b.classList=["error w-100 text-center"],I.classList=["error w-100 text-center"],g.appendChild(E),g.appendChild(w),g.appendChild(h),c.appendChild(g),f.appendChild(k),f.appendChild(B),f.appendChild(b),u.appendChild(f),y.appendChild(M),y.appendChild(N),y.appendChild(I),m.appendChild(y),r.appendChild(c),r.appendChild(u),r.appendChild(m),r.appendChild(_),p.append(S),p.appendChild(C),s.appendChild(p),l.appendChild(d),l.appendChild(r),l.appendChild(s),i[0].appendChild(l),w.value=o,w.focus({preventScroll:!1}),window.addEventListener("click",x)}(t,n)};return{detail:{},all:new Map,buildCountryDropDown:function(){},close:function(){!function(){let t=document.getElementById(e);t&&(t.parentNode.removeChild(t),window.removeEventListener("click",x))}()},add:function(e,t){P(e,t)},save:function(e){B(e)},set:function(e){set(e)},set_detail:function(e){N(e)},load_all:function(e){!function(e){Country.all=new Map,e&&$.each(e,function(e,t){let n=N(t);Country.all.set(n.id,n)})}(e)},get:function(e){S(e)},init:function(e){!function(e){C(e)}(e)},initAutocomplete:function(){g()}}}(),Location=function(){"use strict";const e=document.getElementById("form_edit_location"),t=document.getElementById("form_location_details"),n=document.getElementById("location_types_id"),a=document.getElementById("location_name_filter"),i=document.getElementById("location_city_id"),o=document.getElementById("location_country_id"),l=document.getElementById("location_province_id"),d=document.getElementById("location_id"),r=document.getElementById("location_street_1"),s=document.getElementById("location_street_2"),c=document.getElementById("location_zipcode"),u=document.getElementById("location_name"),m=document.getElementById("location_enabled"),_=document.getElementById("button_clear_form_edit_location"),p=document.getElementById("button_submit_form_edit_location"),g=document.getElementById("button_edit_location"),f=document.getElementById("button_close_edit_location_form"),y=document.getElementById("form_edit_location_filter"),v=document.getElementById("location_name_filter_id"),h={groups:{locationGroup:"location_name_filter location_name_filter_id"},rules:{location_name_filter:{required:!0},location_name_filter_id:{required:!0,digits:!0}},messages:{location_name_filter:{required:"Field Required"},location_name_filter_id:{required:"Field Required",digits:"invalid"}}},b={rules:{location_types_id:{required:!0},location_city_id:{required:!0,digits:!0},location_country_id:{required:!0,digits:!0},location_province_id:{required:!0,digits:!0},location_name:{required:!0}},messages:{location_types_id:{required:"Field Required"},location_city_id:{required:"Field Required",digits:"invalid"},location_country_id:{required:"Field Required",digits:"invalid"},location_province_id:{required:"Field Required",digits:"invalid"},location_id:{required:"Field Required",digits:"invalid"},location_name:{required:"Field Required"}}},I=document.getElementById("form_product_edit_location"),w=document.getElementById("button_edit_product_location"),E=document.getElementById("button_clear_form_edit_product_location"),B=document.getElementById("button_submit_form_edit_product_location"),k=document.getElementById("button_close_edit_product_location_form"),N=document.getElementById("product_location_search"),M=document.getElementById("card_product_edit_location");let x,C,S={},P=!1,D=!1,L="medium",F=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$('a[data-toggle="tab"]').on("hide.bs.tab",function(e){V()});const T=function(){d.value="",n.value="",u.value="",r.value="",s.value="",c.value="",$(o).val("").trigger("change")},R=function(e){T();let t={},a={},i={},l={};if(e){N.value=e.display_medium?e.display_medium:"",u.value=e.name,$(d).val(e.id).trigger("change"),r.value=e.street_1,s.value=e.street_2,c.value=e.zipcode;let m="";e.type&&(m=(l=e.type).id),$(n).val(m),e.country&&(t=e.country,Country.id=t.id?t.id.toString():null),e.province&&(a=e.province,Province.id=a.id?a.id.toString():null),e.city&&(i=e.city,City.id=i.id?i.id:null),$(o).val(t.id?t.id:"").trigger("change")}},q=function(e){T(),$(M).hide()},A=function(e){T(),R(e),$(M).show()};$(B).on("click",function(){A()}),$(w).on("click",function(){Location.detail&&A(Location.detail)}),$(B).on("click",function(){}),$(E).on("click",function(){q()}),$(k).on("click",function(){q()}),$(N).on("click",function(){$(this).select()}).on("change",function(){D=!1,setTimeout(function(){N.value},200)}).on("search",function(){D=!1}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/locations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{default_display:L},onSelect:function(e){e&&e.data&&(D=!0)},onSearchComplete:function(e,t){}}),$(f).on("click",function(){H(),G(S),a.value=S.display_medium,$(d).val(S.id).trigger("change"),V()}),$(_).on("click",function(){H(),G()}),$(p).on("click",function(){Z()}),$(g).on("click",function(){d.value,z()}),$("input[name='location_display']").on("change",function(){let e=$("input[name='location_display']:checked").val();L=e,O(),null!==Location.detail["display_"+e]&&(a.value=Location.detail["display_"+e])}),$(u).on("change",function(){setTimeout(function(){let e=u.value;Y(e)},200)}),$(d).on("change",function(){$(v).val($(d).val())});const O=function(){$(a).on("click",function(){$(this).select()}).on("change",function(){setTimeout(function(){let e=a.value;!1===D&&(""===a.value?(a.value="",$(d).val("").trigger("change"),H()):U(e))},200)}).on("search",function(){D=!1,$(d).val("").trigger("change"),a.value="",P=!0,K(),H(),G()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/locations",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{default_display:L},onSelect:function(t){if(t&&t.data&&t.data.country&&t.data.province&&t.data.city){D=!0,H();let e=t.data;Location.detail=e,S=e,G(e)}e&&clearValidation(e)},onSearchComplete:function(e,t){}})},Q=function(e){toastr.error(e)},Y=function(e){if(e&&""!==e){j({name:e,default_display:L},function(t){if(t&&t[0])if(confirm(`Location: ${e} all ready exists. Would you like to use it?`)){let e=t[0];H(),G(e)}else H(),G()})}},U=function(e){if(e&&""!==e){j({name:e,default_display:L},function(t){if(t&&t[0]){let e=t[0];D=!0,H(),G(e)}else D=!1,confirmDialog(`Location: ${e} does not exist. Would you like to create it?`,t=>{t?W(e):(H(),G(S),V())})})}},W=function(e){!1===D&&e&&(H(),G(),z(),u.value=e,u.disabled=!0)},j=function(e,t){if(!e)return Q("Error Loading Location- Missing Data");try{sendGetRequest("/api/v1.0/locations/validate",e,function(e,n,a){return e?t(e):Q("Oops: 1")})}catch(e){return Q("Error Validating Location")}},z=function(){!function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!0}),a.disabled=!0,g.disabled=!0}(),$(t).show()},V=function(){if(!t)return;let e=K(S);G(e),function(){let e=document.getElementsByName("location_display");$.each(e,function(e,t){t.disabled=!1}),a.disabled=!1,g.disabled=!1}(),$(t).hide()},H=function(){u.disabled=!1,u.value="",a.value="",$(d).val("").trigger("change"),n.value="",r.value="",s.value="",c.value="",$(o).val("").trigger("change"),document.getElementById("location_display_medium").checked=!0},G=function(e){let t={},i={},l={},_={};if(e){a.value=e.display_medium?e.display_medium:"",m.checked=1===e.enabled,u.value=e.name,$(d).val(e.id).trigger("change"),r.value=e.street_1,s.value=e.street_2,c.value=e.zipcode;let p="";e.type&&(p=(_=e.type).id),$(n).val(p),e.country&&(t=e.country,Country.id=t.id?t.id.toString():null),e.province&&(i=e.province,Province.id=i.id?i.id.toString():null),e.city&&(l=e.city,City.id=l.id?l.id.toString():null),$(o).val(t.id?t.id:"").trigger("change")}},K=function(e){let t={id:null,display_long:null,display_medium:null,display_short:null,location_types_id:null,name:null,street_1:null,street_2:null,zipcode:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null,city:{id:null,name:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null},province:{created_by:F,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,iso2:null,iso3:null,modified_by:F,name:null,name_long:null,note:null,sort_order:999},country:{created_by:F,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),currency_id:null,enabled:1,id:null,iso2:null,iso3:null,modified_by:F,name:null,name_long:null,note:null,sort_order:999},type:{created_by:F,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,icon:null,id:null,modified_by:F,name:null,note:null,sort_order:999}};S=t;let n={},a={},i={},o={};return e?(e.country&&(n=e.country),e.province&&(a=e.province),e.city&&(i=e.city),e.type&&(o=e.type)):e={},t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.zipcode=e.zipcode?e.zipcode:null,t.display_long=e.display_long?e.display_long:null,t.display_medium=e.display_medium?e.display_medium:null,t.display_short=e.display_short?e.display_short:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:F,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:F,t.note=e.note?e.note:null,t.country={created_by:n.created_by?n.created_by:F,date_created:n.date_created?n.date_created:formatDateMySQL(),date_modified:n.date_modified?n.date_modified:formatDateMySQL(),currency_id:n.currency_id?n.currency_id:null,enabled:n.enabled?n.enabled:1,id:n.id?n.id:null,iso2:n.iso2?n.iso2:null,iso3:n.iso3?n.iso3:null,modified_by:n.modified_by?n.modified_by:F,name:n.name?n.name:null,name_long:n.name_long?n.name_long:null,note:n.note?n.note:null,sort_order:n.sort_order?n.sort_order:999},t.province={created_by:a.created_by?a.created_by:F,date_created:a.date_created?a.date_created:formatDateMySQL(),date_modified:a.date_modified?a.date_modified:formatDateMySQL(),enabled:a.enabled?a.enabled:1,id:a.id?a.id:null,iso2:a.iso2?a.iso2:null,iso3:a.iso3?a.iso3:null,modified_by:a.modified_by?a.modified_by:F,name:a.name?a.name:null,name_long:a.name_long?a.name_long:null,note:a.note?a.note:null,sort_order:a.sort_order?a.sort_order:999},t.city={created_by:i.created_by?i.created_by:F,date_created:i.date_created?i.date_created:formatDateMySQL(),date_modified:i.date_modified?i.date_modified:formatDateMySQL(),enabled:i.enabled?i.enabled:1,id:i.id?i.id:null,modified_by:i.modified_by?i.modified_by:F,name:i.name?i.name:null,note:i.note?i.note:null,sort_order:i.sort_order?i.sort_order:999},t.type={created_by:o.created_by?o.created_by:F,date_created:o.date_created?o.date_created:formatDateMySQL(),date_modified:o.date_modified?o.date_modified:formatDateMySQL(),enabled:o.enabled?o.enabled:1,icon:o.icon?o.icon:null,id:o.id?o.id:null,modified_by:o.modified_by?o.modified_by:F,name:o.name?o.name:null,note:o.note?o.note:null,sort_order:o.sort_order?o.sort_order:999},Province.set_detail(t.province),Country.set_detail(t.country),City.set_detail(t.city),Location.detail=t,t},J=function(t){let n={};t&&(n=function(e){return K(e)}(t),S=n),e&&(validator_init(b),x=$(e).validate(),validator_init(h),C=$(y).validate(),$(o).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(l).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(i).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),H(),G(n),V()),I&&($(o).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(l).BuildDropDown({data:Array.from(Province.all.values()),title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(i).BuildDropDown({data:Array.from(City.all.values()),title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["location_country_id"]}),Province.init({dropdowns:["location_province_id"]}),City.init({dropdowns:["location_city_id"]}),Location.detail=n,R(n)),a&&O()},Z=function(){$(e).valid()&&confirmDialog("Would you like to update?",e=>{e&&function(e,t){e&&sendPostRequest("/api/v1.0/locations/update",e,function(e,n,a){return e?t(e):Q("Oops: 1")})}(X(),function(e){let t;if(e&&e[0]){let n="medium";t=e[0],S=t;let i=document.getElementsByName("location_display");for(let e=0;e<i.length;e++)i[e].checked&&(n=i[e].value);d.value=t.id,a.value=t["display_"+n],V()}})})},X=function(){return remove_nulls({id:isNaN(parseInt(d.value))?null:parseInt(d.value),city_id:isNaN(parseInt(i.value))?null:parseInt(i.value),province_id:isNaN(parseInt(l.value))?null:parseInt(l.value),country_id:isNaN(parseInt(l.value))?null:parseInt(o.value),location_types_id:isNaN(parseInt(n.value))?null:parseInt(n.value),name:u&&""!==u.value?u.value:null,street_1:r&&""!==r.value?r.value:null,street_2:s&&""!==s.value?s.value:null,zipcode:c&&""!==c.value?c.value:null,enabled:1,note:null})};return{validator:null,detail:{},all:new Map,types:new Map,get:function(e){},load_all:function(e){load_all(e)},save:function(e){Z(e)},init:function(e){J(e)},populate_form:function(e){G(e)},set_detail:function(e){return K(e)},build:function(){if($(y).valid())return X()}}}(),Variant=function(){"use strict";const e=document.getElementById("button_remove_variant_from_product"),t=document.getElementById("product_edit_variant_section"),n=document.getElementById("panel_tab_variant"),a=document.getElementById("category_id"),i=document.getElementById("product_id"),o=document.getElementById("product_edit_variant_form_variant_name_filter"),l=document.getElementById("table_variant_product_edit"),d=document.getElementById("product_edit_variant_form"),r=document.getElementById("display_product_variant_name"),s=document.getElementById("product_edit_variant_form_variant_id"),c=document.getElementById("product_edit_variant_form_variant_name"),u=document.getElementById("product_edit_variant_form_variant_enabled"),m=document.getElementById("product_edit_variant_form_variant_code"),_=document.getElementById("product_edit_variant_form_variant_min_age"),p=document.getElementById("product_edit_variant_form_variant_max_age"),g=document.getElementById("product_edit_variant_form_submit_button"),f=document.getElementById("product_edit_variant_form_clear_button"),y=document.getElementById("product_edit_variant_form_close_button"),v=document.getElementById("product_edit_variant_form_variant_used_in_pricing"),h=document.getElementById("table_variant_product_edit_add_new_button"),b=document.getElementById("product_edit_variant_display");let I=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,w=$(l),E=!1,B={rules:{product_edit_variant_form_variant_name:{required:!0},product_edit_variant_form_variant_min_age:{number:!0,min:0},product_edit_variant_form_variant_max_age:{number:!0,min:1}},messages:{product_edit_variant_form_variant_name:{required:"Field Required"},product_edit_variant_form_variant_min_age:{number:"Field Invalid",min:"Field Invalid"},product_edit_variant_form_variant_max_age:{number:"Field Invalid",min:"Field Invalid"}}};$(e).on("click",function(){M()}),$(t).on("change",function(){C()}),$(h).on("click",function(){w.clearSelectedRows(),F()}),$(f).on("click",function(){D(),w.clearSelectedRows()}),$(y).on("click",function(){D(),w.clearSelectedRows()}),$(g).on("click",function(){O()}),$(n).on("hide.bs.tab",function(){D(),w.clearSelectedRows(),o.value="",o.disabled=!1});const k=function(e){if(!e)return;let t=isNaN(parseInt(e.id))?null:parseInt(e.id);t&&$(`#product_edit_variant_display_${t}`).remove()},N=function(e){if(!e)return;let t=isNaN(parseInt(e.id))?null:parseInt(e.id),n=isNaN(parseInt(e.max_age))?null:parseInt(e.max_age),a=isNaN(parseInt(e.min_age))?null:parseInt(e.min_age),i=e.name?e.name:null,o=e.code?e.code:null;Variant.all.get(t)&&k(Variant.all.get(t)),$(b).append(`\n            <div id="product_edit_variant_display_${t}" class="col-12 col-sm-12 col-md-4 px-1">\n                <div class="card">\n                    <div class="card-body">\n                    \n                        <h5 class="card-title">${i}</h5>\n                        <h6 class="card-subtitle my-2 text-muted">${o}</h6>\n                        <p class="card-text"></p>\n       \n                        <table class="table table-sm">\n                            <thead>\n                                <tr>\n                                    <th>&nbsp;</th>\n                                    <th>Min</th>\n                                    <th>Max</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <tr>\n                                    <td>Age</td>\n                                    <td>${a}</td>\n                                    <td>${n}</td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        `)},M=function(){confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e={variant_id:parseInt(s.value),product_id:parseInt(i.value)};x(e,function(t){if(t){let t=Y(Variant.all.get(e.variant_id));Variant.all.delete(e.variant_id),w.deleteRow(t),w.clearSelectedRows(),o.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),C(),D(),YearCalendar.endLoading(),k(t),toastr.warning(`Variant: ${t.name} - has been removed`,"Variant")}})}else D(),w.clearSelectedRows(),o.value="",o.disabled=!1})},x=function(e,t){if(e){let n="/api/v1.0/variants/remove";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e);S("Oops: 1")})}catch(e){}}},C=function(){if(0===Array.from(Variant.all.values()).length){$("<span/>",{class:"badge badge-danger  ml-2",text:"!",id:"variantNeedsAttention"});$(n).html('<span id="tab_span_variant">Variant</span> <span id="variantNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>')}else $(n).html('<span id="tab_span_variant">Variant</span>');Product.updateProgress()},S=function(e){toastr.error(e,"Variant Error")},P=function(e){if(e&&""!==e){let t=remove_nulls({name:e,category_id:isNaN(parseInt(a.value))?null:parseInt(a.value)});!function(e,t){if(e)try{sendGetRequest("/api/v1.0/variants/validate",e,function(e,n,a){if(e)return t(e);S("Oops: 1")})}catch(e){S("Error Validating Variant")}else S("Error Loading Variant - Missing Data")}(t,function(n){let a=null;if(n&&n[0]&&(a=n,n[0]&&(a=n[0])),a){let e,t=Variant.all.get(parseInt(a.id));t?(e=Y(t),w.loadRow(e)):e=Y(a),F(e)}else confirmDialog(`The variant: ${e} does not exist exists. Would you like to create it?`,n=>{if(n){let n="/api/v1.0/variants/new";try{sendPostRequest(n,t,function(t,n,a){if(!t)return S("Oops: 1");{let n=t;t[0]&&(n=t[0]);let a=Y(n);L(),w.clearSelectedRows(),E=!1,c.value=e,r.innerText=e,F(a),q()}})}catch(e){}}})})}},D=function(){L(),A(),T()},L=function(){clearValidation(d),r.innerText="&nbsp;",s.value="",c.value="",u.checked=!0,m.value="",_.value=0,p.value="",v.checked=!0},F=function(e){L(),e&&(v.checked=1===e.used_in_pricing,r.innerText=e.name?e.name:"&nbsp;",s.value=isNaN(parseInt(e.id))?"":parseInt(e.id),c.value=e.name?e.name:"&nbsp;",u.checked=!(e.enabled&&0===e.enabled),m.value=e.name?e.name:"&nbsp;",_.value=isNaN(parseInt(e.min_age))?1:parseInt(e.min_age),p.value=isNaN(parseInt(e.max_age))?"":parseInt(e.max_age)),q(),R()},T=function(){C(),o.disabled=!1,o.value="",$(d).hide()},R=function(){o.disabled=!0,$(d).show()},q=function(){v.disabled=!1,s.disabled=!0,c.disabled=!0,u.disabled=!0,m.disabled=!0,_.disabled=!1,p.disabled=!1,g.disabled=!1},A=function(){v.disabled=!0,s.disabled=!0,c.disabled=!0,u.disabled=!0,m.disabled=!0,_.disabled=!0,p.disabled=!0,g.disabled=!0},O=function(){(function(){let e=$(d).valid(),t=isNaN(parseInt(_.value))?null:parseInt(_.value),n=isNaN(parseInt(p.value))?null:parseInt(p.value);return null!==t&&null!==n&&parseInt(n)<parseInt(t)&&(setError(p,"Age is greater than minimum"),e=!1),e})()&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){!function(e,t){if(e){let n="/api/v1.0/variants/update";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e);S("Oops: 1")})}catch(e){}}}(function(){let e={id:isNaN(parseInt(s.value))?null:parseInt(s.value),category_id:isNaN(parseInt(a.value))?null:parseInt(a.value),product_id:isNaN(parseInt(i.value))?null:parseInt(i.value),name:c&&""!==c.value?c.value:null,code:m&&""!==m.value?m.value:null,min_age:isNaN(parseInt(_.value))?null:parseInt(_.value),max_age:isNaN(parseInt(p.value))?null:parseInt(p.value),used_in_pricing:!0===v.checked?1:0};return remove_nulls(e)}(),function(e){if(e){let t=Y(e[0]?e[0]:e);Variant.all.get(t.id)?w.updateRow(t):w.insertRow(t),Variant.all.set(t.id,t),w.loadRow(t),w.jumpToRow(t),w.clearSelectedRows(),o.disabled=!1,o.value="",PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),C(),D(),N(t),YearCalendar.endLoading(),toastr.success(`Variant: ${t.name} - has been updated`,"Variant")}})}else D(),w.clearSelectedRows(),o.value="",o.disabled=!1})},Q=function(e){let t=[];e&&e&&(t=e),l&&(w=$(l).table({table_type:"display_list",data:Variant.all,columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Code",targets:1,data:"code",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Min Age",targets:2,data:"min_age",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Max Age",targets:3,data:"max_age",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Variant.edit})),function(e){Variant.all=new Map,e&&$.each(e,function(e,t){let n=Y(t);Variant.all.set(n.id,n),w.insertRow(n),N(n)})}(t),o&&function(){let e=isNaN(parseInt(a.value))?null:parseInt(a.value);$(o).on("click",function(){$(this).select()}).on("search",function(){E=!1,D(),w.clearSelectedRows()}).on("change",function(){setTimeout(function(){let e=o.value;w.clearSelectedRows(),!1===E&&(""===e?(o.value="",E=!1,D()):P(e))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/variants",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:e},onSelect:function(e){if(w.clearSelectedRows(),!e||!e.data)return;let t,n=e.data,a=Variant.all.get(parseInt(n.id));a?(t=Y(a),w.loadRow(t)):(t=Y(n)).used_in_pricing=1,F(t)}})}(),d&&(validator_init(B),Variant.validator=$(d).validate(),D(),C())},Y=function(e){let t={id:null,category_id:null,name:null,min_age:null,max_age:null,enabled:1,date_created:formatDateMySQL(),created_by:I,date_modified:formatDateMySQL(),modified_by:I,used_in_pricing:1,note:null};return e&&(t.id=e.id?e.id:null,t.category_id=e.category_id?e.category_id:null,t.name=e.name?e.name:null,t.code=e.code?e.code:null,t.min_age=e.min_age?e.min_age.toString():null,t.max_age=e.max_age?e.max_age:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:I,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:I,t.used_in_pricing=1===e.used_in_pricing?1:0,t.note=e.note?e.note:null),Product.detail=t,t};return{validator:null,all:new Map,set:function(e){return Y(e)},edit:function(e){!function(e){if(e){let t=Y(e);F(t)}}(e)},init:function(e){Q(e)}}}(),Unit=function(){"use strict";const e=document.getElementById("panel_tab_unit"),t=document.getElementById("button_remove_unit_from_product"),n=document.getElementById("category_id"),a=document.getElementById("product_id"),i=document.getElementById("product_edit_unit_form"),o=document.getElementById("product_edit_unit_form_submit_button"),l=document.getElementById("edit_product_unit"),d=document.getElementById("product_edit_unit_form_unit_name_filter"),r=document.getElementById("table_unit_product_edit"),s=document.getElementById("product_edit_unit_form_unit_id"),c=document.getElementById("product_edit_unit_form_unit_name"),u=document.getElementById("product_edit_unit_form_unit_room_code"),m=document.getElementById("product_edit_unit_form_unit_min_nights"),_=document.getElementById("product_edit_unit_form_unit_max_nights"),p=document.getElementById("product_edit_unit_form_unit_min_pax"),g=document.getElementById("product_edit_unit_form_unit_max_pax"),f=document.getElementById("product_edit_unit_form_unit_description_short"),y=document.getElementById("product_edit_unit_form_unit_description_long"),v=document.getElementById("product_edit_unit_form_unit_enabled"),h=document.getElementById("display_product_unit_name"),b=document.getElementById("product_edit_unit_form_clear_button"),I=document.getElementById("product_edit_unit_form_close_button"),w=document.getElementById("table_unit_product_edit_add_new_button"),E=document.getElementById("unit_keywords"),B=document.getElementById("unit_amenities"),k=document.getElementById("product_edit_unit_display"),N=document.getElementById("unit_images");let M,x,C,S=1,P="Unit",D="Nights",L="Pax",F=null,T=1,R=null,q=1,A=null,O=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,Q=$(r),Y=!1,U={rules:{product_edit_unit_form_unit_min_nights:{required:!0,number:!0,min:1},product_edit_unit_form_unit_min_pax:{required:!0,number:!0,min:1},product_edit_unit_form_unit_max_pax:{required:!0,number:!0,min:1}},messages:{product_edit_unit_form_unit_min_nights:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"},product_edit_unit_form_unit_min_pax:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"},product_edit_unit_form_unit_max_pax:{required:"Field Required",number:"Field Invalid",min:"Field Invalid"}}};$(t).on("click",function(){W()}),$(o).on("click",function(){Z()}),$(b).on("click",function(){ie(),Q.clearSelectedRows(),d.value="",d.disabled=!1,c.disabled=!0}),$(I).on("click",function(){console.log("Unit.product_edit_unit_form_close_button:click()"),ie(),Q.clearSelectedRows(),d.value="",d.disabled=!1,c.disabled=!0}),$(w).on("click",function(){ie(),Q.clearSelectedRows(),ee(),d.value="",c.value="",d.disabled=!0,c.disabled=!1,de(),oe()}),$(e).on("hide.bs.tab",function(){ie(),Q.clearSelectedRows(),d.value="",d.disabled=!1,c.disabled=!0});const W=function(){confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e={unit_id:parseInt(s.value),product_id:parseInt(a.value)};!function(e,t){if(e){let n="/api/v1.0/units/remove";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e);V("Oops: 1")})}catch(e){}}}(e,function(t){let n=e.unit_id;if(t){let e=Unit.all.get(n);e&&Q.deleteRow(e),Unit.all.delete(n),Q.clearSelectedRows(),d.value="",d.disabled=!1,PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),j(),ne(),ae(),K(e),YearCalendar.endLoading(),toastr.warning(`Unit: ${e.name} - has been removed`,"Unit")}})}})},j=function(){0===Array.from(Unit.all.values()).length?$(e).html(`<span id="tab_span_unit">${P}</span> <span id="unitNeedsAttention" class="badge rounded-pill badge-notification bg-danger">!</span>`):$(e).html(`<span id="tab_span_unit">${P}</span>`),Product.updateProgress()},z=function(e){if(e&&""!==e){H({name:e},function(t){let a=null;if(t&&t[0]&&(a=t,t[0]&&(a=t[0])),a){let e,t=Unit.all.get(parseInt(a.id));t?(e=G(t),Q.loadRow(e)):e=G(a),le(e)}else confirmDialog(`The unit: ${e} does not exist exists. Would you like to create it?`,t=>{if(t){let t=isNaN(parseInt(n.value))?null:parseInt(n.value),a=removeNulls({category_id:t,name:e||null});try{sendPostRequest("/api/v1.0/units/new",a,function(e,t,n){if(e){let t=e;e[0]&&(t=e[0]);let n=G(t);Q.clearSelectedRows(),Y=!1,ne(),le(n),de()}})}catch(e){}}else ie(),Q.clearSelectedRows(),d.value="",d.disabled=!1,c.disabled=!0})})}},V=function(e){toastr.error(`${e}`,"Unit")},H=function(e,t){if(e)try{sendGetRequest("/api/v1.0/units/validate",e,function(e,n,a){if(e)return t(e);V("Oops: 1")})}catch(e){V("Error Validating Unit")}else V("Error Loading Unit - Missing Data")},G=function(e){let t={api_id:null,blurb:null,category_id:1,cover_image:"/public/img/unit_cover_placeholder.jpg",created_by:O,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),description_long:null,description_short:null,enabled:1,end_time:null,id:null,max_nights:null,max_pax:null,meeting_point:null,min_nights:1,min_pax:1,modified_by:O,name:null,note:null,room_code:null,start_time:null,time_notes:null,keywords:[],amenities:[],images:[]};return e&&(t.api_id=e.api_id?e.api_id:null,t.blurb=e.blurb?e.blurb:null,t.category_id=e.category_id?e.category_id:null,t.cover_image=e.cover_image?e.cover_image:"/public/img/unit_cover_placeholder.jpg",t.created_by=e.created_by?e.created_by:O,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.description_long=e.description_long?e.description_long:null,t.description_short=e.description_short?e.description_short:null,t.enabled=e.enabled?e.enabled:1,t.end_time=e.end_time?e.end_time:null,t.id=e.id?e.id:null,t.max_nights=e.max_nights?e.max_nights:null,t.max_pax=e.max_pax?e.max_pax:null,t.meeting_point=e.meeting_point?e.meeting_point:null,t.min_nights=e.min_nights?e.min_nights:1,t.min_pax=e.min_pax?e.min_pax:1,t.modified_by=e.modified_by?e.modified_by:O,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.room_code=e.room_code?e.room_code:null,t.start_time=e.start_time?e.start_time:null,t.time_notes=e.time_notes?e.time_notes:null,t.amenities=e.amenities?e.amenities:null,t.keywords=e.keywords?e.keywords:null,t.images=e.images?e.images:[]),t},K=function(e){if(!e)return;let t=isNaN(parseInt(e.id))?null:parseInt(e.id);t&&$(`#product_edit_unit_display_${t}`).remove()},J=function(e){if(!e)return;e.ammenities&&getListOfIds(e.ammenities),isNaN(parseInt(e.category_id))||parseInt(e.category_id);let t=isNaN(parseInt(e.id))?null:parseInt(e.id),n=(e.keywords&&getListOfIds(e.keywords),isNaN(parseInt(e.max_nights))?null:parseInt(e.max_nights)),a=isNaN(parseInt(e.max_pax))?null:parseInt(e.max_pax),i=isNaN(parseInt(e.min_nights))?null:parseInt(e.min_nights),o=isNaN(parseInt(e.min_pax))?null:parseInt(e.min_pax),l=e.name?e.name:null,d=e.room_code?e.room_code:null,r=(e.start_time&&e.start_time,e.time_notes&&e.time_notes,S),s=colorScheme.get(r);S>=16&&(S=0),S++;let c=s&&s.backGround?s.backGround:"#fff",u=s&&s.textColor?s.textColor:"#0a070d",m=s&&s.borderColor?s.borderColor:"#0a070d";c=shadeColor(c,30),m=shadeColor(m,-30);let _=Unit.all.get(t);_&&K(_),$(k).append(`\n            <div id="product_edit_unit_display_${t}" class="col-12 col-sm-12 col-md-4 px-1">\n                <div class="card card-body mb-2" style="background-color:${c}; color:${u};border:solid 1px ${m};">\n                    <h5 class="card-title w-100 text-truncate" style="color:${u};border-color:${m}">${l}</h5>\n                    <h6 class="card-subtitle my-2 text-muted" style="color:${u}">${d}</h6>\n                    <table class="table table-sm" style="color:${u};border-color:${m}">\n                        <thead>\n                            <tr style="font-size:.85rem;font-weight:400;color:#0a070d;">\n                                <th style="font-size:.85rem;font-weight:400;color:#0a070d;">&nbsp;</th>\n                                <th style="font-size:.85rem;font-weight:400;color:#0a070d;">Min</th>\n                                <th style="font-size:.85rem;font-weight:400;color:#0a070d;">Max</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr style="border-top-color: ${m} !important;">\n                                <th style="border-top-color: ${m} !important;">Pax:</th>\n                                <td>${o}</td>\n                                <td>${a}</td>\n                            </tr>\n                            <tr>\n                                <th>Nights:</th>\n                                <td>${i}</td>\n                                <td>${n}</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        `)},Z=function(){(function(){let e=$(i).valid(),t=isNaN(parseInt(p.value))?null:parseInt(p.value),n=isNaN(parseInt(g.value))?null:parseInt(g.value),a=isNaN(parseInt(m.value))?null:parseInt(m.value),o=isNaN(parseInt(_.value))?null:parseInt(_.value);return null!==t&&null!==n&&(parseInt(n)<parseInt(t)?(setError(g,"Pax is greater than minimum"),e=!1):clearError(g)),null!==a&&null!==o&&(parseInt(o)<parseInt(a)?(setError(_,"Pax is greater than minimum"),e=!1):clearError(_)),e})()&&confirmDialog("Would you like to update? This change may affect your Pricing Worksheets.",e=>{if(e){let e=function(){let e={id:isNaN(parseInt(s.value))?null:parseInt(s.value),product_id:isNaN(parseInt(a.value))?null:parseInt(a.value),category_id:isNaN(parseInt(n.value))?null:parseInt(n.value),min_pax:parseInt(p.value)?parseInt(p.value):null,max_pax:parseInt(g.value)?parseInt(g.value):null,min_nights:parseInt(m.value)?parseInt(m.value):null,max_nights:parseInt(_.value)?parseInt(_.value):null,api_id:null,name:c.value?c.value:null,room_code:u.value?u.value:null,blurb:null,cover_image:"",meeting_point:null,time_notes:null,start_time:null,end_time:null,description_short:f.value?f.value:null,description_long:y.value?y.value:null,enabled:!0===v.checked?1:0,keywords:M.build(),amenities:x.build()};return remove_nulls(e)}();X(e,function(e){if(e){let t=G(e[0]?e[0]:e);Unit.all.get(t.id)?Q.updateRow(t):Q.insertRow(t),J(t),Unit.all.set(t.id,t),PricingWorksheet.pricingWorksheet(),Pricing.resetForm(),YearCalendar.refresh(),ie(),j(),Q.clearSelectedRows(),d.value="",d.disabled=!1,c.disabled=!0,toastr.success(`Unit: ${t.name} - has been updated`,"Unit"),YearCalendar.endLoading()}})}})},X=function(e,t){if(e){let n="/api/v1.0/units/update";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){return V("Error")}}},ee=function(){s.disabled=!0,u.disabled=!0,m.disabled=!0,p.disabled=!0,c.disabled=!1,_.disabled=!1,g.disabled=!1,f.disabled=!1,y.disabled=!1,v.disabled=!1},te=function(e){let t=[];e&&(t=e,e.units&&(t=e.units)),$(document).ready(function(){i&&(C=isNaN(parseInt(n.value))?null:parseInt(n.value),$(d).on("click",function(){$(this).select()}).on("search",function(){Y=!1,ne(),ae()}).on("change",function(){setTimeout(function(){let e=d.value;!1===Y&&(""===e?(Y=!1,ne(),ae()):z(e))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/units",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",params:{category_id:C},onSelect:function(e){if(Q.clearSelectedRows(),!e||!e.data)return;let t,n=e.data,a=Unit.all.get(parseInt(n.id));a?(t=G(a),Q.loadRow(t)):t=G(n),le(t)}}),validator_init(U),Unit.validator=$(i).validate(),function(){let e=document.getElementById("category_id")&&!isNaN(parseInt(document.getElementById("category_id").value))?parseInt(document.getElementById("category_id").value):null;if(e){switch(e){case 1:F=null,T=1,R=null,q=1,L="Pax",D="Nights",P="Units";break;case 2:F=1,T=1,R=1,q=1,L="Pax",D="Days",P="Seat";break;case 3:F=null,T=1,R=null,q=1,L="Pax",D="Days",P="Units";break;case 4:case 5:F=null,T=1,R=null,q=1,L="Pax",D="Nights",P="Units";break;default:F=null,T=1,R=null,q=1,L="Pax",D="Nights",P="Units"}M=$(E).BuildKeyword([]),x=$(B).BuildKeyword([])}}()),N&&(Unit.unitImages=$("#unit_images").fileManager({height:400,source:"unit",images:[]})),d&&(1===(C=isNaN(parseInt(n.value))?null:parseInt(n.value))?(Unit.byValue="Night",Unit.paxValue="Pax"):(Unit.byValue="Day",Unit.paxValue="Pax"),Q=$(r).table({table_type:"display_list",data:[],columnDefs:[{title:"Room Code",targets:0,data:"room_code",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Min "+Unit.byValue+"(s)",targets:2,data:"min_nights",render:function(e,t,n,a){let i=1;return"<span style='white-space: nowrap;'>"+(i=null===e?"null":e)+"</span>"}},{title:"Max "+Unit.byValue+"(s)",targets:3,data:"max_nights",render:function(e,t,n,a){let i=1;return"<span style='white-space: nowrap;'>"+(i=null===e?"&infin;":e)+"</span>"}},{title:"Min "+Unit.paxValue,targets:4,data:"min_pax",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Max "+Unit.paxValue,targets:5,data:"max_pax",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Unit.edit}),function(e){console.log("Unit.loadAll(units)",e),Unit.all=new Map,e||(e=[]),$.each(e,function(e,t){console.log("|__ unit",t);let n=G(t);Q.insertRow(n),J(n),Unit.all.set(n.id,n)}),j()}(t)),l&&(ie(),j())})},ne=function(){console.log("Unit:clearForm()"),s.value="",c.value="",u.value="",m.value=1,_.value="",p.value=1,g.value="",f.value="",y.value="",v.checked=!0},ae=function(){console.log("Unit:hideForm()"),l&&($(l).hide(),d.disabled=!1,j())},ie=function(){console.log("Unit:resetForm()");let e,t,a,i,o,l,d,r,s,c,f,y,v,h,b=isNaN(parseInt(n.value))?null:parseInt(n.value);switch(ne(),ae(),b){case 1:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Nights:",i="Maximum Nights:",v="Room Code:",o=!1,l=!1,d=!1,r=!1,h=!1,s=1,c="",f=1,y="";break;case 2:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Days:",i="Maximum Days:",v="Seat Code:",s=1,c=1,f=1,y=1;break;case 3:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Days:",i="Maximum Days:",v="Unit Code:",s=1,c=1,f=1,y=1;break;case 4:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Days:",i="Maximum Days:",v="Seat Code:",s=1,c=1,f=1,y=1;break;default:e="Minimum Pax:",t="Maximum Pax:",a="Minimum Nights:",i="Maximum Nights:",o=!1,l=!1,d=!1,r=!1,s=1,c="",f=1,y=""}let I=document.getElementsByTagName("LABEL");for(let e=0;e<I.length;e++)if(""!==I[e].htmlFor){let t=document.getElementById(I[e].htmlFor);t&&(t.label=I[e])}m.value=f,_.value=y,p.value=s,g.value=c,m.label.innerHTML=a,_.label.innerHTML=i,p.label.innerHTML=e,g.label.innerHTML=t,u.label.innerHTML=v,m.disabled=d,_.disabled=r,p.disabled=o,g.disabled=l,x.clear(),M.clear()},oe=function(){l&&($('label[for="product_edit_unit_form_unit_min_nights"]').html(`Minimum ${D}`),$('label[for="product_edit_unit_form_unit_max_nights"]').html(`Maximum ${D}`),$('label[for="product_edit_unit_form_unit_min_pax"]').html(`Minimum ${L}`),$('label[for="product_edit_unit_form_unit_max_pax"]').html(`Maximum ${L}`),$(l).show(),d.disabled=!0)},le=function(e){if(ie(),e){let t=isNaN(parseInt(n.value))?null:parseInt(n.value),a=e.keywords?e.keywords:[],i=e.amenities?e.amenities:[];2===t||4===t?(m.value=e.min_nights?e.min_nights:1,_.value=e.max_nights?e.max_nights:1,p.value=e.min_pax?e.min_pax:1,g.value=e.max_pax?e.max_pax:1,m.disabled=!0,_.disabled=!0,p.disabled=!0,g.disabled=!0,u.disabled=!0):(m.value=e.min_nights?e.min_nights:1,_.value=e.max_nights?e.max_nights:null,p.value=e.min_pax?e.min_pax:1,g.value=e.max_pax?e.max_pax:null,m.disabled=!1,_.disabled=!1,p.disabled=!1,g.disabled=!1,u.disabled=!1),d.value=e.name?e.name:"",s.value=e.id?e.id:"",c.value=e.name?e.name:"",u.value=e.room_code?e.room_code:"",f.value=e.description_short?e.description_short:"",y.value=e.description_long?e.description_long:"",v.checked=!0,h.innerText=e.name?e.name:"",M.set(a),x.set(i)}oe()},de=function(){ee(),s.disabled=!0,c.disabled=!0,u.disabled=!0,v.disabled=!0,f.disabled=!1,y.disabled=!1};return{unitImages:null,all:new Map,byValue:"Night",paxValue:"Pax",validator:null,edit:function(e){!function(e){console.log("Unit.edit(unit)",e);let t=A&&A.id&&!isNaN(parseInt(A.id))?parseInt(A.id):null,n=e&&e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null;t&&n&&t===n||(A=e,le(e),Unit.unitImages.load({height:400,source:"unit",sourceId:e.id,images:e.images}),de())}(e)},init:function(e){te(e)}}}(),Address=function(){"use strict";const e=document.getElementById("button_add_address_table"),t=document.getElementById("button_close_edit_address_form"),n=document.getElementById("button_clear_form_edit_address"),a=document.getElementById("button_submit_form_edit_address"),i=document.getElementById("form_edit_address"),o=document.getElementById("card_edit_address_form"),l=document.getElementById("table_address"),d=document.getElementById("address_id"),r=document.getElementById("company_id"),s=document.getElementById("address_enabled"),c=document.getElementById("address_street_1"),u=document.getElementById("address_street_2"),m=document.getElementById("address_street_3"),_=document.getElementById("address_country_id"),p=document.getElementById("address_types_id"),g=document.getElementById("address_province_id"),f=document.getElementById("address_city_id"),y=document.getElementById("address_postal_code"),v=document.getElementById("address_company_id"),h=document.getElementById("clear_address_table");let b,I=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,w=$(l),E={},B={groups:{cityGroup:"address_country_id address_province_id address_city_id"},rules:{address_types_id:{required:!0},address_company_id:{required:!0},address_country_id:{required:!0},address_province_id:{required:!0},address_city_id:{required:!0}},messages:{address_company_id:{required:"Field Required"},address_types_id:{required:"Field Required"},address_country_id:{required:"Field Required"},address_province_id:{required:"Field Required"},address_city_id:{required:"Field Required"}}};$(e).on("click",function(){w.clearSelectedRows(),S(),D()}),$(n).on("click",function(){w.clearSelectedRows(),S()}),$(a).on("click",function(){let e=N();e&&confirmDialog("Would you like to update?",t=>{t&&k(e)})}),$(t).on("click",function(){w.clearSelectedRows(),S(),P()}),$(h).on("click",function(){Address.clearTable()});const k=function(e){e&&M(e,function(e){if(e&&e[0]){let t=e[0],n=T(t);Address.all.get(n.id)?w.updateRow(n):w.insertRow(n),Address.all.set(n.id,n),w.clearSelectedRows(),S(),P(),toastr.success("Address Updated")}})},N=function(){if(x()){let e={company_id:isNaN(parseInt(v.value))?null:parseInt(v.value),street_1:""!==c.value?c.value:null,street_2:""!==u.value?u.value:null,street_3:""!==m.value?m.value:null,postal_code:""!==y.value?y.value:null,country_id:isNaN(_.value)?null:parseInt(_.value),province_id:isNaN(g.value)?null:parseInt(g.value),city_id:isNaN(f.value)?null:parseInt(f.value),address_types_id:toNumbers(getListOfIds($(p).val())),enabled:!0===s.checked?1:0,id:isNaN(parseInt(d.value))?null:parseInt(d.value)};return remove_nulls(e)}},M=function(e,t){e&&sendPostRequest("/api/v1.0/addresses/update",e,function(e,n,a){return e?t(e):C("Oops: 1")})},x=function(){return $(i).valid()},C=function(e){toastr.error(e)},S=function(){d.value="",s.checked=!0,c.value="",u.value="",m.value="",y.value="",$(p).val([]),$(_).val("").trigger("change")},P=function(){o&&$(o).hide()},D=function(e){o&&(d.value="",v.value=r.value,$(p).val([]),s.checked=!0,c.value="",u.value="",m.value="",_.value="",g.value="",f.value="",y.value="",function(e){e&&(d.value=e.id?e.id:null,v.value=e.company_id?e.company_id:null,$(p).val(e.address_types_id?e.address_types_id:[]),s.checked=1===e.enabled,c.value=e.street_1?e.street_1:null,u.value=e.street_2?e.street_2:null,m.value=e.street_3?e.street_3:null,y.value=e.postal_code?e.postal_code:null,Province.id=e.province.id,Country.id=e.country.id,City.id=e.city.id,$(_).val(e.country.id?e.country.id:"").trigger("change"))}(e),$(o).show())},L=function(e){if(Address.all=new Map,!e)return;let t,n=0;$.each(e,function(e,a){let i=T(a);0===n&&(t=i),Address.all.set(i.id,i),w.insertRow(i),n++}),l&&(t&&w.loadRow(t),w.clearSelectedRows()),o&&(S(),P())},F=function(e){l&&($.fn.DataTable.isDataTable(l)||(w=$(l).table({table_type:"display_list",data:Array.from(Address.all.values()),columnDefs:[{title:"ID",targets:0,data:"id",render:function(e,t,n,a){return e}},{title:"Address",targets:1,data:"medium_address_formatted",render:function(e,t,n,a){return e}},{title:"Types",targets:2,data:"formatted_types",render:function(e,t,n,a){return e}}],rowClick:Address.navigate}))),e&&L(e),i&&(validator_init(B),b=$(i).validate(),$(_).BuildDropDown({data:Array.from(Country.all.values()),title:"Country",id_field:"id",text_field:"name",first_selectable:!1}),$(g).BuildDropDown({data:[],title:"Province",id_field:"id",text_field:"name",first_selectable:!1}),$(f).BuildDropDown({data:[],title:"City",id_field:"id",text_field:"name",first_selectable:!1}),Country.init({dropdowns:["address_country_id"]}),Province.init({dropdowns:["address_province_id"]}),City.init({dropdowns:["address_city_id"]}))},T=function(e){let t={id:null,company_id:null,street_1:null,street_2:null,street_3:null,postal_code:null,enabled:1,address_types_id:[],date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null,short_address_formatted:null,medium_address_formatted:null,long_address_formatted:null,country:{id:null,name:null,iso2:null,iso3:null,currency_id:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},province:{id:null,country_id:null,name:null,iso2:null,iso3:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},city:{id:null,province_id:null,name:null,sort_order:999,enabled:1,date_created:formatDateMySQL(),created_by:parseInt(I),date_modified:formatDateMySQL(),modified_by:parseInt(I),note:null},formatted_types:""};return e&&(t.country={id:parseInt(e.country.id?e.country.id:null),name:e.country.name?e.country.name:null,name_long:e.country.name_long?e.country.name_long:null,currency_id:parseInt(e.country.currency_id?e.country.currency_id:null),iso2:e.country.iso2?e.country.iso2:null,iso3:e.country.iso3?e.country.iso3:null,sort_order:parseInt(e.country.sort_order?e.country.sort_order:999),enabled:parseInt(e.country.enabled?e.country.enabled:1),date_created:e.country.date_created?e.country.date_created:formatDateMySQL(),created_by:parseInt(e.country.created_by?e.country.created_by:I),date_modified:e.country.date_modified?e.country.date_modified:formatDateMySQL(),modified_by:parseInt(e.country.modified_by?e.country.modified_by:I),note:e.country.note?e.country.note:null},t.province={id:parseInt(e.province.id?e.province.id:null),country_id:parseInt(e.country.id?e.country.id:null),name:e.province.name?e.province.name:null,iso2:e.province.iso2?e.province.iso2:null,iso3:e.province.iso3?e.province.iso3:null,sort_order:parseInt(e.province.sort_order?e.province.sort_order:999),enabled:parseInt(e.province.enabled?e.province.enabled:1),date_created:e.province.date_created?e.province.date_created:formatDateMySQL(),created_by:parseInt(e.province.created_by?e.province.created_by:I),date_modified:e.province.date_modified?e.province.date_modified:formatDateMySQL(),modified_by:parseInt(e.province.modified_by?e.province.modified_by:I),note:e.province.note?e.province.note:null},t.city={id:parseInt(e.city.id?e.city.id:null),province_id:parseInt(e.province.id?e.province.id:null),name:e.city.name?e.city.name:null,sort_order:parseInt(e.city.sort_order?e.city.sort_order:999),enabled:parseInt(e.city.enabled?e.city.enabled:1),date_created:e.city.date_created?e.city.date_created:formatDateMySQL(),created_by:parseInt(e.city.created_by?e.city.created_by:I),date_modified:e.city.date_modified?e.city.date_modified:formatDateMySQL(),modified_by:parseInt(e.city.modified_by?e.city.modified_by:I),note:e.city.note?e.city.note:null},t.id=parseInt(e.id?e.id:null),t.company_id=parseInt(e.company_id?e.company_id:null),t.address_types_id=getListOfIds(e.address_types_id),t.short_address_formatted=e.short_address_formatted?e.short_address_formatted:null,t.medium_address_formatted=e.medium_address_formatted?e.medium_address_formatted:null,t.long_address_formatted=e.long_address_formatted?e.long_address_formatted:null,t.street_1=e.street_1?e.street_1:null,t.street_2=e.street_2?e.street_2:null,t.street_3=e.street_3?e.street_3:null,t.postal_code=e.postal_code?e.postal_code:null,t.enabled=parseInt(e.enabled?e.enabled:1),t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=parseInt(e.created_by?e.created_by:I),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=parseInt(e.modified_by?e.modified_by:I),t.note=e.note?e.note:null,t.formatted_types=e.formatted_types?e.formatted_types:""),E=t,Address.detail=t,t},R=function(){let e=Array.from(Address.all.values());$.each(e,function(e,t){w.deleteRow(t)}),Address.all=new Map},q=function(e){e&&function(e,t){if(!e)return C("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/addresses",e,function(e,n,a){return e?t(e):C("Oops: 1")})}catch(e){return C("Error Validating Company")}}({company_id:e},function(e){if(e){let t=e;R(),function(e){if(l){let t;Address.all=new Map;let n=0;$.each(e,function(e,a){0===n&&(t=a),a.address_types_id=getListOfIds(a.address_types_id),Address.all.set(a.id,a),w.insertRow(a),n++}),l&&(t&&w.loadRow(t),w.clearSelectedRows())}}(t)}})};return{validator:null,detail:{},all:new Map,get_by_company_id:function(e){q(e)},get:function(e){},navigate:function(e){!function(e){e&&D(e)}(e)},load_all:function(e){L(e)},save:function(e){k(e)},clearTable:function(){R()},init:function(e){F(e)}}}(),Register=function(){"use strict";return{init:function(e){}}}();$.fn.DisabledDOW=function(e){"use strict";let t=this.attr("id"),n="Disabled DOW",a=t+"_";e&&(e.name&&""!==e.name&&(a=e.name),e&&e.label&&""!==e.label&&(n=e.label));const i=document.getElementById(t),o=$(i);o.on("change",function(){});const l=function(){let e=Array.from(s.days_of_week.values()),t=document.createElement("div");return t.classList.add("col-12"),t.classList.add("col-md-10"),t.classList.add("px-1"),$.each(e,function(e,n){let a=function(){let e=document.createElement("div");return e.classList.add("custom-control"),e.classList.add("custom-checkbox"),e.classList.add("custom-control-inline"),e}(),i=function(e){let t=document.createElement("label");return t.classList.add("custom-control-label"),t.htmlFor=e.for,t.innerText=e.label,t}(n),o=function(e){let t=document.createElement("input");return t.type="checkbox",t.classList=e.class,t.id=e.for,t.name=e.for,t.value=e.value,t.addEventListener("click",e=>{let n=t.id?t.id:"";r(t,n)}),t}(n);a.appendChild(o),a.appendChild(i),t.appendChild(a)}),t},d=function(){$.each(Array.from(s.days_of_week.values()),function(e,t){document.getElementById(t.for).checked=!1}),$.each(s.disabled_dows,function(e,t){let n="number"==typeof t?t.toString():t,a=s.days_of_week.get(n);a&&a.for&&(document.getElementById(a.for).checked=!0)}),7===s.disabled_dows.length&&(document.getElementById(a+"dow_select_all").checked=!0)},r=function(e,t){let n,i;switch(t){case a+"dow_select_all":!0===e.checked?s.disabled_dows=[0,1,2,3,4,5,6]:s.disabled_dows=[],s.disabled_dows.sort();break;case a+"dow_select_sun":n=0,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_mon":n=1,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_tue":n=2,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_wed":n=3,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_thu":n=4,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_fri":n=5,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort();break;case a+"dow_select_sat":n=6,i=s.disabled_dows.indexOf(n),!0===e.checked?!i>-1&&s.disabled_dows.push(n):i>-1&&s.disabled_dows.splice(i,1),s.disabled_dows.sort()}d()},s={days_of_week:[],disabled_dows:[],el:null,value:function(e){},els:[],init:function(e){!function(e){let t=[];if(e){if(e===[]||null===e||""===e)return s.disabled_dows=[],[];t="string"==typeof e?getListOfIds(e.replace(/\s/g,"")):e}s.disabled_dows=t,d()}(e)}};return function(){o.empty(),s.days_of_week=new Map,s.days_of_week.set("*",{label:"All",for:a+"dow_select_all",value:"*",class:"custom-control-input dow_select"}),s.days_of_week.set("0",{label:"Sun",for:a+"dow_select_sun",value:0,class:"custom-control-input dow_select"}),s.days_of_week.set("1",{label:"Mon",for:a+"dow_select_mon",value:1,class:"custom-control-input dow_select"}),s.days_of_week.set("2",{label:"Tue",for:a+"dow_select_tue",value:2,class:"custom-control-input dow_select"}),s.days_of_week.set("3",{label:"Wed",for:a+"dow_select_wed",value:3,class:"custom-control-input dow_select"}),s.days_of_week.set("4",{label:"Thu",for:a+"dow_select_thu",value:4,class:"custom-control-input dow_select"}),s.days_of_week.set("5",{label:"Fri",for:a+"dow_select_fri",value:5,class:"custom-control-input dow_select"}),s.days_of_week.set("6",{label:"Sat",for:a+"dow_select_sat",value:6,class:"custom-control-input dow_select"});let e=function(){let e=document.createElement("div");return e.classList="row",e}(),t=function(){let e=document.createElement("div"),t=document.createElement("label");return t.innerText=n+":",e.classList.add("col-12"),e.classList.add("col-md-2"),e.classList.add("px-1"),e.appendChild(t),e}(),d=l();e.appendChild(t),e.appendChild(d),i.appendChild(e)}(),s};const ColorScheme=function(){"use strict";document.getElementById("product_edit_season_id");const e=document.getElementById("season_id"),t=document.getElementById("edit_scheme"),n=(document.getElementById("form_edit_scheme"),document.getElementById("product_edit_season_id_name_display")),a=document.getElementById("button_close_edit_scheme");let i;$(a).on("click",function(){$(t).hide()}),$(e).on("click",function(){$(t).show()});const o=function(e){var t;e&&e.swatches&&(t=e.swatches,ColorScheme.all=new Map,t&&$.each(t,function(e,t){ColorScheme.all.set(parseInt(t.id),t)})),(i=document.querySelectorAll(".season_toggle_item")).forEach(e=>e.addEventListener("click",t=>{let n=parseInt(e.dataset.colorschemeid),a=ColorScheme.all.get(n);a&&l(a)}))},l=function(e){if(e){let t=e.background_color?e.background_color:null,a=e.border_color?e.border_color:null,i=parseInt(e.id),o=e.text_color?e.text_color:null,l=e.name?e.name:null,d=document.querySelector("#product_edit_season_id");$(n).text(`\n                    ${l}\n                `),$("a.dropdown-item.season_toggle_item").removeClass("active"),$(`a#${i}`).addClass("active"),d.style.setProperty("color",o,"important"),d.style.setProperty("background-color",t,"important"),d.style.setProperty("border-color",a,"important")}},d=function(){let e=document.querySelector("#product_edit_season_id");$(e).addClass("disabled")};return{all:new Map,disable:function(){d()},enable:function(){!function(){let e=document.querySelector("#product_edit_season_id");$(e).removeClass("disabled")}()},load:function(e){l(e)},edit:function(e){!function(e){$(".color_scheme_block").removeClass("active"),$(e).addClass("active")}(e)},change:function(e){},init:function(e){o(e),d()}}}();$.fn.ColorScheme=function(e){};const Car=function(){"use strict";const e=document.getElementById("category_id");let t,n;return{id:null,detail:{id:null,province_id:null,country_id:null,created_by:null,modified_by:null,sort_order:null,name:null,enabled:null,date_created:null,date_modified:null,note:null},all:new Map,init:function(a){!function(a){console.log("Car.init(settings)",a),t=isNaN(parseInt(e.value))?null:parseInt(e.value),n=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4}(a)}}}(),Airport=function(){"use strict";const t=document.getElementById("product_edit_location_section"),n=document.getElementById("category_id"),a=document.getElementById("modal_product_depart_from_airport_cancel_button"),i=document.getElementById("modal_product_depart_from_airport_submit_button"),o=document.getElementById("modal_product_depart_from_airport_iata_code"),l=document.getElementById("modal_product_depart_from_airport_country_id"),d=document.getElementById("modal_product_depart_from_airport_province_id"),r=document.getElementById("modal_product_depart_from_airport_city_id"),s=document.getElementById("modal_product_depart_from_airport_city"),c=document.getElementById("modal_product_depart_from_airport"),u=document.getElementById("modal_product_depart_from_airport_id"),m=document.getElementById("modal_product_depart_from_airport_add_block"),_=document.getElementById("modal_product_depart_from_airport_types_id"),p=document.getElementById("modal_product_depart_from_new_airport_id"),g=document.getElementById("modal_product_arrive_to_airport_cancel_button"),f=document.getElementById("modal_product_arrive_to_new_airport_id"),y=document.getElementById("modal_product_arrive_to_airport_submit_button"),v=document.getElementById("modal_product_arrive_to_airport_iata_code"),h=document.getElementById("modal_product_arrive_to_airport_country_id"),b=document.getElementById("modal_product_arrive_to_airport_province_id"),I=document.getElementById("modal_product_arrive_to_airport_city_id"),w=document.getElementById("modal_product_arrive_to_airport_city"),E=document.getElementById("modal_product_arrive_to_airport"),B=document.getElementById("modal_product_arrive_to_airport_id"),k=document.getElementById("modal_product_arrive_to_airport_add_block"),N=document.getElementById("modal_product_arrive_to_airport_types_id"),M=(document.getElementById("modal_product_location_id"),document.getElementById("modal_product_street_1"),document.getElementById("modal_product_street_2"),document.getElementById("modal_product_postal_code"),document.getElementById("modal_product_province_id")),x=document.getElementById("modal_product_country_id"),C=document.getElementById("modal_product_city_id"),S=document.getElementById("product_edit_location_city_id"),P=document.getElementById("product_location_departing_airport_form"),D=document.getElementById("product_location_departing_airport_search"),L=document.getElementById("product_location_departing_airport_id"),F=document.getElementById("product_location_departing_airport_airport_types_id"),T=document.getElementById("product_location_departing_airport_city_id"),R=document.getElementById("product_location_departing_airport_name"),q=document.getElementById("product_location_departing_airport_iata_code"),A=document.getElementById("product_location_departing_airport_edit_button"),O=(document.getElementById("product_location_departing_airport_gps_code"),document.getElementById("product_location_departing_airport_local_code"),document.getElementById("product_location_departing_airport_home_link")),Q=document.getElementById("product_location_departing_airport_wikipedia_link"),Y=(document.getElementById("product_location_departing_airport_scheduled_service"),document.getElementById("product_location_departing_airport_keywords"),document.getElementById("product_location_departing_airport_enabled")),U=(document.getElementById("product_location_departing_airport_date_created"),document.getElementById("product_location_departing_airport_created_by"),document.getElementById("product_location_departing_airport_date_modified"),document.getElementById("product_location_departing_airport_modified_by"),document.getElementById("product_location_departing_airport_note"),document.getElementById("product_location_departing_airport_city_search")),W=document.getElementById("product_location_departing_airport_remove_button"),j=document.getElementById("product_location_departing_airport_clear_button"),z=document.getElementById("product_location_departing_airport_save_button"),V=document.getElementById("product_location_arriving_airport_edit_button"),H=document.getElementById("product_location_arriving_airport_form"),G=document.getElementById("product_location_arriving_airport_search"),K=document.getElementById("product_location_arriving_airport_id"),J=document.getElementById("product_location_arriving_airport_airport_types_id"),Z=document.getElementById("product_location_arriving_airport_city_id"),X=document.getElementById("product_location_arriving_airport_name"),ee=document.getElementById("product_location_arriving_airport_iata_code"),te=(document.getElementById("product_location_arriving_airport_gps_code"),document.getElementById("product_location_arriving_airport_local_code"),document.getElementById("product_location_arriving_airport_home_link")),ne=document.getElementById("product_location_arriving_airport_wikipedia_link"),ae=(document.getElementById("product_location_arriving_airport_scheduled_service"),document.getElementById("product_location_arriving_airport_keywords"),document.getElementById("product_location_arriving_airport_enabled")),ie=(document.getElementById("product_location_arriving_airport_date_created"),document.getElementById("product_location_arriving_airport_created_by"),document.getElementById("product_location_arriving_airport_date_modified"),document.getElementById("product_location_arriving_airport_modified_by"),document.getElementById("product_location_arriving_airport_note"),document.getElementById("product_location_arriving_airport_city_search")),oe=document.getElementById("product_location_arriving_airport_remove_button"),le=document.getElementById("product_location_arriving_airport_clear_button"),de=document.getElementById("product_location_arriving_airport_save_button"),re=document.getElementById("modal_product_arrive_to_airport_postal_code"),se=document.getElementById("modal_product_arrive_to_airport_street_1"),ce=document.getElementById("modal_product_arrive_to_airport_street_2"),ue=document.getElementById("modal_product_depart_from_airport_postal_code"),me=document.getElementById("modal_product_depart_from_airport_street_1"),_e=document.getElementById("modal_product_depart_from_airport_street_2");document.getElementById("user_id")&&(isNaN(parseInt(document.getElementById("user_id").value))||parseInt(document.getElementById("user_id").value));let pe={groups:{locationGroup:"product_location_departing_airport_city_search product_location_departing_airport_city_id"},rules:{product_location_departing_airport_name:{required:!0},product_location_departing_airport_iata_code:{required:!0},product_location_departing_airport_airport_types_id:{required:!0},product_location_departing_airport_city_search:{required:!0},product_location_departing_airport_city_id:{required:!0},product_location_departing_airport_home_link:{url:!0},product_location_departing_airport_wikipedia_link:{url:!0}},messages:{product_location_departing_airport_name:{required:"Field Required"},product_location_departing_airport_iata_code:{required:"Field Required"},product_location_departing_airport_airport_types_id:{required:"Field Required"},product_location_departing_airport_city_search:{required:"Field Required"},product_location_departing_airport_city_id:{required:"Field Required"},product_location_departing_airport_home_link:{url:"Field Invalid"},product_location_departing_airport_wikipedia_link:{url:"Field Invalid"}}},ge={groups:{locationGroup:"product_location_arriving_airport_city_search product_location_arriving_airport_city_id"},rules:{product_location_arriving_airport_name:{required:!0},product_location_arriving_airport_iata_code:{required:!0},product_location_arriving_airport_airport_types_id:{required:!0},product_location_arriving_airport_city_search:{required:!0},product_location_arriving_airport_city_id:{required:!0},product_location_arriving_airport_home_link:{url:!0},product_location_arriving_airport_wikipedia_link:{url:!0}},messages:{product_location_arriving_airport_name:{required:"Field Required"},product_location_arriving_airport_iata_code:{required:"Field Required"},product_location_arriving_airport_airport_types_id:{required:"Field Required"},product_location_arriving_airport_city_search:{required:"Field Required"},product_location_arriving_airport_city_id:{required:"Field Required"},product_location_arriving_airport_home_link:{url:"Field Invalid"},product_location_arriving_airport_wikipedia_link:{url:"Field Invalid"}}},fe=!1,ye=!1;$(A).on("click",function(){D.disabled=!0,Ee("depart_from"),we("arrive_to")}),$(V).on("click",function(){G.disabled=!0,Ee("arrive_to"),we("depart_from")}),$(W).on("click",function(){let e=Airport.departingAirport;Ne(e,"depart_from"),we("depart_from"),clearValidation(P)}),$(oe).on("click",function(){let e=Airport.arrivingAirport;Ne(e,"arrive_to"),we("arrive_to"),clearValidation(H)}),$(j).on("click",function(){ke("depart_from")}),$(le).on("click",function(){ke("arrive_to")}),$(z).on("click",function(){Se("depart_from")}),$(de).on("click",function(){Se("arrive_to")}),$(m).on("change",function(){ve()}).on("keyup",function(){ve()}),$(a).on("click",function(){be("depart_from")}),$(g).on("click",function(){be("arrive_to")}),$(i).on("click",function(){Pe("depart_from")}),$(y).on("click",function(){Pe("arrive_to")});const ve=function(){let e=!0;return""===o.value?($(o).showError("Field Required"),e=!1):$(o).hideError(),""===_.value?($(_).showError("Field Required"),e=!1):$(_).hideError(),isNaN(parseInt(r.value))?($(s).showError("Field Required"),e=!1):$(s).hideError(),e},he=function(e){if(m&&k&&e)if("depart_from"===e){if(ve()){let e=me&&""!==me.value?me.value:null,t=_e&&""!==_e.value?_e.value:null,n=ue&&""!==ue.value?ue.value:null,a={airport_types_id:isNaN(parseInt(_.value))?null:parseInt(_.value),city_id:isNaN(parseInt(r.value))?null:parseInt(r.value),name:""!==c.value?c.value:null,street_1:e,street_2:t,postal_code:n,iata_code:""!==o.value?o.value:null};return removeNulls(a)}}else if("arrive_to"===e&&function(){let e=!0;return""===v.value?($(v).showError("Field Required"),e=!1):$(v).hideError(),""===N.value?($(N).showError("Field Required"),e=!1):$(N).hideError(),isNaN(parseInt(I.value))?($(w).showError("Field Required"),e=!1):$(w).hideError(),e}()){let e=se&&""!==se.value?se.value:null,t=ce&&""!==ce.value?ce.value:null,n=re&&""!==re.value?re.value:null,a={airport_types_id:isNaN(parseInt(N.value))?null:parseInt(N.value),city_id:isNaN(parseInt(I.value))?null:parseInt(I.value),name:""!==E.value?E.value:null,street_1:e,street_2:t,postal_code:n,iata_code:""!==v.value?v.value:null};return removeNulls(a)}},be=function(e){m&&k&&(Ie(e),we(e))},Ie=function(e){m&&k&&e&&("depart_from"===e?(o.value="",s.value="",r.value="",l.value="",d.value="",r.value="",_.value="",ue.value="",me.value="",_e.value="",c.disabled=!1,clearAllValidation()):"arrive_to"===e&&(v.value="",w.value="",I.value="",h.value="",b.value="",I.value="",N.value="",re.value="",se.value="",ce.value="",E.disabled=!1,clearAllValidation()))},$e=function(e){m&&k&&e&&(E.disabled=!1,c.disabled=!1,Ie(e),we("depart_from"),we("arrive_to"))},we=function(e){m&&k&&e&&("depart_from"===e?$(m).hide():"arrive_to"===e&&$(k).hide()),t&&e&&("depart_from"===e&&P&&($(P).hide(),D.disabled=!1),"arrive_to"===e&&H&&($(H).hide(),G.disabled=!1))},Ee=function(e){m&&k&&e&&("depart_from"===e?(c.disabled=!0,$(m).show(),$(k).hide()):"arrive_to"===e&&(E.disabled=!0,$(k).show(),$(m).hide())),t&&e&&("depart_from"===e&&P&&($(P).show(),D.disabled=!0),"arrive_to"===e&&H&&($(H).show(),G.disabled=!0))},Be=function(){D&&$(D).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){L&&(L.value=""),D&&(D.value=""),ke("depart_from")}).on("keyup",function(){fe=!1}).on("change",function(){setTimeout(function(){let e=D.value;!1===fe&&(""===e?(D.value="",L.value="",fe=!1):Me(e,"depart_from"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;fe=!0;let t=e.data;t&&(Ne(t,"depart_from"),L&&(L.value=t.id),T&&(T.value=t.city.id,S.value=t.city.id),D&&(D.value=e.value))}}),G&&$(G).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){L&&(L.value=""),D&&(D.value=""),ke("arrive_to")}).on("keyup",function(){fe=!1}).on("change",function(){}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;fe=!0;let t=e.data;t&&(Ne(t,"arrive_to"),K&&(K.value=t.id),Z&&(Z.value=t.city.id),G&&(G.value=e.value))}}),c&&$(c).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("search",function(){u&&(u.value=""),c&&(c.value=""),x&&(x.value=""),M&&(M.value=""),C&&(C.value="")}).on("keyup",function(){fe=!1}).on("change",function(){setTimeout(function(){let e=c.value;!1===fe&&(""===e?(c.value="",u.value="",x&&(x.value=""),M&&(M.value=""),C&&(C.value=""),fe=!1):Me(e,"depart_from"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;fe=!0;let t=e.data;if(console.log("|__ airport",t),t){let e=isNaN(parseInt(t.country.id))?null:parseInt(t.country.id),n=isNaN(parseInt(t.province.id))?null:parseInt(t.province.id),a=isNaN(parseInt(t.city.id))?null:parseInt(t.city.id);c&&(c.value=t.name?t.name:""),u&&(u.value=isNaN(parseInt(t.id))?"":parseInt(t.id)),x&&(x.value=e),M&&(M.value=n),C&&(C.value=a)}else $e("depart_from"),Ee("depart_from")}}),E&&$(E).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).on("keyup",function(){ye=!1}).on("search",function(){B&&(B.value=""),E&&(E.value="")}).on("change",function(){setTimeout(function(){let e=E.value;!1===ye&&(""===e?(E.value="",B.value="",ye=!1):Me(e,"arrive_to"))},200)}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/airports",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;ye=!0;let t=e.data;t?(E&&(E.value=t.name?t.name:""),B&&(B.value=isNaN(parseInt(t.id))?"":parseInt(t.id))):($e("arrive_to"),Ee("arrive_to"))}})},ke=function(e){e&&("depart_from"===e&&(F.value="",R.value="",T.value="",D.value="",L.value="",O.value="",Q.value="",U.value="",Y.checked=!0,q.value="",W.disabled=!0,z.disabled=!0,j.disabled=!0,S.value=""),"arrive_to"===e&&(J.value="",X.value="",Z.value="",G.value="",K.value="",te.value="",ne.value="",ie.value="",ae.checked=!0,ee.value="",oe.disabled=!0,de.disabled=!0,le.disabled=!0))},Ne=function(e,t){if(t&&(ke(t),e&&e.city)){e.city.name,e.province.name,e.country.name;let n=`${e.city.name} (${e.province.name}, ${e.country.name})`,a=(e.city.name,e.province.name,e.country.name,"");if(a=e.name&&e.iata_code?`${e.iata_code} - ${e.name}`:e.name&&!e.iata_code?`${e.name}`:!e.name&&e.iata_code?`${e.iata_code}`:"Airport Name","depart_from"===t){let t=isNaN(parseInt(e.city.id))?null:parseInt(e.city.id);F.value=e.airport_types_id?e.airport_types_id:"",R.value=e.name?e.name:null,T.value=isNaN(parseInt(e.city.id))?null:parseInt(e.city.id),D.value=a,L.value=isNaN(parseInt(e.id))?null:parseInt(e.id),O.value=e.home_link?e.home_link:null,Q.value=e.wikipedia_link?e.wikipedia_link:null,Y.checked=e.enabled&&1===e.enabled,q.value=e.iata_code?e.iata_code:null,W.disabled=!1,z.disabled=!1,j.disabled=!1,S.value=t,U.value=n}"arrive_to"===t&&(J.value=e.airport_types_id?e.airport_types_id:"",X.value=e.name?e.name:null,Z.value=isNaN(parseInt(e.city.id))?null:parseInt(e.city.id),G.value=a,K.value=isNaN(parseInt(e.id))?null:parseInt(e.id),te.value=e.home_link?e.home_link:null,ne.value=e.wikipedia_link?e.wikipedia_link:null,ae.checked=e.enabled&&1===e.enabled,ee.value=e.iata_code?e.iata_code:null,oe.disabled=!1,de.disabled=!1,le.disabled=!1,ie.value=n)}},Me=function(e,t){if(e&&""!==e){xe({name:e},function(n){let a=null;if(n&&(a=n,n[0]&&(a=n[0])),a&&a.id)if(console.log("|__ airport",a),"depart_from"===t){let e=a.name?a.name:null,t=isNaN(parseInt(a.id))?null:parseInt(a.id),n=isNaN(parseInt(a.country.id))?null:parseInt(a.country.id),i=isNaN(parseInt(a.province.id))?null:parseInt(a.province.id),o=isNaN(parseInt(a.city.id))?null:parseInt(a.city.id);fe=!0,c&&(c.value=e),u&&(u.value=t),x&&(x.value=n),M&&(M.value=i),C&&(C.value=o)}else ye=!0,E.value=a.name,B.value=a.id;else confirmDialog(`The airport: ${e} does not exist exists. Would you like to create it?`,e=>{e?("depart_from"===t?fe=!1:ye=!1,function(e,t){m&&k&&(Ie(t),Ee(t))}(0,t)):"depart_from"===t?(x&&(x.value=""),M&&(M.value=""),C&&(C.value=""),u&&(u.value=""),c&&(c.value="")):(B&&(B.value=""),E&&(E.value=""))})})}},xe=function(e,t){if(e)try{sendGetRequest("/api/v1.0/airports/validate",e,function(e,n,a){if(e)return t(e);Ce("Oops: 1")})}catch(e){Ce("Error Validating Airport")}else Ce("Error Loading Airport - Missing Data")},Ce=function(e){toastr.error(e)},Se=function(e){(function(e){if(e){if("depart_from"===e)return $(P).valid();if("arrive_to"===e)return $(H).valid()}})(e)&&confirmDialog("Would you like to update?",t=>{t&&function(e,t){if(console.log("Airport.sendUpdateRequest(dataToSend)",e),e){let n="/api/v1.0/airports/update";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){}}}(function(e){console.log("Airport.buildAirportUpdateRecord(type)",e);let t={};if(e)if("depart_from"===e){let e=me&&""!==me.value?me.value:null,n=_e&&""!==_e.value?_e.value:null,a=ue&&""!==ue.value?ue.value:null;t.id=isNaN(parseInt(L.value))?null:parseInt(L.value),t.airport_types_id=isNaN(parseInt(F.value))?null:parseInt(F.value),t.city_id=isNaN(parseInt(T.value))?null:parseInt(T.value),t.name=""===R.value?null:R.value,t.iata_code=""===q.value?null:q.value,t.home_link=""===O.value?null:O.value,t.wikipedia_link=""===Q.value?null:Q.value,t.enabled=!0===Y.checked?1:0,t.street_1=e,t.street_2=n,t.postal_code=a}else if("arrive_to"===e){let e=se&&""!==se.value?se.value:null,n=ce&&""!==ce.value?ce.value:null,a=re&&""!==re.value?re.value:null;t.id=isNaN(parseInt(K.value))?null:parseInt(K.value),t.airport_types_id=isNaN(parseInt(J.value))?null:parseInt(J.value),t.city_id=isNaN(parseInt(Z.value))?null:parseInt(Z.value),t.name=""===X.value?null:X.value,t.iata_code=""===ee.value?null:ee.value,t.home_link=""===te.value?null:te.value,t.wikipedia_link=""===ne.value?null:ne.value,t.enabled=!0===ae.checked?1:0,t.street_1=e,t.street_2=n,t.postal_code=a}return t}(e),function(e){let t;if(e){t=e,e[0]&&(t=e[0]);let n=t.name?t.name:null;toastr.success(`Airport ${n} has been updated`,"Airport Updated")}})})},Pe=function(e){if(e){let t=he(e);t&&confirmDialog("Would you like to update?",n=>{n&&function(e,t){if(e){let n="/api/v1.0/airports/update";try{sendPostRequest(n,e,function(e){if(e)return t(e);Ce("Oops: 1")})}catch(e){console.log("error",e)}}}(t,function(t){let n;t&&(n=t,t[0]&&(n=t[0])),n&&("depart_from"===e&&(c&&(c.value=n.name?n.name:""),p&&(p.value=isNaN(parseInt(n.id))?"":parseInt(n.id)),u&&(u.value=isNaN(parseInt(n.id))?"":parseInt(n.id)),x&&(x.value=isNaN(parseInt(n.country.id))?"":parseInt(n.country.id)),M&&(M.value=isNaN(parseInt(n.province.id))?"":parseInt(n.province.id)),C&&(C.value=isNaN(parseInt(n.city.id))?"":parseInt(n.city.id))),"arrive_to"===e&&(E&&(E.value=n.name?n.name:""),f&&(f.value=isNaN(parseInt(n.id))?"":parseInt(n.id)),B&&(B.value=isNaN(parseInt(n.id))?"":parseInt(n.id))),$e(e),Be())})})}};return{airportDepartValidator:null,airportArriveValidator:null,arrivingAirport:null,departingAirport:null,resetAirportForm:function(e){$e(e)},init:function(e){!function(e){$(document).ready(function(){if((c||E)&&(Be(),$e("depart_from"),$e("arrive_to")),e){console.log("|__ settings",e);let a=n&&!isNaN(parseInt(n.value))?parseInt(n.value):null;if(t&&2===a){if(Be(),ke("depart_from"),ke("arrive_to"),e.product){let t=e.product;if(t.arriving_location){Airport.arrivingAirport=t.arriving_location;let e=t.arriving_location;Ne(e,"arrive_to")}else Airport.arrivingAirport=null;if(t.departing_location){let e=t.departing_location;Airport.departingAirport=t.departing_location,Ne(e,"depart_from")}else Airport.departingAirport=null}initializeValidator(pe),Airport.airportDepartValidator=$(P).validate(),initializeValidator(ge),Airport.airportArriveValidator=$(H).validate()}}we("depart_from"),we("arrive_to")})}(e)}}}(),AirportTypes=function(){"use strict";document.getElementById("input_airport_types_id"),document.getElementById("input_airport_types_name"),document.getElementById("input_airport_types_sort_order"),document.getElementById("input_airport_types_enabled"),document.getElementById("input_airport_types_date_created"),document.getElementById("input_airport_types_created_by"),document.getElementById("input_airport_types_date_modified"),document.getElementById("input_airport_types_modified_by"),document.getElementById("input_airport_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),AirportTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,AirportTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);AirportTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),Category=function(){"use strict";const e=document.getElementById("modal_product_category_id"),t=document.getElementById("modal_product_provider_company_id"),n=document.getElementById("modal_product_provider_location_id"),a=document.getElementById("modal_product_location_id"),i=document.getElementById("modal_product_vendor_company_id"),o=document.getElementById("modal_product_city"),l=document.getElementById("modal_product_country_cars"),d=document.getElementById("modal_product_name"),r=document.getElementById("modal_product_sku"),s=document.getElementById("modal_product_vendor_name"),c=document.getElementById("modal_product_provider_id"),u=document.getElementById("modal_product_vendor_id"),m=document.getElementById("modal_product_rating_types_id"),_=document.getElementById("modal_product_currency_id"),p=document.getElementById("modal_product_pricing_strategies_types_id"),g=document.getElementById("modal_product_city_id"),f=document.getElementById("modal_product_country_id"),y=document.getElementById("modal_product_province_id");let v=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(e).on("change",function(){let e=$(this).val();h(e)});const h=function(e){let v;if(console.log("Category.handleProductChange(categoryId)",e),$("div[data-categoryid]").hide(),e&&(e=parseInt(e),(v=Types.category.get(parseInt(e)))&&(Product.resetNewProductDetails(),Product.initAutoComplete(e),Product.attr1=v.attribute_id,Product.attr2=null,Product.attr3=null,Product.updateProductSKU(),e&&!isNaN(parseInt(e)))))switch(parseInt(e)){case 1:l&&(l.value=""),p&&(p.value=""),s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!1,d.disabled=!1,_.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='1']").show();break;case 2:p.value="2",s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!0,d.disabled=!1,_.disabled=!1,p.disabled=!0,r.disabled=!0,$("div[data-categoryid='2']").show();break;case 3:p.value="3",s.value="",s.value="",l&&(l.value=""),f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!0,d.disabled=!1,_.disabled=!1,p.disabled=!0,r.disabled=!0,$("div[data-categoryid='3']").show(),Country.initAutocomplete();break;case 4:p.value="2",s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!0,d.disabled=!1,_.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='4']").show();break;case 5:p.value="",s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!1,d.disabled=!1,_.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='5']").show();break;case 6:p.value="2",s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!0,d.disabled=!1,_.disabled=!1,p.disabled=!0,r.disabled=!0,$("div[data-categoryid='6']").show();break;case 7:s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!1,d.disabled=!1,_.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='7']").show();break;case 8:s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!1,d.disabled=!1,_.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='8']").show();break;case 9:s.value="",s.value="",f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),l&&(l.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",_.value="",o.disabled=!1,m.disabled=!1,d.disabled=!1,_.disabled=!1,p.disabled=!1,r.disabled=!0,$("div[data-categoryid='9']").show();break;default:s.value="",s.value="",l&&(l.value=""),f&&(f.value=""),y&&(y.value=""),g&&(g.value=""),c.value="",t.value="",n.value="",a.value="",u.value="",i.value="",m.value="",r.value="",o.disabled=!0,m.disabled=!0,d.disabled=!0,_.disabled=!0,p.disabled=!0,r.disabled=!0,r.disabled=!0,o.disabled=!0,m.disabled=!0,p.disabled=!0}},b=function(e){let t={category_id:1,name:null,last_update:null,id:null,pricing_strategy_types_id:null,color_scheme_id:null,icon:null,view_product_index:1,view_product_index_filter:1,view_product_index_search:1,view_product_edit:1,view_product_package_edit:1,view_product_package_index:1,all_day:1,overlap:1,editable:1,duration_editable:1,start_editable:1,display:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:v,date_modified:formatDateMySQL(),modified_by:v,note:null};return e&&(t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.last_update=e.last_update?e.last_update:null,t.id=e.id?e.id:null,t.pricing_strategy_types_id=e.pricing_strategy_types_id?e.pricing_strategy_types_id:null,t.color_scheme_id=e.color_scheme_id?e.color_scheme_id:null,t.name=e.name?e.name:null,t.icon=e.icon?e.icon:null,t.view_product_index=e.view_product_index?e.view_product_index:1,t.view_product_index_filter=e.view_product_index_filter?e.view_product_index_filter:1,t.view_product_index_search=e.view_product_index_search?e.view_product_index_search:1,t.view_product_edit=e.view_product_edit?e.view_product_edit:1,t.view_product_package_edit=e.view_product_package_edit?e.view_product_package_edit:1,t.view_product_package_index=e.view_product_package_index?e.view_product_package_index:1,t.all_day=e.all_day?e.all_day:1,t.overlap=e.overlap?e.overlap:1,t.editable=e.editable?e.editable:1,t.duration_editable=e.duration_editable?e.duration_editable:1,t.start_editable=e.start_editable?e.start_editable:1,t.display=e.display?e.display:null,t.sort_order=e.sort_order?e.sort_order:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:created_by,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:modified_by,t.note=e.note?e.note:null,t.seasons=e.seasons?e.seasons:[]),Category.detail=t,t},I=function(e){console.log("Category.loadAll(categories)",e),Category.all=new Map,e&&$.each(e,function(e,t){let n=b(t);Category.all.set(n.id,n)})};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){I(e)},save:function(e){},init:function(e){!function(e){console.log("Category.init()",e);let t=[];e&&e.categories&&(t=e.categories),I(t)}(e)}}}(),ContactTypes=function(){"use strict";document.getElementById("input_contact_types_id"),document.getElementById("input_contact_types_name"),document.getElementById("input_contact_types_sort_order"),document.getElementById("input_contact_types_enabled"),document.getElementById("input_contact_types_date_created"),document.getElementById("input_contact_types_created_by"),document.getElementById("input_contact_types_date_modified"),document.getElementById("input_contact_types_modified_by"),document.getElementById("input_contact_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),ContactTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,ContactTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);ContactTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),Company=function(){"use strict";document.getElementById("product_edit_page");const e=document.getElementById("button_save_provider"),t=document.getElementById("form_edit_company"),n=(document.getElementById("company_enabled"),document.getElementById("company_name")),a=document.getElementById("company_phone_1"),i=document.getElementById("company_phone_2"),o=document.getElementById("company_fax"),l=document.getElementById("company_email"),d=document.getElementById("company_website"),r=document.getElementById("button_submit_form_edit_company"),s=document.getElementById("company_cover_image"),c=document.getElementById("address_company_id"),u=document.getElementById("company_id"),m=document.getElementById("contact_company_id"),_=document.getElementById("form_edit_company_block"),p=document.getElementById("button_edit_company_name"),g=document.getElementById("button_cancel_edit_company_name"),f=document.getElementById("button_close_edit_company_form"),y=document.getElementById("form_edit_vendor"),v=document.getElementById("form_edit_provider"),h=document.getElementById("vendor_name"),b=document.getElementsByClassName("vendor_company_id"),I=document.getElementById("provider_name"),w=document.getElementById("provider_company_id"),E=document.getElementById("company_keywords"),B=(document.getElementById("company_logo"),document.getElementById("company_description_long")),k=document.getElementById("company_description_short"),N=document.getElementById("button_clear_form_edit_company"),M=document.getElementById("company_images"),x={rules:{company_name:{required:!0},company_phone_1:{},company_phone_2:{},company_fax:{},company_email:{email:!0},company_website:{url:!0}},messages:{company_name:{required:"Field Required1"},company_email:{email:"Field Invalid"},company_website:{url:"Field Invalid"}}};let C,S,P={},D=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,L=!1,F={};$('a[data-toggle="tab"]').on("hide.bs.tab",function(e){z()}),$(g).on("click",function(){let e=W(F);R(e),z()}),$(p).on("click",function(){F=A(),j()}),$(N).on("click",function(){U()}),$(f).on("click",function(){z()}),$(r).on("click",function(){let e=Company.build();e&&confirmDialog("Would you like to update?",t=>{t&&Y(e,function(e){if(e&&e[0]){let t=e[0],n=W(t);P=n,R(n),T(),z()}})})}),$(u).on("change",function(){c.value=u.value}),$(t).on("change",function(){V()});const T=function(){$(n).on("change",function(){setTimeout(function(){let e=n.value;!1===L&&(""===e?(n.value="",u.value="",L=!1):O(e))},200)}).on("search",function(){Company.reset_form(!0),v&&Provider.reset_form(),y&&Vendor.reset_form()}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/companies",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;L=!0,R(t),I?$(I).val(t.name).trigger("change"):$(h).val(t.name),w&&$(w).val(t.id),Address.get_by_company_id(t.id),Contact.getByCompanyId(t.id)}})},R=function(e){console.log("Company.populate_form(company)",e);$("#company_logo").dropify();let t=e.keywords?e.keywords:"";$(u).val(e.id?e.id:"").trigger("change"),n.value=e.name?e.name:"",a.value=e.phone_1?e.phone_1:"",i.value=e.phone_2?e.phone_2:"",o.value=e.fax?e.fax:"",l.value=e.email?e.email:"",d.value=e.website?e.website:"",B.value=e.description_long?e.description_long:"",k.value=e.description_short?e.description_short:"",C=$(E).BuildKeyword(t),I&&$(I).val(e.name?e.name:"").trigger("change"),h&&(h.value=e.name?e.name:null),w&&(w.value=e.id?e.id:null),b&&(b.value=e.id?e.id:null),m&&(m.value=e.id?e.id:null),c&&(c.value=e.id?e.id:null)},q=function(e){toastr.error(e)},A=function(){return remove_nulls({email:$(l).val(),enabled:1,fax:$(o).val(),id:isNaN(u.value)?null:parseInt(u.value),modified_by:D,cover_image:"/public/img/placeholder.jpg",description_short:k.value,description_long:B.value,keywords:C.build(),name:$(n).val(),note:null,phone_1:$(a).val(),phone_2:$(i).val(),status_id:10,website:$(d).val()})},O=function(e){if(e&&""!==e){Q({name:e},function(t){let a=null;t&&t[0]&&t[0]&&(a=t[0]),a?(U(!0),R(a),Address.get_by_company_id(a.id),Contact.getByCompanyId(a.id)):confirmDialog(`The company: ${e} does not exist exists. Would you like to create it?`,e=>{e&&Y({name:n.value,status_id:10,enabled:1},function(e){e&&e[0]&&(a=e[0],F=a,U(!0),R(a),j())})})})}},Q=function(e,t){if(e)try{sendGetRequest("/api/v1.0/companies/validate",e,function(e,n,a){if(e)return t(e);q("Oops: 1")})}catch(e){q("Error Validating Company")}else q("Error Loading Company- Missing Data")},Y=function(e,t){e&&sendPostRequest("/api/v1.0/companies/update",e,function(e,n,a){if(e)return t(e);q("Oops: 1")})},U=function(e){a.value="",i.value="",o.value="",l.value="",d.value="",e&&!0===e&&(I&&$(I).val("").trigger("change"),h&&$(h).val("").trigger("change"),$(u).val("").trigger("change"),n.value="",Address.clearTable(),Contact.clearTable())},W=function(e){let t={created_by:D,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),email:null,cover_image:"/public/img/placeholder.jpg",enabled:1,fax:null,id:null,modified_by:D,name:null,note:null,phone_1:null,phone_2:null,status_id:10,website:null,description_short:null,description_long:null,keywords:null,logo:null,images:[]};return e&&(t.created_by=e.created_by?e.created_by:D,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.email=e.email?e.email:null,t.cover_image=e.cover_image?e.cover_image:null,t.enabled=e.enabled?e.enabled:1,t.fax=e.fax?e.fax:null,t.id=e.id?e.id:null,t.modified_by=e.modified_by?e.modified_by:D,t.name=e.name?e.name:null,t.note=e.note?e.note:null,t.phone_1=e.phone_1?e.phone_1:null,t.phone_2=e.phone_2?e.phone_2:null,t.status_id=e.status_id?e.status_id:10,t.website=e.website?e.website:null,t.logo=e.logo?e.logo:"",t.keywords=e.keywords?e.keywords:"",t.description_long=e.description_long?e.description_long:"",t.description_short=e.description_short?e.description_short:"",t.images=e.images?e.images:[]),Company.detail=t,t},j=function(){P=Company.build(),_&&($(_).show(),$(g).show(),$(p).hide(),$(n).attr("readonly",!0)),e&&($(e).attr("readonly",!0),e.disabled=!0)},z=function(){if(_){W(P);$(n).attr("readonly",!1),$(_).hide(),$(g).hide(),$(p).show(),T()}e&&($(e).attr("readonly",!1),e.disabled=!1)},V=function(){isNaN(parseInt(u.value))?(p.disabled=!0,$(s).attr("readonly",!0),$(a).attr("readonly",!0),$(i).attr("readonly",!0),$(o).attr("readonly",!0),$(l).attr("readonly",!0)):($(a).attr("readonly",!1),$(i).attr("readonly",!1),$(o).attr("readonly",!1),$(l).attr("readonly",!1),$(s).attr("readonly",!1),p.disabled=!1)};return{all:new Map,build:function(){if($(t).valid())return A()},validator:null,detail:{created_by:D,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),email:null,enabled:1,fax:null,id:null,modified_by:D,name:null,note:null,phone_1:null,phone_2:null,status_id:10,website:null},fileManager:null,add_to_company_list:function(e,t){return Y(e,t)},company_exists:function(e){O(e)},populate_form:function(e){R(e)},reset_form:function(e){U(e)},init:function(e){!function(e){console.log("Company.init(company)",e);let n=[];if(e){let a=W(e);n=e.images?e.images:[],M&&(Company.fileManager=$("#company_images").fileManager({height:400,source:"company",sourceId:a.id,images:n})),t&&(R(a),validator_init(x),S=$(t).validate(),T(),_&&z())}}(e)}}}(),Contact=function(){"use strict";const e=document.getElementById("clear_contact_table"),t=document.getElementById("button_add_contact_table"),n=document.getElementById("button_clear_form_edit_contact"),a=document.getElementById("button_close_edit_contact_form"),i=document.getElementById("button_submit_form_edit_contact"),o=document.getElementById("company_id"),l=document.getElementById("contact_company_id"),d=document.getElementById("contact_id"),r=document.getElementById("contact_name_first"),s=document.getElementById("contact_name_last"),c=document.getElementById("contact_phone"),u=document.getElementById("contact_email"),m=document.getElementById("contact_enabled"),_=document.getElementById("contact_types_id"),p=document.getElementById("card_edit_contact_form"),g=document.getElementById("form_edit_contact"),f=document.getElementById("table_contact");document.getElementById("contact_date_created"),document.getElementById("contact_created_by"),document.getElementById("contact_date_modified"),document.getElementById("contact_modified_by"),document.getElementById("contact_note");let y,v=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,h=$(f),b={rules:{contact_name_first:{required:!0},contact_name_last:{required:!0},contact_phone:{required:!0},contact_email:{required:!0},contact_types_id:{required:!0}},messages:{contact_name_first:{required:"Field Required"},contact_name_last:{required:"Field Required"},contact_phone:{required:"Field Required"},contact_email:{required:"Field Required"},contact_types_id:{required:"Field Required"}}};$(i).on("click",function(){I()&&confirmDialog("Would you like to update?",e=>{e&&w()})}),$(t).on("click",function(){h.clearSelectedRows(),k(),N()}),$(n).on("click",function(){h.clearSelectedRows(),k()}),$(a).on("click",function(){h.clearSelectedRows(),k(),M()}),$(e).on("click",function(){Contact.clearTable()});const I=function(){return $(g).valid()},w=function(){let e=function(){let e={name_first:r.value,name_last:s.value,email:u.value,phone:c.value,contact_types_id:toNumbers(getListOfIds($(_).val())),enabled:!0===m.checked?1:0,company_id:isNaN(l.value)?null:parseInt(l.value),id:isNaN(d.value)?null:parseInt(d.value)};return remove_nulls(e)}();e&&E(e,function(e){if(e&&e[0]){let t=e[0],n=x(t);Contact.all.get(n.id)?h.updateRow(n):h.insertRow(n),Contact.all.set(n.id,n),toastr.success("Contact Updated")}})},E=function(e,t){e&&sendPostRequest("/api/v1.0/contacts/update",e,function(e,n,a){return e?t(e):B("Oops: 1")})},B=function(e){toastr.error(e)},k=function(){p&&(d.value="",r.value="",s.value="",c.value="",u.value="",m.checked=!0,$(_).val([]))},N=function(){p&&$(p).show()},M=function(){p&&$(p).hide()},x=function(e){let t={id:null,company_id:null,name_first:null,name_last:null,formatted_types:"",formatted_names:"",phone:null,email:null,enabled:1,date_created:formatDateMySQL(),created_by:v,date_modified:formatDateMySQL(),modified_by:v,note:null};return e&&(t.id=e.id?e.id:null,t.company_id=e.company_id?e.company_id:null,t.name_first=e.name_first?e.name_first:null,t.name_last=e.name_last?e.name_last:null,t.formatted_types=e.formatted_types?e.formatted_types:"",t.formatted_names=e.formatted_names?e.formatted_names:"",t.contact_types_id=getListOfIds(e.contact_types_id),t.phone=e.phone?e.phone:null,t.email=e.email?e.email:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:created_by,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:modified_by,t.note=e.note?e.note:null),Contact.detail=t,t},C=function(e){Contact.all=new Map,e&&($.each(e,function(e,t){let n=x(t);Contact.all.set(n.id,n),h.insertRow(n)}),e[0]&&h.loadRow(e[0]))},S=function(e){e&&function(e){k(),l.value=o.value,e&&(d.value=validInt(e.id),r.value=e.name_first?e.name_first:null,s.value=e.name_last?e.name_last:null,c.value=e.phone?e.phone:null,u.value=e.email?e.email:null,m.checked=!e.enabled||1===e.enabled,$(_).val(e.contact_types_id?e.contact_types_id:[])),N()}(e)},P=function(e){f&&f&&($.fn.DataTable.isDataTable(f)||(h=$(f).table({table_type:"display_list",data:Contact.all,columnDefs:[{title:"ID",targets:0,data:"id",render:function(e,t,n,a){return e}},{title:"Name",targets:1,data:"formatted_names",render:function(e,t,n,a){return e}},{title:"Types",targets:2,data:"formatted_types",render:function(e,t,n,a){return e}}],rowClick:Contact.navigate}))),e&&C(e),g&&(validator_init(b),y=$(g).validate()),M()},D=function(){let e=Array.from(Contact.all.values());$.each(e,function(e,t){h.deleteRow(t)}),Contact.all=new Map},L=function(e){e&&function(e,t){if(!e)return B("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/contacts",e,function(e,n,a){return e?t(e):B("Oops: 1")})}catch(e){return B("Error Validating Company")}}({company_id:e},function(e){if(e){let t=e;D(),function(e){if(f){let t;Contact.all=new Map;let n=0;$.each(e,function(e,a){0===n&&(t=a),a.contact_types_id=getListOfIds(a.contact_types_id),Contact.all.set(a.id,a),h.insertRow(a),n++}),f&&(t&&h.loadRow(t),h.clearSelectedRows())}}(t)}})};return{validator:null,detail:{},all:new Map,getByCompanyId:function(e){L(e)},clearTable:function(){D()},navigate:function(e){S(e)},load_all:function(e){C(e)},save:function(e){w(e)},init:function(e){P(e)}}}(),Currency=function(){"use strict";document.getElementById("input_currency_id"),document.getElementById("input_currency_sort_order"),document.getElementById("input_currency_name"),document.getElementById("input_currency_iso"),document.getElementById("input_currency_minor_unit"),document.getElementById("input_currency_symbol"),document.getElementById("input_currency_enabled"),document.getElementById("input_currency_date_created"),document.getElementById("input_currency_created_by"),document.getElementById("input_currency_date_modified"),document.getElementById("input_currency_modified_by"),document.getElementById("input_currency_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,sort_order:null,name:null,iso:null,minor_unit:null,symbol:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.sort_order=t.sort_order?t.sort_order:null,n.name=t.name?t.name:null,n.iso=t.iso?t.iso:null,n.minor_unit=t.minor_unit?t.minor_unit:null,n.symbol=t.symbol?t.symbol:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),Currency.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,Currency.all=new Map,n&&$.each(n,function(e,n){let a=t(n);Currency.all.set("id",a)})},save:function(e){},init:function(){}}}();Currency.init();const Vendor=function(){"use strict";const e=document.getElementById("panel_tab_contact"),t=document.getElementById("button_add_vendor_page_heading"),n=document.getElementById("vendor_index_table_add_button"),a=document.getElementById("vendor_company_id"),i=document.getElementById("form_edit_vendor"),o=document.getElementById("vendor_name"),l=document.getElementById("vendor_id"),d=document.getElementById("vendor_show_online"),r=document.getElementById("vendor_show_sales"),s=document.getElementById("vendor_show_ops"),c=document.getElementById("vendor_is_provider"),u=document.getElementById("vendor_sku"),m=document.getElementById("vendor_enabled"),_=document.getElementById("provider_edit"),p=(document.getElementById("provider_name"),document.getElementById("provider_company_id"),document.getElementById("company_id")),g=document.getElementById("button_submit_form_edit_vendor"),f=document.getElementById("table_vendor_index"),y=document.getElementById("form_vendor_add"),v=document.getElementById("modal_button_submit_add_vendor"),h=document.getElementById("modal_button_cancel_add_vendor"),b=document.getElementById("modal_new_vendor"),I=document.getElementById("vendor_modal_vendor_name"),w=document.getElementById("button_save_vendor"),E=document.getElementById("company_name"),B=document.getElementById("form_product_add"),k=document.getElementById("modal_product_vendor_id"),N=document.getElementById("modal_product_vendor_name"),M=document.getElementById("modal_product_provider_vendor_match"),x=document.getElementById("modal_product_provider_company_id"),C=document.getElementById("modal_product_vendor_company_id"),S=document.getElementById("product_edit_details_section_vendor_form_filter"),P=document.getElementById("product_edit_details_section_vendor_form_vendor_id");let D,L,F=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,T=!1,R={rules:{vendor_name:{required:!0}},messages:{vendor_name:{required:"Field Required"}}},q={rules:{vendor_modal_vendor_name:{required:!0}},messages:{vendor_modal_vendor_name:{required:"Field Required"}}},A=$(f);$(w).on("click",function(){Company.build();Z()}),$(t).on("click",function(){Y()}),$(n).on("click",function(){Y()}),$(h).on("click",function(){Q()}),$(v).on("click",function(){if(U()){let e={name:I.value};confirmDialog(`Vendor: ${name} will be added`,t=>{t&&W(e)})}}),$(I).on("change",function(){setTimeout(function(){let e=I.value;!1===T&&(""===e?(I.value="",T=!1):O(e))},200)}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;confirmDialog(`Vendor ${t.name} ALREADY exists. Would you like to load this record to edit?`,e=>{e?window.location.replace("/vendors/"+t.id):z()})}}),$(N).on("change",function(){setTimeout(function(){let e=N.value;T=!1,""===e?(k.value="",N.value="",C.value="",Product.attr3=null,Product.updateProductSKU(),T=!1):O(e)},200)}).on("search",function(){k.value="",N.value="",C.value="",M.checked=!1,Product.attr3=null,Product.updateProductSKU(),T=!1}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;e.data;if(B){let t=isNaN(parseInt(x.value))?null:parseInt(x.value);k.value=e.data.id,N.value=e.data.name,C.value=e.data.company_id,Product.attr3=e.data.sku,Product.updateProductSKU(),M.checked=parseInt(e.data.company_id)===t}T=!0}}),$(p).on("change",function(){$(a).val(p.value)}),$(g).on("click",function(){Z()});const O=function(e){if(e&&""!==e){H({name:e},function(e){let t;if(e&&e.length>0)t=e,e.length>0&&e[0]&&(t=e[0]);else{k.value="",C.value="",Product.attr3=null,Product.updateProductSKU();let e=N.value;""!==e&&confirmDialog(`Vendor ${e} does not exists. Would you like to create this`,e=>{if(e){let e={name:N.value};W(e)}else N.value=""})}t&&(I&&confirmDialog(`Vendor ${t.name} ALREADY exists. Would you like to load this record to edit?`,e=>{e&&window.location.replace("/vendors/"+t.id)}),B&&(k.value=t.id?t.id:"",C.value=t.company_id?t.company_id:"",Product.attr3=t.sku?t.sku:null,Product.updateProductSKU()))})}},Q=function(){$(b).modal("hide")},Y=function(){$(I).val(""),$(b).modal("show")},U=function(){return!!y&&$(y).valid()},W=function(e){e&&j(e,function(e){if(e&&e[0]){let t=e[0];t.id&&(B&&(C.value=t.company_id?t.company_id:"",k.value=t.id?t.id:"",M.checked=C.value===x.value,Product.attr3=t.sku?t.sku:null,Product.updateProductSKU()),y&&window.location.replace("/vendors/"+t.id))}})},j=function(e,t){if(e)try{sendPostRequest("/api/v1.0/vendors/add",e,function(e,n,a){return e?t(e):V("Oops: 1")})}catch(e){}},z=function(){I.value=""},V=function(e){toastr.error(e)},H=function(e,t){if(!e)return V("Error Loading Company- Missing Data");try{sendGetRequest("/api/v1.0/vendors/validate",e,function(e,n,a){return e?t(e):V("Oops: 1")})}catch(e){return V("Error Validating Company")}},G=function(){return{id:null,name:null,company_id:null,status_id:1,show_online:1,show_sales:1,show_ops:1,is_provider:1,sku:null,enabled:1,date_created:formatDateMySQL(),created_by:F,date_modified:formatDateMySQL(),modified_by:F,note:null,company:{},addresses:[],contacts:[]}},K=function(e){let t,n=G(),a={},i=[];return e&&(n.id=e.id?e.id:null,n.name=e.name?e.name:null,n.status_id=e.status_id?e.status_id:null,n.show_online=e.show_online,n.show_sales=e.show_sales,n.show_ops=e.show_ops,n.is_provider=e.is_provider,n.sku=e.sku?e.sku:null,n.enabled=e.enabled,n.date_created=e.date_created?e.date_created:formatDateMySQL(),n.created_by=e.created_by?e.created_by:created_by,n.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),n.modified_by=e.modified_by?e.modified_by:modified_by,n.note=e.note?e.note:null,e.company&&(a=e.company,n.company_id=a.id,e.company.addresses&&(t=e.addresses),e.company.contacts&&(i=e.contacts))),n.addresses=t,n.contacts=i,n.company=a,Vendor.detail=n,n},J=function(e,t){if(e)try{sendPostRequest("/api/v1.0/vendors/update",e,function(e,n,a){return e?t(e):V("Oops: 1")})}catch(e){}},Z=function(){let e=Vendor.build();e.company_detail=Company.build(),e&&confirmDialog("Would you like to update?",t=>{t&&J(e,function(e){if(e&&e[0]){let t=e[0];if(t.id)if(""===l.value||isNaN(parseInt(l.value)))window.location.replace("/vendors/"+t.id);else{let e=E.value;toastr.success(`Vendor ${e} has been updated.`)}}})})},X=function(e){e&&J(e,function(e){if(e&&e[0]){let t=e[0];if(t.id)if(""===l.value||isNaN(parseInt(l.value)))window.location.replace("/vendors/"+t.id);else{let e=E.value;toastr.success(`Vendor ${e} has been updated.`)}}})},ee=function(e){Vendor.all=new Map,e&&$.each(e,function(e,t){let n=K(t);A.insertRow(n),Vendor.all.set(n.id,n)})},te=function(e){let t={};if(e&&(e.company&&(t=e.company),e.vendor_detail)){let t=K(e.vendor_detail);n=t,S.value=n.company.name,P.value=n.id,Product.attr3=n.sku?n.sku:null}var n;i&&(o&&(o.value=e.name?e.name:"",o&&$(o).on("change",function(){setTimeout(function(){let e=o.value;T=!1,""===e?(o.value="",a.value=""):O(e)},200)}).on("click",function(){$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/vendors",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){e.data}})),l&&(l.value=e.id?e.id:""),a&&(a.value=t.id?t.id:""),u&&(u.value=e.sku?e.sku:""),m&&(m.checked=!e.enabled||1===e.enabled),c&&(c.checked=1===e.is_provider),d&&(d.checked=1===e.show_online),s&&(s.checked=1===e.show_ops),r&&(r.checked=1===e.show_sales),validator_init(R),L=$(i).validate())},ne=function(e){y&&(validator_init(q),D=$(y).validate()),A=$(f).table({table_type:"display_list",data:Vendor.all,columnDefs:[{title:"Id",targets:0,data:"id",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Name",targets:1,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:2,data:"sku",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}}],rowClick:Vendor.navigate}),e&&e.vendors&&ee(e.vendors)},ae=function(){o&&($(c).attr("readonly",!0),c.disabled=!0,$(o).attr("readonly",!0),$(l).attr("readonly",!0),$(u).attr("readonly",!0),$(c).attr("readonly",!0))};return{validator:null,detail:{},all:new Map,newVendor:function(e,t){return j(e,t)},index:function(e){ne(e)},setProvider:function(){_&&(c.checked=!0,$(c).attr("readonly","true"),c.disabled=!0,$(o).attr("readonly","true"),$(l).attr("readonly","true"),$(u).attr("readonly","true"),$(c).attr("readonly","true"))},get:function(e){},load_all:function(e){ee(e)},reset_form:function(){o.value="",l.value="",a.value="",d.checked=!0,r.checked=!0,s.checked=!0,c.checked=!0,u.value="",m.checked=!0},save:function(e){X(e)},init:function(e){te(e)},build:function(){if($(i).valid())return remove_nulls({id:isNaN(parseInt(l.value))?null:parseInt(l.value),company_id:isNaN(parseInt(a.value))?null:parseInt(a.value),name:""!==o.value?o.value:null,status_id:10,enabled:m.checked?1:0,show_online:!0===d.checked?1:0,show_sales:!0===r.checked?1:0,show_ops:!0===s.checked?1:0,is_provider:!0===c.checked?1:0,sku:u.value})},navigate:function(e){!function(e){e&&e.id&&window.location.replace("/vendors/"+e.id)}(e)},edit:function(t){!function(t){let n=[],a=[],i={},o={};t&&t.vendor_detail&&(o=K(t.vendor_detail),n=t.address_detail?t.address_detail:[],a=t.contact_detail?t.contact_detail:[],i=t.company_detail?t.company_detail:{}),$(e).removeClass("disabled"),Vendor.init(o),Address.init(n),Contact.init(a),Company.init(i),ae()}(t)},setVendor:function(){ae()}}}(),Tour=function(){"use strict";const e=document.getElementById("tour_route");return{all:new Map,route:null,detail:{},init:function(t){!function(t){console.log("Tour.init(options)",t),e&&$(e).routeManager({stops:[{id:1,location_id:1,time:"01:00"},{id:2,location_id:2,time:"01:00"},{id:3,location_id:3,time:"01:00"},{id:4,location_id:4,time:"01:00"},{id:5,location_id:5,time:"01:00"},{id:6,location_id:6,time:"01:00"}]})}(t)}}}(),MessageTypes=function(){"use strict";document.getElementById("input_message_types_id"),document.getElementById("input_message_types_name"),document.getElementById("input_message_types_icon"),document.getElementById("input_message_types_sort_order"),document.getElementById("input_message_types_enabled"),document.getElementById("input_message_types_date_created"),document.getElementById("input_message_types_created_by"),document.getElementById("input_message_types_date_modified"),document.getElementById("input_message_types_modified_by"),document.getElementById("input_message_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,icon:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.icon=t.icon?t.icon:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),MessageTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,MessageTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);MessageTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),Pricing=function(){"use strict";let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=document.getElementById("pricing_strategy_unit_id"),n=document.getElementById("pricing_strategy_season_id"),a=(document.getElementById("pricing_strategy_profile_id"),document.getElementById("pricing_strategy_types_id")),i=document.getElementById("calendar_filter_profile_id");$(a).on("change",function(){PricingWorksheet.pricingWorksheet()});const o=function(e){Pricing.all=new Map,e||(e=[]),$.each(e,function(e,t){t.pricings;let n=t.pricing_code,a=t.matrix_code,i=(Matrix.all.get(a),r(t));Pricing.all.set(n,i)})},l=function(){let e=InventoryProfile&&InventoryProfile.all?Array.from(InventoryProfile.all.values()):[],t="<option value='' disabled readonly selected>-- Profiles --</option>";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(i).empty(),$(i).html(t)},d=function(){!function(){let e=Season&&Season.all?Array.from(Season.all.values()):[],t="";$.each(e,function(e,n){let a=n.name,i=n.id;t+=`<option value="${i}">${a}</option>`}),$(n).empty(),$(n).html(t)}(),function(){let e=Unit&&Unit.all?Array.from(Unit.all.values()):[],n="";$.each(e,function(e,t){let a=t.name,i=t.id;n+=`<option value="${i}">${a}</option>`}),$(t).empty(),$(t).html(n)}(),l()},r=function(t){let n={pricing_code:null,matrix_code:null,code:null,id:null,product_id:null,season_id:null,unit_id:null,matrix_id:null,variant_id:0,name:null,mon:null,tue:null,wed:null,thu:null,fri:null,sat:null,sun:null,monMargin:null,tueMargin:null,wedMargin:null,thuMargin:null,friMargin:null,satMargin:null,sunMargin:null,count:1,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.pricing_code=t.pricing_code?t.pricing_code:null,n.matrix_code=t.matrix_code?t.matrix_code:null,n.code=t.code?t.code:null,n.id=t.id?t.id:null,n.product_id=t.product_id?t.id:null,n.season_id=t.season_id?t.id:null,n.unit_id=t.unit_id?t.id:null,n.matrix_id=t.matrix_id?t.matrix_id:null,n.variant_id=t.variant_id?t.variant_id:null,n.name=t.name?t.name:null,n.mon=t.mon?t.mon:null,n.tue=t.tue?t.tue:null,n.wed=t.wed?t.wed:null,n.thu=t.thu?t.thu:null,n.fri=t.fri?t.fri:null,n.sat=t.sat?t.sat:null,n.sun=t.sun?t.sun:null,n.monMargin=t.monMargin?t.monMargin:null,n.tueMargin=t.tueMargin?t.tueMargin:null,n.wedMargin=t.wedMargin?t.wedMargin:null,n.thuMargin=t.thuMargin?t.thuMargin:null,n.friMargin=t.friMargin?t.friMargin:null,n.satMargin=t.satMargin?t.satMargin:null,n.sunMargin=t.sunMargin?t.sunMargin:null,n.count=t.count?t.count:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:e,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:e,n.note=t.note?t.note:null),Pricing.detail=n,n};return{all:new Map,init:function(e){!function(e){d();let t,n=[];e&&(t=e,e.pricings&&(n=e.pricings)),t.pricing_strategy_types_id&&(a.value=t.pricing_strategy_types_id,PricingWorksheet.pricingStrategyId=parseInt(t.pricing_strategy_types_id)),o(n)}(e)},set:function(e){return r(e)},resetForm:function(){d()},loadProfileDropdown:function(){l()}}}(),Matrix=function(){"use strict";let e,t,n,a=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const i=function(e){let t={been_saved:0,cost:0,created_by:a,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,has_pricing:0,id:null,margin:0,code:null,modified_by:a,note:null,price:0,pricings:new Map,product_id:null,season_id:null,unit_id:null};return e&&(t.been_saved=e.been_saved?e.been_saved:0,t.cost=e.cost?e.cost:null,t.created_by=e.created_by?e.created_by:a,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.enabled=e.enabled?e.enabled:1,t.has_pricing=e.has_pricing?e.has_pricing:null,t.id=e.id?e.id:null,t.margin=e.margin?e.margin:null,t.code=e.code?e.code:null,t.modified_by=e.modified_by?e.modified_by:a,t.note=e.note?e.note:null,t.price=e.price?e.price:null,t.product_id=e.product_id?e.product_id:null,t.season_id=e.season_id?e.season_id:null,t.unit_id=e.unit_id?e.unit_id:null),Matrix.detail=t,t},o=function(e){let t=[];e&&e.matrices&&(t=e.matrices),function(e){Matrix.all=new Map,e||(e=[]),$.each(e,function(e,t){let n=i(t),a=t.code;Matrix.all.set(a,n)})}(t),l()},l=function(){e=document.getElementsByName("matrix_cost"),n=document.getElementsByName("matrix_price"),t=document.getElementsByName("matrix_margin"),e.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid})),n.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid})),t.forEach(e=>e.addEventListener("keyup",t=>{e.dataset.matrixid}))};return{detail:{},all:new Map,set:function(e){return i(e)},init:function(e){o(e)},buildMatrixForm:function(){l()},loadPerUnitForm:function(){},loadPerPersonForm:function(){},loadPerDayForm:function(){}}}(),PricingStrategyTypes=function(){"use strict";document.getElementById("input_pricing_strategy_types_id"),document.getElementById("input_pricing_strategy_types_name"),document.getElementById("input_pricing_strategy_types_enabled"),document.getElementById("input_pricing_strategy_types_date_created"),document.getElementById("input_pricing_strategy_types_created_by"),document.getElementById("input_pricing_strategy_types_date_modified"),document.getElementById("input_pricing_strategy_types_modified_by"),document.getElementById("input_pricing_strategy_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),PricingStrategyTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,PricingStrategyTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);PricingStrategyTypes.all.set("id",a)})},save:function(e){},init:function(){}}}();PricingStrategyTypes.init();const RatingTypes=function(){"use strict";document.getElementById("input_rating_types_id"),document.getElementById("input_rating_types_name"),document.getElementById("input_rating_types_enabled"),document.getElementById("input_rating_types_date_created"),document.getElementById("input_rating_types_created_by"),document.getElementById("input_rating_types_date_modified"),document.getElementById("input_rating_types_modified_by"),document.getElementById("input_rating_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),RatingTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,RatingTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);RatingTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),SalesTypes=function(){"use strict";document.getElementById("input_sales_types_id"),document.getElementById("input_sales_types_name"),document.getElementById("input_sales_types_class"),document.getElementById("input_sales_types_sort_order"),document.getElementById("input_sales_types_enabled"),document.getElementById("input_sales_types_date_created"),document.getElementById("input_sales_types_created_by"),document.getElementById("input_sales_types_date_modified"),document.getElementById("input_sales_types_modified_by"),document.getElementById("input_sales_types_note");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(t){let n={id:null,name:null,class:null,sort_order:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.class=t.class?t.class:null,n.sort_order=t.sort_order?t.sort_order:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null),SalesTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){var n;n=e,SalesTypes.all=new Map,n&&$.each(n,function(e,n){let a=t(n);SalesTypes.all.set("id",a)})},save:function(e){},init:function(){}}}(),StatusTypes=function(){"use strict";document.getElementById("input_status_types_id"),document.getElementById("input_status_types_name"),document.getElementById("input_status_types_enabled"),document.getElementById("input_status_types_date_created"),document.getElementById("input_status_types_created_by"),document.getElementById("input_status_types_date_modified"),document.getElementById("input_status_types_modified_by"),document.getElementById("input_status_types_note"),document.getElementById("input_status_types_sort_order");let e=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;const t=function(e){StatusTypes.all=new Map,e&&$.each(e,function(e,t){let n=a(t);n.id&&StatusTypes.all.set(n.id,n)})},n=function(e){let t="";e&&(t=e);Array.from(StatusTypes.all.values())},a=function(t){let n={id:null,name:null,enabled:1,date_created:formatDateMySQL(),created_by:e,date_modified:formatDateMySQL(),modified_by:e,note:null,sort_order:null};return t&&(n.id=t.id?t.id:null,n.name=t.name?t.name:null,n.enabled=t.enabled?t.enabled:1,n.date_created=t.date_created?t.date_created:formatDateMySQL(),n.created_by=t.created_by?t.created_by:created_by,n.date_modified=t.date_modified?t.date_modified:formatDateMySQL(),n.modified_by=t.modified_by?t.modified_by:modified_by,n.note=t.note?t.note:null,n.sort_order=t.sort_order?t.sort_order:null),StatusTypes.detail=n,n};return{validator:null,detail:{},all:new Map,get:function(e){},load_all:function(e){t(e)},save:function(e){},init:function(e){!function(e){e&&e.status_types&&(t(e.status_types),n())}(e)}}}(),Types=function(){"use strict";const e=function(e,t){$.each(e,function(e,n){Types[t].set(n.id,n)})};return{allot_by:new Map,address_types:new Map,season_types:new Map,airport_types:new Map,categories_ratings_types:new Map,category:new Map,color_scheme:new Map,contact_types:new Map,currency:new Map,location_types:new Map,message_types:new Map,pricing_strategy_types:new Map,rating_types:new Map,sales_types:new Map,status_types:new Map,init:function(t){t&&function(t){Types.address_types=new Map,Types.allot_by=new Map,Types.airport_types=new Map,Types.categories_ratings_types=new Map,Types.category=new Map,Types.color_scheme=new Map,Types.contact_types=new Map,Types.currency=new Map,Types.location_types=new Map,Types.message_types=new Map,Types.pricing_strategy_types=new Map,Types.rating_types=new Map,Types.sales_types=new Map,Types.status_types=new Map,Country.all=new Map,t.address_types&&e(t.address_types,"address_types"),t.season_types&&(e(t.season_types,"season_types"),Season.init({seasons:t.season_types})),t.airport_types&&e(t.airport_types,"airport_types"),t.category&&(e(t.category,"category"),Category.init({categories:t.category})),t.color_scheme&&e(t.color_scheme,"color_scheme"),t.contact_types&&e(t.contact_types,"contact_types"),t.currency&&e(t.currency,"currency"),t.location_types&&e(t.location_types,"location_types"),t.message_types&&e(t.message_types,"message_types"),t.pricing_strategy_types&&e(t.pricing_strategy_types,"pricing_strategy_types"),t.rating_types&&e(t.rating_types,"rating_types"),t.sales_types&&e(t.sales_types,"sales_types"),t.status_types&&(e(t.status_types,"status_types"),StatusTypes.init({status_types:t.status_types})),t.allot_by&&e(t.allot_by,"allot_by"),t.countries&&Country.load_all(t.countries)}(t)}}}(),Login=function(){"use strict";document.getElementById("dataToSend");const e=document.getElementById("email"),t=document.getElementById("password"),n=document.getElementById("button_login_submit"),a=document.getElementById("button_login_register"),i=document.getElementById("form_login"),o=document.getElementById("register_form_submit_button"),l=document.getElementById("register_page_form"),d=document.getElementById("register_page"),r=function(e,t){return Login.validator=validator_init(t),$(e).valid()},s=function(o){let l={rules:{email:{required:!0,email:!0},password:{required:!0}},messages:{email:{required:"Field Required",email:"Field invalid"},password:{required:"Field Required"}}};Login.validator=validator_init(l),$(a).on("click",function(){}),$(n).on("click",function(){s()});const d=function(e){toastr.error(e)},s=function(){if(r(i,l)){let n={email:e.value,password:t.value};!function(e){if(!e)return d("Error: 3");try{sendPostRequest("/api/v1.0/users/login",e,function(e,t,n){if(!e||!e.id)return d("Error Logging In: 1");e.id&&window.location.replace("/")})}catch(e){return d("Error: 2")}}(remove_nulls(n))}}};return{detail:{},all:new Map,validator:null,init:function(e){!function(e){i&&Login.login(e),d&&Login.register(e)}(e)},login:function(e){s()},register:function(e){!function(e){let t={rules:{user_name_first:{required:!0},user_name_last:{required:!0},user_email:{required:!0,email:!0},user_password:{required:!0,minlength:5},user_password_confirm:{required:!0,minlength:5,equalTo:"#user_password"}},messages:{user_name_first:{required:"Field Required"},user_name_last:{required:"Field Required"},user_email:{required:"Field Required",email:"Field invalid"},user_password:{required:"Field Required"}}};const n=document.getElementById("user_name_first"),a=document.getElementById("user_name_last"),i=document.getElementById("user_email"),d=document.getElementById("user_password");Login.validator=validator_init(t),$(o).on("click",function(){s()});const s=function(){if(r(l,t)){let e={name_first:n.value,name_last:a.value,email:i.value,password:d.value};c(remove_nulls(e))}},c=function(e){if(!e)return handle_login_error("Error: 3");try{sendPostRequest("/api/v1.0/users/register",e,function(e,t,n){if(!e||!e.id)return handle_login_error("Error Logging In: 1");e.id&&window.location.replace("/")})}catch(e){return handle_login_error("Error: 2")}}}()}}}();Login.init();const Provider=function(){"use strict";const t=document.getElementById("button_add_provider_page_heading"),n=document.getElementById("button_edit_provider_name"),a=document.getElementById("button_save_provider"),i=document.getElementById("panel_tab_contact"),o=document.getElementById("panel_tab_vendor"),l=document.getElementById("panel_tab_address"),d=document.getElementById("panel_tab_provider"),r=document.getElementById("table_provider_index"),s=document.getElementById("location_id"),c=document.getElementById("company_name"),u=document.getElementById("provider_id"),m=document.getElementById("provider_name"),_=document.getElementById("provider_company_id"),p=document.getElementById("provider_enabled"),g=document.getElementById("provider_code_direct_id"),f=document.getElementById("vendor_name"),y=document.getElementById("vendor_company_id"),v=document.getElementById("company_id"),h=document.getElementById("location_name_filter_id"),b=document.getElementById("form_edit_provider"),I=document.getElementById("form_product_add"),w=document.getElementById("modal_product_provider_name"),E=document.getElementById("modal_product_provider_id"),B=document.getElementById("modal_product_vendor_id"),k=document.getElementById("modal_product_vendor_name"),N=document.getElementById("modal_product_vendor_company_id"),M=document.getElementById("modal_product_provider_company_id"),x=document.getElementById("modal_product_provider_vendor_match"),C=document.getElementById("modal_product_provider_location_id"),S=document.getElementById("modal_product_location_id"),P=(document.getElementById("product_edit_details_section_provider_form"),document.getElementById("product_edit_details_section_provider_form_filter")),D=document.getElementById("product_edit_details_section_provider_form_provider_id"),L=document.getElementById("product_edit_details_section_provider_form_submit_button"),F=document.getElementById("product_edit_details_section_provider_form_provider_company_id"),T=document.getElementById("product_edit_details_section_provider_form_details"),R=document.getElementById("product_edit_details_section_provider_form_provider_name"),q=document.getElementById("product_edit_details_section_provider_form_provider_phone_1"),A=document.getElementById("product_edit_details_section_provider_form_provider_phone_2"),O=document.getElementById("product_edit_details_section_provider_form_provider_fax"),Q=document.getElementById("product_edit_details_section_provider_form_provider_website"),Y=document.getElementById("product_edit_details_section_provider_form_provider_email"),U=document.getElementById("product_edit_details_section_provider_form_provider_cover_image"),W=document.getElementById("product_edit_details_section_provider_form_provider_enabled"),j=(document.getElementById("product_edit_details_section_provider_form_provider_note"),document.getElementById("product_edit_details_section_provider_form_provider_keywords"),document.getElementById("product_edit_details_section_provider_form_provider_description_long")),z=document.getElementById("product_edit_details_section_provider_form_provider_description_short"),V=document.getElementById("product_edit_details_section_provider_form_provider_logo"),H=document.getElementById("product_edit_details_section_provider_form_cancel_button"),G=document.getElementById("provider_keywords"),K=document.getElementById("product_edit_details_section_provider_form_reset_button"),J=document.getElementById("product_edit_provider_panel_link_product"),Z=document.getElementById("display_provider_name"),X=document.getElementById("display_provider_code_direct"),ee=document.getElementById("product_edit_details_section_provider_form_edit_button");let te,ne,ae,ie,oe=!1,le=$(r),de=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,re={rules:{provider_name:{required:!0},provider_company_id:{required:!0}},messages:{provider_company_id:{required:"Field Required"},provider_name:{required:"Field Required"}}};$(ee).on("click",function(){console.log("Provider.product_edit_details_section_provider_form_reset_button:click()"),me()}),$(K).on("click",function(){console.log("Provider.product_edit_details_section_provider_form_reset_button:click()");let e=$e();ue(e)}),$(L).on("click",function(){console.log("Provider.product_edit_details_section_provider_form_submit_button:click()")}),$(J).on("click",function(){console.log("Provider.product_edit_provider_panel_link_product:click()"),me()}),$(H).on("click",function(){console.log("Provider.product_edit_details_section_provider_form_cancel_button:click()"),ce(ne),_e()}),$(a).on("click",function(){let e=$("#provider_edit_tabs > li.nav-item > a.nav-link"),t=$("div.tab-pane"),n=Company.build(),a=Provider.build(),i=Location.build(),o=Vendor.build(),l=Array.from(Address.all.values()),d=Array.from(Contact.all.values());n&&a&&i&&o&&l&&d?(a.location_id=i.id?i.id:null,o.is_provider=b?1:0,confirmDialog("Would you like to update?",e=>{e&&be({company_detail:n,provider_detail:a,location_detail:i,vendor_detail:o,addresses:l,contacts:d})})):$.each(t,function(n,a){if($(this).find(".is-invalid").length>0){let n=$("body").find("[aria-controls='"+$(this).attr("id")+"']");return e.removeClass("active"),t.removeClass("active"),$(this).addClass("active"),n.addClass("active"),!1}})}),$("#provider_edit").on("change",function(){Ne()}),$(_).on("change",function(){$(y).val($(this).val())}),$(t).on("click",function(){}),$(n).on("click",function(){we()}),$(v).on("change",function(){$(_).val(v.value)}),$("#modal_product_provider_name").on("change",function(){ie=!1,setTimeout(function(){let e=w.value;console.log("|__ provider_name",e),""===e?(B.value="",E.value="",k.value="",w.value="",N.value="",M.value="",C.value="",k.disabled=!0,Product.attr2=null,Product.attr3=null,Product.updateProductSKU()):ge(e)},200)}).on("search",function(){ie=!1,B.value="",E.value="",k.value="",w.value="",N.value="",M.value="",C.value="",Product.attr2=null,Product.attr3=null,Product.updateProductSKU(),k.disabled=!0}).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;let t=$e(e.data),n=t.vendor,a=t.code_direct_id?t.code_direct_id:null,i=n.sku?n.sku:null;B.value=parseInt(e.data.vendor.id),E.value=e.data.id,k.value=e.data.name,N.value=isNaN(parseInt(e.data.company_id))?null:parseInt(e.data.company_id),M.value=isNaN(parseInt(e.data.company_id))?null:parseInt(e.data.company_id),x.checked=!0,k.disabled=!1,C.value=isNaN(parseInt(t.location.id))?null:parseInt(t.location.id),Product.attr2=a,Product.attr3=i,Product.updateProductSKU()}});const se=/[^A-Za-z0-9]/g,ce=function(e){console.log("Provider.populateProductEditProviderForm(provider)",e);let t=$e(e),n=t.keywords?t.keywords:[],a=t.company.cover_image?t.company.cover_image:"/public/img/placeholder.jpg",i=t.company.logo?t.company.logo:"/public/img/placeholder.jpg",o=t.company.name?t.company.name:null,l=e.code_direct_id?e.code_direct_id:null;i=i.replace(se,""),a=a.replace(se,""),console.log("|__ coverImage",a),console.log("|__ logoImage",i),console.log("|__ Provider.detail",Provider.detail),P.value=e.company.name?e.company.name:null,D.value=e.id?e.id:null,F.value=e.company_id?e.company_id:null,R.value=e.company.name?e.company.name:null,q.value=e.company.phone_1?e.company.phone_1:null,A.value=e.company.phone_2?e.company.phone_2:null,O.value=e.company.fax?e.company.fax:null,Q.value=e.company.website?e.company.website:null,Y.value=e.company.email?e.company.email:null,j.value=e.description_long?e.description_long:null,z.value=e.description_short?e.description_short:null,W.checked=e.enabled&&1===e.enabled,U.value=a.toString(),V.value=i.toString(),te=$(G).BuildKeyword(n),Z.innerText=o,X.innerText=l,Product.attr2=l},ue=function(){console.log("Provider.resetProductEditProviderForm()"),P.value="",D.value="",F.value="",R.value="",q.value="",A.value="",O.value="",Q.value="",Y.value="",j.value="",z.value="",W.checked=!0,U.value="/public/img/placeholder.jpg"},me=function(){console.log("Provider.openProductEditProviderForm()"),$(T).show(),$(ee).addClass("d-none"),$(K).removeClass("d-none"),$(L).removeClass("d-none"),$(H).removeClass("d-none")},_e=function(){console.log("Provider.closeProductEditProviderForm()"),$(T).hide(),$(ee).addClass("d-none"),$(K).addClass("d-none"),$(L).addClass("d-none"),$(H).addClass("d-none")},pe=function(){m&&$(m).on("change",function(){}).on("search",function(){Provider.reset_form(),Vendor.reset_form()}).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data,n=t.company?t.company:{},a=(t.addresses&&t.addresses,t.contacts&&t.contacts,t.location?t.location:{}),i=(t.vendor&&t.vendor,t.id),o=t.company.name,l=t.company.id;b&&($(_).val(l),$(u).val(i),confirmDialog("This provider exists. Would you like to edit it?",e=>{e?(window.location.replace("/providers/"+i),Be(t),Company.populate_form(n),Location.populate_form(a),$(y).val(l),$(f).val(o).trigger("change")):(Provider.reset_form(),Vendor.reset_form())}))}}),P&&$(P).on("change",function(){setTimeout(function(){let e=P.value;!1===ie&&(""===e?(P.value="",F.value="",D.value="",ie=!1,$(F).val("").trigger("change"),$(D).val("").trigger("change")):ge(e))},200)}).on("search",function(){}).on("click",function(){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/providers",minChars:2,cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e.data)return;let t=e.data;ne=t;t.company&&t.company,t.addresses&&t.addresses,t.contacts&&t.contacts,t.location&&t.location,t.vendor&&t.vendor,t.id,t.company.name,t.company.id;ce(t)}})},ge=function(e){if(console.log("Provider.provider_exists(name)",e),e&&""!==e){ke({name:e},function(e){let t;if(console.log("|__ data",e),I)if(e&&0!==e.length){e&&(t=e,e.length>0&&(t=e[0]));let n=t.vendor,a=t.code_direct_id?t.code_direct_id:null,i=n.sku?n.sku:null;B.value=parseInt(n.id),E.value=t.id,k.value=t.name,N.value=isNaN(parseInt(t.company_id))?null:parseInt(t.company_id),M.value=isNaN(parseInt(t.company_id))?null:parseInt(t.company_id),x.checked=!0,k.disabled=!1,C.value=isNaN(parseInt(t.location.id))?null:parseInt(t.location.id),S.value=isNaN(parseInt(t.location.id))?null:parseInt(t.location.id),Product.attr2=a,Product.attr3=i,Product.updateProductSKU()}else confirmDialog("This provider does not exist. Would you like to create it?",e=>{e?Company.add_to_company_list({name:w.value,status_id:10,enabled:1},function(e){if(e&&e[0]){let t=e[0];M.value=t.id,N.value=t.id,w.value=t.name,k.value=t.name,x.checked=!0,Ie(remove_nulls({location_id:null,company_id:t.id,code_direct_id:null,id:null,provider_vendor:1,enabled:1}))}}):(B.value="",E.value="",k.value="",w.value="",ie=!1)});b&&(e&&e.length>0&&(t=e[0],confirmDialog("This provider exists. Would you like to edit it?",e=>{e?window.location.href="/providers/"+t.id:(Company.reset_form(),Provider.reset_form(),Vendor.reset_form())})),$(f).val($(m).val()).trigger("change"))})}},fe=function(){le=$(r).table({table_type:"display_list",data:Provider.all,columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Code Direct ID",targets:1,data:"code_direct_id",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:2,data:"vendor",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e.sku+"</span>"}},{title:"Location",targets:3,data:"location",render:function(e,t,n,a){let i="";return"<span style='white-space: nowrap;'>"+(i=e.display_medium)+"</span>"}}],rowClick:Provider.navigate})},ye=function(e,t,n){console.log("Provider.handleProviderError(msg)",e),t||(t="Product"),n||(n="error"),toastr[n](`${e}`,t)},ve=function(e,t){if(e)try{sendPostRequest("/api/v1.0/providers/update",e,function(e,n,a){if(e)return t(e);ye("Oops: 1","Provider","error")})}catch(e){console.log("error",e)}},he=function(e){Provider.all=new Map,e&&$.each(e,function(e,t){let n=$e(t);le.insertRow(n),Provider.all.set(n.id,n)})},be=function(e){e&&ve(e,function(e){if(e&&e[0]){let t=e[0];if(t.id)if(""===u.value||isNaN(parseInt(u.value)))window.location.replace("/providers/"+t.id);else{let e=c.value;toastr.success(`Provider ${e} has been updated.`)}}})},Ie=function(e){if(e){let t={name:w.value,status_id:1,show_online:1,show_sales:1,show_ops:1,is_provider:1,enabled:1};Vendor.newVendor(t,function(t){let n,a={};t&&(n=t,t[0]&&(n=t[0]),e.location_id=e.location_id?e.location_id:1,e.vendor_id=n.id,ve(a={provider_detail:e},function(e){if(e&&e[0]){let t=e[0],n=t.vendor,a=t.company;$e(t);w.value=t.name,E.value=t.id,M.value=a.id,k.value=t.name,B.value=n.id,N.value=a.id,pe(),Product.attr2=t.code_direct_id?t.code_direct_id:null,Product.attr3=n.sku?n.sku:null,Product.updateProductSKU()}}))})}},$e=function(e){let t={addresses:[],contacts:[],location:{},company:{},vendor:{},id:null,description_long:null,description_short:null,keywords:null,company_id:null,name:null,code_direct_id:null,provider_vendor:1,enabled:1,date_created:formatDateMySQL(),created_by:de,date_modified:formatDateMySQL(),modified_by:de,note:null};return e&&(t.id=e.id?e.id:null,t.name=e.name?e.name:null,t.location_id=e.location_id?e.location_id:null,t.code_direct_id=e.code_direct_id?e.code_direct_id:null,t.description_long=e.description_long?e.description_long:null,t.description_short=e.description_short?e.description_short:null,t.keywords=e.keywords?e.keywords:null,t.provider_vendor=e.provider_vendor?e.provider_vendor:1,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.company_id=e.company_id?e.company_id:null,t.created_by=e.created_by?e.created_by:de,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:de,t.note=e.note?e.note:null,t.vendor=e.vendor?e.vendor:{},t.addresses=e.addresses?e.addresses:[],t.contacts=e.contacts?e.contacts:[],t.location=e.location?e.location:{},t.company=e.company?e.company:{}),Provider.detail=t,t},we=function(){""!==u.value&&_.value},Ee=function(){$(m).attr("readonly",!0),b&&(oe||$(c).attr("readonly",!0))},Be=function(e){e&&(u.value=e.id?e.id:null,$(m).val(e.name?e.name:null),$(c).val($(m).val()),_.value=e.company_id?e.company_id:null,g.value=e.code_direct_id?e.code_direct_id:null,p.checked=!e.enabled||1===e.enabled)},ke=function(e,t){if(e)try{sendGetRequest("/api/v1.0/providers/validate",e,function(e,n,a){if(e)return t(e);ye("Oops: 1")})}catch(e){ye("Error Validating Company")}else ye("Error Loading Company- Missing Data")},Ne=function(){isNaN(u.value)||u.value;let e=isNaN(_.value)?null:_.value;null===e||""===e?($(i).addClass("disabled"),$(l).addClass("disabled"),$(d).addClass("disabled"),$(o).addClass("disabled")):($(i).removeClass("disabled"),$(l).removeClass("disabled"),$(d).removeClass("disabled"),$(o).removeClass("disabled")),a.disabled=!(""!==v.value&&""!==h.value)};return{validator:null,detail:{},all:new Map,navigate:function(e){!function(e){e&&e.id&&window.location.replace("/providers/"+e.id)}(e)},get:function(e){get(e)},build:function(){if($(b).valid())return remove_nulls({location_id:isNaN(parseInt(s.value))?null:parseInt(s.value),company_id:isNaN(parseInt(_.value))?null:parseInt(_.value),code_direct_id:""===g.value?null:g.value,id:isNaN(parseInt(u.value))?null:parseInt(u.value),provider_vendor:b?1:0,enabled:1})},load_all:function(e){he(e)},save:function(e){be(e)},init:function(e){!function(e){if(console.log("Provider.init(settings)",e),e&&e.provider_detail){let t=$e(e.provider_detail);ne=t,e.provider_detail.company&&(console.log("Provider.init(settings)",e),Company.init(e.provider_detail.company)),ce(t)}P?(pe(),_e()):pe()}(e)},reset_form:function(){u.value="",$(m).val("").trigger("change"),_.value="",g.value="",p.checked=!0},provider_exists:function(e){ge(e)},enable_form_fields:function(){we()},disable_form_fields:function(){Ee()},index:function(e){var t;t=e,fe(),t&&t.providers&&he(t.providers)},edit:function(e){!function(e){let t={},n=[],i=[],r={},s={},c={};b&&(pe(),validator_init(re),ae=$(b).validate()),e&&(e.is_new&&(oe=e.is_new,a.disabled=!0,$(d).addClass("disabled"),$(o).addClass("disabled"),$(l).addClass("disabled")),e.provider_detail&&(n=(t=$e(e.provider_detail)).addresses?t.addresses:[],i=t.contacts?t.contacts:[],r=t.location?t.location:{},s=t.company?t.company:{},c=t.vendor?t.vendor:{})),Be(t),Vendor.init(c),Location.init(r),Address.init(n),Contact.init(i),Company.init(s),Vendor.setProvider(),Ee(),Ne()}(e)}}}(),Profile=function(){"use strict";const e=document.getElementById("table_profile_product_edit");document.getElementById("product_edit_profile_form_profile_name_filter"),document.getElementById("product_edit_profile_form");let t=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4;$(e);const n=function(e){let n={advanced_booking_date:null,advanced_booking_max:null,advanced_booking_min:null,allot_by_details:{created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},allot_by_id:null,checkin_dow:"",checkout_dow:"",created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),days_out:null,departure_dow:"",enabled:1,equal_duration:null,expires:null,id:null,inc_days_dow:"",max_duration:null,min_duration:1,min_length_days:1,modified_by:t,name:null,note:null,product_profile_details:{created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,modified_by:t,note:null,product_id:null,profile_id:null},quantity:null,release_amt:null,return_dow:"",sales_types_details:{class:null,created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},sales_types_id:null,transfer_sales_types_details:{class:null,created_by:t,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),enabled:1,id:null,modified_by:t,name:null,note:null,sort_order:999},transfer_sales_types_id:null,weekday_dow:""};return e&&(n.advanced_booking_date=e.advanced_booking_date?e.advanced_booking_date:null,n.advanced_booking_max=e.advanced_booking_max?e.advanced_booking_max:null,n.advanced_booking_min=e.advanced_booking_min?e.advanced_booking_min:null,n.allot_by_details.created_by=e.created_by?e.created_by:null,n.allot_by_details.date_created=e.date_created?e.date_created:formatDateMySQL(),n.allot_by_details.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),n.allot_by_details.enabled=e.enabled?e.enabled:1,n.allot_by_details.id=e.id?e.id:null,n.allot_by_details.modified_by=e.modified_by?e.modified_by:t,n.allot_by_details.name=e.name?e.name:null,n.allot_by_details.note=e.note?e.note:null,n.allot_by_details.sort_order=e.sort_order?e.sort_order:999),n},a=function(e){let t=[];e&&e.profiles&&(t=e.profiles),function(e){Profile.all=new Map,e||(e=[]),$.each(e,function(e,t){n(t)})}(t)};return{all:new Map,init:function(e){a(e)},edit:function(e){}}}();function FileManager(e,t){if(!(t&&t.source&&e))return console.log("Missing options."),console.log("|__ options",t),console.log("|__ options.source",t.source),void console.log("|__ options.sourceId",t.sourceId);let n=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,a=t.source,i=t.sourceId,o="file_manager_"+a,l={defaultFile:"",maxFileSize:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,showRemove:!0,showLoader:!0,showErrors:!0,errorTimeout:3e3,errorsPosition:"overlay",imgFileExtensions:["png","jpg","jpeg","gif","bmp","webp"],maxFileSizePreview:"5M",allowedFormats:["portrait","square","landscape"],allowedFileExtensions:["*"],urls:{remove:"/",update:"/",get:"get",upload:"/"},messages:{default:"Drag and drop a file here or click",replace:"Drag and drop or click to replace",remove:"Remove",error:"Ooops, something wrong happended."},error:{fileSize:"The file size is too big ({{ value }} max).",minWidth:"The image width is too small ({{ value }}}px min).",maxWidth:"The image width is too big ({{ value }}}px max).",minHeight:"The image height is too small ({{ value }}}px min).",maxHeight:"The image height is too big ({{ value }}px max).",imageFormat:"The image format is not allowed ({{ value }} only).",fileExtension:"The file is not allowed ({{ value }} only)."},tpl:{gallery:{wrap:""},preview:{wrapper:`<section id="${o}_preview" class="mb-4 p-0 filemanager-preview-wrapper d-flex align-items-center justify-content-center" />`,error:`<img id="${o}_image" src="/public/img/placeholder.jpg" alt="Preview Placeholder" class="img-fluid" />`,container:'<div class="filemanager-preview "/>',loader:"<div class='filemanager-loader'></div>",message:'<div class="filemanager-message w-100 text-center d-flex flex-column"><i class="fas fa-upload w-100 fa-4x mb-2"></i><p class="w-100 mt-4">Drag and drop a file here or click</p></div>',errorsContainer:'<div class="filemanager-errors-container"><ul></ul></div>',errorLine:'<p class="filemanager-error"></p>',clearButton:'<button type="button" class="filemanager-clear">remove</button>'},filename:'<p class="fileManager-filename"><span class="fileManager-filename-inner"></span></p>'}};this.userId=n,this.element=e,this.source=a,this.sourceId=i,this.baseId=o,this.isInit=!1,this.errorsEvent=$.Event("filemanager.errors"),this.errorsEvent.errors=[],this.isDisabled=!1,this.all=new Map,this.images=t.images?t.images:[],this.inputs={labels:{},buttons:{},fields:{},displays:{},errors:{}},this.detail={alt:null,caption:null,created_by:n,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),dimensions:null,enabled:1,extension:null,height:null,id:null,is_cover:0,is_shown:1,modified_by:n,name:null,note:null,path:null,size:null,thumbs_path:null,title:null,width:null},this.file={object:null,name:null,size:null,width:null,height:null,type:null},this.settings=$.extend(!0,l,t),Array.isArray(this.settings.allowedFormats)||(this.settings.allowedFormats=this.settings.allowedFormats.split(" ")),Array.isArray(this.settings.allowedFileExtensions)||(this.settings.allowedFileExtensions=this.settings.allowedFileExtensions.split(" ")),this.uploadProgress=this.uploadProgress.bind(this),this.uploadComplete=this.uploadComplete.bind(this),this.uploadFailed=this.uploadFailed.bind(this),this.uploadCanceled=this.uploadCanceled.bind(this),this.validate=this.validate.bind(this),this.isShown=this.isShown.bind(this),this.isCover=this.isCover.bind(this),this.clearElement=this.clearElement.bind(this),this.formHide=this.formHide.bind(this),this.formShow=this.formShow.bind(this),this.formRemove=this.formRemove.bind(this),this.formCancel=this.formCancel.bind(this),this.onChange=this.onChange.bind(this),this.formClear=this.formClear.bind(this),this.fileSelected=this.fileSelected.bind(this),this.formReset=this.formReset.bind(this),this.open=this.open.bind(this),this.load=this.load.bind(this),this.onFileReady=this.onFileReady.bind(this),this.displaySet=this.displaySet.bind(this),this.buildImageThumbnails=this.buildImageThumbnails.bind(this),this.formUpload=this.formUpload.bind(this),this.sendUpdateRequest=this.sendUpdateRequest.bind(this),this.init(t),this.createElements(),this.assignEvents(),this.loadAll(),this.formReset()}FileManager.prototype.createPreviewElements=function(){let e;console.log("FileManager.createPreviewElements()"),this.previewWrapper=$(this.settings.tpl.preview.wrapper),this.previewLoader=$(this.settings.tpl.preview.loader),this.previewContainer=$(this.settings.tpl.preview.container),this.previewMessage=$(this.settings.tpl.preview.message),this.previewWrapper.append(this.previewContainer),e=$(this.settings.tpl.preview.message).insertBefore(this.previewContainer),$(this.settings.tpl.preview.errorLine).appendTo(e),!0===this.settings.showLoader&&(this.loader=$(this.settings.tpl.preview.loader),this.previewWrapper.append(this.loader),this.hideLoader()),!0===this.settings.showErrors&&(this.previewErrorsContainer=$(this.settings.tpl.preview.errorsContainer),"outside"===this.settings.errorsPosition?this.previewErrorsContainer.insertAfter(this.previewWrapper):this.previewWrapper.append(this.previewErrorsContainer)),!1===this.isDisabled&&!0===this.settings.showRemove&&(this.clearButton=$(this.settings.tpl.preview.clearButton),this.previewWrapper.append(this.clearButton),this.clearButton.on("click",this.clearElement));let t=this.settings.defaultFile||"";""!==t.trim()&&(this.file.name=this.cleanFilename(t),this.setPreview(this.isImage(),t)),this.preview=this.previewWrapper},FileManager.prototype.setPreview=function(e,t){console.log("FileManager.setPreview(previewable, src)",this);let n=this.previewContainer;if(this.hideLoader(),this.preview.removeClass("has-error").addClass("has-preview"),!0===e){let e=$("<img alt='File Preview' class='img-fluid' src='"+t+"'/>");this.settings.height&&e.css("max-height",this.settings.height),this.previewContainer.empty(),e.appendTo(n)}else $("<i />").attr("class","filemanager-font-file").appendTo(n),$('<span class="filemanager-extension" />').html(this.getFileType()).appendTo(n);this.formShow()},FileManager.prototype.resetPreview=function(){console.log("FileManager.resetPreview()");let e=this.previewContainer;this.preview.removeClass("has-error"),this.preview.removeClass("has-preview"),e.find(".filemanager-extension").remove(),e.find("i").remove(),e.find("img").remove(),this.hideLoader()},FileManager.prototype.clearElement=function(){if(console.log("FileManager.clearElement()"),0===this.errorsEvent.errors.length){let e=$.Event("filemanager.beforeClear");this.inputs.fields.imageFile.trigger(e,[this]),!1!==e.result&&(this.resetFile(),this.inputs.fields.imageFile.val(""),this.resetPreview(),this.inputs.fields.imageFile.trigger($.Event("filemanager.afterClear"),[this])),this.formClear(),this.displayClear(),this.formHide()}},FileManager.prototype.hideLoader=function(e){$(this.loader).hide()},FileManager.prototype.showLoader=function(e){$(this.loader).show()},FileManager.prototype.clearErrors=function(){console.log("FileManager.clearErrors()"),this.preview.removeClass("has-errors"),void 0!==this.previewErrorsContainer&&this.previewErrorsContainer.children("ul").html("")},FileManager.prototype.pushError=function(e){console.log("FileManager.pushError(errorKey)",e);let t=$.Event("filemanager.error."+e);this.errorsEvent.errors.push(t),this.inputs.fields.imageFile.trigger(t,[this]),console.log("|__ this.errorsEvent.errors",this.errorsEvent.errors)},FileManager.prototype.showError=function(e){console.log("FileManager.showError(errorKey)",e),void 0!==this.previewErrorsContainer&&this.previewErrorsContainer.children("ul").append("<li>"+this.getError(e)+"</li>")},FileManager.prototype.getError=function(e){console.log("FileManager.getError(errorKey)",e);let t=this.settings.error[e],n="";return"fileSize"===e?n=this.settings.maxFileSize:"minWidth"===e?n=this.settings.minWidth:"maxWidth"===e?n=this.settings.maxWidth:"minHeight"===e?n=this.settings.minHeight:"maxHeight"===e?n=this.settings.maxHeight:"imageFormat"===e?n=this.settings.allowedFormats.join(", "):"fileExtension"===e&&(n=this.settings.allowedFileExtensions.join(", ")),""!==n?t.replace("{{ value }}",n):t},FileManager.prototype.createElements=function(){this.isInit=!0,this.inputs.buttons.close=$(`<a href="javascript:void(0);" id="${this.baseId+"_form_button_close"}" class="panel-button-close fas fa-times"/>`),this.inputs.buttons.upload=$(`<button type="button" id="${this.baseId+"_form_button_upload"}" name="submit" class="btn btn-primary btn-sm waves-effect waves-light" >upload</button>`),this.inputs.buttons.clear=$(`<button type="button" id="${this.baseId+"_form_button_clear"}" name="clear" class="btn btn-flat primary-text text-center p-1 mx-0 mb-0 waves-effect waves-light" >clear</button>`),this.inputs.buttons.cancel=$(`<button type="button" id="${this.baseId+"_form_button_cancel"}" name="cancel" class="btn btn-danger btn-sm waves-effect waves-light" >cancel</button>`),this.inputs.buttons.remove=$(`<button type="button" id="${this.baseId+"_form_button_remove"}" name="remove" class="btn btn-outline-danger btn-sm waves-effect waves-ligh" >remove</button>`),this.inputs.fields.imageFile=$(`<input type="file" id="${this.baseId+"_form_file_upload"}" name="${this.baseId+"_form_file_upload"}" />`),this.inputs.fields.imageId=$(`<input type="text" id="${this.baseId+"_form_id"}" name="${this.baseId+"_form_id"}" value="" placeholder="" class="form-control" readonly="readonly"/>`),this.inputs.fields.imageName=$(`<input type="text" id="${this.baseId+"_form_name"}" name="${this.baseId+"_form_name"}" value="" placeholder="" class="form-control" readonly="readonly"/>`),this.inputs.fields.imageEnabled=$(`<input type="checkbox" id="${this.baseId+"_form_enabled"}" name="${this.baseId+"_form_enabled"}" value="1" class="custom-control-input" />`),this.inputs.fields.imageIsShown=$(`<input type="checkbox" id="${this.baseId+"_form_is_shown"}" name="${this.baseId+"_form_is_shown"}" value="1" class="custom-control-input" />`),this.inputs.fields.imageIsCover=$(`<input type="checkbox" id="${this.baseId+"_form_is_cover"}" name="${this.baseId+"_form_is_cover"}" value="1" class="custom-control-input" />`),this.inputs.fields.imageCaption=$(`<textarea id="${this.baseId+"_form_caption"}" name="${this.baseId+"_form_caption"}" class="md-textarea short-description form-control" rows="4" maxlength="200"/>`),this.inputs.fields.imageAlt=$(`<input type="text" id="${this.baseId+"_form_alt"}" name="${this.baseId+"_form_alt"}" class="form-control"/>`),this.inputs.fields.imageTitle=$(`<input type="text" id="${this.baseId+"_form_title"}" name="${this.baseId+"_form_title"}" class="form-control"/>`),this.input=this.inputs.fields.imageFile,this.inputs.errors.imageFile=$(`<div id="${this.baseId+"_form_enabled"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageId=$(`<div id="${this.baseId+"_form_id"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageName=$(`<div id="${this.baseId+"_form_name"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageEnabled=$(`<div id="${this.baseId+"_form_enabled"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageIsShown=$(`<div id="${this.baseId+"_form_is_shown"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageIsCover=$(`<div id="${this.baseId+"_form_is_cover"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageCaption=$(`<div id="${this.baseId+"_form_caption"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageAlt=$(`<div id="${this.baseId+"_form_alt"}-error" class="error w-100 text-center"/>`),this.inputs.errors.imageTitle=$(`<div id="${this.baseId+"_form_title"}-error" class="error w-100 text-center"/>`),this.inputs.labels.imageEnabled=$(`<label for="${this.baseId+"_form_enabled"}" class="custom-control-label p-0">Enabled</label>`),this.inputs.labels.imageIsShown=$(`<label for="${this.baseId+"_form_is_shown"}" class="custom-control-label p-0">Shown</label>`),this.inputs.labels.imageIsCover=$(`<label for="${this.baseId+"_form_is_cover"}" class="custom-control-label p-0">Cover</label>`),this.inputs.labels.imageId=$(`<label for="${this.baseId+"_form_enabled"}" >Id:</label>`),this.inputs.labels.imageTitle=$(`<label for="${this.baseId+"_form_title"}" >Title:</label>`),this.inputs.labels.imageAlt=$(`<label for="${this.baseId+"_form_alt"}" >Alt:</label>`),this.inputs.labels.imageCaption=$(`<label for="${this.baseId+"_form_caption"}" >Caption:</label>`),this.inputs.labels.imageNameField=$(`<label for="${this.baseId+"_form_name"}" >Name:</label>`),this.inputs.labels.imageNameDetail=$('<span class="font-weight-bolder" >Name:</span>'),this.inputs.labels.imageRatio=$('<span class="font-weight-bolder" >Ratio:</span>'),this.inputs.labels.imageSize=$('<span class="font-weight-bolder" >Size:</span>'),this.inputs.labels.imageExtension=$('<span class="font-weight-bolder" >Extension:</span>'),this.inputs.labels.imageDimensions=$('<span class="font-weight-bolder" >Dimensions:</span>'),this.inputs.labels.imageType=$('<span class="font-weight-bolder" >Type:</span>'),this.inputs.labels.imageHeight=$('<span class="font-weight-bolder" >Height:</span>'),this.inputs.labels.imageWidth=$('<span class="font-weight-bolder" >Width:</span>'),this.inputs.displays.imageRatio=$(`<span id="${this.baseId+"_form_ratio"}" />`),this.inputs.displays.imageHeight=$(`<span id="${this.baseId+"_form_height"}" />`),this.inputs.displays.imageWidth=$(`<span id="${this.baseId+"_form_width"}" />`),this.inputs.displays.imageSize=$(`<span id="${this.baseId+"_form_size"}" />`),this.inputs.displays.imageExtension=$(`<span id="${this.baseId+"_form_extension"}"/>`),this.inputs.displays.imageName=$(`<span id="${this.baseId+"_form_name"}" />`),this.inputs.displays.imageDimensions=$(`<span id="${this.baseId+"_form_dimensions"}" />`),this.inputs.displays.imageType=$(`<span id="${this.baseId+"_form_type"}" />`),this.createPreviewElements(),this.detailSection=$(`<section id="${this.baseId+"_detail"}" class="card card-body grey lighten-3 p-3 mb-2"/>`),this.render()},FileManager.prototype.fileGallery=function(){let e,t,n,a,i,o,l,d,r,s,c,u=this.source?this.source.ucwords()+" Images:":"Files";return r=$("<i/>",{class:"fas fa-sliders-h"}),t=$("<span/>",{text:u}),this.inputs.buttons.toggle=$("<a/>",{id:this.baseId+"_gallery_toggle"}).append(r),i=$('<hr class="ml-3 mr-3 mt-1 mb-3 color-dark"/>'),(n=$("<h5/>",{class:"card-title label",id:this.baseId+"_gallery_heading"})).append(t),e=$("<div/>",{class:"d-flex justify-content-between"}).append(n,this.inputs.buttons.toggle),this.galleryContainer=$("<div/>",{id:this.baseId+"_gallery_container",class:"row"}),d=$("<span/>",{text:"Choose File",id:this.baseId+"_gallery_file_upload_label"}),this.inputs.fields.imageFileButton=$("<div/>",{class:"btn btn-secondary btn-sm waves-effect waves-light"}).append(d,this.inputs.fields.imageFile),l=$("<div/>",{class:"d-flex justify-content-end mb-2"}).append(this.inputs.fields.imageFileButton),o=$("<div/>",{class:"file-field"}).append(l),s=$("<div/>",{class:"col-12"}).append(o),c=$("<div/>",{class:"row"}).append(s),a=$("<section/>",{class:"card card-body z-depth-0 mb-2",id:this.baseId+"_gallery"}).append(e,i,this.galleryContainer,c)},FileManager.prototype.fileFormFields=function(){let e,t,n,a,i,o,l,d,r,s,c,u,m,_,p,g,f,y,v,h,b,I,w,E,B,k,N,M,x,C,S;return h=$("<div class='form-element'/>"),b=$("<div class='form-element'/>"),I=$("<div class='form-element'/>"),w=$("<div class='form-element'/>"),E=$("<div class='form-element'/>"),N=$("<div class='form-element mb-4'/>"),k=$("<div class='form-element'/>"),B=$("<div class='form-element'/>"),d=$("<div/>",{class:"custom-control custom-switch"}).append(this.inputs.fields.imageEnabled,this.inputs.labels.imageEnabled),r=$("<div/>",{class:"custom-control custom-switch"}).append(this.inputs.fields.imageIsShown,this.inputs.labels.imageIsShown),s=$("<div/>",{class:"custom-control custom-switch"}).append(this.inputs.fields.imageIsCover,this.inputs.labels.imageIsCover),h.append(this.inputs.labels.imageId,this.inputs.fields.imageId,this.inputs.errors.imageId),b.append(this.inputs.labels.imageNameField,this.inputs.fields.imageName,this.inputs.errors.imageName),I.append(d,this.inputs.errors.imageEnabled),E.append(s,this.inputs.errors.imageIsCover),w.append(r,this.inputs.errors.imageIsShown),B.append(this.inputs.labels.imageTitle,this.inputs.fields.imageTitle,this.inputs.errors.imageTitle),k.append(this.inputs.labels.imageAlt,this.inputs.fields.imageAlt,this.inputs.errors.imageAlt),N.append(this.inputs.labels.imageCaption,this.inputs.fields.imageCaption,this.inputs.errors.imageCaption),this.inputs.fields.progress=$(`<div id="${this.baseId+"_progress"}" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"/>`),S=$("<div class='progress'/>").append(this.inputs.fields.progress),c=$("<div/>",{class:"col-12 col-md-6"}).append(h),u=$("<div/>",{class:"col-12 col-md-6"}).append(b),m=$("<div/>",{class:"col-12 col-md-4 d-flex align-self-end justify-content-center pb-2 mb-2 mt-4"}).append(I),_=$("<div/>",{class:"col-12 col-md-4 d-flex align-self-end justify-content-center pb-2 mb-2 mt-4"}).append(w),p=$("<div/>",{class:"col-12 col-md-4 d-flex align-self-end justify-content-center pb-2 mb-2 mt-4"}).append(E),g=$("<div/>",{class:"col-12"}).append(B),f=$("<div/>",{class:"col-12"}).append(k),y=$("<div/>",{class:"col-12"}).append(N),v=$("<div/>",{class:"col-12"}).append(S),x=$("<div/>",{class:"col-12 col-md-6 text-left"}).append(this.inputs.buttons.cancel,this.inputs.buttons.remove),C=$("<div/>",{class:"col-12 col-md-6 text-right"}).append(this.inputs.buttons.clear,this.inputs.buttons.upload),t=$("<div/>",{class:"row"}).append(c,u),n=$("<div/>",{class:"row"}).append(m,_,p),a=$("<div/>",{class:"row"}).append(g),i=$("<div/>",{class:"row"}).append(f),o=$("<div/>",{class:"row"}).append(y),l=$("<div/>",{class:"row mt-2"}).append(v),M=$("<div/>",{class:"row mt-2"}).append(x,C),e=$("<section/>",{id:this.baseId+"_form_data"}).append(t,n,a,i,o,l,M)},FileManager.prototype.fileForm=function(){let e,t,n,a;return this.form=$(`<form id="${this.baseId}_form" class="card card-body z-depth-0 mb-2" novalidate="novalidate"/>`),t=$("<span/>",{text:"Image"}),n=$("<h5/>",{class:"card-title",id:this.baseId+"_form_heading"}),e=$("<h6/>",{id:this.baseId+"_form_subheading"}),a=$('<hr class="ml-3 mr-3 mt-1 mb-3 color-dark"/>'),n.append(t,this.inputs.buttons.close),this.form.append(n,e,a,this.preview,this.fileDetail(this),this.fileFormFields(this)),this.form},FileManager.prototype.fileDetail=function(){let e,t,n,a,i,o,l,d,r,s,c,u,m,_,p,g,f,y,v,h;return i=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageNameDetail),o=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageName),l=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageSize),d=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageSize),r=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageDimensions),s=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageDimensions),c=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageRatio),u=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageRatio),m=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageHeight),_=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageHeight),p=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageWidth),g=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageWidth),f=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageType),y=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageType),v=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.labels.imageExtension),h=$('<div class="col-12 col-md-3 p-1 text-truncate"/>').append(this.inputs.displays.imageExtension),e=$("<div/>",{class:"row"}).append(i,o,l,d),t=$("<div/>",{class:"row"}).append(r,s,c,u),n=$("<div/>",{class:"row"}).append(m,_,p,g),a=$("<div/>",{class:"row"}).append(f,y,v,h),this.detailSection.append(e,t,n,a),this.detailSection},FileManager.prototype.formShow=function(){console.log("this.formShow()");let e=document.getElementById(this.inputs.fields.imageFile.attr("id")),t=document.getElementById(this.inputs.buttons.toggle.attr("id"));this.form.show(),t.disabled=!0,e.disabled=!0},FileManager.prototype.formHide=function(){console.log("this.formHide()");let e=document.getElementById(this.inputs.fields.imageFile.attr("id")),t=document.getElementById(this.inputs.buttons.toggle.attr("id"));this.form.hide(),this.inputs.buttons.upload.html("upload"),t.disabled=!1,e.disabled=!1},FileManager.prototype.formClear=function(){console.log("FileManager.formClear()",this.inputs);let e=document.getElementById(this.inputs.fields.progress.attr("id"));$(this.inputs.fields.imageId).val(""),$(this.inputs.fields.imageName).val(""),$(this.inputs.fields.imageAlt).val(""),$(this.inputs.fields.imageTitle).val(""),$(this.inputs.fields.imageCaption).val(""),$(this.inputs.fields.imageIsCover).attr("checked",!1),$(this.inputs.fields.imageEnabled).attr("checked",!0),$(this.inputs.fields.imageIsShown).attr("checked",!0),$("img.selected").removeClass("selected"),$(e).css({width:"0%","background-color":"#007bff",color:"#fff"}),clearValidation(this.form)},FileManager.prototype.formReset=function(){console.log("this.formReset()"),this.formClear(),this.displayClear(),this.resetPreview(),this.clearSelected()},FileManager.prototype.formCancel=function(){console.log("FileManager.formCancel()"),this.formReset(),this.formHide()},FileManager.prototype.formRemove=function(){console.log("FileManager.formRemove()");const e=this.inputs.fields.imageId[0];let t=this;if(e){let n=isNaN(parseInt(e.value))?null:parseInt(e.value);if(null!==n){console.log("|__ imageId",n);let e=t.all.get(n);if(e){console.log("|__ image",e);let a=document.getElementById("image_"+n);a&&confirmDialog("Would you like to delete this image?",e=>{e&&this.sendRemoveRequest({image_id:n,source:t.source,source_id:t.sourceId},function(e){e&&e.deleted&&(!0!==e.deleted&&"true"!==e.deleted||(t.all.delete(n),$(a).parent("div").remove(),t.formReset(),t.formHide(),toastr.success("File Removed","File Manager")))})})}}}},FileManager.prototype.formLoad=function(e){if(console.log("FileManager.formLoad(image)",e),e){let t=isNaN(parseInt(e.id))?null:parseInt(e.id),n=e.name?e.name:null,a=e.title?e.title:null,i=e.alt?e.alt:null,o=e.caption?e.caption:null,l=e.enabled&&1===e.enabled,d=!(!e.is_shown||1!==e.is_shown),r=!(!e.is_cover||1!==e.is_cover),s=e.path?e.path:null,c=e.name?e.name:null,u=e.extension?e.extension:null;console.log("|__ imageId",t),console.log("|__ imageName",n),console.log("|__ imageTitle",a),console.log("|__ imageAlt",i),console.log("|__ imageCaption",o),console.log("|__ imageEnabled",l),console.log("|__ imageIsShown",d),console.log("|__ imageIsCover",r),$(this.inputs.fields.imageId).val(t),$(this.inputs.fields.imageName).val(n),$(this.inputs.fields.imageAlt).val(i),$(this.inputs.fields.imageTitle).val(a),$(this.inputs.fields.imageCaption).val(o),$(this.inputs.fields.imageIsCover).attr("checked",r),$(this.inputs.fields.imageEnabled).attr("checked",l),$(this.inputs.fields.imageIsShown).attr("checked",d);let m=is_null(s)||is_null(c)||is_null(u)?this.settings.defaultFile?this.settings.defaultFile:null:`${s}/${c}.${u}`;console.log("|__ path",m),this.setPreview(this.isImage(),m),this.displaySet(),this.form.show()}},FileManager.prototype.displayReset=function(){console.log("FileManager.displayReset()",this),this.displayClear()},FileManager.prototype.displayClear=function(){console.log("FileManager.displayClear()",this),$(this.inputs.displays.imageName).html("&nbsp;"),$(this.inputs.displays.imageType).html("&nbsp;"),$(this.inputs.displays.imageRatio).html("&nbsp;"),$(this.inputs.displays.imageExtension).html("&nbsp;"),$(this.inputs.displays.imageDimensions).html("&nbsp;"),$(this.inputs.displays.imageSize).html("&nbsp;"),$(this.inputs.displays.imageHeight).html("&nbsp;"),$(this.inputs.displays.imageWidth).html("&nbsp;")},FileManager.prototype.displaySet=function(){let e,t,n,a,i,o,l,d;console.log("FileManager.displaySet()",this.detail),this.displayReset(),e=this.detail.name?this.detail.name:"&nbsp;",t=this.detail.type?this.detail.type:"&nbsp;",n=this.detail.ratio?this.detail.ratio:"&nbsp;",a=this.detail.extension?this.detail.extension:"&nbsp;",i=this.detail.dimensions?this.detail.dimensions:"&nbsp;",o=this.detail.size?this.detail.size:"&nbsp;",l=isNaN(parseInt(this.detail.height))?"&nbsp;":this.detail.height+"px",d=isNaN(parseInt(this.detail.width))?"&nbsp;":this.detail.width+"px",$(this.inputs.displays.imageName).html(e),$(this.inputs.displays.imageType).html(t),$(this.inputs.displays.imageRatio).html(n),$(this.inputs.displays.imageExtension).html(a),$(this.inputs.displays.imageDimensions).html(i),$(this.inputs.displays.imageSize).html(o),$(this.inputs.displays.imageHeight).html(l),$(this.inputs.displays.imageWidth).html(d)},FileManager.prototype.handleError=function(e,t,n){n||(n="error"),t||(t="File Manager"),toastr[n](e,t)},FileManager.prototype.defaultDetail=function(){this.detail={alt:null,caption:null,created_by:this.userId,date_created:formatDateMySQL(),date_modified:formatDateMySQL(),dimensions:null,enabled:1,extension:null,height:null,id:null,is_cover:0,is_shown:1,modified_by:this.userId,name:null,note:null,path:null,size:null,thumbs_path:null,title:null,width:null}},FileManager.prototype.setDetail=function(e){if(console.log("FileManager.setDetail(image)",e),this.defaultDetail(),e)return this.detail.alt=e.alt?e.alt:null,this.detail.caption=e.caption?e.caption:null,this.detail.created_by=isNaN(parseInt(this.created_by))?this.userId:parseInt(this.created_by),this.detail.date_created=e.date_created?e.date_created:formatDateMySQL(),this.detail.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),this.detail.dimensions=e.dimensions?e.dimensions:null,this.detail.enabled=e.enabled&&1===e.enabled?1:0,this.detail.extension=e.extension?e.extension:null,this.detail.height=isNaN(parseInt(e.height))?null:parseInt(e.height),this.detail.id=isNaN(parseInt(e.id))?null:parseInt(e.id),this.detail.is_cover=e.is_cover&&1===e.is_cover?1:0,this.detail.is_shown=e.is_shown&&1===e.is_shown?1:0,this.detail.modified_by=isNaN(parseInt(this.modified_by))?this.userId:parseInt(this.modified_by),this.detail.name=e.name?e.name:null,this.detail.note=e.note?e.note:null,this.detail.path=e.path?e.path:null,this.detail.size=e.size?e.size:null,this.detail.thumbs_path=e.thumbs_path?e.thumbs_path:null,this.detail.title=e.title?e.title:null,this.detail.width=isNaN(parseInt(e.width))?null:parseInt(e.width),this.setFile(e),console.log("|__ this.detail",this.detail),console.log("|__ this.file",this.file),this.detail},FileManager.prototype.loadAll=function(){console.log("this.loadAll()"),this.images||(this.images=[]);let e=new Map,t=this;$.each(this.images,function(n,a){t.setDetail(a),e.set(a.id,a),t.galleryContainer.append(t.buildImageThumbnails(a))}),this.all=e},FileManager.prototype.buildImageThumbnails=function(e){console.log("this.buildImageThumbnails(image)",e);let t="",n="";if(e){let a=this,i=(e.path&&e.path,e.alt?e.alt:null),o=e.id&&!isNaN(parseInt(e.id))?parseInt(e.id):null,l=!(!e.is_cover||1!==e.is_cover),d=!(!e.is_shown||1!==e.is_shown),r=e.thumbs_path?e.thumbs_path:null,s=e.path?e.path:null,c=e.name?e.name:null,u=e.extension?e.extension:null;if(l&&(t="is-cover-image"),d&&(n="is-shown"),null!==r&&null!==s&&null!==c&&null!==u){let l=$(`<img id="image_${o}" data-id="${o}" class="img-thumbnail ${t} ${n}" alt="${i}" src="${r}/${c}.${u}" />`);return l.on("click",function(){a.edit(e.id)}),$("<div/>",{class:"col-12 col-md-4 mb-2"}).append(l)}}},FileManager.prototype.clearSelected=function(){console.log("this.clearSelected()"),$("img.selected").removeClass("selected")},FileManager.prototype.translateMessages=function(){console.log("FileManager.translateMessages()");for(let e in this.settings.tpl){console.log("|__ name",e);for(let t in this.settings.messages)console.log("|__ |__ key",t),this.settings.tpl[e]?this.settings.tpl[e]=this.settings.tpl[e].replace("{{ "+t+" }}",this.settings.messages[t]):this.settings.tpl.preview[e]&&(this.settings.tpl.preview[e]=this.settings.tpl.preview[e].replace("{{ "+t+" }}",this.settings.messages[t]))}},FileManager.prototype.cleanFilename=function(e){var t=e.split("\\").pop();return t===e&&(t=e.split("/").pop()),""!==e?t:""},FileManager.prototype.validateImage=function(){0!==this.settings.minWidth&&this.settings.minWidth>=this.file.width&&this.pushError("minWidth"),0!==this.settings.maxWidth&&this.settings.maxWidth<=this.file.width&&this.pushError("maxWidth"),0!==this.settings.minHeight&&this.settings.minHeight>=this.file.height&&this.pushError("minHeight"),0!==this.settings.maxHeight&&this.settings.maxHeight<=this.file.height&&this.pushError("maxHeight"),"-1"===this.settings.allowedFormats.indexOf(this.getImageFormat())&&this.pushError("imageFormat")},FileManager.prototype.checkFileSize=function(){0!==this.sizeToByte(this.settings.maxFileSize)&&this.file.size>this.sizeToByte(this.settings.maxFileSize)&&this.pushError("fileSize")},FileManager.prototype.isFileExtensionAllowed=function(){return console.log("FileManager.isFileExtensionAllowed"),"-1"!==this.settings.allowedFileExtensions.indexOf("*")||"-1"!==this.settings.allowedFileExtensions.indexOf(this.getFileType())||(this.pushError("fileExtension"),!1)},FileManager.prototype.isImage=function(e){console.log("FileManager.isImage");let t=this.settings.imgFileExtensions,n=this.getFileType();return t.indexOf(n)>=0},FileManager.prototype.getFileType=function(){return console.log("FileManager.getFileType()"),this.file.name.split(".").pop().toLowerCase()},FileManager.prototype.getImageFormat=function(){return this.file.width===this.file.height?"square":this.file.width<this.file.height?"portrait":this.file.width>this.file.height?"landscape":void 0},FileManager.prototype.setFileName=function(e){console.log("FileManager.setFileName(file)",e);let t,n=null,a=[];if(e&&e.name){let i=e.name.split(".");if(i.length){n=i[i.length-1];for(let e=0;e<i.length-1;e++)a.push(i[e]);t=a.join(".")}}this.detail.name=t,this.detail.extension=n},FileManager.prototype.setFileDetail=function(e){console.log("FileManager.setFileDetail(file)",e),this.detail.path=`/public/img/${this.source}/${this.sourceId}`,this.detail.thumbs_path=`/public/img/${this.source}/${this.sourceId}`,this.detail.id=null,this.detail.title=null,this.detail.alt=null,this.detail.title=null,this.detail.caption=null,this.detail.enabled=1,this.detail.is_shown=1,this.detail.is_cover=0,this.detail.date_created=formatDateMySQL(),this.detail.date_modified=formatDateMySQL(),this.detail.created_by=this.userId,this.detail.modified_by=this.userId,this.detail.note=null},FileManager.prototype.setFileDimensions=function(e,t){console.log("FileManager.setFileDimensions(width, height)",e,t),this.file.width=null,this.file.height=null,this.detail.dimensions=null,this.detail.width=null,this.detail.height=null,e&&t&&(this.file.width=e,this.file.height=t,this.detail.dimensions=`${e} x ${t}`,this.detail.width=e,this.detail.height=t)},FileManager.prototype.setFileSize=function(e){console.log("FileManager.setFileSize(file)",e);let t=null;t=e.size>1048576?(Math.round(100*e.size/1048576)/100).toString()+"MB":(Math.round(100*e.size/1024)/100).toString()+"KB",this.detail.size=t},FileManager.prototype.setFileInformation=function(e){console.log("FileManager.setFileInformation(file)",e),this.file.object=e,this.file.name=e.name,this.file.size=e.size,this.file.type=e.type,this.file.width=null,this.file.height=null,this.detail.type=e.type},FileManager.prototype.sizeToByte=function(e){let t=0;if(0!==e){let n=e.slice(-1).toUpperCase(),a=1024,i=1024*a,o=1024*i;"K"===n?t=parseFloat(e)*a:"M"===n?t=parseFloat(e)*i:"G"===n&&(t=parseFloat(e)*o)}return t},FileManager.prototype.findClosest=function(e,t){console.log("FileManager.findClosest(arrSorted, value)",e,t);let n=e[0],a=Math.abs(e[0]-t);for(let i=1;i<e.length;i++){let o=Math.abs(e[i]-t);if(!(o<a))return n;a=o,n=e[i]}return e[e.length-1]},FileManager.prototype.estimateAspectRatio=function(e,t){console.log("FileManager.estimateAspectRatio(width, height)",e,t);let n=Math.max(e,t)/Math.min(e,t);if(n in LOOKUP)return void(this.detail.ratio=LOOKUP[n]);let a=this.findClosest(RATIOS,n);Math.abs(a-n)<=ERROR_ALLOWED?this.detail.ratio=LOOKUP[a]:this.detail.ratio=Math.round(100*n)/100+":1"},FileManager.prototype.resetFile=function(){console.log("FileManager.resetFile()"),this.file.object=null,this.file.name=null,this.file.size=null,this.file.type=null,this.file.width=null,this.file.height=null},FileManager.prototype.setFile=function(e){if(console.log("FileManager.setFile(file)",e),this.resetFile(),e){let t=e.name&&e.extension?e.name+"."+e.extension:null,n=e.extension?FILE_TYPES[e.extension]:null,a=e.size&&!isNaN(parseInt(formatSize(e.size)))?parseInt(formatSize(e.size)):null,i=e.size?e.size:null,o=e.width&&!isNaN(parseInt(e.width))?parseInt(e.width):null,l=e.height&&!isNaN(parseInt(e.height))?parseInt(e.height):null;this.file.object=e.object?e.object:null,this.file.size=a,this.file.name=t,this.file.sizeFormatted=i,this.file.type=n,this.file.width=o,this.file.height=l,this.detail.type=n,this.detail.width=o,this.detail.height=l,this.setFileDimensions(this.file.width,this.file.height),this.estimateAspectRatio(this.file.width,this.file.height)}},FileManager.prototype.fileSelected=function(e){console.log("FileManager.fileSelected(event)",e),this.readFile(this.inputs.fields.imageFile[0])},FileManager.prototype.readFile=function(e){console.log("FileManager.readFile(input)",e),e&&e.files[0]||this.handleError("Missing fields","File Manager","error");const t=new FileReader,n=new Image;let a=e.files[0],i=null,o=this,l=$.Event("filemanager.fileReady"),d=document.getElementById($(this.inputs.buttons.remove).attr("id"));this.errorsEvent.errors=[],this.showLoader(),this.setFileInformation(a),this.setFileDetail(a),this.checkFileSize(),this.isFileExtensionAllowed(),this.isImage()&&this.file.size<this.sizeToByte(this.settings.maxFileSizePreview)?(this.inputs.fields.imageFile.on("filemanager.fileReady",this.onFileReady),t.readAsDataURL(a),t.onload=function(e){i=e.target.result,n.src=e.target.result,n.onload=function(){o.setFileDimensions(this.width,this.height),o.estimateAspectRatio(this.width,this.height),o.setFileSize(a),o.setFileName(a),o.validateImage(),$(o.input).trigger(l,[!0,i]),console.log("|__ file",o.file),console.log("|__ detail",o.detail),o.displaySet(),d.disabled=!0}}.bind(this)):this.onFileReady(!1)},FileManager.prototype.onFileReady=function(e,t,n){if(console.log("FileManager.onFileReady(event, previewable, src)",e),$(this.inputs.fields.imageFile).off("fileManager.fileReady",this.onFileReady),console.log("|__ this.errorsEvent.errors",this.errorsEvent.errors),0===this.errorsEvent.errors.length)this.setPreview(t,n);else{this.inputs.fields.imageFile.trigger(this.errorsEvent,[this]);for(let e=this.errorsEvent.errors.length-1;e>=0;e--){let t=this.errorsEvent.errors[e].namespace.split(".").pop();this.showError(t)}if(void 0!==this.previewErrorsContainer){this.previewErrorsContainer.addClass("visible");let e=this.previewErrorsContainer,t=this.preview;setTimeout(function(){e.removeClass("visible"),t.removeClass("has-error")},this.settings.errorTimeout)}this.resetPreview()}},FileManager.prototype.onChange=function(e){""!==$(this.inputs.fields.imageFile).val()?(this.formReset(),this.fileSelected(e)):this.formReset(e)},FileManager.prototype.isShown=function(){console.log("FileManager.isShown()");const e=document.getElementById($(this.inputs.fields.imageIsShown).attr("id")),t=document.getElementById($(this.inputs.fields.imageId).attr("id"));if(console.log("|__ _is_shown",e),console.log("|__ _image_id",t),e&&t){let n=isNaN(parseInt(t.value))?null:parseInt(t.value);if(n){let t=document.getElementById("image_"+n);t&&(!0===e.checked?$(t).addClass("is-shown"):$(t).removeClass("is-shown"))}}},FileManager.prototype.isCover=function(){console.log("FileManager.isCover()");const e=document.getElementById($(this.inputs.fields.imageIsCover).attr("id")),t=document.getElementById($(this.inputs.fields.imageId).attr("id"));if(console.log("|__ _is_cover",e),console.log("|__ _image_id",t),e&&t){let n=isNaN(parseInt(t.value))?null:parseInt(t.value);if(n){let t=document.getElementById("image_"+n);t&&(!0===e.checked?($("img.is-cover-image").removeClass("is-cover-image"),$(t).addClass("is-cover-image")):$(t).removeClass("is-cover-image"))}}},FileManager.prototype.formUpload=function(){console.log("FileManager.formUpload()");const e=document.getElementById($(this.inputs.fields.imageId).attr("id")),t=document.getElementById($(this.inputs.fields.imageAlt).attr("id")),n=document.getElementById($(this.inputs.fields.imageTitle).attr("id")),a=document.getElementById($(this.inputs.fields.imageCaption).attr("id")),i=document.getElementById($(this.inputs.fields.imageIsShown).attr("id")),o=document.getElementById($(this.inputs.fields.imageEnabled).attr("id")),l=document.getElementById($(this.inputs.fields.imageIsCover).attr("id")),d=document.getElementById($(this.inputs.displays.imageHeight).attr("id")),r=document.getElementById($(this.inputs.displays.imageWidth).attr("id")),s=document.getElementById($(this.inputs.displays.imageExtension).attr("id")),c=document.getElementById($(this.inputs.displays.imageDimensions).attr("id")),u=document.getElementById($(this.inputs.displays.imageSize).attr("id")),m=document.getElementById($(this.inputs.displays.imageRatio).attr("id")),_=document.getElementById($(this.inputs.fields.imageFile).attr("id")),p=document.getElementById($(this.inputs.displays.imageType).attr("id"));let g,f,y,v,h,b,I,w,E,B,k,N,M,x,C,S,P,D,L,F,T=null,R=new FormData,q=new XMLHttpRequest,A=this;F=(F=d?d.innerHTML:null).replace("px",""),F=parseInt(F),T=(T=r?r.innerHTML:null).replace("px",""),T=parseInt(T),D=e&&!isNaN(parseInt(e.value))?parseInt(e.value):null,x=a&&""!==a.value?a.value:null,N=n&&""!==n.value?n.value:null,I=p&&""!==p.innerHTML?p.innerHTML:null,M=t&&""!==t.value?t.value:null,C=i&&!0===i.checked?1:0,P=o&&!0===o.checked?1:0,S=l&&!0===l.checked?1:0,b=document.getElementById($(this.inputs.displays.imageName).attr("id"))?document.getElementById($(this.inputs.displays.imageName).attr("id")).innerText:null,h=s?s.innerText:null,v=u?u.innerText:null,E=c?c.innerText:null,y=T?isNaN(parseInt(T))?null:parseInt(T):null,f=F?isNaN(parseInt(F))?null:parseInt(F):null,w=m?m.innerText:null,B=A.source,k=A.sourceId;let O={alt:M,caption:x,dimensions:E,directory:B,directory_id:k,enabled:P,extension:h,height:f,id:D,is_cover:S,is_shown:C,name:b,path:g=`/public/img/${B}/${k}`,ratio:w,size:v,thumbs_path:L=`/public/thumbs/${B}/${k}`,type:I,title:N,width:y};if(this.validate()){null!==(isNaN(parseInt(e.value))?null:parseInt(e.value))?confirmDialog("Would you like to update this image?",e=>{e&&this.sendUpdateRequest(removeNulls(O),function(e){if(e){console.log("|__ data",e);let t=A.setDetail(e[0]?e[0]:e);if(t.id&&t.name){console.log("|__ detail",t);let e=A.all.get(t.id);console.log("|__ image",e),A.all.set(t.id,t),A.formReset(),A.formHide(),toastr.success(`${t.name} - has been updated`,"File Manager")}else console.log("|__ data",e),toastr.error(`${t.name} - has not been updated`,"File Manager")}})}):confirmDialog("Would you like to add this image?",e=>{if(e){let e=_.files[0];if(e)switch(O.file=e,R.append("dimensions",E),R.append("extension",h),R.append("file",_.files[0],`${b}.${h}`),R.append("height",f),R.append("name",b),R.append("path",g),R.append("thumbs_path",L),R.append("ratio",w),R.append("size",v),R.append("type",I),R.append("width",y),R.append("directory",B),R.append("directory_id",k),R.append("title",N),R.append("enabled",P),R.append("is_shown",C),R.append("is_cover",S),R.append("alt",M),R.append("caption",x),q.upload.addEventListener("progress",this.uploadProgress,!1),q.addEventListener("load",this.uploadComplete,!1),q.addEventListener("error",this.uploadFailed,!1),q.addEventListener("abort",this.uploadCanceled,!1),B.toLowerCase()){case"product":q.open("POST","/api/v1.0/upload/product"),q.send(R);break;case"unit":q.open("POST","/api/v1.0/upload/unit"),q.send(R);break;case"company":q.open("POST","/api/v1.0/upload/company"),q.send(R);break;case"user":q.open("POST","/api/v1.0/upload/user"),q.send(R);break;default:return}}})}},FileManager.prototype.uploadComplete=function(e){console.log("FileManager.uploadComplete(event)",e);let t=null;if(e&&e.target&&e.target.responseText){const n=JSON.parse(e.target.responseText);if(console.log("image",n),n)if(n.status&&"success"===n.status&&void 0!==n.result)t=n.result[0]?n.result[0]:n.result,this.formReset(),this.formHide(),this.all.set(t.id,t),this.galleryContainer.append(this.buildImageThumbnails(t)),toastr.success(`Image ${t.name} was added.`,"File Manager");else if(n.status&&"error"===n.status&&void 0!==n.error){t=n.error;let e=1,a=t.length;$.each(t,function(t,n){console.log(`Error(${e} of ${a}): `,n),e++}),this.formReset(),this.formHide(),toastr.warning("Image was added with issues.","File Manager")}}},FileManager.prototype.uploadProgress=function(e){console.log("FileManager.uploadProgress(event)",e);let t=document.getElementById(this.inputs.fields.progress.attr("id"));if(e.lengthComputable){let n=Math.round(100*e.loaded/e.total);t.innerHTML=n.toString()+"%",$(t).css({width:`${n}%`,"background-color":"#007bff",color:"#fff"})}else t.innerHTML="unable to compute",$(t).css({width:"100%","background-color":"#c58e34",color:"#06030a"})},FileManager.prototype.uploadFailed=function(e){console.log("FileManager.uploadFailed(event)",e)},FileManager.prototype.uploadCanceled=function(e){console.log("FileManager.uploadFailed(event)",e)},FileManager.prototype.sendRemoveRequest=function(e,t){if(console.log("FileManager.sendRemoveRequest(dataToSend, callback)",e,t),e){let n="/api/v1.0/images/remove";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){return console.log("error",e),this.handleError("Error Removing Image.","Image Manager","error")}}},FileManager.prototype.sendUpdateRequest=function(e,t){console.log("FileManager.sendUpdateRequest(dataToSend, callback)",e,t);let n=this,a=this.source?this.source:null,i=isNaN(parseInt(this.sourceId))?null:parseInt(this.sourceId);if(e&&null!==a&&null!==i){let a="/api/v1.0/images/update";try{sendPostRequest(a,e,function(e,n,a){if(e)return t(e)})}catch(e){return console.log("error",e),n.handleError("Error Retrieving Images.","Image Manager","error")}}},FileManager.prototype.validate=function(){console.log("FileManager.validate()");let e=this.form[0];return $(e).valid()},FileManager.prototype.formRules=function(){console.log("FileManager.formRules()");let e={},t={};return e[`file_manager_${this.source}_form_title`]={required:!0},e[`file_manager_${this.source}_form_alt`]={required:!0},e[`file_manager_${this.source}_form_caption`]={required:!0},t[`file_manager_${this.source}_form_title`]={required:"Field is required."},t[`file_manager_${this.source}_form_alt`]={required:"Field is required."},t[`file_manager_${this.source}_form_caption`]={required:"Field is required."},{rules:e,messages:t}},FileManager.prototype.assignEvents=function(){console.log("FileManager.assignEvents()");let e=this.form[0],t=this.formRules();initializeValidator(t),this.inputs.buttons.toggle.on("click",this.open),this.inputs.buttons.close.on("click",this.formHide),this.inputs.buttons.cancel.on("click",this.formCancel),this.inputs.buttons.remove.on("click",this.formRemove),this.inputs.buttons.clear.on("click",this.formClear),this.inputs.buttons.upload.on("click",this.formUpload),this.inputs.fields.imageFile.on("change",this.onChange),this.inputs.fields.imageIsShown.on("change",this.isShown),this.inputs.fields.imageIsCover.on("change",this.isCover),this.validator=$(e).validate()},FileManager.prototype.edit=function(e){console.log("FileManager.edit(imageId)",e);let t=document.getElementById($(this.inputs.buttons.remove).attr("id"));if(this.formReset(),this.inputs.buttons.upload.html("Update"),e){let n=this.all.get(e),a=e?"image_"+e.toString():null,i=document.getElementById(a);n&&i&&($(i).addClass("selected"),this.setDetail(n),this.formLoad(n),t.disabled=!1)}},FileManager.prototype.open=function(){console.log("FileManager.open()"),$(this.inputs.fields.imageFile).trigger("click")},FileManager.prototype.render=function(){this.form=this.fileForm(),this.gallery=this.fileGallery(),$(this.element).append(this.form,this.gallery),this.input=$(this.inputs.fields.imageFile)[0];document.getElementById($(this.form).attr("id"));initializeValidator(),this.formHide()},FileManager.prototype.load=function(e){console.log("FileManager.load(options)",e),e&&e.source&&e.sourceId&&(this.all=new Map,this.source=e.source?e.source:null,this.images=e.images?e.images:[],this.sourceId=isNaN(parseInt(e.sourceId))?null:parseInt(e.sourceId),this.formReset(),this.formHide(),this.galleryContainer.empty(),this.loadAll())},FileManager.prototype.init=function(e){console.log("FileManager.init(options)",e),this.inputs.displays.imageId=null,this.inputs.displays.imageName=null,this.inputs.displays.imageAlt=null,this.inputs.displays.imageTitle=null,this.inputs.displays.imageIsCover=null,this.inputs.displays.imagePath=null,this.inputs.displays.imageExtension=null,this.inputs.displays.imageDimensions=null,this.inputs.displays.imageSize=null,this.inputs.displays.imageHeight=null,this.inputs.displays.imageWidth=null,this.inputs.displays.imageEnabled=null,this.inputs.displays.imageDateCreated=null,this.inputs.displays.imageCreatedBy=null,this.inputs.displays.imageDateModified=null,this.inputs.displays.imageModifiedBy=null,this.inputs.displays.imageNote=null,this.inputs.displays.imageFile=null,this.inputs.displays.imageType=null,this.inputs.displays.imageRatio=null,this.inputs.errors.imageId=null,this.inputs.errors.imageName=null,this.inputs.errors.imageAlt=null,this.inputs.errors.imageTitle=null,this.inputs.errors.imageIsCover=null,this.inputs.errors.imageEnabled=null,this.inputs.errors.imageIsShown=null,this.inputs.errors.imageFile=null,this.inputs.labels.imageId=null,this.inputs.labels.imageNameField=null,this.inputs.labels.imageNameDetail=null,this.inputs.labels.imageAlt=null,this.inputs.labels.imageTitle=null,this.inputs.labels.imageIsCover=null,this.inputs.labels.imageEnabled=null,this.inputs.labels.imageIsShown=null,this.inputs.fields.imageId=null,this.inputs.fields.imageName=null,this.inputs.fields.imageAlt=null,this.inputs.fields.imageTitle=null,this.inputs.fields.imageIsCover=null,this.inputs.fields.imageEnabled=null,this.inputs.fields.imageIsShown=null,this.inputs.fields.progress=null,this.inputs.buttons.toggle=null,this.inputs.buttons.close=null,this.inputs.buttons.cancel=null,this.inputs.buttons.remove=null,this.inputs.buttons.clear=null,this.inputs.buttons.upload=null,this.inputs.fields.imageFileButton=null,this.loader=null,this.input=null,this.file.sizeFormatted=null,this.form=null,this.gallery=null,this.preview=null,this.detailSection=null,this.galleryContainer=null,this.settings.urls={get:`/api/v1.0/images/${this.source}/${this.sourceId}`,update:"/api/v1.0/images/update",remove:"/api/v1.0/images/remove"}},$.fn.fileManager=function(e){"use strict";return new FileManager(document.getElementById($(this).attr("id")),e)};const Product=function(){"use strict";const e=document.getElementById("product_edit_meta_description_long_update_button"),t=document.getElementById("product_edit_meta_description_short_update_button"),n=document.getElementById("product_edit_meta_product_amenities_update_button"),a=document.getElementById("product_edit_meta_product_keywords_update_button"),i=document.getElementById("product_edit_details_section_publish"),o=document.getElementById("product_edit_details_section_save_draft"),l=document.getElementById("modal_product_depart_from_time"),d=document.getElementById("modal_product_depart_from_date"),r=document.getElementById("modal_product_arrive_to_time"),s=document.getElementById("modal_product_arrive_to_date"),c=document.getElementById("modal_product_depart_from_airport"),u=document.getElementById("modal_product_arrive_to_airport"),m=document.getElementById("modal_product_depart_from_station"),_=document.getElementById("modal_product_arrive_to_station"),p=document.getElementById("modal_product_depart_from_airport_id"),g=document.getElementById("modal_product_arrive_to_airport_id"),f=document.getElementById("modal_product_depart_from_station_id"),y=document.getElementById("modal_product_arrive_to_station_id"),v=document.getElementById("modal_button_cancel_add_product"),h=document.getElementById("modal_button_submit_add_product"),b=document.getElementById("modal_product_provider_name"),I=document.getElementById("modal_product_vendor_name"),w=document.getElementById("modal_product_provider_id"),E=document.getElementById("modal_product_vendor_id"),B=document.getElementById("modal_new_product"),k=document.getElementById("modal_product_name"),N=document.getElementById("modal_product_category_id"),M=document.getElementById("modal_product_sku"),x=document.getElementById("modal_product_rating_types_id"),C=document.getElementById("modal_product_currency_id"),S=document.getElementById("modal_product_pricing_strategies_types_id"),P=document.getElementById("modal_product_provider_company_id"),D=document.getElementById("modal_product_vendor_company_id"),L=document.getElementById("modal_product_provider_vendor_match"),F=document.getElementById("modal_product_provider_location_id"),T=document.getElementById("modal_product_location_id"),R=document.getElementById("modal_product_street_1"),q=document.getElementById("modal_product_street_2"),A=document.getElementById("modal_product_postal_code"),O=document.getElementById("modal_product_city_id"),Q=document.getElementById("modal_product_province_id"),Y=document.getElementById("modal_product_country_id"),U=document.getElementById("modal_product_city"),W=document.getElementById("modal_button_clear_add_product"),j=document.getElementById("modal_product_depart_from_station_date"),z=document.getElementById("modal_product_arrive_to_station_date"),V=document.getElementById("modal_product_depart_from_station_time"),H=document.getElementById("modal_product_arrive_to_station_time"),G=document.getElementById("form_product_add"),K=document.getElementById("product_edit_page"),J=document.getElementById("product_panel_link_overview"),Z=document.getElementById("panel_tab_product_o"),X=document.getElementById("product_panel_link_product"),ee=document.getElementById("panel_tab_product"),te=document.getElementById("product_panel_link_season"),ne=document.getElementById("panel_tab_season"),ae=document.getElementById("product_panel_link_unit"),ie=document.getElementById("panel_tab_unit"),oe=document.getElementById("product_panel_link_variant"),le=document.getElementById("panel_tab_variant"),de=document.getElementById("product_panel_link_inventory"),re=document.getElementById("panel_tab_inventory"),se=document.getElementById("product_panel_link_pricing"),ce=document.getElementById("panel_tab_pricing"),ue=document.getElementById("panel_tab_location"),me=(document.getElementById("panel_tab_product_location"),document.getElementById("panel_tab_product_meta"),document.getElementById("panel_tab_meta")),_e=document.getElementById("product_panel_link_meta"),pe=document.getElementById("product_panel_link_location"),ge=document.getElementById("product_edit_details_currency_id"),fe=document.getElementById("product_edit_details_rating_types_id"),ye=document.getElementById("product_keywords"),ve=document.getElementById("product_edit_meta_description_long"),he=document.getElementById("product_edit_meta_description_short"),be=document.getElementById("product_index_page"),Ie=document.getElementById("product_index_table"),$e=document.getElementById("product_amenities"),we=document.getElementById("product_id"),Ee=document.getElementById("product_edit_details_name"),Be=document.getElementById("product_edit_details_enabled"),ke=document.getElementById("product_edit_details_sku"),Ne=document.getElementById("pricing_strategy_types_id"),Me=document.getElementById("product_edit_location_city_id"),xe=document.getElementById("product_edit_location_id"),Ce=document.getElementById("provider_id"),Se=document.getElementById("vendor_id"),Pe=document.getElementById("display_product_name"),De=document.getElementById("button_save_product"),Le=document.getElementById("button_add_product_page_heading"),Fe=document.getElementById("category_id"),Te=document.getElementById("product_location_departing_station_city_id"),Re=document.getElementById("product_location_arriving_station_city_id"),qe=document.getElementById("product_location_departing_airport_id"),Ae=document.getElementById("product_location_arriving_airport_id"),Oe=document.getElementById("product_location"),Qe=document.getElementById("product_edit_details_submit_button"),Ye=document.getElementById("product_description_long"),Ue=document.getElementById("product_edit_details_section_seasons"),We=document.getElementById("product_edit_details_section_units"),je=document.getElementById("product_edit_details_section_variants"),ze=document.getElementById("product_edit_details_section_status"),Ve=document.getElementById("product_description_short"),He=document.getElementById("product_edit_details_section_profiles"),Ge=document.getElementById("user_id");let Ke,Je,Ze,Xe,et,tt,nt=document.querySelectorAll('input[type=radio][name="location_to_use"]'),at=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,it={groups:{},rules:{modal_product_sku:{required:!0},modal_product_depart_from_airport:function(e){let t=isNaN(parseInt(document.getElementById("category_id")))?null:parseInt(document.getElementById("category_id"));if(console.log("categoryId",t),2===t)return!0},modal_product_depart_from_airport_id:function(e){let t=isNaN(parseInt(document.getElementById("category_id")))?null:parseInt(document.getElementById("category_id"));if(console.log("categoryId",t),2===t)return!0},modal_product_arrive_to_airport:function(e){let t=isNaN(parseInt(document.getElementById("category_id")))?null:parseInt(document.getElementById("category_id"));if(console.log("categoryId",t),2===t)return!0},modal_product_arrive_to_airport_id:function(e){let t=isNaN(parseInt(document.getElementById("category_id")))?null:parseInt(document.getElementById("category_id"));if(console.log("categoryId",t),2===t)return!0},modal_product_rating_types_id:{required:!0},modal_product_city_id:{required:!0},modal_product_currency_id:{required:!0},modal_product_pricing_strategies_types_id:{required:!0},modal_product_name:{required:!0},modal_product_category_id:{required:!0},modal_product_provider_name:{required:!0},modal_product_provider_id:{required:!0},modal_product_provider_company_id:{required:!0},modal_product_vendor_name:{required:!0},modal_product_vendor_id:{required:!0},modal_product_vendor_company_id:{required:!0}},messages:{modal_product_city_id:{required:"Field Required"},modal_product_sku:{required:"Field Required"},modal_product_depart_from_airport:{required:"Field Required"},modal_product_depart_from_airport_id:{required:"Field Required"},modal_product_arrive_to_airport:{required:"Field Required"},modal_product_arrive_to_airport_id:{required:"Field Required"},modal_product_rating_types_id:{required:"Field Required"},modal_product_currency_id:{required:"Field Required"},modal_product_pricing_strategies_types_id:{required:"Field Required"},modal_product_name:{required:"Field Required"},modal_product_provider_id:{required:"Field Required"},modal_product_category_id:{required:"Field Required"},modal_product_provider_name:{required:"Field Required"},modal_product_vendor_name:{required:"Field Required"},modal_product_provider_company_id:{required:"Field Required"},modal_product_vendor_id:{required:"Field Required"},modal_product_vendor_company_id:{required:"Field Required"}}};$(e).on("click",function(){console.log("Product.product_edit_meta_description_long_update_button.click()"),ot()}),$(t).on("click",function(){console.log("Product.product_edit_meta_description_short_update_button.click()"),ot()}),$(n).on("click",function(){console.log("Product.product_edit_meta_product_amenities_update_button.click()"),ot()}),$(a).on("click",function(){console.log("Product.product_edit_meta_product_keywords_update_button.click()"),ot()}),$(i).on("click",function(){console.log("Product.product_edit_details_section_publish.click()")}),$(o).on("click",function(){console.log("Product.product_edit_details_section_save_draft.click()")}),$("#button_view_calendar").on("click",function(){$("#seasonCalendarModal").modal("show")}),$(Ee).on("change",function(){Pe.innerText=Ee.value}),$(Qe).on("click",function(){dt()}),$(fe).on("change",function(){Product.detail.rating_types_id=isNaN(parseInt(fe.value))?1:parseInt(fe.value),It()}),$(De).on("click",function(){_t()}),$(Le).on("click",function(){mt()}),$(B).on("hide.bs.modal",function(){ut(),clearValidation(G)}),$(v).on("click",function(){ut(),Airport.resetAirportForm("depart_from"),Airport.resetAirportForm("arrive_to"),Station.resetStationForm("depart_from"),Station.resetStationForm("arrive_to"),clearValidation(G),$(B).modal("hide")}),$(h).on("click",function(){ct()&&confirmDialog("Would you like to update?",e=>{e&&rt()})}),$(L).on("change",function(){null!==(isNaN(parseInt(P.value))?null:parseInt(P.value))&&(L.checked?(D.value=P.value,null!==Provider.detail?(D.value=Provider.detail.vendor.company_id,E.value=Provider.detail.vendor.id,I.value=Provider.detail.vendor.name):(D.value="",E.value="",I.value="")):(D.value="",E.value="",I.value=""))}),$(W).on("click",function(){ut()}),$("#page").on("change",function(){bt()}),$(he).on("change",function(){Product.detail.description_short=$(this).val(),It()}),$(ve).on("change",function(){Product.detail.description_long=$(this).val(),It()});const ot=function(){console.log("Product.updateMeta()");let e=isNaN(parseInt(we.value))?null:parseInt(we.value);console.log("|__ productId",e);let t=isNaN(parseInt(Fe.value))?null:parseInt(Fe.value);console.log("|__ categoryId",t);let n=isNaN(parseInt(Ge.value))?null:parseInt(Ge.value);console.log("|__ userId",n);let a=function(){console.log("Product.buildMetaObject()");let e=isNaN(parseInt(we.value))?null:parseInt(we.value),t=Xe.build(),n=et.build(),a=""!==he.value?he.value:null,i=""!==ve.value?ve.value:null;return removeNulls({amenities:n,keywords:t,id:e,description_long:i,description_short:a})}();console.log("|__ dataToSend",a),confirmDialog("Would you like to update?",e=>{e&&lt(a,function(e){let t;if(e){t=e,e[0]&&(t=e[0]);pt(t);K&&bt(),yt(`Product ${t.name} was updated.`,"Product","success")}})})},lt=function(e,t){if(console.log("Product.sendRequestUpdateProductMeta(dataToSend, callback)",e),e){let n="/api/v1.0/products/update_meta";try{sendPostRequest(n,e,function(e,n,a){if(e)return t(e)})}catch(e){return console.log("error",e),yt("Error")}}},dt=function(){console.log("Product.updateProductDetails()");isNaN(parseInt(we.value))||parseInt(we.value),isNaN(parseInt(Fe.value))||parseInt(Fe.value),isNaN(parseInt(Ge.value))||parseInt(Ge.value);let e=function(){console.log("Product.buildProductDetailRecord()");let e=ft(),t=Be&&!0===Be.checked?1:0,n=isNaN(parseInt(fe.value))?null:parseInt(fe.value),a=isNaN(parseInt(ge.value))?null:parseInt(ge.value),i=Ee&&""!==Ee.value?Ee.value:null,o=isNaN(parseInt(we.value))?null:parseInt(we.value);isNaN(parseInt(Fe.value))||parseInt(Fe.value),isNaN(parseInt(Ge.value))||parseInt(Ge.value);return removeNulls({id:o||null,rating_types_id:n||null,currency_id:a||null,name:i||null,sku:e||null,enabled:t})}();confirmDialog("Would you like to update?",t=>{t&&function(e,t){if(console.log("Product.sendRequestUpdateProductDetail(dataToSend)",e),e){let n="/api/v1.0/products/update_detail";try{sendPostRequest(n,e,function(e,n,a){if(console.log("|__ |__ data",e),e)return t(e)})}catch(e){return console.log("error",e),yt("Error")}}}(e,function(e){let t;if(e){t=e,e[0]&&(t=e[0]),console.log("|__ |__ product",t);pt(t);K&&bt(),yt(`Product ${t.name} was updated.`,"Product","success")}})})},rt=function(){console.log("Product.saveNewProduct()");let e,t=function(){console.log("Category.buildInsertData()");let e,t,n,a,i,o,l,d,r,s,c,u,m,_,v,h,b,I,$,B=isNaN(parseInt(N.value))?null:parseInt(N.value),L={name:null,street_1:null,street_2:null,zipcode:null,country_id:null,province_id:null,city_id:null};_=Y&&!isNaN(parseInt(Y.value))?parseInt(Y.value):null,m=Q&&!isNaN(parseInt(Q.value))?parseInt(Q.value):null,v=O&&!isNaN(parseInt(O.value))?parseInt(O.value):null,s=R&&""!==R.value?R.value:null,c=q&&""!==q.value?q.value:null,u=A&&""!==A.value?A.value:null,e=k&&""!==k.value?k.value:null,t=M&&""!==M.value?M.value:null,n=C&&!isNaN(parseInt(C.value))?parseInt(C.value):null,o=w&&!isNaN(parseInt(w.value))?parseInt(w.value):null,l=E&&!isNaN(parseInt(E.value))?parseInt(E.value):null,i=x&&!isNaN(parseInt(x.value))?parseInt(x.value):null,a=S&&!isNaN(parseInt(S.value))?parseInt(S.value):null;let F=moment(new Date).format("YYYY-MM-DD"),T=moment(F,"YYYY-MM-DD").add(3,"months").format("YYYY-MM-DD"),U=moment(T,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD");1===B?(d=null,r=null,h=null,b=null,I=null,$=null,L={name:e,location_types_id:2,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):2===B?(d=isNaN(parseInt(p.value))?null:parseInt(p.value),r=isNaN(parseInt(g.value))?null:parseInt(g.value),h=Product.depart_from_date&&""!==Product.depart_from_date.value()&&null!==Product.depart_from_date.value()?Product.depart_from_date.value():T,b=Product.depart_from_time&&""!==Product.depart_from_time.value()&&null!==Product.depart_from_time.value()?Product.depart_from_time.value():"12:00",I=Product.arrive_to_date&&""!==Product.arrive_to_date.value()&&null!==Product.arrive_to_date.value()?Product.arrive_to_date.value():U,$=Product.arrive_to_time&&""!==Product.arrive_to_time.value()&&null!==Product.arrive_to_time.value()?Product.arrive_to_time.value():"12:00",L={name:e,location_types_id:3,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):3===B?(d=null,r=null,h=null,b=null,I=null,$=null,L={name:e,location_types_id:18,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):4===B?(d=isNaN(parseInt(f.value))?null:parseInt(f.value),r=isNaN(parseInt(y.value))?null:parseInt(y.value),h=Product.depart_from_date&&""!==Product.depart_from_date.value()&&null!==Product.depart_from_date.value()?Product.depart_from_date.value():T,b=Product.depart_from_time&&""!==Product.depart_from_time.value()&&null!==Product.depart_from_time.value()?Product.depart_from_time.value():"12:00",I=Product.arrive_to_date&&""!==Product.arrive_to_date.value()&&null!==Product.arrive_to_date.value()?Product.arrive_to_date.value():U,$=Product.arrive_to_time&&""!==Product.arrive_to_time.value()&&null!==Product.arrive_to_time.value()?Product.arrive_to_time.value():"12:00",L={name:e,location_types_id:4,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):5===B?(d=null,r=null,h=null,b=null,I=null,$=null,L={name:e,location_types_id:7,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):6===B?(d=null,r=null,h=null,b=null,I=null,$=null,L={name:e,location_types_id:17,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):7===B?(d=null,r=null,h=null,b=null,I=null,$=null,L={name:e,location_types_id:19,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):8===B?(d=null,r=null,h=null,b=null,I=null,$=null,L={name:e,location_types_id:19,street_1:s,street_2:c,zipcode:u,country_id:_,province_id:m,city_id:v}):(d=null,r=null);let W={category_id:B,depart_from:d,depart_date:h,depart_time:b,arrive_to:r,arrive_date:I,arrive_time:$,street_1:s,street_2:c,country_id:_,province_id:m,city_id:v,postal_code:u,pricing_strategy_types_id:a,status_types_id:1,currency_id:n,rating_types_id:i,provider_id:o,vendor_id:l,provider_vendor_match:(isNaN(parseInt(P.value))?null:parseInt(P.value))===(isNaN(parseInt(D.value))?null:parseInt(D.value))?1:0,name:e,sku:t,use_provider_location_id:0,location:L};return remove_nulls(W)}();console.log("|__ dataToSend",t),st(t,function(t){if(console.log("data",t),t&&(e=t,1===t.length&&(e=t[0]),e.id)){let t=pt(e);console.log("|__ detail",t),tt.insertRow(t),tt.loadRow(t),tt.jumpToRow(t),tt.clearSelectedRows(),toastr.success(`Product - ${e.id} was created, would you like to edit?`,"Product Created")}})},st=function(e,t){console.log("Product.newProduct(dataToSend)",e);if(e)try{sendPostRequest("/api/v1.0/products/add",e,function(e,n,a){return e?t(e):yt("Oops: 1")})}catch(e){console.log("error",e),yt("Oops: 1")}},ct=function(){console.log("Product.validateNewProduct()");let e=!1;if(G){e=$(G).valid(),console.log("isValid",e);var t=jQuery(G).validate(it);if(console.log("validator",t),jQuery(G).valid())for(var n=new Object,a=0;a<t.errorList.length;a++)console.log("Product.newProduct_validator.errorList[i].message");console.log("Submit Errors",n)}return console.log("isValid",e),e},ut=function(){console.log("Product.clearModalForm()"),B&&(k.value="",R.value="",q.value="",A.value="",Product.depart_from_date.value(""),Product.arrive_to_date.value(""),c.value="",u.value="",m.value="",_.value="",p.value="",g.value="",f.value="",y.value="",N.value="",M.value="",x.value="",C.value="",P.value="",D.value="",S.value="",F.value="",T.value="",U.value="",O.value="",Product.attr1=null,Product.attr2=null,Product.attr3=null,Product.updateProductSKU(),$("div[data-categoryid]").hide(),Product.resetNewProductDetails())},mt=function(){ut(),$(B).modal("show")},_t=function(){let e=function(){{let e,t,n=isNaN(parseInt(Fe.value))?null:parseInt(Fe.value);2===n?(e=isNaN(parseInt(Ae.value))?null:parseInt(Ae.value),t=isNaN(parseInt(qe.value))?null:parseInt(qe.value)):4===n?(e=isNaN(parseInt(Re.value))?null:parseInt(Re.value),t=isNaN(parseInt(Te.value))?null:parseInt(Te.value)):(e=null,t=null);let a={id:isNaN(parseInt(we.value))?null:parseInt(we.value),category_id:isNaN(parseInt(Fe.value))?null:parseInt(Fe.value),description_short:he&&""!==he.value?he.value:null,description_long:ve&&""!==ve.value?ve.value:null,amenities:et.build(),keywords:Xe.build(),rating_types_id:isNaN(parseInt(fe.value))?null:parseInt(fe.value),currency_id:isNaN(parseInt(ge.value))?null:parseInt(ge.value),name:""!==Ee.value?Ee.value:null,pricing_strategy_types_id:isNaN(parseInt(Ne.value))?null:parseInt(Ne.value),city_id:isNaN(parseInt(Me.value))?null:parseInt(Me.value),location_id:xe&&!isNaN(parseInt(xe.value))?parseInt(xe.value):null,provider_id:isNaN(parseInt(Ce.value))?null:parseInt(Ce.value),vendor_id:isNaN(parseInt(Se.value))?null:parseInt(Se.value),use_provider_location_id:0,provider_vendor_match:1,status_types_id:2,enabled:Be.checked?1:0,sku:""!==ke.value?ke.value:null,arrive_to:e,depart_from:t};return removeNulls(a)}}();console.log("dataToSend",e),e&&confirmDialog("Would you like to update?",t=>{t&&function(e,t){if(e)try{sendPostRequest("/api/v1.0/products/update",e,function(e,n,a){if(e)return t(e);yt("Oops: 1")})}catch(e){console.log("error",e),yt("Oops: 1")}}(e,function(e){let t;if(e&&(t=e,e[0]&&(t=e[0])),t.id){let e=pt(t),n=e.name?e.name:null;toastr.success(`Product ${n} has been updated`,"Product Updated")}})})},pt=function(e){console.log("Product.set(product)",e);let t={id:null,category_id:null,pricing_strategy_types_id:null,status_types_id:null,product_status_types_id:null,currency_id:null,location_id:null,city_id:null,vendor_id:null,provider_id:null,name:null,provider_vendor_match:1,description_short:null,description_long:null,rating:null,sku:null,phone:null,infant:null,child:null,teen:null,depart_from:null,arrive_to:null,depart_time:null,arrive_time:null,day_span:null,cover_image:null,api_id:null,from_api:1,hotel_code:null,enabled:1,date_created:formatDateMySQL(),created_by:at,date_modified:formatDateMySQL(),modified_by:at,note:null,amenities:"",keywords:"",seasons:[],units:[],use_provider_location:0,variants:[],category:{},location:{},vendor:{},profiles:[],provider:{}};return e&&(t.id=e.id?e.id:null,t.category_id=e.category_id?e.category_id:null,t.pricing_strategy_types_id=e.pricing_strategy_types_id?e.pricing_strategy_types_id:null,t.status_types_id=e.status_types_id?e.status_types_id:null,t.product_status_types_id=e.product_status_types_id?e.product_status_types_id:null,t.currency_id=e.currency_id?e.currency_id:null,t.location_id=e.location_id?e.location_id:null,t.city_id=e.city_id?e.city_id:null,t.vendor_id=e.vendor_id?e.vendor_id:null,t.provider_id=e.provider_id?e.provider_id:null,t.name=e.name?e.name:null,t.provider_vendor_match=e.provider_vendor_match?e.provider_vendor_match:1,t.description_short=e.description_short?e.description_short:null,t.description_long=e.description_long?e.description_long:null,t.rating=e.rating?e.rating:null,t.sku=e.sku?e.sku:null,t.phone=e.phone?e.phone:null,t.infant=e.infant?e.infant:null,t.child=e.child?e.child:null,t.teen=e.teen?e.teen:null,t.depart_from=e.depart_from?e.depart_from:null,t.arrive_to=e.arrive_to?e.arrive_to:null,t.depart_time=e.depart_time?e.depart_time:null,t.arrive_time=e.arrive_time?e.arrive_time:null,t.day_span=e.day_span?e.day_span:null,t.cover_image=e.cover_image?e.cover_image:null,t.api_id=e.api_id?e.api_id:null,t.from_api=e.from_api?e.from_api:1,t.hotel_code=e.hotel_code?e.hotel_code:null,t.enabled=e.enabled?e.enabled:1,t.date_created=e.date_created?e.date_created:formatDateMySQL(),t.created_by=e.created_by?e.created_by:at,t.date_modified=e.date_modified?e.date_modified:formatDateMySQL(),t.modified_by=e.modified_by?e.modified_by:at,t.note=e.note?e.note:null,t.category=e.category?e.category:{},t.keywords=e.keywords?e.keywords:"",t.amenities=e.amenities?e.amenities:"",t.seasons=e.seasons?e.seasons:[],t.units=e.units?e.units:[],t.use_provider_location=e.use_provider_location?e.use_provider_location:0,t.variants=e.variants?e.variants:[],t.location=e.location?e.location:{},t.vendor=e.vendor?e.vendor:{},t.provider=e.provider?e.provider:{}),Product.detail=t,t},gt=function(e){Product.all=new Map,e&&$.each(e,function(e,t){let n=pt(t);tt.insertRow(n),Product.all.set("id",n)})},ft=function(){let e=Product.attr1,t=Product.attr2,n=Product.attr3,a="";if(is_null(e)||is_null(t)||is_null(n)){if(M&&(M.value=""),is_null(e))return;if(is_null(t))return;if(is_null(n))return}else a=e.replace(/-/g,"")+"-"+t.replace(/-/g,"")+"-"+n.replace(/-/g,""),M&&(M.value=a),ke&&(ke.value=a);return a},yt=function(e,t,n){console.log("Product.handleProductError(msg)",e),t||(t="Product"),n||(n="error"),toastr[n](`${e}`,t)},vt=function(e){if(console.log("Product.index(settings)",e),Ie&&(tt=$(Ie).table({table_type:"display_list",data:[],columnDefs:[{title:"Name",targets:0,data:"name",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"SKU",targets:1,data:"sku",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e+"</span>"}},{title:"Provider",targets:2,data:"provider",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e.name+"</span>"}},{title:"Vendor",targets:3,data:"vendor",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e.name+"</span>"}},{title:"Location",targets:4,data:"location",render:function(e,t,n,a){let i="";return"<span style='white-space: nowrap;'>"+(i=e.display_medium)+"</span>"}},{title:"Category",targets:5,data:"category",render:function(e,t,n,a){return"<span style='white-space: nowrap;'>"+e.name+"</span>"}}],rowClick:Product.navigate}),e)){let t=e.products?e.products:[],n=e.stations?e.stations:[],a=e.category?e.category:[];$(document).ready(function(){B&&(Category.init(a),Airport.init(),Station.init(n)),gt(t)})}},ht=function(){let e=isNaN(parseInt(N.value))?null:parseInt(N.value);null!==e&&$(k).on("change",function(){}).on("search",function(){}).on("click",function(e){"readonly"===$(this).attr("readonly")?e.preventDefault():$(this).select()}).autocomplete({serviceUrl:"/api/v1.0/autocomplete/products",minChars:2,params:{category_id:e},cache:!1,dataType:"json",triggerSelectOnValidInput:!1,paramName:"st",onSelect:function(e){if(!e||!e.data)return;e.data}})},bt=function(){if(K){let e=Array.from(Variant.all.values()),t=Array.from(InventoryProfile.all.values()),n=Array.from(Unit.all.values()),a=Array.from(Season.all.values()),o=document.querySelectorAll("button[data-target='#seasonCalendarModal']");if(0===e.length||0===n.length||0===a.length||0===t.length)$(i).addClass("disabled"),0===e.length||0===n.length||0===a.length?(o.forEach(e=>{e.disabled=!0}),$("#button_view_calendar").addClass("disabled"),$(ce).addClass("disabled"),$(re).addClass("disabled")):$(re).removeClass("disabled"),0===t.length&&($("#button_view_calendar").addClass("disabled"),$(ce).addClass("disabled")),$(De).addClass("disabled"),$("#panel_tab_pricing").html('\n\t\t\t\t\t\t\t<span id="tab_span_pricing">Pricing</span>\n\t\t\t\t\t\t\t<span class="badge rounded-pill badge-notification bg-danger tab-badge" style="color:#fff!important">!</span>\n\t\t\t\t\t\t');else{$("#button_view_calendar").removeClass("disabled"),$(ce).removeClass("disabled"),$(re).removeClass("disabled"),"incomplete"===PricingWorksheet.status()?($(i).addClass("disabled"),$(De).addClass("disabled"),$("#panel_tab_pricing").html("<span id='tab_span_pricing'>Pricing</span> <span class='badge rounded-pill badge-notification bg-danger tab-badge' style='color:#fff!important'>!</span>")):($(i).removeClass("disabled"),$(De).removeClass("disabled"),$("#panel_tab_pricing").html("<span id='tab_span_pricing'>Pricing</span>"))}It()}},It=function(){if(K){let e,t,n="Product Location",a="fas fa-archway";Product.detail.location&&(e=Product.detail.location),e&&(t=e.type?e.type:null,n=e.display_medium?e.display_medium:"Product Location"),t&&(a=t.icon?t.icon:"fas fa-archway"),Oe&&$(Oe).empty().html(`\n\t\t\t\t\t\t<i class="${a} mr-2"></i> <span class="">${n}</span>\n\t\t\t\t\t`);let i=isNaN(parseInt(fe.value))?1:parseInt(fe.value),o="";for(let e=0;e<5;e++)o+=e<i?'\n\t\t\t\t\t\t<li class="list-inline-item mr-0">\n                            <i class="fas fa-star"></i>\n                        </li>\n\t\t\t\t\t':'\n\t\t\t\t\t\t<li class="list-inline-item mr-0">\n                            <i class="far fa-star"></i>\n                        </li>\n\t\t\t\t\t';$("ul.rating").empty().html(o);let l="";if(ze){let e=isNaN(parseInt(Product.detail.status_types_id))?null:parseInt(Product.detail.status_types_id);if(e){let t=StatusTypes.all.get(e);if(t){let e=t.name?t.name:"";l=`\n\t\t\t\t\t\t\t<span class="">Status</span>\n\t\t\t\t\t\t\t<span id="product_edit_details_section_status_text" class="badge badge-${e.replace(/\s+/g,"-").toLowerCase()} badge-pill badge-status">${e}</span>\n\t\t\t\t\t\t`}}}ze&&$(ze).empty().html(l);let d=Array.from(Season.all.values()).length,r="badge badge-success badge-pill";0===d&&(r="badge badge-danger badge-pill");let s=Array.from(Unit.all.values()).length,c="badge badge-success badge-pill";0===s&&(c="badge badge-danger badge-pill");let u=Array.from(Variant.all.values()).length,m="badge badge-success badge-pill";0===u&&(m="badge badge-danger badge-pill");let _=Array.from(InventoryProfile.all.values()).length,p="badge badge-success badge-pill";0===_&&(p="badge badge-danger badge-pill"),Ue.classList=r,Ue.innerText=d,We.classList=c,We.innerText=s,je.classList=m,je.innerText=u,He.classList=p,He.innerText=_,$(Ve).empty().html(Product.detail.description_short),$(Ye).empty().html(Product.detail.description_long),ft()}},$t=function(e){let t={location:{},provider:{},vendor:{},seasons:[],units:[],variants:[],profiles:[],matrix:[]};e&&(t=e),Array.prototype.forEach.call(nt,function(e){}),function(e){console.log("Product.setEditFormValues(product)",e);let t,n=pt(e);n.category&&(t=n.category);let a=isNaN(parseInt(e.id))?null:parseInt(e.id),i=e.sku?e.sku:"",o=e.name?e.name:"",l=e.rating_types_id?e.rating_types_id:"",d=e.enabled&&1===e.enabled,r=e.currency_id?e.currency_id:"",s=e.description_long?e.description_long:"",c=e.description_short?e.description_short:"",u=e.keywords?e.keywords:[],m=e.amenities?e.amenities:[],_=e.images?e.images:[];Product.fileManager=$("#product_images").fileManager({height:400,source:"product",sourceId:a,images:_}),Xe=$(ye).BuildKeyword(u),et=$($e).BuildKeyword(m),Ee.value=o,ke.value=i,Be.checked=d,he.value=c,ve.value=s,ge.value=r,fe.value=l,Product.attr1=t.attribute_id?t.attribute_id:null}(t)};return{validator:null,depart_from_date:null,depart_from_time:null,calendars:null,product_initial_location:null,provider_initial_location:null,arrive_to_station_time:null,depart_from_station_time:null,arrive_to_station_date:null,depart_from_station_date:null,detail:{},all:new Map,attr1:null,attr2:null,attr3:null,newProduct_validator:null,updateDisplay:function(){It()},updateProgress:function(){bt(),$("html").css({overflow:"auto"})},updateProductSKU:function(){ft()},setNewFormDetails:function(e){var t;t=e,console.log("Product.setNewFormDetails(category_id)",t)},get:function(e){},loadAll:function(e){gt(e)},save:function(e){_t(e)},init:function(e){!function(e){let t,n,a,i,o,c,u,m,_,p,g,f,y;console.log("Product.init(settings)",e),K&&$(document).ready(function(){if(Ke=document.getElementById("user_id")?isNaN(parseInt(document.getElementById("user_id").value))?4:parseInt(document.getElementById("user_id").value):4,Je=document.getElementById("category_id")?isNaN(parseInt(document.getElementById("category_id").value))?null:parseInt(document.getElementById("category_id").value):null,Ze=document.getElementById("product_id")?isNaN(parseInt(document.getElementById("product_id").value))?null:parseInt(document.getElementById("product_id").value):null,e&&e.product_details){(t=e.product_details).images&&(y=t.images),t.provider&&(c=t.provider),t.vendor&&(u=t.vendor),t.variants&&(n=t.variants),t.seasons&&(a=t.seasons),t.matrices&&(m=t.matrices),t.profiles&&(o=t.profiles),t.units&&(i=t.units),t.pricings&&(_=t.pricings),t.location&&(p=t.location),t.arriving_location&&(g=t.arriving_location),t.departing_location&&(f=t.departing_location);let l={pricing_strategy_types_id:isNaN(parseInt(t.pricing_strategy_types_id))?null:parseInt(t.pricing_strategy_types_id)};switch(Provider.init({provider_detail:c}),Vendor.init({vendor_detail:u}),Variant.init(n),Season.init(a),Season.loadAll(a),Unit.init({units:i}),Matrix.init({matrices:m}),Pricing.init({pricings:_}),InventoryProfile.init({profiles:o}),PricingWorksheet.init({pricing_strategy:l,pricings:_}),Product.calendar=$("#calendar").YearCalendar({displayEventTime:!1,calendarType:"season",events:[]}),Je){case 1:ProductLocation.init({product_location:p,product:t});break;case 2:ProductLocation.init({product_location:p,departing_location:f,arriving_location:g,product:t});break;case 3:ProductLocation.init({product_location:p,product:t});break;case 4:ProductLocation.init({product_location:p,departing_location:f,arriving_location:g,product:t});break;case 5:ProductLocation.init({product_location:p,product:t});break;case 6:ProductLocation.init({product_location:p,product:t}),Tour.init({route:[]});break;case 7:case 8:case 9:ProductLocation.init({product_location:p,product:t})}$(J).on("click",function(){$(Z).tab("show")}),$(pe).on("click",function(){$(ue).tab("show")}),$(X).on("click",function(){$(ee).tab("show")}),$(te).on("click",function(){$(ne).tab("show")}),$(ae).on("click",function(){$(ie).tab("show")}),$(oe).on("click",function(){$(le).tab("show")}),$(de).on("click",function(){$(re).tab("show")}),$(se).on("click",function(){$(ce).tab("show")}),$(_e).on("click",function(){$(me).tab("show")}),ht(),$t(t),bt()}}),be&&(Provider.init(),Product.index(e),G&&$(document).ready(function(){d&&(Product.depart_from_date=$(d).dateSelect({onStart:function(){}})),l&&(Product.depart_from_time=$(l).timeSelect({onStart:function(){}})),s&&(Product.arrive_to_date=$(s).dateSelect({onStart:function(){}})),r&&(Product.arrive_to_time=$(r).timeSelect({onStart:function(){}})),z&&(Product.depart_from_station_date=$(z).dateSelect({onStart:function(){}})),j&&(Product.depart_from_station_date=$(j).dateSelect({onStart:function(){}})),H&&(Product.arrive_to_station_time=$(H).timeSelect({onStart:function(){}})),V&&(Product.depart_from_station_time=$(V).timeSelect({onStart:function(){}})),validator_init(it),Product.newProduct_validator=$(G).validate()}))}(e)},index:function(e){vt(e)},navigate:function(e){!function(e){e&&e.id&&window.location.replace("/products/"+e.id)}(e)},resetNewProductDetails:function(){console.log("Product.resetNewProductDetails()"),Product.depart_from_date.value(""),Product.arrive_to_date.value(""),Airport.resetAirportForm("depart_from"),Airport.resetAirportForm("arrive_to"),Station.resetStationForm("depart_from"),Station.resetStationForm("arrive_to"),l.value="",r.value="",c.value="",u.value="",w.value="",E.value="",b.value="",I.value="",U.value="",k.value="",M.value="",O.value="",x.value="",C.value="",S.value="",k.disabled=!0,M.disabled=!0,x.disabled=!0,C.disabled=!0,S.disabled=!0,U.disabled=!0,clearValidation(G)},initAutoComplete:function(){ht()}}}();$(function(){const e=document.getElementById("profile_card"),t=document.getElementById("profile_card_cover_image"),n=document.getElementById("profile_edit_name");$(n).on("click",function(){});const a=function(){parseInt($(e).outerHeight());let n,a=parseInt($(e).outerWidth()),i=0;n=a/2+"px",i=a+"px",$(t).css({width:"100%",height:"100%","max-height":n+"px"})};window.addEventListener("resize",debounce(function(t){e&&a()})),a()}),$(document).ready(function(){window.addEventListener("load",function(){const e=document.getElementsByTagName("input");mdbPreloader&&$(mdbPreloader).delay(1e3).fadeOut(300);for(let t=0;t<e.length;t++)"text"===e[t].type&&(e[t].classList.contains("date-format"),e[t].classList.contains("time-format"))},!1),window.addEventListener("resize",debounce(function(e){resize_elements()})),(new WOW).init(),$(this).scrollTop(0),$("body").scrollTop(),$.fn.dataTableExt.afnFiltering.push(function(e,t,n){if("dates_table"===e.nTable.id){var a=document.getElementById("min").value,i=document.getElementById("max").value;a=a.substring(6,10)+a.substring(3,5)+a.substring(0,2),i=i.substring(6,10)+i.substring(3,5)+i.substring(0,2);var o=t[1].substring(6,10)+t[1].substring(3,5)+t[1].substring(0,2),l=t[1].substring(6,10)+t[1].substring(3,5)+t[1].substring(0,2);return""===a&&""===i||(a<=o&&""===i||(i>=l&&""===a||a<=o&&i>=l))}return!0}),"scrollRestoration"in history&&(history.scrollRestoration="manual"),$(".button-collapse").sideNav(sideNavOptions),window.scrollTo(0,0),resize_elements(),$(function(){$('[data-toggle="tooltip"]').tooltip()}),document.querySelectorAll(".panel-code").forEach(e=>{let t=$(e).html(),n="",a="";$(e).empty(),"json"===e.dataset.datatype?(n=jsonPrettify(t),a="json"):"jsonp"===e.dataset.datatype?(n=jsonPrettify(t),a="jsonp"):"json5"===e.dataset.datatype&&(n=jsonPrettify(t),a="json5");let i=document.createElement("pre"),o=document.createElement("code");o.classList=[`language-${a}`],o.innerHTML=n,i.appendChild(o),e.appendChild(i),Prism.highlightElement(o)}),$("button.pre_display_button").show(),$("div.pre_display_el").hide(),$(function(){$("textarea.short-description").maxlength({alwaysShow:!0,threshold:10,warningClass:"badge badge-warning",limitReachedClass:"badge badge-danger"})}),$(function(){toastr.options={closeButton:!0,debug:!0,newestOnTop:!0,progressBar:!1,positionClass:"md-toast-bottom-right",preventDuplicates:!0,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}})});