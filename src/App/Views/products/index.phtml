<?php
	
	use Framework\App\Controllers\Location;
	
	if (!isset($page_data)) {
		$page_data = [];
	}
	
	$temp = [];
	$temp["products"] = [];
	$temp["stations"] = [];
	$temp["airports"] = [];
	
	$products = (isset($page_data["products"])) ? $page_data["products"] : [];
	$stations = (isset($page_data["stations"])) ? $page_data["stations"] : [];
	$airports = (isset($page_data["airports"])) ? $page_data["airports"] : [];
	
	foreach ($products AS $product) {
		$temp["products"][] = $product;
	}
	
	foreach ($stations AS $station) {
		$temp["stations"][] = $station;
	}
	
	foreach ($airports AS $airport) {
		$temp["airports"][] = $airport;
	}
	
	$types = json_decode(TYPES, true);
	
	foreach ($types AS $k => $type) {
		$temp["types"][$k] = $type;
	}
	
	$settings = json_encode($temp, 1);
	
	//echo "<pre>" . var_export($types["category"], 1) . "</pre>";
	//echo "<pre>" . var_export($page_data["products"], 1) . "</pre>";
	
	$init = "Product.init($settings);";
	
	if (!defined("COUNTRIES")) {
		define("COUNTRIES", $page_data["types"]["countries"]);
	}
	
	$currency = [];
	if (isset($page_data["types"]["currency"])) {
		$currency = $page_data["types"]["currency"];
	}
	
	$airport_types = [];
	if (isset($page_data["types"]["airport_types"])) {
		$airport_types = $page_data["types"]["airport_types"];
	}

?>

<!-- Product Index Page -->
<section id="product_index_page" class="section">
	<!--
	<div class="row gx-1">
		<div class="col-12 p-1">
			<?php //include_once(VIEWS_PATH . "/products/forms/product_search.phtml"); ?>
		</div>
	</div>
	-->
	
	<!-- Index Table -->
	<?php include_once(VIEWS_PATH . "/products/tables/product_index_table.phtml"); ?>
	<!-- /Index Table -->
	
	<?php //*?>
	<!-- Test Elements -->
	<div id="testElements">
		<div class="row gx-1">
			<?php //displayJsonOnPage(TYPES, "TEMP"); ?>
			<?php //displayJsonOnPage($products, "products"); ?>
			<?php //displayJsonOnPage($stations, "stations"); ?>
			<?php //displayJsonOnPage($pricings, "Pricings"); ?>
			<?php //displayJsonOnPage($vendor, "Vendor"); ?>
			<?php //displayJsonOnPage($product, "Product"); ?>
			<?php //displayJsonOnPage($location, "Location"); ?>
		</div>
	</div>
	<!-- /Test Elements -->
	<?php //*/ ?>
	
	<div class="row">
		<div class="col-12 col-md-4">
			
			<button type="button" id="package_test_button" class="btn btn-primary">Test</button>
		
		</div>
	</div>
</section>
<!-- /Product Index Page -->

<!-- New Product Modal -->
<?php include_once(VIEWS_PATH . "/products/modals/new_product_modal.phtml"); ?>
<!-- /New Product Modal -->

<!-- New Package Modal -->
<?php include_once(VIEWS_PATH . "/products/modals/new_package_modal.phtml"); ?>
<!-- /New Package Modal -->

<script type="text/javascript">
	
	$(function () {
		console.group("TYPES")
		Types.init(<?php echo TYPES;?>)
		console.groupEnd()
		
		
		<?php echo $init;?>
	})

</script>
